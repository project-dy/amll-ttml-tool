{"version":3,"file":"kuroshiro-analyzer-kuromoji-fix-dict-6EI2KzNQ.js","sources":["../../libs/kuromoji.js/src/viterbi/ViterbiNode.js","../../libs/kuromoji.js/src/viterbi/ViterbiLattice.js","../../libs/kuromoji.js/src/util/SurrogateAwareString.js","../../libs/kuromoji.js/src/viterbi/ViterbiBuilder.js","../../libs/kuromoji.js/src/viterbi/ViterbiSearcher.js","../../libs/kuromoji.js/src/util/IpadicFormatter.js","../../libs/kuromoji.js/src/Tokenizer.js","../../node_modules/.pnpm/fflate@0.8.2/node_modules/fflate/esm/browser.js","../../node_modules/.pnpm/doublearray@0.0.2/node_modules/doublearray/doublearray.js","../../libs/kuromoji.js/src/util/ByteBuffer.js","../../libs/kuromoji.js/src/dict/TokenInfoDictionary.js","../../libs/kuromoji.js/src/dict/ConnectionCosts.js","../../libs/kuromoji.js/src/dict/CharacterClass.js","../../libs/kuromoji.js/src/dict/InvokeDefinitionMap.js","../../libs/kuromoji.js/src/dict/CharacterDefinition.js","../../libs/kuromoji.js/src/dict/UnknownDictionary.js","../../libs/kuromoji.js/src/dict/DynamicDictionaries.js","../../libs/kuromoji.js/src/loader/DictionaryLoader.js","../../libs/kuromoji.js/src/loader/BrowserDictionaryLoader.js","../../libs/kuromoji.js/src/TokenizerBuilder.js","../../libs/kuromoji.js/src/dict/builder/ConnectionCostsBuilder.js","../../libs/kuromoji.js/src/dict/builder/CharacterDefinitionBuilder.js","../../libs/kuromoji.js/src/dict/builder/DictionaryBuilder.js","../../libs/kuromoji.js/src/kuromoji.js","../../node_modules/.pnpm/kuroshiro@1.2.0/node_modules/kuroshiro/dist/kuroshiro.js","../../src/utils/kuroshiro-analyzer-kuromoji-fix-dict.ts"],"sourcesContent":["/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * ViterbiNode is a node of ViterbiLattice\n * @param {number} node_name Word ID\n * @param {number} node_cost Word cost to generate\n * @param {number} start_pos Start position from 1\n * @param {number} length Word length\n * @param {string} type Node type (KNOWN, UNKNOWN, BOS, EOS, ...)\n * @param {number} left_id Left context ID\n * @param {number} right_id Right context ID\n * @param {string} surface_form Surface form of this word\n * @constructor\n */\nfunction ViterbiNode(\n\tnode_name,\n\tnode_cost,\n\tstart_pos,\n\tlength,\n\ttype,\n\tleft_id,\n\tright_id,\n\tsurface_form,\n) {\n\tthis.name = node_name;\n\tthis.cost = node_cost;\n\tthis.start_pos = start_pos;\n\tthis.length = length;\n\tthis.left_id = left_id;\n\tthis.right_id = right_id;\n\tthis.prev = null;\n\tthis.surface_form = surface_form;\n\tif (type === \"BOS\") {\n\t\tthis.shortest_cost = 0;\n\t} else {\n\t\tthis.shortest_cost = Number.MAX_VALUE;\n\t}\n\tthis.type = type;\n}\n\nexport default ViterbiNode;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ViterbiNode from \"./ViterbiNode\";\n\n/**\n * ViterbiLattice is a lattice in Viterbi algorithm\n * @constructor\n */\nfunction ViterbiLattice() {\n\tthis.nodes_end_at = [];\n\tthis.nodes_end_at[0] = [new ViterbiNode(-1, 0, 0, 0, \"BOS\", 0, 0, \"\")];\n\tthis.eos_pos = 1;\n}\n\n/**\n * Append node to ViterbiLattice\n * @param {ViterbiNode} node\n */\nViterbiLattice.prototype.append = function (node) {\n\tconst last_pos = node.start_pos + node.length - 1;\n\tif (this.eos_pos < last_pos) {\n\t\tthis.eos_pos = last_pos;\n\t}\n\n\tlet prev_nodes = this.nodes_end_at[last_pos];\n\tif (prev_nodes == null) {\n\t\tprev_nodes = [];\n\t}\n\tprev_nodes.push(node);\n\n\tthis.nodes_end_at[last_pos] = prev_nodes;\n};\n\n/**\n * Set ends with EOS (End of Statement)\n */\nViterbiLattice.prototype.appendEos = function () {\n\tconst last_index = this.nodes_end_at.length;\n\tthis.eos_pos++;\n\tthis.nodes_end_at[last_index] = [\n\t\tnew ViterbiNode(-1, 0, this.eos_pos, 0, \"EOS\", 0, 0, \"\"),\n\t];\n};\n\nexport default ViterbiLattice;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * String wrapper for UTF-16 surrogate pair (4 bytes)\n * @param {string} str String to wrap\n * @constructor\n */\nfunction SurrogateAwareString(str) {\n\tthis.str = str;\n\tthis.index_mapping = [];\n\n\tfor (let pos = 0; pos < str.length; pos++) {\n\t\tconst ch = str.charAt(pos);\n\t\tthis.index_mapping.push(pos);\n\t\tif (SurrogateAwareString.isSurrogatePair(ch)) {\n\t\t\tpos++;\n\t\t}\n\t}\n\t// Surrogate aware length\n\tthis.length = this.index_mapping.length;\n}\n\nSurrogateAwareString.prototype.slice = function (index) {\n\tif (this.index_mapping.length <= index) {\n\t\treturn \"\";\n\t}\n\tconst surrogate_aware_index = this.index_mapping[index];\n\treturn this.str.slice(surrogate_aware_index);\n};\n\nSurrogateAwareString.prototype.charAt = function (index) {\n\tif (this.str.length <= index) {\n\t\treturn \"\";\n\t}\n\tconst surrogate_aware_start_index = this.index_mapping[index];\n\tconst surrogate_aware_end_index = this.index_mapping[index + 1];\n\n\tif (surrogate_aware_end_index == null) {\n\t\treturn this.str.slice(surrogate_aware_start_index);\n\t}\n\treturn this.str.slice(surrogate_aware_start_index, surrogate_aware_end_index);\n};\n\nSurrogateAwareString.prototype.charCodeAt = function (index) {\n\tif (this.index_mapping.length <= index) {\n\t\treturn NaN;\n\t}\n\tconst surrogate_aware_index = this.index_mapping[index];\n\tconst upper = this.str.charCodeAt(surrogate_aware_index);\n\tlet lower;\n\tif (\n\t\tupper >= 0xd800 &&\n\t\tupper <= 0xdbff &&\n\t\tsurrogate_aware_index < this.str.length\n\t) {\n\t\tlower = this.str.charCodeAt(surrogate_aware_index + 1);\n\t\tif (lower >= 0xdc00 && lower <= 0xdfff) {\n\t\t\treturn (upper - 0xd800) * 0x400 + lower - 0xdc00 + 0x10000;\n\t\t}\n\t}\n\treturn upper;\n};\n\nSurrogateAwareString.prototype.toString = function () {\n\treturn this.str;\n};\n\nSurrogateAwareString.isSurrogatePair = function (ch) {\n\tconst utf16_code = ch.charCodeAt(0);\n\tif (utf16_code >= 0xd800 && utf16_code <= 0xdbff) {\n\t\t// surrogate pair\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n};\n\nexport default SurrogateAwareString;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ViterbiNode from \"./ViterbiNode\";\nimport ViterbiLattice from \"./ViterbiLattice\";\nimport SurrogateAwareString from \"../util/SurrogateAwareString\";\n\n/**\n * ViterbiBuilder builds word lattice (ViterbiLattice)\n * @param {DynamicDictionaries} dic dictionary\n * @constructor\n */\nfunction ViterbiBuilder(dic) {\n\tthis.trie = dic.trie;\n\tthis.token_info_dictionary = dic.token_info_dictionary;\n\tthis.unknown_dictionary = dic.unknown_dictionary;\n}\n\n/**\n * Build word lattice\n * @param {string} sentence_str Input text\n * @returns {ViterbiLattice} Word lattice\n */\nViterbiBuilder.prototype.build = function (sentence_str) {\n\tconst lattice = new ViterbiLattice();\n\tconst sentence = new SurrogateAwareString(sentence_str);\n\n\tlet key;\n\tlet trie_id;\n\tlet left_id;\n\tlet right_id;\n\tlet word_cost;\n\tfor (let pos = 0; pos < sentence.length; pos++) {\n\t\tconst tail = sentence.slice(pos);\n\t\tconst vocabulary = this.trie.commonPrefixSearch(tail);\n\t\tfor (let n = 0; n < vocabulary.length; n++) {\n\t\t\t// Words in dictionary do not have surrogate pair (only UCS2 set)\n\t\t\ttrie_id = vocabulary[n].v;\n\t\t\tkey = vocabulary[n].k;\n\n\t\t\tconst token_info_ids = this.token_info_dictionary.target_map[trie_id];\n\t\t\tfor (let i = 0; i < token_info_ids.length; i++) {\n\t\t\t\tconst token_info_id = parseInt(token_info_ids[i]);\n\n\t\t\t\tleft_id = this.token_info_dictionary.dictionary.getShort(token_info_id);\n\t\t\t\tright_id = this.token_info_dictionary.dictionary.getShort(\n\t\t\t\t\ttoken_info_id + 2,\n\t\t\t\t);\n\t\t\t\tword_cost = this.token_info_dictionary.dictionary.getShort(\n\t\t\t\t\ttoken_info_id + 4,\n\t\t\t\t);\n\n\t\t\t\t// node_name, cost, start_index, length, type, left_id, right_id, surface_form\n\t\t\t\tlattice.append(\n\t\t\t\t\tnew ViterbiNode(\n\t\t\t\t\t\ttoken_info_id,\n\t\t\t\t\t\tword_cost,\n\t\t\t\t\t\tpos + 1,\n\t\t\t\t\t\tkey.length,\n\t\t\t\t\t\t\"KNOWN\",\n\t\t\t\t\t\tleft_id,\n\t\t\t\t\t\tright_id,\n\t\t\t\t\t\tkey,\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Unknown word processing\n\t\tconst surrogate_aware_tail = new SurrogateAwareString(tail);\n\t\tconst head_char = new SurrogateAwareString(surrogate_aware_tail.charAt(0));\n\t\tconst head_char_class = this.unknown_dictionary.lookup(\n\t\t\thead_char.toString(),\n\t\t);\n\t\tif (\n\t\t\tvocabulary == null ||\n\t\t\tvocabulary.length === 0 ||\n\t\t\thead_char_class.is_always_invoke === 1\n\t\t) {\n\t\t\t// Process unknown word\n\t\t\tkey = head_char;\n\t\t\tif (\n\t\t\t\thead_char_class.is_grouping === 1 &&\n\t\t\t\t1 < surrogate_aware_tail.length\n\t\t\t) {\n\t\t\t\tfor (let k = 1; k < surrogate_aware_tail.length; k++) {\n\t\t\t\t\tconst next_char = surrogate_aware_tail.charAt(k);\n\t\t\t\t\tconst next_char_class = this.unknown_dictionary.lookup(next_char);\n\t\t\t\t\tif (head_char_class.class_name !== next_char_class.class_name) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tkey += next_char;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst unk_ids =\n\t\t\t\tthis.unknown_dictionary.target_map[head_char_class.class_id];\n\t\t\tfor (let j = 0; j < unk_ids.length; j++) {\n\t\t\t\tconst unk_id = parseInt(unk_ids[j]);\n\n\t\t\t\tleft_id = this.unknown_dictionary.dictionary.getShort(unk_id);\n\t\t\t\tright_id = this.unknown_dictionary.dictionary.getShort(unk_id + 2);\n\t\t\t\tword_cost = this.unknown_dictionary.dictionary.getShort(unk_id + 4);\n\n\t\t\t\t// node_name, cost, start_index, length, type, left_id, right_id, surface_form\n\t\t\t\tlattice.append(\n\t\t\t\t\tnew ViterbiNode(\n\t\t\t\t\t\tunk_id,\n\t\t\t\t\t\tword_cost,\n\t\t\t\t\t\tpos + 1,\n\t\t\t\t\t\tkey.length,\n\t\t\t\t\t\t\"UNKNOWN\",\n\t\t\t\t\t\tleft_id,\n\t\t\t\t\t\tright_id,\n\t\t\t\t\t\tkey.toString(),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\tlattice.appendEos();\n\n\treturn lattice;\n};\n\nexport default ViterbiBuilder;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * ViterbiSearcher is for searching best Viterbi path\n * @param {ConnectionCosts} connection_costs Connection costs matrix\n * @constructor\n */\nfunction ViterbiSearcher(connection_costs) {\n\tthis.connection_costs = connection_costs;\n}\n\n/**\n * Search best path by forward-backward algorithm\n * @param {ViterbiLattice} lattice Viterbi lattice to search\n * @returns {Array} Shortest path\n */\nViterbiSearcher.prototype.search = function (lattice) {\n\tlattice = this.forward(lattice);\n\treturn this.backward(lattice);\n};\n\nViterbiSearcher.prototype.forward = function (lattice) {\n\tlet i;\n\tlet j;\n\tlet k;\n\tfor (i = 1; i <= lattice.eos_pos; i++) {\n\t\tconst nodes = lattice.nodes_end_at[i];\n\t\tif (nodes == null) {\n\t\t\tcontinue;\n\t\t}\n\t\tfor (j = 0; j < nodes.length; j++) {\n\t\t\tconst node = nodes[j];\n\t\t\tlet cost = Number.MAX_VALUE;\n\t\t\tlet shortest_prev_node;\n\n\t\t\tconst prev_nodes = lattice.nodes_end_at[node.start_pos - 1];\n\t\t\tif (prev_nodes == null) {\n\t\t\t\t// TODO process unknown words (repair word lattice)\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (k = 0; k < prev_nodes.length; k++) {\n\t\t\t\tconst prev_node = prev_nodes[k];\n\n\t\t\t\tlet edge_cost;\n\t\t\t\tif (node.left_id == null || prev_node.right_id == null) {\n\t\t\t\t\t// TODO assert\n\t\t\t\t\tconsole.log(\"Left or right is null\");\n\t\t\t\t\tedge_cost = 0;\n\t\t\t\t} else {\n\t\t\t\t\tedge_cost = this.connection_costs.get(\n\t\t\t\t\t\tprev_node.right_id,\n\t\t\t\t\t\tnode.left_id,\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst _cost = prev_node.shortest_cost + edge_cost + node.cost;\n\t\t\t\tif (_cost < cost) {\n\t\t\t\t\tshortest_prev_node = prev_node;\n\t\t\t\t\tcost = _cost;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnode.prev = shortest_prev_node;\n\t\t\tnode.shortest_cost = cost;\n\t\t}\n\t}\n\treturn lattice;\n};\n\nViterbiSearcher.prototype.backward = function (lattice) {\n\tconst shortest_path = [];\n\tconst eos = lattice.nodes_end_at[lattice.nodes_end_at.length - 1][0];\n\n\tlet node_back = eos.prev;\n\tif (node_back == null) {\n\t\treturn [];\n\t}\n\twhile (node_back.type !== \"BOS\") {\n\t\tshortest_path.push(node_back);\n\t\tif (node_back.prev == null) {\n\t\t\t// TODO Failed to back. Process unknown words?\n\t\t\treturn [];\n\t\t}\n\t\tnode_back = node_back.prev;\n\t}\n\n\treturn shortest_path.reverse();\n};\n\nexport default ViterbiSearcher;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * Mappings between IPADIC dictionary features and tokenized results\n * @constructor\n */\nfunction IpadicFormatter() {}\n\nIpadicFormatter.prototype.formatEntry = function (\n\tword_id,\n\tposition,\n\ttype,\n\tfeatures,\n) {\n\tconst token = {};\n\ttoken.word_id = word_id;\n\ttoken.word_type = type;\n\ttoken.word_position = position;\n\n\ttoken.surface_form = features[0];\n\ttoken.pos = features[1];\n\ttoken.pos_detail_1 = features[2];\n\ttoken.pos_detail_2 = features[3];\n\ttoken.pos_detail_3 = features[4];\n\ttoken.conjugated_type = features[5];\n\ttoken.conjugated_form = features[6];\n\ttoken.basic_form = features[7];\n\ttoken.reading = features[8];\n\ttoken.pronunciation = features[9];\n\n\treturn token;\n};\n\nIpadicFormatter.prototype.formatUnknownEntry = function (\n\tword_id,\n\tposition,\n\ttype,\n\tfeatures,\n\tsurface_form,\n) {\n\tconst token = {};\n\ttoken.word_id = word_id;\n\ttoken.word_type = type;\n\ttoken.word_position = position;\n\n\ttoken.surface_form = surface_form;\n\ttoken.pos = features[1];\n\ttoken.pos_detail_1 = features[2];\n\ttoken.pos_detail_2 = features[3];\n\ttoken.pos_detail_3 = features[4];\n\ttoken.conjugated_type = features[5];\n\ttoken.conjugated_form = features[6];\n\ttoken.basic_form = features[7];\n\t// token.reading = features[8];\n\t// token.pronunciation = features[9];\n\n\treturn token;\n};\n\nexport default IpadicFormatter;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ViterbiBuilder from \"./viterbi/ViterbiBuilder\";\nimport ViterbiSearcher from \"./viterbi/ViterbiSearcher\";\nimport IpadicFormatter from \"./util/IpadicFormatter\";\n\nconst PUNCTUATION = /、|。/;\n\n/**\n * Tokenizer\n * @param {DynamicDictionaries} dic Dictionaries used by this tokenizer\n * @constructor\n */\nfunction Tokenizer(dic) {\n\tthis.token_info_dictionary = dic.token_info_dictionary;\n\tthis.unknown_dictionary = dic.unknown_dictionary;\n\tthis.viterbi_builder = new ViterbiBuilder(dic);\n\tthis.viterbi_searcher = new ViterbiSearcher(dic.connection_costs);\n\tthis.formatter = new IpadicFormatter(); // TODO Other dictionaries\n}\n\n/**\n * Split into sentence by punctuation\n * @param {string} input Input text\n * @returns {Array.<string>} Sentences end with punctuation\n */\nTokenizer.splitByPunctuation = function (input) {\n\tconst sentences = [];\n\tlet tail = input;\n\twhile (true) {\n\t\tif (tail === \"\") {\n\t\t\tbreak;\n\t\t}\n\t\tconst index = tail.search(PUNCTUATION);\n\t\tif (index < 0) {\n\t\t\tsentences.push(tail);\n\t\t\tbreak;\n\t\t}\n\t\tsentences.push(tail.substring(0, index + 1));\n\t\ttail = tail.substring(index + 1);\n\t}\n\treturn sentences;\n};\n\n/**\n * Tokenize text\n * @param {string} text Input text to analyze\n * @returns {Array} Tokens\n */\nTokenizer.prototype.tokenize = function (text) {\n\tconst sentences = Tokenizer.splitByPunctuation(text);\n\tconst tokens = [];\n\tfor (let i = 0; i < sentences.length; i++) {\n\t\tconst sentence = sentences[i];\n\t\tthis.tokenizeForSentence(sentence, tokens);\n\t}\n\treturn tokens;\n};\n\nTokenizer.prototype.tokenizeForSentence = function (sentence, tokens) {\n\tif (tokens == null) {\n\t\ttokens = [];\n\t}\n\tconst lattice = this.getLattice(sentence);\n\tconst best_path = this.viterbi_searcher.search(lattice);\n\tlet last_pos = 0;\n\tif (tokens.length > 0) {\n\t\tlast_pos = tokens[tokens.length - 1].word_position;\n\t}\n\n\tfor (let j = 0; j < best_path.length; j++) {\n\t\tconst node = best_path[j];\n\n\t\tlet token;\n\t\tlet features;\n\t\tlet features_line;\n\t\tif (node.type === \"KNOWN\") {\n\t\t\tfeatures_line = this.token_info_dictionary.getFeatures(node.name);\n\t\t\tif (features_line == null) {\n\t\t\t\tfeatures = [];\n\t\t\t} else {\n\t\t\t\tfeatures = features_line.split(\",\");\n\t\t\t}\n\t\t\ttoken = this.formatter.formatEntry(\n\t\t\t\tnode.name,\n\t\t\t\tlast_pos + node.start_pos,\n\t\t\t\tnode.type,\n\t\t\t\tfeatures,\n\t\t\t);\n\t\t} else if (node.type === \"UNKNOWN\") {\n\t\t\t// Unknown word\n\t\t\tfeatures_line = this.unknown_dictionary.getFeatures(node.name);\n\t\t\tif (features_line == null) {\n\t\t\t\tfeatures = [];\n\t\t\t} else {\n\t\t\t\tfeatures = features_line.split(\",\");\n\t\t\t}\n\t\t\ttoken = this.formatter.formatUnknownEntry(\n\t\t\t\tnode.name,\n\t\t\t\tlast_pos + node.start_pos,\n\t\t\t\tnode.type,\n\t\t\t\tfeatures,\n\t\t\t\tnode.surface_form,\n\t\t\t);\n\t\t} else {\n\t\t\t// TODO User dictionary\n\t\t\ttoken = this.formatter.formatEntry(\n\t\t\t\tnode.name,\n\t\t\t\tlast_pos + node.start_pos,\n\t\t\t\tnode.type,\n\t\t\t\t[],\n\t\t\t);\n\t\t}\n\n\t\ttokens.push(token);\n\t}\n\n\treturn tokens;\n};\n\n/**\n * Build word lattice\n * @param {string} text Input text to analyze\n * @returns {ViterbiLattice} Word lattice\n */\nTokenizer.prototype.getLattice = function (text) {\n\treturn this.viterbi_builder.build(text);\n};\n\nexport default Tokenizer;\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, i32 = Int32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new i32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return { b: b, r: r };\n};\nvar _a = freb(fleb, 2), fl = _a.b, revfl = _a.r;\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b.b, revfd = _b.r;\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >> 8) | ((x & 0x00FF) << 8)) >> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 1; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    return new u8(v.subarray(s, e));\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, st, buf, dict) {\n    // source length       dict length\n    var sl = dat.length, dl = dict ? dict.length : 0;\n    if (!sl || st.f && !st.l)\n        return buf || new u8(0);\n    var noBuf = !buf;\n    // have to estimate size\n    var resize = noBuf || st.i != 2;\n    // no state\n    var noSt = st.i;\n    // Assumes roughly 33% compression ratio average\n    if (noBuf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (resize)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17\n        if (resize)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & (1 << b) - 1, pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (resize)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                if (bt < dt) {\n                    var shift = dl - dt, dend = Math.min(dt, end);\n                    if (shift + bt < 0)\n                        err(3);\n                    for (; bt < dend; ++bt)\n                        buf[bt] = dict[shift + bt];\n                }\n                for (; bt < end; ++bt)\n                    buf[bt] = buf[bt - dt];\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    // don't reallocate for streams or user buffers\n    return bt != buf.length && noBuf ? slc(buf, 0, bt) : buf.subarray(0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >> 8;\n    d[o + 2] |= v >> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return { t: et, l: 0 };\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return { t: v, l: 1 };\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return { t: new u8(tr), l: mbt };\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return { c: cl.subarray(0, cli), n: s };\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a.t, mlb = _a.l;\n    var _b = hTree(df, 15), ddt = _b.t, mdb = _b.l;\n    var _c = lc(dlt), lclt = _c.c, nlc = _c.n;\n    var _d = lc(ddt), lcdt = _d.c, ndc = _d.n;\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        ++lcfreq[lclt[i] & 31];\n    for (var i = 0; i < lcdt.length; ++i)\n        ++lcfreq[lcdt[i] & 31];\n    var _e = hTree(lcfreq, 7), lct = _e.t, mlcb = _e.l;\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + 2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18];\n    if (bs >= 0 && flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >> 5) & 127), p += clct[i] >> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        var sym = syms[i];\n        if (sym > 255) {\n            var len = (sym >> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (sym >> 23) & 31), p += fleb[len];\n            var dst = sym & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (sym >> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[sym]), p += ll[sym];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new i32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, st) {\n    var s = st.z || dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var lst = st.l;\n    var pos = (st.r || 0) & 7;\n    if (lvl) {\n        if (pos)\n            w[0] = st.r >> 3;\n        var opt = deo[lvl - 1];\n        var n = opt >> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = st.p || new u16(32768), head = st.h || new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new i32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index          l/lind  waitdx          blkpos\n        var lc_1 = 0, eb = 0, i = st.i || 0, li = 0, wi = st.w || 0, bs = 0;\n        for (; i + 2 < s; ++i) {\n            // hash value\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && (rem > 423 || !lst)) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = imod - pimod & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = i - dif + j & 32767;\n                                    var pti = prev[ti];\n                                    var cd = ti - pti & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += imod - pimod & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one int32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        for (i = Math.max(i, wi); i < s; ++i) {\n            syms[li++] = dat[i];\n            ++lf[dat[i]];\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        if (!lst) {\n            st.r = (pos & 7) | w[(pos / 8) | 0] << 3;\n            // shft(pos) now 1 less if pos & 7 != 0\n            pos -= 7;\n            st.h = head, st.p = prev, st.i = i, st.w = wi;\n        }\n    }\n    else {\n        for (var i = st.w || 0; i < s + lst; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[(pos / 8) | 0] = lst;\n                e = s;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n        st.i = s;\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Adler32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a & 0xFF00) << 8 | (b & 255) << 8 | (b >> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    if (!st) {\n        st = { l: 1 };\n        if (opt.dictionary) {\n            var dict = opt.dictionary.subarray(-32768);\n            var newDat = new u8(dict.length + dat.length);\n            newDat.set(dict);\n            newDat.set(dat, dict.length);\n            dat = newDat;\n            st.w = dict.length;\n        }\n    }\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? (st.l ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : 20) : (12 + opt.mem), pre, post, st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return fnStr;\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            fnStr = wcln(fns[i], fnStr, td_1);\n        ch[id] = { c: wcln(fns[m], fnStr, td_1), e: td_1 };\n    }\n    var td = mrg({}, ch[id].e);\n    return wk(ch[id].c + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, i32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gopt]; };\nvar bDflt = function () { return [u8, u16, i32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zls]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get opts\nvar gopt = function (o) { return o && {\n    out: o.size && new u8(o.size),\n    dictionary: o.dictionary\n}; };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) {\n        if (ev.data.length) {\n            strm.push(ev.data[0], ev.data[1]);\n            postMessage([ev.data[0].length]);\n        }\n        else\n            strm.flush();\n    };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id, flush, ext) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else if (!Array.isArray(dat))\n            ext(dat);\n        else if (dat.length == 1) {\n            strm.queuedSize -= dat[0];\n            if (strm.ondrain)\n                strm.ondrain(dat[0]);\n        }\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.queuedSize = 0;\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        strm.queuedSize += d.length;\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n    if (flush) {\n        strm.flush = function () { w.postMessage([]); };\n    }\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += (d[10] | d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return (d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16 | d[l - 1] << 24) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + (o.filename ? o.filename.length + 1 : 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (o.dictionary && 32);\n    c[1] |= 31 - ((c[0] << 8) | c[1]) % 31;\n    if (o.dictionary) {\n        var h = adler();\n        h.p(o.dictionary);\n        wbytes(c, 2, h.d());\n    }\n};\n// zlib start\nvar zls = function (d, dict) {\n    if ((d[0] & 15) != 8 || (d[0] >> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if ((d[1] >> 5 & 1) == +!dict)\n        err(6, 'invalid zlib data: ' + (d[1] & 32 ? 'need' : 'unexpected') + ' dictionary');\n    return (d[1] >> 3 & 4) + 2;\n};\nfunction StrmOpt(opts, cb) {\n    if (typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n        this.s = { l: 0, i: 32768, w: 32768, z: 32768 };\n        // Buffer length must always be 0 mod 32768 for index calculations to be correct when modifying head and prev\n        // 98304 = 32768 (lookback) + 65536 (common chunk size)\n        this.b = new u8(98304);\n        if (this.o.dictionary) {\n            var dict = this.o.dictionary.subarray(-32768);\n            this.b.set(dict, 32768 - dict.length);\n            this.s.i = 32768 - dict.length;\n        }\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, this.s), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        var endLen = chunk.length + this.s.z;\n        if (endLen > this.b.length) {\n            if (endLen > 2 * this.b.length - 32768) {\n                var newBuf = new u8(endLen & -32768);\n                newBuf.set(this.b.subarray(0, this.s.z));\n                this.b = newBuf;\n            }\n            var split = this.b.length - this.s.z;\n            this.b.set(chunk.subarray(0, split), this.s.z);\n            this.s.z = this.b.length;\n            this.p(this.b, false);\n            this.b.set(this.b.subarray(-32768));\n            this.b.set(chunk.subarray(split), 32768);\n            this.s.z = chunk.length - split + 32768;\n            this.s.i = 32766, this.s.w = 32768;\n        }\n        else {\n            this.b.set(chunk, this.s.z);\n            this.s.z += chunk.length;\n        }\n        this.s.l = final & 1;\n        if (this.s.z > this.s.w + 8191 || final) {\n            this.p(this.b, final || false);\n            this.s.w = this.s.i, this.s.i -= 2;\n        }\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * deflated output for small inputs.\n     */\n    Deflate.prototype.flush = function () {\n        if (!this.ondata)\n            err(5);\n        if (this.s.l)\n            err(4);\n        this.p(this.b, false);\n        this.s.w = this.s.i, this.s.i -= 2;\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6, 1);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    function Inflate(opts, cb) {\n        // no StrmOpt here to avoid adding to workerizer\n        if (typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        var dict = opts && opts.dictionary && opts.dictionary.subarray(-32768);\n        this.s = { i: 0, b: dict ? dict.length : 0 };\n        this.o = new u8(32768);\n        this.p = new u8(0);\n        if (dict)\n            this.o.set(dict);\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        if (!this.p.length)\n            this.p = c;\n        else if (c.length) {\n            var n = new u8(this.p.length + c.length);\n            n.set(this.p), n.set(c, this.p.length), this.p = n;\n        }\n    };\n    Inflate.prototype.c = function (final) {\n        this.s.i = +(this.d = final || false);\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.s, this.o);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    function AsyncInflate(opts, cb) {\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Inflate(ev.data);\n            onmessage = astrm(strm);\n        }, 7, 0);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gopt(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, opts) {\n    return inflt(data, { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        this.l += chunk.length;\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, this.s);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * GZIPped output for small inputs.\n     */\n    Gzip.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8, 1);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming single or multi-member GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    function Gunzip(opts, cb) {\n        this.v = 1;\n        this.r = 0;\n        Inflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        this.r += chunk.length;\n        if (this.v) {\n            var p = this.p.subarray(this.v - 1);\n            var s = p.length > 3 ? gzs(p) : 4;\n            if (s > p.length) {\n                if (!final)\n                    return;\n            }\n            else if (this.v > 1 && this.onmember) {\n                this.onmember(this.r - p.length);\n            }\n            this.p = p.subarray(s), this.v = 0;\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n        // process concatenated GZIP\n        if (this.s.f && !this.s.l && !final) {\n            this.v = shft(this.s.p) + 9;\n            this.s = { i: 0 };\n            this.o = new u8(0);\n            this.push(new u8(0), final);\n        }\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming single or multi-member GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    function AsyncGunzip(opts, cb) {\n        var _this = this;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Gunzip(ev.data);\n            strm.onmember = function (offset) { return postMessage(offset); };\n            onmessage = astrm(strm);\n        }, 9, 0, function (offset) { return _this.onmember && _this.onmember(offset); });\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0], ev.data[1])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, opts) {\n    var st = gzs(data);\n    if (st + 8 > data.length)\n        err(6, 'invalid gzip data');\n    return inflt(data.subarray(st, -8), { i: 2 }, opts && opts.out || new u8(gzl(data)), opts && opts.dictionary);\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        this.c.p(chunk);\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        var raw = dopt(c, this.o, this.v && (this.o.dictionary ? 6 : 2), f && 4, this.s);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    /**\n     * Flushes buffered uncompressed data. Useful to immediately retrieve the\n     * zlibbed output for small inputs.\n     */\n    Zlib.prototype.flush = function () {\n        Deflate.prototype.flush.call(this);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10, 1);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, opts.dictionary ? 6 : 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    function Unzlib(opts, cb) {\n        Inflate.call(this, opts, cb);\n        this.v = opts && opts.dictionary ? 2 : 1;\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 6 && !final)\n                return;\n            this.p = this.p.subarray(zls(this.p, this.v - 1)), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    function AsyncUnzlib(opts, cb) {\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, StrmOpt.call(this, opts, cb), function (ev) {\n            var strm = new Unzlib(ev.data);\n            onmessage = astrm(strm);\n        }, 11, 0);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gopt(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, opts) {\n    return inflt(data.subarray(zls(data, opts && opts.dictionary), -4), { i: 2 }, opts && opts.out, opts && opts.dictionary);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    function Decompress(opts, cb) {\n        this.o = StrmOpt.call(this, opts, cb) || {};\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n    }\n    // init substream\n    // overriden by AsyncDecompress\n    Decompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (dat, final) {\n            _this.ondata(dat, final);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(this.o)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(this.o)\n                        : new this.Z(this.o);\n                this.i();\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    function AsyncDecompress(opts, cb) {\n        Decompress.call(this, opts, cb);\n        this.queuedSize = 0;\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n    }\n    AsyncDecompress.prototype.i = function () {\n        var _this = this;\n        this.s.ondata = function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        };\n        this.s.ondrain = function (size) {\n            _this.queuedSize -= size;\n            if (_this.ondrain)\n                _this.ondrain(size);\n        };\n    };\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        this.queuedSize += chunk.length;\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param opts The decompression options\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, opts) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, opts)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, opts)\n            : unzlibSync(data, opts);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return { s: r, r: slc(d, i - 1) };\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (final) {\n            if (r.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = r;\n        this.ondata(s, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td) {\n        return td.decode(dat);\n    }\n    else {\n        var _a = dutf8(dat), s = _a.s, r = _a.r;\n        if (r.length)\n            err(8);\n        return s;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this.ondata(err, dat, final);\n                    _this.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this.d & 1))\n                        return;\n                    _this.u.splice(-1, 1);\n                    _this.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this = this;\n        this.i = new Inflate(function (dat, final) {\n            _this.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this.k[0] == chks_3 && _this.c)\n                                        _this.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    // Synchronously decompress under 512KB, or barely-compressed data\n                    if (su < 524288 || sc > 0.8 * su) {\n                        try {\n                            cbl(null, inflateSync(infl, { out: new u8(su) }));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), { out: new u8(su) });\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","// Copyright (c) 2014 Takuya Asano All Rights Reserved.\n\n(function () {\n\n    \"use strict\";\n\n    var TERM_CHAR = \"\\u0000\", // terminal character\n        TERM_CODE = 0,        // terminal character code\n        ROOT_ID = 0,          // index of root node\n        NOT_FOUND = -1,       // traverse() returns if no nodes found\n        BASE_SIGNED = true,\n        CHECK_SIGNED = true,\n        BASE_BYTES = 4,\n        CHECK_BYTES = 4,\n        MEMORY_EXPAND_RATIO = 2;\n\n\n    var newBC = function (initial_size) {\n\n        if (initial_size == null) {\n            initial_size = 1024;\n        }\n\n        var initBase = function (_base, start, end) {  // 'end' index does not include\n            for (var i = start; i < end; i++) {\n                _base[i] = - i + 1;  // inversed previous empty node index\n            }\n            if (0 < check.array[check.array.length - 1]) {\n                var last_used_id = check.array.length - 2;\n                while (0 < check.array[last_used_id]) {\n                    last_used_id--;\n                }\n                _base[start] = - last_used_id;\n            }\n        };\n\n        var initCheck = function (_check, start, end) {\n            for (var i = start; i < end; i++) {\n                _check[i] = - i - 1;  // inversed next empty node index\n            }\n        };\n\n        var realloc = function (min_size) {\n            // expand arrays size by given ratio\n            var new_size = min_size * MEMORY_EXPAND_RATIO;\n            // console.log('re-allocate memory to ' + new_size);\n\n            var base_new_array = newArrayBuffer(base.signed, base.bytes, new_size);\n            initBase(base_new_array, base.array.length, new_size);  // init BASE in new range\n            base_new_array.set(base.array);\n            base.array = null;  // explicit GC\n            base.array = base_new_array;\n\n            var check_new_array = newArrayBuffer(check.signed, check.bytes, new_size);\n            initCheck(check_new_array, check.array.length, new_size);  // init CHECK in new range\n            check_new_array.set(check.array);\n            check.array = null;  // explicit GC\n            check.array = check_new_array;\n        };\n\n        var first_unused_node = ROOT_ID + 1;\n\n        var base = {\n            signed: BASE_SIGNED,\n            bytes: BASE_BYTES,\n            array: newArrayBuffer(BASE_SIGNED, BASE_BYTES, initial_size)\n        };\n\n        var check = {\n            signed: CHECK_SIGNED,\n            bytes: CHECK_BYTES,\n            array: newArrayBuffer(CHECK_SIGNED, CHECK_BYTES, initial_size)\n        };\n\n        // init root node\n        base.array[ROOT_ID] = 1;\n        check.array[ROOT_ID] = ROOT_ID;\n\n        // init BASE\n        initBase(base.array, ROOT_ID + 1, base.array.length);\n\n        // init CHECK\n        initCheck(check.array, ROOT_ID + 1, check.array.length);\n\n        return {\n            getBaseBuffer: function () {\n                return base.array;\n            },\n            getCheckBuffer: function () {\n                return check.array;\n            },\n            loadBaseBuffer: function (base_buffer) {\n                base.array = base_buffer;\n                return this;\n            },\n            loadCheckBuffer: function (check_buffer) {\n                check.array = check_buffer;\n                return this;\n            },\n            size: function () {\n                return Math.max(base.array.length, check.array.length);\n            },\n            getBase: function (index) {\n                if (base.array.length - 1 < index) {\n                    return - index + 1;\n                    // realloc(index);\n                }\n                // if (!Number.isFinite(base.array[index])) {\n                //     console.log('getBase:' + index);\n                //     throw 'getBase' + index;\n                // }\n                return base.array[index];\n            },\n            getCheck: function (index) {\n                if (check.array.length - 1 < index) {\n                    return - index - 1;\n                    // realloc(index);\n                }\n                // if (!Number.isFinite(check.array[index])) {\n                //     console.log('getCheck:' + index);\n                //     throw 'getCheck' + index;\n                // }\n                return check.array[index];\n            },\n            setBase: function (index, base_value) {\n                if (base.array.length - 1 < index) {\n                    realloc(index);\n                }\n                base.array[index] = base_value;\n            },\n            setCheck: function (index, check_value) {\n                if (check.array.length - 1 < index) {\n                    realloc(index);\n                }\n                check.array[index] = check_value;\n            },\n            setFirstUnusedNode: function (index) {\n                // if (!Number.isFinite(index)) {\n                //     throw 'assertion error: setFirstUnusedNode ' + index + ' is not finite number';\n                // }\n                first_unused_node = index;\n            },\n            getFirstUnusedNode: function () {\n                // if (!Number.isFinite(first_unused_node)) {\n                //     throw 'assertion error: getFirstUnusedNode ' + first_unused_node + ' is not finite number';\n                // }\n                return first_unused_node;\n            },\n            shrink: function () {\n                var last_index = this.size() - 1;\n                while (true) {\n                    if (0 <= check.array[last_index]) {\n                        break;\n                    }\n                    last_index--;\n                }\n                base.array = base.array.subarray(0, last_index + 2);   // keep last unused node\n                check.array = check.array.subarray(0, last_index + 2); // keep last unused node\n            },\n            calc: function () {\n                var unused_count = 0;\n                var size = check.array.length;\n                for (var i = 0; i < size; i++) {\n                    if (check.array[i] < 0) {\n                        unused_count++;\n                    }\n                }\n                return {\n                    all: size,\n                    unused: unused_count,\n                    efficiency: (size - unused_count) / size\n                };\n            },\n            dump: function () {\n                // for debug\n                var dump_base = \"\";\n                var dump_check = \"\";\n\n                var i;\n                for (i = 0; i < base.array.length; i++) {\n                    dump_base = dump_base + \" \" + this.getBase(i);\n                }\n                for (i = 0; i < check.array.length; i++) {\n                    dump_check = dump_check + \" \" + this.getCheck(i);\n                }\n\n                console.log(\"base:\" + dump_base);\n                console.log(\"chck:\" + dump_check);\n\n                return \"base:\" + dump_base + \" chck:\" + dump_check;\n            }\n        };\n    };\n\n\n    /**\n     * Factory method of double array\n     */\n    function DoubleArrayBuilder(initial_size) {\n        this.bc = newBC(initial_size);  // BASE and CHECK\n        this.keys = [];\n    }\n\n\n    /**\n     * Append a key to initialize set\n     * (This method should be called by dictionary ordered key)\n     *\n     * @param {String} key\n     * @param {Number} value Integer value from 0 to max signed integer number - 1\n     */\n    DoubleArrayBuilder.prototype.append = function (key, record) {\n        this.keys.push({ k: key, v: record });\n        return this;\n    };\n\n    /**\n     * Build double array for given keys\n     *\n     * @param {Array} keys Array of keys. A key is a Object which has properties 'k', 'v'.\n     * 'k' is a key string, 'v' is a record assigned to that key.\n     * @return {DoubleArray} Compiled double array\n     */\n    DoubleArrayBuilder.prototype.build = function (keys, sorted) {\n\n        if (keys == null) {\n            keys = this.keys;\n        }\n\n        if (keys == null) {\n            return new DoubleArray(this.bc);\n        }\n\n        if (sorted == null) {\n            sorted = false;\n        }\n\n        // Convert key string to ArrayBuffer\n        var buff_keys =\n            keys.map(function (k) {\n                return {\n                    k: stringToUtf8Bytes(k.k + TERM_CHAR),\n                    v: k.v\n                };\n            });\n\n        // Sort keys by byte order\n        if (sorted) {\n            this.keys = buff_keys;\n        } else {\n            this.keys =\n                buff_keys.sort(function (k1, k2) {\n                    var b1 = k1.k;\n                    var b2 = k2.k;\n                    var min_length = Math.min(b1.length, b2.length);\n                    for (var pos = 0; pos < min_length; pos++) {\n                        if (b1[pos] === b2[pos]) {\n                            continue;\n                        }\n                        return b1[pos] - b2[pos];\n                    }\n                    return b1.length - b2.length;\n                });\n        }\n\n        buff_keys = null;  // explicit GC\n\n        this._build(ROOT_ID, 0, 0, this.keys.length);\n        return new DoubleArray(this.bc);\n    };\n\n    /**\n     * Append nodes to BASE and CHECK array recursively\n     */\n    DoubleArrayBuilder.prototype._build = function (parent_index, position, start, length) {\n\n        var children_info = this.getChildrenInfo(position, start, length);\n        var _base = this.findAllocatableBase(children_info);\n\n        this.setBC(parent_index, children_info, _base);\n\n        for (var i = 0; i < children_info.length; i = i + 3) {\n            var child_code = children_info[i];\n            if (child_code === TERM_CODE) {\n                continue;\n            }\n            var child_start = children_info[i + 1];\n            var child_len = children_info[i + 2];\n            var child_index = _base + child_code;\n            this._build(child_index, position + 1, child_start, child_len);\n        }\n    };\n\n    DoubleArrayBuilder.prototype.getChildrenInfo = function (position, start, length) {\n        var current_char = this.keys[start].k[position];\n        var i = 0;\n        var children_info = new Int32Array(length * 3);\n\n        children_info[i++] = current_char;  // char (current)\n        children_info[i++] = start;         // start index (current)\n\n        var next_pos = start;\n        var start_pos = start;\n        for (; next_pos < start + length; next_pos++) {\n            var next_char = this.keys[next_pos].k[position];\n            if (current_char !== next_char) {\n                children_info[i++] = next_pos - start_pos;  // length (current)\n\n                children_info[i++] = next_char;             // char (next)\n                children_info[i++] = next_pos;              // start index (next)\n                current_char = next_char;\n                start_pos = next_pos;\n            }\n        }\n        children_info[i++] = next_pos - start_pos;\n        children_info = children_info.subarray(0, i);\n\n        return children_info;\n    };\n\n    DoubleArrayBuilder.prototype.setBC = function (parent_id, children_info, _base) {\n\n        var bc = this.bc;\n\n        bc.setBase(parent_id, _base);  // Update BASE of parent node\n\n        var i;\n        for (i = 0; i < children_info.length; i = i + 3) {\n            var code = children_info[i];\n            var child_id = _base + code;\n\n            // Update linked list of unused nodes\n\n            // Assertion\n            // if (child_id < 0) {\n            //     throw 'assertion error: child_id is negative'\n            // }\n\n            var prev_unused_id = - bc.getBase(child_id);\n            var next_unused_id = - bc.getCheck(child_id);\n            // if (prev_unused_id < 0) {\n            //     throw 'assertion error: setBC'\n            // }\n            // if (next_unused_id < 0) {\n            //     throw 'assertion error: setBC'\n            // }\n            if (child_id !== bc.getFirstUnusedNode()) {\n                bc.setCheck(prev_unused_id, - next_unused_id);\n            } else {\n                // Update first_unused_node\n                bc.setFirstUnusedNode(next_unused_id);\n            }\n            bc.setBase(next_unused_id, - prev_unused_id);\n\n            var check = parent_id;         // CHECK is parent node index\n            bc.setCheck(child_id, check);  // Update CHECK of child node\n\n            // Update record\n            if (code === TERM_CODE) {\n                var start_pos = children_info[i + 1];\n                // var len = children_info[i + 2];\n                // if (len != 1) {\n                //     throw 'assertion error: there are multiple terminal nodes. len:' + len;\n                // }\n                var value = this.keys[start_pos].v;\n\n                if (value == null) {\n                    value = 0;\n                }\n\n                var base = - value - 1;       // BASE is inverted record value\n                bc.setBase(child_id, base);  // Update BASE of child(leaf) node\n            }\n        }\n    };\n\n\n    /**\n     * Find BASE value that all children are allocatable in double array's region\n     */\n    DoubleArrayBuilder.prototype.findAllocatableBase = function (children_info) {\n\n        var bc = this.bc;\n\n        // Assertion: keys are sorted by byte order\n        // var c = -1;\n        // for (var i = 0; i < children_info.length; i = i + 3) {\n        //     if (children_info[i] < c) {\n        //         throw 'assertion error: not sort key'\n        //     }\n        //     c = children_info[i];\n        // }\n\n        // iterate linked list of unused nodes\n        var _base;\n        var curr = bc.getFirstUnusedNode();  // current index\n        // if (curr < 0) {\n        //     throw 'assertion error: getFirstUnusedNode returns negative value'\n        // }\n\n        while (true) {\n            _base = curr - children_info[0];\n\n            if (_base < 0) {\n                curr = - bc.getCheck(curr);  // next\n\n                // if (curr < 0) {\n                //     throw 'assertion error: getCheck returns negative value'\n                // }\n\n                continue;\n            }\n\n            var empty_area_found = true;\n            for (var i = 0; i < children_info.length; i = i + 3) {\n                var code = children_info[i];\n                var candidate_id = _base + code;\n\n                if (!this.isUnusedNode(candidate_id)) {\n                    // candidate_id is used node\n                    // next\n                    curr = - bc.getCheck(curr);\n                    // if (curr < 0) {\n                    //     throw 'assertion error: getCheck returns negative value'\n                    // }\n\n                    empty_area_found = false;\n                    break;\n                }\n            }\n            if (empty_area_found) {\n                // Area is free\n                return _base;\n            }\n        }\n    };\n\n    /**\n     * Check this double array index is unused or not\n     */\n    DoubleArrayBuilder.prototype.isUnusedNode = function (index) {\n        var bc = this.bc;\n        var check = bc.getCheck(index);\n\n        // if (index < 0) {\n        //     throw 'assertion error: isUnusedNode index:' + index;\n        // }\n\n        if (index === ROOT_ID) {\n            // root node\n            return false;\n        }\n        if (check < 0) {\n            // unused\n            return true;\n        }\n\n        // used node (incl. leaf)\n        return false;\n    };\n\n\n    /**\n     * Factory method of double array\n     */\n    function DoubleArray(bc) {\n        this.bc = bc;       // BASE and CHECK\n        this.bc.shrink();\n    }\n\n\n    /**\n     * Look up a given key in this trie\n     *\n     * @param {String} key\n     * @return {Boolean} True if this trie contains a given key\n     */\n    DoubleArray.prototype.contain = function (key) {\n\n        var bc = this.bc;\n\n        key += TERM_CHAR;\n        var buffer = stringToUtf8Bytes(key);\n\n        var parent = ROOT_ID;\n        var child = NOT_FOUND;\n\n        for (var i = 0; i < buffer.length; i++) {\n            var code = buffer[i];\n\n            child = this.traverse(parent, code);\n            if (child === NOT_FOUND) {\n                return false;\n            }\n\n            if (bc.getBase(child) <= 0) {\n                // leaf node\n                return true;\n            } else {\n                // not leaf\n                parent = child;\n                continue;\n            }\n        }\n        return false;\n    };\n\n\n    /**\n     * Look up a given key in this trie\n     *\n     * @param {String} key\n     * @return {Number} Record value assgned to this key, -1 if this key does not contain\n     */\n    DoubleArray.prototype.lookup = function (key) {\n\n        key += TERM_CHAR;\n        var buffer = stringToUtf8Bytes(key);\n\n        var parent = ROOT_ID;\n        var child = NOT_FOUND;\n\n        for (var i = 0; i < buffer.length; i++) {\n            var code = buffer[i];\n            child = this.traverse(parent, code);\n            if (child === NOT_FOUND) {\n                return NOT_FOUND;\n            }\n            parent = child;\n        }\n\n        var base = this.bc.getBase(child);\n        if (base <= 0) {\n            // leaf node\n            return - base - 1;\n        } else {\n            // not leaf\n            return NOT_FOUND;\n        }\n    };\n\n\n    /**\n     * Common prefix search\n     *\n     * @param {String} key\n     * @return {Array} Each result object has 'k' and 'v' (key and record,\n     * respectively) properties assigned to matched string\n     */\n    DoubleArray.prototype.commonPrefixSearch = function (key) {\n\n        var buffer = stringToUtf8Bytes(key);\n\n        var parent = ROOT_ID;\n        var child = NOT_FOUND;\n\n        var result = [];\n\n        for (var i = 0; i < buffer.length; i++) {\n            var code = buffer[i];\n\n            child = this.traverse(parent, code);\n\n            if (child !== NOT_FOUND) {\n                parent = child;\n\n                // look forward by terminal character code to check this node is a leaf or not\n                var grand_child = this.traverse(child, TERM_CODE);\n\n                if (grand_child !== NOT_FOUND) {\n                    var base = this.bc.getBase(grand_child);\n\n                    var r = {};\n\n                    if (base <= 0) {\n                        // If child is a leaf node, add record to result\n                        r.v = - base - 1;\n                    }\n\n                    // If child is a leaf node, add word to result\n                    r.k = utf8BytesToString(arrayCopy(buffer, 0, i + 1));\n\n                    result.push(r);\n                }\n                continue;\n            } else {\n                break;\n            }\n        }\n\n        return result;\n    };\n\n    DoubleArray.prototype.traverse = function (parent, code) {\n        var child = this.bc.getBase(parent) + code;\n        if (this.bc.getCheck(child) === parent) {\n            return child;\n        } else {\n            return NOT_FOUND;\n        }\n    };\n\n    DoubleArray.prototype.size = function () {\n        return this.bc.size();\n    };\n\n    DoubleArray.prototype.calc = function () {\n        return this.bc.calc();\n    };\n\n    DoubleArray.prototype.dump = function () {\n        return this.bc.dump();\n    };\n\n\n    // Array utility functions\n\n    var newArrayBuffer = function (signed, bytes, size) {\n        if (signed) {\n            switch(bytes) {\n                case 1:\n                return new Int8Array(size);\n                case 2:\n                return new Int16Array(size);\n                case 4:\n                return new Int32Array(size);\n                default:\n                throw new RangeError(\"Invalid newArray parameter element_bytes:\" + bytes);\n            }\n        } else {\n            switch(bytes) {\n                case 1:\n                return new Uint8Array(size);\n                case 2:\n                return new Uint16Array(size);\n                case 4:\n                return new Uint32Array(size);\n                default:\n                throw new RangeError(\"Invalid newArray parameter element_bytes:\" + bytes);\n            }\n        }\n    };\n\n    var arrayCopy = function (src, src_offset, length) {\n        var buffer = new ArrayBuffer(length);\n        var dstU8 = new Uint8Array(buffer, 0, length);\n        var srcU8 = src.subarray(src_offset, length);\n        dstU8.set(srcU8);\n        return dstU8;\n    };\n\n\n    /**\n     * Convert String (UTF-16) to UTF-8 ArrayBuffer\n     *\n     * @param {String} str UTF-16 string to convert\n     * @return {Uint8Array} Byte sequence encoded by UTF-8\n     */\n    var stringToUtf8Bytes = function (str) {\n\n        // Max size of 1 character is 4 bytes\n        var bytes = new Uint8Array(new ArrayBuffer(str.length * 4));\n\n        var i = 0, j = 0;\n\n        while (i < str.length) {\n            var unicode_code;\n\n            var utf16_code = str.charCodeAt(i++);\n            if (utf16_code >= 0xD800 && utf16_code <= 0xDBFF) {\n                // surrogate pair\n                var upper = utf16_code;           // high surrogate\n                var lower = str.charCodeAt(i++);  // low surrogate\n\n                if (lower >= 0xDC00 && lower <= 0xDFFF) {\n                    unicode_code =\n                        (upper - 0xD800) * (1 << 10) + (1 << 16) +\n                        (lower - 0xDC00);\n                } else {\n                    // malformed surrogate pair\n                    return null;\n                }\n            } else {\n                // not surrogate code\n                unicode_code = utf16_code;\n            }\n\n            if (unicode_code < 0x80) {\n                // 1-byte\n                bytes[j++] = unicode_code;\n\n            } else if (unicode_code < (1 << 11)) {\n                // 2-byte\n                bytes[j++] = (unicode_code >>> 6) | 0xC0;\n                bytes[j++] = (unicode_code & 0x3F) | 0x80;\n\n            } else if (unicode_code < (1 << 16)) {\n                // 3-byte\n                bytes[j++] = (unicode_code >>> 12) | 0xE0;\n                bytes[j++] = ((unicode_code >> 6) & 0x3f) | 0x80;\n                bytes[j++] = (unicode_code & 0x3F) | 0x80;\n\n            } else if (unicode_code < (1 << 21)) {\n                // 4-byte\n                bytes[j++] = (unicode_code >>> 18) | 0xF0;\n                bytes[j++] = ((unicode_code >> 12) & 0x3F) | 0x80;\n                bytes[j++] = ((unicode_code >> 6) & 0x3F) | 0x80;\n                bytes[j++] = (unicode_code & 0x3F) | 0x80;\n\n            } else {\n                // malformed UCS4 code\n            }\n        }\n\n        return bytes.subarray(0, j);\n    };\n\n\n    /**\n     * Convert UTF-8 ArrayBuffer to String (UTF-16)\n     *\n     * @param {Uint8Array} bytes UTF-8 byte sequence to convert\n     * @return {String} String encoded by UTF-16\n     */\n    var utf8BytesToString = function (bytes) {\n\n        var str = \"\";\n        var code, b1, b2, b3, b4, upper, lower;\n        var i = 0;\n\n        while (i < bytes.length) {\n\n            b1 = bytes[i++];\n\n            if (b1 < 0x80) {\n                // 1 byte\n                code = b1;\n            } else if ((b1 >> 5) === 0x06) {\n                // 2 bytes\n                b2 = bytes[i++];\n                code = ((b1 & 0x1f) << 6) | (b2 & 0x3f);\n            } else if ((b1 >> 4) === 0x0e) {\n                // 3 bytes\n                b2 = bytes[i++];\n                b3 = bytes[i++];\n                code = ((b1 & 0x0f) << 12) | ((b2 & 0x3f) << 6) | (b3 & 0x3f);\n            } else {\n                // 4 bytes\n                b2 = bytes[i++];\n                b3 = bytes[i++];\n                b4 = bytes[i++];\n                code = ((b1 & 0x07) << 18) | ((b2 & 0x3f) << 12) | ((b3 & 0x3f) << 6) | (b4 & 0x3f);\n            }\n\n            if (code < 0x10000) {\n\t            str += String.fromCharCode(code);\n            } else {\n\t            // surrogate pair\n\t            code -= 0x10000;\n\t            upper = (0xD800 | (code >> 10));\n\t            lower = (0xDC00 | (code & 0x3FF));\n\t            str += String.fromCharCode(upper, lower);\n            }\n        }\n\n        return str;\n    };\n\n\n    // public methods\n    var doublearray = {\n        builder: function (initial_size) {\n            return new DoubleArrayBuilder(initial_size);\n        },\n        load: function (base_buffer, check_buffer) {\n            var bc = newBC(0);\n            bc.loadBaseBuffer(base_buffer);\n            bc.loadCheckBuffer(check_buffer);\n            return new DoubleArray(bc);\n        }\n    };\n\n    if (\"undefined\" === typeof module) {\n\t    // In browser\n        window.doublearray = doublearray;\n    } else {\n\t    // In node\n        module.exports = doublearray;\n    }\n\n})();\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * Convert String (UTF-16) to UTF-8 ArrayBuffer\n *\n * @param {String} str UTF-16 string to convert\n * @return {Uint8Array} Byte sequence encoded by UTF-8\n */\nconst stringToUtf8Bytes = function (str) {\n\t// Max size of 1 character is 4 bytes\n\tconst bytes = new Uint8Array(str.length * 4);\n\n\tlet i = 0;\n\tlet j = 0;\n\n\twhile (i < str.length) {\n\t\tlet unicode_code;\n\n\t\tconst utf16_code = str.charCodeAt(i++);\n\t\tif (utf16_code >= 0xd800 && utf16_code <= 0xdbff) {\n\t\t\t// surrogate pair\n\t\t\tconst upper = utf16_code; // high surrogate\n\t\t\tconst lower = str.charCodeAt(i++); // low surrogate\n\n\t\t\tif (lower >= 0xdc00 && lower <= 0xdfff) {\n\t\t\t\tunicode_code =\n\t\t\t\t\t(upper - 0xd800) * (1 << 10) + (1 << 16) + (lower - 0xdc00);\n\t\t\t} else {\n\t\t\t\t// malformed surrogate pair\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\t// not surrogate code\n\t\t\tunicode_code = utf16_code;\n\t\t}\n\n\t\tif (unicode_code < 0x80) {\n\t\t\t// 1-byte\n\t\t\tbytes[j++] = unicode_code;\n\t\t} else if (unicode_code < 1 << 11) {\n\t\t\t// 2-byte\n\t\t\tbytes[j++] = (unicode_code >>> 6) | 0xc0;\n\t\t\tbytes[j++] = (unicode_code & 0x3f) | 0x80;\n\t\t} else if (unicode_code < 1 << 16) {\n\t\t\t// 3-byte\n\t\t\tbytes[j++] = (unicode_code >>> 12) | 0xe0;\n\t\t\tbytes[j++] = ((unicode_code >> 6) & 0x3f) | 0x80;\n\t\t\tbytes[j++] = (unicode_code & 0x3f) | 0x80;\n\t\t} else if (unicode_code < 1 << 21) {\n\t\t\t// 4-byte\n\t\t\tbytes[j++] = (unicode_code >>> 18) | 0xf0;\n\t\t\tbytes[j++] = ((unicode_code >> 12) & 0x3f) | 0x80;\n\t\t\tbytes[j++] = ((unicode_code >> 6) & 0x3f) | 0x80;\n\t\t\tbytes[j++] = (unicode_code & 0x3f) | 0x80;\n\t\t} else {\n\t\t\t// malformed UCS4 code\n\t\t}\n\t}\n\n\treturn bytes.subarray(0, j);\n};\n\n/**\n * Convert UTF-8 ArrayBuffer to String (UTF-16)\n *\n * @param {Array} bytes UTF-8 byte sequence to convert\n * @return {String} String encoded by UTF-16\n */\nconst utf8BytesToString = function (bytes) {\n\tlet str = \"\";\n\tlet code;\n\tlet b1;\n\tlet b2;\n\tlet b3;\n\tlet b4;\n\tlet upper;\n\tlet lower;\n\tlet i = 0;\n\n\twhile (i < bytes.length) {\n\t\tb1 = bytes[i++];\n\n\t\tif (b1 < 0x80) {\n\t\t\t// 1 byte\n\t\t\tcode = b1;\n\t\t} else if (b1 >> 5 === 0x06) {\n\t\t\t// 2 bytes\n\t\t\tb2 = bytes[i++];\n\t\t\tcode = ((b1 & 0x1f) << 6) | (b2 & 0x3f);\n\t\t} else if (b1 >> 4 === 0x0e) {\n\t\t\t// 3 bytes\n\t\t\tb2 = bytes[i++];\n\t\t\tb3 = bytes[i++];\n\t\t\tcode = ((b1 & 0x0f) << 12) | ((b2 & 0x3f) << 6) | (b3 & 0x3f);\n\t\t} else {\n\t\t\t// 4 bytes\n\t\t\tb2 = bytes[i++];\n\t\t\tb3 = bytes[i++];\n\t\t\tb4 = bytes[i++];\n\t\t\tcode =\n\t\t\t\t((b1 & 0x07) << 18) |\n\t\t\t\t((b2 & 0x3f) << 12) |\n\t\t\t\t((b3 & 0x3f) << 6) |\n\t\t\t\t(b4 & 0x3f);\n\t\t}\n\n\t\tif (code < 0x10000) {\n\t\t\tstr += String.fromCharCode(code);\n\t\t} else {\n\t\t\t// surrogate pair\n\t\t\tcode -= 0x10000;\n\t\t\tupper = 0xd800 | (code >> 10);\n\t\t\tlower = 0xdc00 | (code & 0x3ff);\n\t\t\tstr += String.fromCharCode(upper, lower);\n\t\t}\n\t}\n\n\treturn str;\n};\n\n/**\n * Utilities to manipulate byte sequence\n * @param {(number|Uint8Array)} arg Initial size of this buffer (number), or buffer to set (Uint8Array)\n * @constructor\n */\nfunction ByteBuffer(arg) {\n\tlet initial_size;\n\tif (arg == null) {\n\t\tinitial_size = 1024 * 1024;\n\t} else if (typeof arg === \"number\") {\n\t\tinitial_size = arg;\n\t} else if (arg instanceof Uint8Array) {\n\t\tthis.buffer = arg;\n\t\tthis.position = 0; // Overwrite\n\t\treturn;\n\t} else {\n\t\t// typeof arg -> String\n\t\tthrow `${typeof arg} is invalid parameter type for ByteBuffer constructor`;\n\t}\n\t// arg is null or number\n\tthis.buffer = new Uint8Array(initial_size);\n\tthis.position = 0;\n}\n\nByteBuffer.prototype.size = function () {\n\treturn this.buffer.length;\n};\n\nByteBuffer.prototype.reallocate = function () {\n\tconst new_array = new Uint8Array(this.buffer.length * 2);\n\tnew_array.set(this.buffer);\n\tthis.buffer = new_array;\n};\n\nByteBuffer.prototype.shrink = function () {\n\tthis.buffer = this.buffer.subarray(0, this.position);\n\treturn this.buffer;\n};\n\nByteBuffer.prototype.put = function (b) {\n\tif (this.buffer.length < this.position + 1) {\n\t\tthis.reallocate();\n\t}\n\tthis.buffer[this.position++] = b;\n};\n\nByteBuffer.prototype.get = function (index) {\n\tif (index == null) {\n\t\tindex = this.position;\n\t\tthis.position += 1;\n\t}\n\tif (this.buffer.length < index + 1) {\n\t\treturn 0;\n\t}\n\treturn this.buffer[index];\n};\n\n// Write short to buffer by little endian\nByteBuffer.prototype.putShort = function (num) {\n\tif (0xffff < num) {\n\t\tthrow `${num} is over short value`;\n\t}\n\tconst lower = 0x00ff & num;\n\tconst upper = (0xff00 & num) >> 8;\n\tthis.put(lower);\n\tthis.put(upper);\n};\n\n// Read short from buffer by little endian\nByteBuffer.prototype.getShort = function (index) {\n\tif (index == null) {\n\t\tindex = this.position;\n\t\tthis.position += 2;\n\t}\n\tif (this.buffer.length < index + 2) {\n\t\treturn 0;\n\t}\n\tconst lower = this.buffer[index];\n\tconst upper = this.buffer[index + 1];\n\tlet value = (upper << 8) + lower;\n\tif (value & 0x8000) {\n\t\tvalue = -((value - 1) ^ 0xffff);\n\t}\n\treturn value;\n};\n\n// Write integer to buffer by little endian\nByteBuffer.prototype.putInt = function (num) {\n\tif (0xffffffff < num) {\n\t\tthrow `${num} is over integer value`;\n\t}\n\tconst b0 = 0x000000ff & num;\n\tconst b1 = (0x0000ff00 & num) >> 8;\n\tconst b2 = (0x00ff0000 & num) >> 16;\n\tconst b3 = (0xff000000 & num) >> 24;\n\tthis.put(b0);\n\tthis.put(b1);\n\tthis.put(b2);\n\tthis.put(b3);\n};\n\n// Read integer from buffer by little endian\nByteBuffer.prototype.getInt = function (index) {\n\tif (index == null) {\n\t\tindex = this.position;\n\t\tthis.position += 4;\n\t}\n\tif (this.buffer.length < index + 4) {\n\t\treturn 0;\n\t}\n\tconst b0 = this.buffer[index];\n\tconst b1 = this.buffer[index + 1];\n\tconst b2 = this.buffer[index + 2];\n\tconst b3 = this.buffer[index + 3];\n\n\treturn (b3 << 24) + (b2 << 16) + (b1 << 8) + b0;\n};\n\nByteBuffer.prototype.readInt = function () {\n\tconst pos = this.position;\n\tthis.position += 4;\n\treturn this.getInt(pos);\n};\n\nByteBuffer.prototype.putString = function (str) {\n\tconst bytes = stringToUtf8Bytes(str);\n\tfor (let i = 0; i < bytes.length; i++) {\n\t\tthis.put(bytes[i]);\n\t}\n\t// put null character as terminal character\n\tthis.put(0);\n};\n\nByteBuffer.prototype.getString = function (index) {\n\tconst buf = [];\n\tlet ch;\n\tif (index == null) {\n\t\tindex = this.position;\n\t}\n\twhile (true) {\n\t\tif (this.buffer.length < index + 1) {\n\t\t\tbreak;\n\t\t}\n\t\tch = this.get(index++);\n\t\tif (ch === 0) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tbuf.push(ch);\n\t\t}\n\t}\n\tthis.position = index;\n\treturn utf8BytesToString(buf);\n};\n\nexport default ByteBuffer;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ByteBuffer from \"../util/ByteBuffer\";\n\n/**\n * TokenInfoDictionary\n * @constructor\n */\nfunction TokenInfoDictionary() {\n\tthis.dictionary = new ByteBuffer(10 * 1024 * 1024);\n\tthis.target_map = {}; // trie_id (of surface form) -> token_info_id (of token)\n\tthis.pos_buffer = new ByteBuffer(10 * 1024 * 1024);\n}\n\n// left_id right_id word_cost ...\n// ^ this position is token_info_id\nTokenInfoDictionary.prototype.buildDictionary = function (entries) {\n\tconst dictionary_entries = {}; // using as hashmap, string -> string (word_id -> surface_form) to build dictionary\n\n\tfor (let i = 0; i < entries.length; i++) {\n\t\tconst entry = entries[i];\n\n\t\tif (entry.length < 4) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst surface_form = entry[0];\n\t\tconst left_id = entry[1];\n\t\tconst right_id = entry[2];\n\t\tconst word_cost = entry[3];\n\t\tconst feature = entry.slice(4).join(\",\"); // TODO Optimize\n\n\t\t// Assertion\n\t\tif (!(isFinite(left_id) && isFinite(right_id) && isFinite(word_cost))) {\n\t\t\tconsole.log(entry);\n\t\t}\n\n\t\tconst token_info_id = this.put(\n\t\t\tleft_id,\n\t\t\tright_id,\n\t\t\tword_cost,\n\t\t\tsurface_form,\n\t\t\tfeature,\n\t\t);\n\t\tdictionary_entries[token_info_id] = surface_form;\n\t}\n\n\t// Remove last unused area\n\tthis.dictionary.shrink();\n\tthis.pos_buffer.shrink();\n\n\treturn dictionary_entries;\n};\n\nTokenInfoDictionary.prototype.put = function (\n\tleft_id,\n\tright_id,\n\tword_cost,\n\tsurface_form,\n\tfeature,\n) {\n\tconst token_info_id = this.dictionary.position;\n\tconst pos_id = this.pos_buffer.position;\n\n\tthis.dictionary.putShort(left_id);\n\tthis.dictionary.putShort(right_id);\n\tthis.dictionary.putShort(word_cost);\n\tthis.dictionary.putInt(pos_id);\n\tthis.pos_buffer.putString(`${surface_form},${feature}`);\n\n\treturn token_info_id;\n};\n\nTokenInfoDictionary.prototype.addMapping = function (source, target) {\n\tlet mapping = this.target_map[source];\n\tif (mapping == null) {\n\t\tmapping = [];\n\t}\n\tmapping.push(target);\n\n\tthis.target_map[source] = mapping;\n};\n\nTokenInfoDictionary.prototype.targetMapToBuffer = function () {\n\tconst buffer = new ByteBuffer();\n\tconst map_keys_size = Object.keys(this.target_map).length;\n\tbuffer.putInt(map_keys_size);\n\tfor (const key in this.target_map) {\n\t\tconst values = this.target_map[key]; // Array\n\t\tconst map_values_size = values.length;\n\t\tbuffer.putInt(parseInt(key));\n\t\tbuffer.putInt(map_values_size);\n\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\tbuffer.putInt(values[i]);\n\t\t}\n\t}\n\treturn buffer.shrink(); // Shrink-ed Typed Array\n};\n\n// from tid.dat\nTokenInfoDictionary.prototype.loadDictionary = function (array_buffer) {\n\tthis.dictionary = new ByteBuffer(array_buffer);\n\treturn this;\n};\n\n// from tid_pos.dat\nTokenInfoDictionary.prototype.loadPosVector = function (array_buffer) {\n\tthis.pos_buffer = new ByteBuffer(array_buffer);\n\treturn this;\n};\n\n// from tid_map.dat\nTokenInfoDictionary.prototype.loadTargetMap = function (array_buffer) {\n\tconst buffer = new ByteBuffer(array_buffer);\n\tbuffer.position = 0;\n\tthis.target_map = {};\n\tbuffer.readInt(); // map_keys_size\n\twhile (true) {\n\t\tif (buffer.buffer.length < buffer.position + 1) {\n\t\t\tbreak;\n\t\t}\n\t\tconst key = buffer.readInt();\n\t\tconst map_values_size = buffer.readInt();\n\t\tfor (let i = 0; i < map_values_size; i++) {\n\t\t\tconst value = buffer.readInt();\n\t\t\tthis.addMapping(key, value);\n\t\t}\n\t}\n\treturn this;\n};\n\n/**\n * Look up features in the dictionary\n * @param {string} token_info_id_str Word ID to look up\n * @returns {string} Features string concatenated by \",\"\n */\nTokenInfoDictionary.prototype.getFeatures = function (token_info_id_str) {\n\tconst token_info_id = parseInt(token_info_id_str);\n\tif (isNaN(token_info_id)) {\n\t\t// TODO throw error\n\t\treturn \"\";\n\t}\n\tconst pos_id = this.dictionary.getInt(token_info_id + 6);\n\treturn this.pos_buffer.getString(pos_id);\n};\n\nexport default TokenInfoDictionary;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * Connection costs matrix from cc.dat file.\n * 2 dimension matrix [forward_id][backward_id] -> cost\n * @constructor\n * @param {number} forward_dimension\n * @param {number} backward_dimension\n */\nclass ConnectionCosts {\n\tconstructor(forward_dimension, backward_dimension) {\n\t\tthis.forward_dimension = forward_dimension;\n\t\tthis.backward_dimension = backward_dimension;\n\n\t\t// leading 2 integers for forward_dimension, backward_dimension, respectively\n\t\tthis.buffer = new Int16Array(forward_dimension * backward_dimension + 2);\n\t\tthis.buffer[0] = forward_dimension;\n\t\tthis.buffer[1] = backward_dimension;\n\t}\n\tput(forward_id, backward_id, cost) {\n\t\tconst index = forward_id * this.backward_dimension + backward_id + 2;\n\t\tif (this.buffer.length < index + 1) {\n\t\t\tthrow \"ConnectionCosts buffer overflow\";\n\t\t}\n\t\tthis.buffer[index] = cost;\n\t}\n\tget(forward_id, backward_id) {\n\t\tconst index = forward_id * this.backward_dimension + backward_id + 2;\n\t\tif (this.buffer.length < index + 1) {\n\t\t\tthrow \"ConnectionCosts buffer overflow\";\n\t\t}\n\t\treturn this.buffer[index];\n\t}\n\tloadConnectionCosts(connection_costs_buffer) {\n\t\tthis.forward_dimension = connection_costs_buffer[0];\n\t\tthis.backward_dimension = connection_costs_buffer[1];\n\t\tthis.buffer = connection_costs_buffer;\n\t}\n}\n\nexport default ConnectionCosts;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\n/**\n * CharacterClass\n * @param {number} class_id\n * @param {string} class_name\n * @param {boolean} is_always_invoke\n * @param {boolean} is_grouping\n * @param {number} max_length\n * @constructor\n */\nfunction CharacterClass(\n\tclass_id,\n\tclass_name,\n\tis_always_invoke,\n\tis_grouping,\n\tmax_length,\n) {\n\tthis.class_id = class_id;\n\tthis.class_name = class_name;\n\tthis.is_always_invoke = is_always_invoke;\n\tthis.is_grouping = is_grouping;\n\tthis.max_length = max_length;\n}\n\nexport default CharacterClass;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ByteBuffer from \"../util/ByteBuffer\";\nimport CharacterClass from \"./CharacterClass\";\n\n/**\n * InvokeDefinitionMap represents invoke definition a part of char.def\n * @constructor\n */\nfunction InvokeDefinitionMap() {\n\tthis.map = [];\n\tthis.lookup_table = {}; // Just for building dictionary\n}\n\n/**\n * Load InvokeDefinitionMap from buffer\n * @param {Uint8Array} invoke_def_buffer\n * @returns {InvokeDefinitionMap}\n */\nInvokeDefinitionMap.load = function (invoke_def_buffer) {\n\tconst invoke_def = new InvokeDefinitionMap();\n\tconst character_category_definition = [];\n\n\tconst buffer = new ByteBuffer(invoke_def_buffer);\n\twhile (buffer.position + 1 < buffer.size()) {\n\t\tconst class_id = character_category_definition.length;\n\t\tconst is_always_invoke = buffer.get();\n\t\tconst is_grouping = buffer.get();\n\t\tconst max_length = buffer.getInt();\n\t\tconst class_name = buffer.getString();\n\t\tcharacter_category_definition.push(\n\t\t\tnew CharacterClass(\n\t\t\t\tclass_id,\n\t\t\t\tclass_name,\n\t\t\t\tis_always_invoke,\n\t\t\t\tis_grouping,\n\t\t\t\tmax_length,\n\t\t\t),\n\t\t);\n\t}\n\n\tinvoke_def.init(character_category_definition);\n\n\treturn invoke_def;\n};\n\n/**\n * Initializing method\n * @param {Array.<CharacterClass>} character_category_definition Array of CharacterClass\n */\nInvokeDefinitionMap.prototype.init = function (character_category_definition) {\n\tif (character_category_definition == null) {\n\t\treturn;\n\t}\n\tfor (let i = 0; i < character_category_definition.length; i++) {\n\t\tconst character_class = character_category_definition[i];\n\t\tthis.map[i] = character_class;\n\t\tthis.lookup_table[character_class.class_name] = i;\n\t}\n};\n\n/**\n * Get class information by class ID\n * @param {number} class_id\n * @returns {CharacterClass}\n */\nInvokeDefinitionMap.prototype.getCharacterClass = function (class_id) {\n\treturn this.map[class_id];\n};\n\n/**\n * For building character definition dictionary\n * @param {string} class_name character\n * @returns {number} class_id\n */\nInvokeDefinitionMap.prototype.lookup = function (class_name) {\n\tconst class_id = this.lookup_table[class_name];\n\tif (class_id == null) {\n\t\treturn null;\n\t}\n\treturn class_id;\n};\n\n/**\n * Transform from map to binary buffer\n * @returns {Uint8Array}\n */\nInvokeDefinitionMap.prototype.toBuffer = function () {\n\tconst buffer = new ByteBuffer();\n\tfor (let i = 0; i < this.map.length; i++) {\n\t\tconst char_class = this.map[i];\n\t\tbuffer.put(char_class.is_always_invoke);\n\t\tbuffer.put(char_class.is_grouping);\n\t\tbuffer.putInt(char_class.max_length);\n\t\tbuffer.putString(char_class.class_name);\n\t}\n\tbuffer.shrink();\n\treturn buffer.buffer;\n};\n\nexport default InvokeDefinitionMap;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport InvokeDefinitionMap from \"./InvokeDefinitionMap\";\nimport CharacterClass from \"./CharacterClass\";\nimport SurrogateAwareString from \"../util/SurrogateAwareString\";\n\nconst DEFAULT_CATEGORY = \"DEFAULT\";\n\n/**\n * CharacterDefinition represents char.def file and\n * defines behavior of unknown word processing\n * @constructor\n */\nfunction CharacterDefinition() {\n\tthis.character_category_map = new Uint8Array(65536); // for all UCS2 code points\n\tthis.compatible_category_map = new Uint32Array(65536); // for all UCS2 code points\n\tthis.invoke_definition_map = null;\n}\n\n/**\n * Load CharacterDefinition\n * @param {Uint8Array} cat_map_buffer\n * @param {Uint32Array} compat_cat_map_buffer\n * @param {InvokeDefinitionMap} invoke_def_buffer\n * @returns {CharacterDefinition}\n */\nCharacterDefinition.load = function (\n\tcat_map_buffer,\n\tcompat_cat_map_buffer,\n\tinvoke_def_buffer,\n) {\n\tconst char_def = new CharacterDefinition();\n\tchar_def.character_category_map = cat_map_buffer;\n\tchar_def.compatible_category_map = compat_cat_map_buffer;\n\tchar_def.invoke_definition_map = InvokeDefinitionMap.load(invoke_def_buffer);\n\treturn char_def;\n};\n\nCharacterDefinition.parseCharCategory = function (\n\tclass_id,\n\tparsed_category_def,\n) {\n\tconst category = parsed_category_def[1];\n\tconst invoke = parseInt(parsed_category_def[2]);\n\tconst grouping = parseInt(parsed_category_def[3]);\n\tconst max_length = parseInt(parsed_category_def[4]);\n\tif (!isFinite(invoke) || (invoke !== 0 && invoke !== 1)) {\n\t\tconsole.log(`char.def parse error. INVOKE is 0 or 1 in:${invoke}`);\n\t\treturn null;\n\t}\n\tif (!isFinite(grouping) || (grouping !== 0 && grouping !== 1)) {\n\t\tconsole.log(`char.def parse error. GROUP is 0 or 1 in:${grouping}`);\n\t\treturn null;\n\t}\n\tif (!isFinite(max_length) || max_length < 0) {\n\t\tconsole.log(`char.def parse error. LENGTH is 1 to n:${max_length}`);\n\t\treturn null;\n\t}\n\tconst is_invoke = invoke === 1;\n\tconst is_grouping = grouping === 1;\n\n\treturn new CharacterClass(\n\t\tclass_id,\n\t\tcategory,\n\t\tis_invoke,\n\t\tis_grouping,\n\t\tmax_length,\n\t);\n};\n\nCharacterDefinition.parseCategoryMapping = function (parsed_category_mapping) {\n\tconst start = parseInt(parsed_category_mapping[1]);\n\tconst default_category = parsed_category_mapping[2];\n\tconst compatible_category =\n\t\t3 < parsed_category_mapping.length ? parsed_category_mapping.slice(3) : [];\n\tif (!isFinite(start) || start < 0 || start > 0xffff) {\n\t\tconsole.log(`char.def parse error. CODE is invalid:${start}`);\n\t}\n\treturn {\n\t\tstart: start,\n\t\tdefault: default_category,\n\t\tcompatible: compatible_category,\n\t};\n};\n\nCharacterDefinition.parseRangeCategoryMapping = function (\n\tparsed_category_mapping,\n) {\n\tconst start = parseInt(parsed_category_mapping[1]);\n\tconst end = parseInt(parsed_category_mapping[2]);\n\tconst default_category = parsed_category_mapping[3];\n\tconst compatible_category =\n\t\t4 < parsed_category_mapping.length ? parsed_category_mapping.slice(4) : [];\n\tif (!isFinite(start) || start < 0 || start > 0xffff) {\n\t\tconsole.log(`char.def parse error. CODE is invalid:${start}`);\n\t}\n\tif (!isFinite(end) || end < 0 || end > 0xffff) {\n\t\tconsole.log(`char.def parse error. CODE is invalid:${end}`);\n\t}\n\treturn {\n\t\tstart: start,\n\t\tend: end,\n\t\tdefault: default_category,\n\t\tcompatible: compatible_category,\n\t};\n};\n\n/**\n * Initializing method\n * @param {Array} category_mapping Array of category mapping\n */\nCharacterDefinition.prototype.initCategoryMappings = function (\n\tcategory_mapping,\n) {\n\t// Initialize map by DEFAULT class\n\tlet code_point;\n\tif (category_mapping != null) {\n\t\tfor (let i = 0; i < category_mapping.length; i++) {\n\t\t\tconst mapping = category_mapping[i];\n\t\t\tconst end = mapping.end || mapping.start;\n\t\t\tfor (code_point = mapping.start; code_point <= end; code_point++) {\n\t\t\t\t// Default Category class ID\n\t\t\t\tthis.character_category_map[code_point] =\n\t\t\t\t\tthis.invoke_definition_map.lookup(mapping.default);\n\n\t\t\t\tfor (let j = 0; j < mapping.compatible.length; j++) {\n\t\t\t\t\tlet bitset = this.compatible_category_map[code_point];\n\t\t\t\t\tconst compatible_category = mapping.compatible[j];\n\t\t\t\t\tif (compatible_category == null) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tconst class_id =\n\t\t\t\t\t\tthis.invoke_definition_map.lookup(compatible_category); // Default Category\n\t\t\t\t\tif (class_id == null) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tconst class_id_bit = 1 << class_id;\n\t\t\t\t\tbitset = bitset | class_id_bit; // Set a bit of class ID 例えば、class_idが3のとき、3ビット目に1を立てる\n\t\t\t\t\tthis.compatible_category_map[code_point] = bitset;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tconst default_id = this.invoke_definition_map.lookup(DEFAULT_CATEGORY);\n\tif (default_id == null) {\n\t\treturn;\n\t}\n\tfor (\n\t\tcode_point = 0;\n\t\tcode_point < this.character_category_map.length;\n\t\tcode_point++\n\t) {\n\t\t// 他に何のクラスも定義されていなかったときだけ DEFAULT\n\t\tif (this.character_category_map[code_point] === 0) {\n\t\t\t// DEFAULT class ID に対応するビットだけ1を立てる\n\t\t\tthis.character_category_map[code_point] = 1 << default_id;\n\t\t}\n\t}\n};\n\n/**\n * Lookup compatible categories for a character (not included 1st category)\n * @param {string} ch UCS2 character (just 1st character is effective)\n * @returns {Array.<CharacterClass>} character classes\n */\nCharacterDefinition.prototype.lookupCompatibleCategory = function (ch) {\n\tconst classes = [];\n\n\t/*\n     if (SurrogateAwareString.isSurrogatePair(ch)) {\n     // Surrogate pair character codes can not be defined by char.def\n     return classes;\n     }*/\n\tconst code = ch.charCodeAt(0);\n\tlet integer;\n\tif (code < this.compatible_category_map.length) {\n\t\tinteger = this.compatible_category_map[code]; // Bitset\n\t}\n\n\tif (integer == null || integer === 0) {\n\t\treturn classes;\n\t}\n\n\tfor (let bit = 0; bit < 32; bit++) {\n\t\t// Treat \"bit\" as a class ID\n\t\tif ((integer << (31 - bit)) >>> 31 === 1) {\n\t\t\tconst character_class = this.invoke_definition_map.getCharacterClass(bit);\n\t\t\tif (character_class == null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tclasses.push(character_class);\n\t\t}\n\t}\n\treturn classes;\n};\n\n/**\n * Lookup category for a character\n * @param {string} ch UCS2 character (just 1st character is effective)\n * @returns {CharacterClass} character class\n */\nCharacterDefinition.prototype.lookup = function (ch) {\n\tlet class_id;\n\n\tconst code = ch.charCodeAt(0);\n\tif (SurrogateAwareString.isSurrogatePair(ch)) {\n\t\t// Surrogate pair character codes can not be defined by char.def, so set DEFAULT category\n\t\tclass_id = this.invoke_definition_map.lookup(DEFAULT_CATEGORY);\n\t} else if (code < this.character_category_map.length) {\n\t\tclass_id = this.character_category_map[code]; // Read as integer value\n\t}\n\n\tif (class_id == null) {\n\t\tclass_id = this.invoke_definition_map.lookup(DEFAULT_CATEGORY);\n\t}\n\n\treturn this.invoke_definition_map.getCharacterClass(class_id);\n};\n\nexport default CharacterDefinition;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport TokenInfoDictionary from \"./TokenInfoDictionary\";\nimport CharacterDefinition from \"./CharacterDefinition\";\nimport ByteBuffer from \"../util/ByteBuffer\";\n\n/**\n * UnknownDictionary\n * @constructor\n */\nfunction UnknownDictionary() {\n\tthis.dictionary = new ByteBuffer(10 * 1024 * 1024);\n\tthis.target_map = {}; // class_id (of CharacterClass) -> token_info_id (of unknown class)\n\tthis.pos_buffer = new ByteBuffer(10 * 1024 * 1024);\n\tthis.character_definition = null;\n}\n\n// Inherit from TokenInfoDictionary as a super class\nUnknownDictionary.prototype = Object.create(TokenInfoDictionary.prototype);\n\nUnknownDictionary.prototype.characterDefinition = function (\n\tcharacter_definition,\n) {\n\tthis.character_definition = character_definition;\n\treturn this;\n};\n\nUnknownDictionary.prototype.lookup = function (ch) {\n\treturn this.character_definition.lookup(ch);\n};\n\nUnknownDictionary.prototype.lookupCompatibleCategory = function (ch) {\n\treturn this.character_definition.lookupCompatibleCategory(ch);\n};\n\nUnknownDictionary.prototype.loadUnknownDictionaries = function (\n\tunk_buffer,\n\tunk_pos_buffer,\n\tunk_map_buffer,\n\tcat_map_buffer,\n\tcompat_cat_map_buffer,\n\tinvoke_def_buffer,\n) {\n\tthis.loadDictionary(unk_buffer);\n\tthis.loadPosVector(unk_pos_buffer);\n\tthis.loadTargetMap(unk_map_buffer);\n\tthis.character_definition = CharacterDefinition.load(\n\t\tcat_map_buffer,\n\t\tcompat_cat_map_buffer,\n\t\tinvoke_def_buffer,\n\t);\n};\n\nexport default UnknownDictionary;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport { builder, load } from \"doublearray\";\nimport TokenInfoDictionary from \"./TokenInfoDictionary\";\nimport ConnectionCosts from \"./ConnectionCosts\";\nimport UnknownDictionary from \"./UnknownDictionary\";\n\n/**\n * Dictionaries container for Tokenizer\n * @param {?DoubleArray} trie\n * @param {?TokenInfoDictionary} token_info_dictionary\n * @param {?ConnectionCosts} connection_costs\n * @param {?UnknownDictionary} unknown_dictionary\n * @constructor\n */\nfunction DynamicDictionaries(\n\ttrie,\n\ttoken_info_dictionary,\n\tconnection_costs,\n\tunknown_dictionary,\n) {\n\tif (trie) {\n\t\tthis.trie = trie;\n\t} else {\n\t\tthis.trie = builder(0).build([{ k: \"\", v: 1 }]);\n\t}\n\tif (token_info_dictionary) {\n\t\tthis.token_info_dictionary = token_info_dictionary;\n\t} else {\n\t\tthis.token_info_dictionary = new TokenInfoDictionary();\n\t}\n\tif (connection_costs) {\n\t\tthis.connection_costs = connection_costs;\n\t} else {\n\t\t// backward_size * backward_size\n\t\tthis.connection_costs = new ConnectionCosts(0, 0);\n\t}\n\tif (unknown_dictionary) {\n\t\tthis.unknown_dictionary = unknown_dictionary;\n\t} else {\n\t\tthis.unknown_dictionary = new UnknownDictionary();\n\t}\n}\n\n// from base.dat & check.dat\nDynamicDictionaries.prototype.loadTrie = function (base_buffer, check_buffer) {\n\tthis.trie = load(base_buffer, check_buffer);\n\treturn this;\n};\n\nDynamicDictionaries.prototype.loadTokenInfoDictionaries = function (\n\ttoken_info_buffer,\n\tpos_buffer,\n\ttarget_map_buffer,\n) {\n\tthis.token_info_dictionary.loadDictionary(token_info_buffer);\n\tthis.token_info_dictionary.loadPosVector(pos_buffer);\n\tthis.token_info_dictionary.loadTargetMap(target_map_buffer);\n\treturn this;\n};\n\nDynamicDictionaries.prototype.loadConnectionCosts = function (cc_buffer) {\n\tthis.connection_costs.loadConnectionCosts(cc_buffer);\n\treturn this;\n};\n\nDynamicDictionaries.prototype.loadUnknownDictionaries = function (\n\tunk_buffer,\n\tunk_pos_buffer,\n\tunk_map_buffer,\n\tcat_map_buffer,\n\tcompat_cat_map_buffer,\n\tinvoke_def_buffer,\n) {\n\tthis.unknown_dictionary.loadUnknownDictionaries(\n\t\tunk_buffer,\n\t\tunk_pos_buffer,\n\t\tunk_map_buffer,\n\t\tcat_map_buffer,\n\t\tcompat_cat_map_buffer,\n\t\tinvoke_def_buffer,\n\t);\n\treturn this;\n};\n\nexport default DynamicDictionaries;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport DynamicDictionaries from \"../dict/DynamicDictionaries\";\n\nfunction join(...path) {\n\treturn path.join(\"/\");\n}\n\nclass DictionaryLoader {\n\t/**\n\t * @param {string} dic_path\n\t */\n\tconstructor(dic_path) {\n\t\t/**\n\t\t * @type {DynamicDictionaries}\n\t\t */\n\t\tthis.dic = new DynamicDictionaries();\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tthis.dic_path = dic_path;\n\t}\n\n\t/**\n\t * @param {string} file\n\t * @return {Promise<ArrayBufferLike>}\n\t */\n\tasync loadArrayBuffer(_file) {\n\t\tthrow new Error(\"DictionaryLoader#loadArrayBuffer should be overwritten\");\n\t}\n\n\tasync load() {\n\t\tconst dic = this.dic;\n\t\tconst dic_path = this.dic_path;\n\t\tconst loadArrayBuffer = this.loadArrayBuffer;\n\t\tconst loadData = (/** @type {string} */ filename) =>\n\t\t\tloadArrayBuffer(join(dic_path, filename));\n\n\t\tawait Promise.all([\n\t\t\t(async () => {\n\t\t\t\tconst buffer = await loadData(\"cc.dat\");\n\t\t\t\tconst cc_buffer = new Int16Array(buffer);\n\t\t\t\tdic.loadConnectionCosts(cc_buffer);\n\t\t\t})(),\n\t\t\t(async () => {\n\t\t\t\tconst [base_buffer, check_buffer] = await Promise.all(\n\t\t\t\t\t[\"base.dat\", \"check.dat\"].map(loadData),\n\t\t\t\t);\n\t\t\t\tdic.loadTrie(new Uint8Array(base_buffer), new Uint8Array(check_buffer));\n\t\t\t})(),\n\t\t\t(async () => {\n\t\t\t\tconst buffers = await Promise.all(\n\t\t\t\t\t[\n\t\t\t\t\t\t\"unk.dat\",\n\t\t\t\t\t\t\"unk_pos.dat\",\n\t\t\t\t\t\t\"unk_map.dat\",\n\t\t\t\t\t\t\"unk_char.dat\",\n\t\t\t\t\t\t\"unk_compat.dat\",\n\t\t\t\t\t\t\"unk_invoke.dat\",\n\t\t\t\t\t].map(loadData),\n\t\t\t\t);\n\t\t\t\tconst unk_buffer = new Uint8Array(buffers[0]);\n\t\t\t\tconst unk_pos_buffer = new Uint8Array(buffers[1]);\n\t\t\t\tconst unk_map_buffer = new Uint8Array(buffers[2]);\n\t\t\t\tconst cat_map_buffer = new Uint8Array(buffers[3]);\n\t\t\t\tconst compat_cat_map_buffer = new Uint32Array(buffers[4]);\n\t\t\t\tconst invoke_def_buffer = new Uint8Array(buffers[5]);\n\n\t\t\t\tdic.loadUnknownDictionaries(\n\t\t\t\t\tunk_buffer,\n\t\t\t\t\tunk_pos_buffer,\n\t\t\t\t\tunk_map_buffer,\n\t\t\t\t\tcat_map_buffer,\n\t\t\t\t\tcompat_cat_map_buffer,\n\t\t\t\t\tinvoke_def_buffer,\n\t\t\t\t);\n\t\t\t})(),\n\t\t]);\n\n\t\treturn dic;\n\t}\n}\n\nexport default DictionaryLoader;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport { decompress } from \"fflate\";\nimport DictionaryLoader from \"./DictionaryLoader\";\n\n/**\n * @param {ArrayBufferLike} buffer\n * @returns {Promise<ArrayBufferLike>}\n */\nfunction decompressAsync(buffer) {\n\treturn new Promise((resolve, reject) => {\n\t\tdecompress(\n\t\t\tnew Uint8Array(buffer),\n\t\t\t{\n\t\t\t\tconsume: true,\n\t\t\t},\n\t\t\tfunction (err, typed_array) {\n\t\t\t\tif (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(typed_array.buffer);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t});\n}\n\n/**\n * BrowserDictionaryLoader inherits DictionaryLoader, using fetch api for download\n * @param {string} dic_path Dictionary path\n * @constructor\n */\nclass BrowserDictionaryLoader extends DictionaryLoader {\n\t/**\n\t * @override\n\t * @param {string} url\n\t * @returns {Promise<ArrayBufferLike>}\n\t */\n\tasync loadArrayBuffer(url) {\n\t\tconst res = await fetch(url);\n\t\tif (!res.ok) throw new Error(res.statusText);\n\t\tconst data = await res.arrayBuffer();\n\t\tconst decompressed = await decompressAsync(data);\n\t\treturn decompressed;\n\t}\n}\n\nexport default BrowserDictionaryLoader;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport Tokenizer from \"./Tokenizer\";\nimport DictionaryLoader from \"./loader/NodeDictionaryLoader\";\n\n/**\n * TokenizerBuilder create Tokenizer instance.\n * @param {Object} option JSON object which have key-value pairs settings\n * @param {string} option.dicPath Dictionary directory path (or URL using in browser)\n * @constructor\n */\nfunction TokenizerBuilder(option) {\n\tif (option.dicPath == null) {\n\t\tthis.dic_path = \"dict/\";\n\t} else {\n\t\tthis.dic_path = option.dicPath;\n\t}\n}\n\n/**\n * Build Tokenizer instance by asynchronous manner\n * @param {TokenizerBuilder~onLoad} callback Callback function\n */\nTokenizerBuilder.prototype.build = function (callback) {\n\tconst loader = new DictionaryLoader(this.dic_path);\n\tloader\n\t\t.load()\n\t\t.then((dic) => callback(null, new Tokenizer(dic)))\n\t\t.catch((err) => callback(err, null));\n};\n\n/**\n * Callback used by build\n * @callback TokenizerBuilder~onLoad\n * @param {Object} err Error object\n * @param {Tokenizer} tokenizer Prepared Tokenizer\n */\n\nexport default TokenizerBuilder;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport ConnectionCosts from \"../ConnectionCosts\";\n\n/**\n * Builder class for constructing ConnectionCosts object\n * @constructor\n */\nfunction ConnectionCostsBuilder() {\n\tthis.lines = 0;\n\tthis.connection_cost = null;\n}\n\nConnectionCostsBuilder.prototype.putLine = function (line) {\n\tif (this.lines === 0) {\n\t\tconst dimensions = line.split(\" \");\n\t\tconst forward_dimension = dimensions[0];\n\t\tconst backward_dimension = dimensions[1];\n\n\t\tif (forward_dimension < 0 || backward_dimension < 0) {\n\t\t\tthrow \"Parse error of matrix.def\";\n\t\t}\n\n\t\tthis.connection_cost = new ConnectionCosts(\n\t\t\tforward_dimension,\n\t\t\tbackward_dimension,\n\t\t);\n\t\tthis.lines++;\n\t\treturn this;\n\t}\n\n\tconst costs = line.split(\" \");\n\n\tif (costs.length !== 3) {\n\t\treturn this;\n\t}\n\n\tconst forward_id = parseInt(costs[0]);\n\tconst backward_id = parseInt(costs[1]);\n\tconst cost = parseInt(costs[2]);\n\n\tif (\n\t\tforward_id < 0 ||\n\t\tbackward_id < 0 ||\n\t\t!isFinite(forward_id) ||\n\t\t!isFinite(backward_id) ||\n\t\tthis.connection_cost.forward_dimension <= forward_id ||\n\t\tthis.connection_cost.backward_dimension <= backward_id\n\t) {\n\t\tthrow \"Parse error of matrix.def\";\n\t}\n\n\tthis.connection_cost.put(forward_id, backward_id, cost);\n\tthis.lines++;\n\treturn this;\n};\n\nConnectionCostsBuilder.prototype.build = function () {\n\treturn this.connection_cost;\n};\n\nexport default ConnectionCostsBuilder;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport CharacterDefinition from \"../CharacterDefinition\";\nimport InvokeDefinitionMap from \"../InvokeDefinitionMap\";\n\nconst CATEGORY_DEF_PATTERN = /^(\\w+)\\s+(\\d)\\s+(\\d)\\s+(\\d)/;\nconst CATEGORY_MAPPING_PATTERN =\n\t/^(0x[0-9A-F]{4})(?:\\s+([^#\\s]+))(?:\\s+([^#\\s]+))*/;\nconst RANGE_CATEGORY_MAPPING_PATTERN =\n\t/^(0x[0-9A-F]{4})\\.\\.(0x[0-9A-F]{4})(?:\\s+([^#\\s]+))(?:\\s+([^#\\s]+))*/;\n\n/**\n * CharacterDefinitionBuilder\n * @constructor\n */\nfunction CharacterDefinitionBuilder() {\n\tthis.char_def = new CharacterDefinition();\n\tthis.char_def.invoke_definition_map = new InvokeDefinitionMap();\n\tthis.character_category_definition = [];\n\tthis.category_mapping = [];\n}\n\nCharacterDefinitionBuilder.prototype.putLine = function (line) {\n\tconst parsed_category_def = CATEGORY_DEF_PATTERN.exec(line);\n\tif (parsed_category_def != null) {\n\t\tconst class_id = this.character_category_definition.length;\n\t\tconst char_class = CharacterDefinition.parseCharCategory(\n\t\t\tclass_id,\n\t\t\tparsed_category_def,\n\t\t);\n\t\tif (char_class == null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.character_category_definition.push(char_class);\n\t\treturn;\n\t}\n\tconst parsed_category_mapping = CATEGORY_MAPPING_PATTERN.exec(line);\n\tif (parsed_category_mapping != null) {\n\t\tconst mapping = CharacterDefinition.parseCategoryMapping(\n\t\t\tparsed_category_mapping,\n\t\t);\n\t\tthis.category_mapping.push(mapping);\n\t}\n\tconst parsed_range_category_mapping =\n\t\tRANGE_CATEGORY_MAPPING_PATTERN.exec(line);\n\tif (parsed_range_category_mapping != null) {\n\t\tconst range_mapping = CharacterDefinition.parseRangeCategoryMapping(\n\t\t\tparsed_range_category_mapping,\n\t\t);\n\t\tthis.category_mapping.push(range_mapping);\n\t}\n};\n\nCharacterDefinitionBuilder.prototype.build = function () {\n\t// TODO If DEFAULT category does not exist, throw error\n\tthis.char_def.invoke_definition_map.init(this.character_category_definition);\n\tthis.char_def.initCategoryMappings(this.category_mapping);\n\treturn this.char_def;\n};\n\nexport default CharacterDefinitionBuilder;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport { builder as _builder } from \"doublearray\";\nimport DynamicDictionaries from \"../DynamicDictionaries\";\nimport TokenInfoDictionary from \"../TokenInfoDictionary\";\nimport ConnectionCostsBuilder from \"./ConnectionCostsBuilder\";\nimport CharacterDefinitionBuilder from \"./CharacterDefinitionBuilder\";\nimport UnknownDictionary from \"../UnknownDictionary\";\n\n/**\n * Build dictionaries (token info, connection costs)\n *\n * Generates from matrix.def\n * cc.dat: Connection costs\n *\n * Generates from *.csv\n * dat.dat: Double array\n * tid.dat: Token info dictionary\n * tid_map.dat: targetMap\n * tid_pos.dat: posList (part of speech)\n */\nfunction DictionaryBuilder() {\n\t// Array of entries, each entry in Mecab form\n\t// (0: surface form, 1: left id, 2: right id, 3: word cost, 4: part of speech id, 5-: other features)\n\tthis.tid_entries = [];\n\tthis.unk_entries = [];\n\tthis.cc_builder = new ConnectionCostsBuilder();\n\tthis.cd_builder = new CharacterDefinitionBuilder();\n}\n\nDictionaryBuilder.prototype.addTokenInfoDictionary = function (line) {\n\tconst new_entry = line.split(\",\");\n\tthis.tid_entries.push(new_entry);\n\treturn this;\n};\n\n/**\n * Put one line of \"matrix.def\" file for building ConnectionCosts object\n * @param {string} line is a line of \"matrix.def\"\n */\nDictionaryBuilder.prototype.putCostMatrixLine = function (line) {\n\tthis.cc_builder.putLine(line);\n\treturn this;\n};\n\nDictionaryBuilder.prototype.putCharDefLine = function (line) {\n\tthis.cd_builder.putLine(line);\n\treturn this;\n};\n\n/**\n * Put one line of \"unk.def\" file for building UnknownDictionary object\n * @param {string} line is a line of \"unk.def\"\n */\nDictionaryBuilder.prototype.putUnkDefLine = function (line) {\n\tthis.unk_entries.push(line.split(\",\"));\n\treturn this;\n};\n\nDictionaryBuilder.prototype.build = function () {\n\tconst dictionaries = this.buildTokenInfoDictionary();\n\tconst unknown_dictionary = this.buildUnknownDictionary();\n\n\treturn new DynamicDictionaries(\n\t\tdictionaries.trie,\n\t\tdictionaries.token_info_dictionary,\n\t\tthis.cc_builder.build(),\n\t\tunknown_dictionary,\n\t);\n};\n\n/**\n * Build TokenInfoDictionary\n *\n * @returns {{trie: *, token_info_dictionary: *}}\n */\nDictionaryBuilder.prototype.buildTokenInfoDictionary = function () {\n\tconst token_info_dictionary = new TokenInfoDictionary();\n\n\t// using as hashmap, string -> string (word_id -> surface_form) to build dictionary\n\tconst dictionary_entries = token_info_dictionary.buildDictionary(\n\t\tthis.tid_entries,\n\t);\n\n\tconst trie = this.buildDoubleArray();\n\n\tfor (const token_info_id in dictionary_entries) {\n\t\tconst surface_form = dictionary_entries[token_info_id];\n\t\tconst trie_id = trie.lookup(surface_form);\n\n\t\t// Assertion\n\t\t// if (trie_id < 0) {\n\t\t//     console.log(\"Not Found:\" + surface_form);\n\t\t// }\n\n\t\ttoken_info_dictionary.addMapping(trie_id, token_info_id);\n\t}\n\n\treturn {\n\t\ttrie: trie,\n\t\ttoken_info_dictionary: token_info_dictionary,\n\t};\n};\n\nDictionaryBuilder.prototype.buildUnknownDictionary = function () {\n\tconst unk_dictionary = new UnknownDictionary();\n\n\t// using as hashmap, string -> string (word_id -> surface_form) to build dictionary\n\tconst dictionary_entries = unk_dictionary.buildDictionary(this.unk_entries);\n\n\tconst char_def = this.cd_builder.build(); // Create CharacterDefinition\n\n\tunk_dictionary.characterDefinition(char_def);\n\n\tfor (const token_info_id in dictionary_entries) {\n\t\tconst class_name = dictionary_entries[token_info_id];\n\t\tconst class_id = char_def.invoke_definition_map.lookup(class_name);\n\n\t\t// Assertion\n\t\t// if (trie_id < 0) {\n\t\t//     console.log(\"Not Found:\" + surface_form);\n\t\t// }\n\n\t\tunk_dictionary.addMapping(class_id, token_info_id);\n\t}\n\n\treturn unk_dictionary;\n};\n\n/**\n * Build double array trie\n *\n * @returns {DoubleArray} Double-Array trie\n */\nDictionaryBuilder.prototype.buildDoubleArray = function () {\n\tlet trie_id = 0;\n\tconst words = this.tid_entries.map(function (entry) {\n\t\tconst surface_form = entry[0];\n\t\treturn { k: surface_form, v: trie_id++ };\n\t});\n\n\tconst builder = _builder(1024 * 1024);\n\treturn builder.build(words);\n};\n\nexport default DictionaryBuilder;\n","/*\n * Copyright 2014 Takuya Asano\n * Copyright 2010-2014 Atilika Inc. and contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\"use strict\";\n\nimport TokenizerBuilder from \"./TokenizerBuilder\";\nimport DictionaryBuilder from \"./dict/builder/DictionaryBuilder\";\n\n// Public methods\nconst kuromoji = {\n\tbuilder: function (option) {\n\t\treturn new TokenizerBuilder(option);\n\t},\n\tdictionaryBuilder: function () {\n\t\treturn new DictionaryBuilder();\n\t},\n};\n\nexport default kuromoji;\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Kuroshiro = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\nmodule.exports = require(\"regenerator-runtime\");\n\n},{\"regenerator-runtime\":2}],2:[function(require,module,exports){\n/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _util = require(\"./util\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n/**\n * Kuroshiro Class\n */\n\n\nvar Kuroshiro = /*#__PURE__*/function () {\n  /**\n   * Constructor\n   * @constructs Kuroshiro\n   */\n  function Kuroshiro() {\n    _classCallCheck(this, Kuroshiro);\n\n    this._analyzer = null;\n  }\n  /**\n   * Initialize Kuroshiro\n   * @memberOf Kuroshiro\n   * @instance\n   * @returns {Promise} Promise object represents the result of initialization\n   */\n\n\n  _createClass(Kuroshiro, [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regenerator.default.mark(function _callee(analyzer) {\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!analyzer || _typeof(analyzer) !== \"object\" || typeof analyzer.init !== \"function\" || typeof analyzer.parse !== \"function\")) {\n                  _context.next = 4;\n                  break;\n                }\n\n                throw new Error(\"Invalid initialization parameter.\");\n\n              case 4:\n                if (!(this._analyzer == null)) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 7;\n                return analyzer.init();\n\n              case 7:\n                this._analyzer = analyzer;\n                _context.next = 11;\n                break;\n\n              case 10:\n                throw new Error(\"Kuroshiro has already been initialized.\");\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function init(_x) {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n    /**\n     * Convert given string to target syllabary with options available\n     * @memberOf Kuroshiro\n     * @instance\n     * @param {string} str Given String\n     * @param {Object} [options] Settings Object\n     * @param {string} [options.to=\"hiragana\"] Target syllabary [\"hiragana\"|\"katakana\"|\"romaji\"]\n     * @param {string} [options.mode=\"normal\"] Convert mode [\"normal\"|\"spaced\"|\"okurigana\"|\"furigana\"]\n     * @param {string} [options.romajiSystem=\"hepburn\"] Romanization System [\"nippon\"|\"passport\"|\"hepburn\"]\n     * @param {string} [options.delimiter_start=\"(\"] Delimiter(Start)\n     * @param {string} [options.delimiter_end=\")\"] Delimiter(End)\n     * @returns {Promise} Promise object represents the result of conversion\n     */\n\n  }, {\n    key: \"convert\",\n    value: function () {\n      var _convert = _asyncToGenerator( /*#__PURE__*/_regenerator.default.mark(function _callee2(str, options) {\n        var ROMAJI_SYSTEMS, rawTokens, tokens, romajiConv, hi, tmp, hpattern, hc, hreg, hmatches, pickKJ, hc1, notations, i, strType, pattern, isLastTokenKanji, subs, c, reg, matches, pickKanji, c1, c2, c3, result, n0, n1, n2, n3, n4, n5;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                options = options || {};\n                options.to = options.to || \"hiragana\";\n                options.mode = options.mode || \"normal\";\n                options.romajiSystem = options.romajiSystem || _util.ROMANIZATION_SYSTEM.HEPBURN;\n                options.delimiter_start = options.delimiter_start || \"(\";\n                options.delimiter_end = options.delimiter_end || \")\";\n                str = str || \"\";\n\n                if (!([\"hiragana\", \"katakana\", \"romaji\"].indexOf(options.to) === -1)) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Invalid Target Syllabary.\");\n\n              case 9:\n                if (!([\"normal\", \"spaced\", \"okurigana\", \"furigana\"].indexOf(options.mode) === -1)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                throw new Error(\"Invalid Conversion Mode.\");\n\n              case 11:\n                ROMAJI_SYSTEMS = Object.keys(_util.ROMANIZATION_SYSTEM).map(function (e) {\n                  return _util.ROMANIZATION_SYSTEM[e];\n                });\n\n                if (!(ROMAJI_SYSTEMS.indexOf(options.romajiSystem) === -1)) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                throw new Error(\"Invalid Romanization System.\");\n\n              case 14:\n                _context2.next = 16;\n                return this._analyzer.parse(str);\n\n              case 16:\n                rawTokens = _context2.sent;\n                tokens = (0, _util.patchTokens)(rawTokens);\n\n                if (!(options.mode === \"normal\" || options.mode === \"spaced\")) {\n                  _context2.next = 36;\n                  break;\n                }\n\n                _context2.t0 = options.to;\n                _context2.next = _context2.t0 === \"katakana\" ? 22 : _context2.t0 === \"romaji\" ? 25 : _context2.t0 === \"hiragana\" ? 29 : 33;\n                break;\n\n              case 22:\n                if (!(options.mode === \"normal\")) {\n                  _context2.next = 24;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", tokens.map(function (token) {\n                  return token.reading;\n                }).join(\"\"));\n\n              case 24:\n                return _context2.abrupt(\"return\", tokens.map(function (token) {\n                  return token.reading;\n                }).join(\" \"));\n\n              case 25:\n                romajiConv = function romajiConv(token) {\n                  var preToken;\n\n                  if ((0, _util.hasJapanese)(token.surface_form)) {\n                    preToken = token.pronunciation || token.reading;\n                  } else {\n                    preToken = token.surface_form;\n                  }\n\n                  return (0, _util.toRawRomaji)(preToken, options.romajiSystem);\n                };\n\n                if (!(options.mode === \"normal\")) {\n                  _context2.next = 28;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", tokens.map(romajiConv).join(\"\"));\n\n              case 28:\n                return _context2.abrupt(\"return\", tokens.map(romajiConv).join(\" \"));\n\n              case 29:\n                for (hi = 0; hi < tokens.length; hi++) {\n                  if ((0, _util.hasKanji)(tokens[hi].surface_form)) {\n                    if (!(0, _util.hasKatakana)(tokens[hi].surface_form)) {\n                      tokens[hi].reading = (0, _util.toRawHiragana)(tokens[hi].reading);\n                    } else {\n                      // handle katakana-kanji-mixed tokens\n                      tokens[hi].reading = (0, _util.toRawHiragana)(tokens[hi].reading);\n                      tmp = \"\";\n                      hpattern = \"\";\n\n                      for (hc = 0; hc < tokens[hi].surface_form.length; hc++) {\n                        if ((0, _util.isKanji)(tokens[hi].surface_form[hc])) {\n                          hpattern += \"(.*)\";\n                        } else {\n                          hpattern += (0, _util.isKatakana)(tokens[hi].surface_form[hc]) ? (0, _util.toRawHiragana)(tokens[hi].surface_form[hc]) : tokens[hi].surface_form[hc];\n                        }\n                      }\n\n                      hreg = new RegExp(hpattern);\n                      hmatches = hreg.exec(tokens[hi].reading);\n\n                      if (hmatches) {\n                        pickKJ = 0;\n\n                        for (hc1 = 0; hc1 < tokens[hi].surface_form.length; hc1++) {\n                          if ((0, _util.isKanji)(tokens[hi].surface_form[hc1])) {\n                            tmp += hmatches[pickKJ + 1];\n                            pickKJ++;\n                          } else {\n                            tmp += tokens[hi].surface_form[hc1];\n                          }\n                        }\n\n                        tokens[hi].reading = tmp;\n                      }\n                    }\n                  } else {\n                    tokens[hi].reading = tokens[hi].surface_form;\n                  }\n                }\n\n                if (!(options.mode === \"normal\")) {\n                  _context2.next = 32;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", tokens.map(function (token) {\n                  return token.reading;\n                }).join(\"\"));\n\n              case 32:\n                return _context2.abrupt(\"return\", tokens.map(function (token) {\n                  return token.reading;\n                }).join(\" \"));\n\n              case 33:\n                throw new Error(\"Unknown option.to param\");\n\n              case 34:\n                _context2.next = 73;\n                break;\n\n              case 36:\n                if (!(options.mode === \"okurigana\" || options.mode === \"furigana\")) {\n                  _context2.next = 73;\n                  break;\n                }\n\n                notations = []; // [basic, basic_type[1=kanji,2=kana,3=others], notation, pronunciation]\n\n                i = 0;\n\n              case 39:\n                if (!(i < tokens.length)) {\n                  _context2.next = 62;\n                  break;\n                }\n\n                strType = (0, _util.getStrType)(tokens[i].surface_form);\n                _context2.t1 = strType;\n                _context2.next = _context2.t1 === 0 ? 44 : _context2.t1 === 1 ? 46 : _context2.t1 === 2 ? 54 : _context2.t1 === 3 ? 56 : 58;\n                break;\n\n              case 44:\n                notations.push([tokens[i].surface_form, 1, (0, _util.toRawHiragana)(tokens[i].reading), tokens[i].pronunciation || tokens[i].reading]);\n                return _context2.abrupt(\"break\", 59);\n\n              case 46:\n                pattern = \"\";\n                isLastTokenKanji = false;\n                subs = []; // recognize kanjis and group them\n\n                for (c = 0; c < tokens[i].surface_form.length; c++) {\n                  if ((0, _util.isKanji)(tokens[i].surface_form[c])) {\n                    if (!isLastTokenKanji) {\n                      // ignore successive kanji tokens (#10)\n                      isLastTokenKanji = true;\n                      pattern += \"(.+)\";\n                      subs.push(tokens[i].surface_form[c]);\n                    } else {\n                      subs[subs.length - 1] += tokens[i].surface_form[c];\n                    }\n                  } else {\n                    isLastTokenKanji = false;\n                    subs.push(tokens[i].surface_form[c]);\n                    pattern += (0, _util.isKatakana)(tokens[i].surface_form[c]) ? (0, _util.toRawHiragana)(tokens[i].surface_form[c]) : tokens[i].surface_form[c];\n                  }\n                }\n\n                reg = new RegExp(\"^\".concat(pattern, \"$\"));\n                matches = reg.exec((0, _util.toRawHiragana)(tokens[i].reading));\n\n                if (matches) {\n                  pickKanji = 1;\n\n                  for (c1 = 0; c1 < subs.length; c1++) {\n                    if ((0, _util.isKanji)(subs[c1][0])) {\n                      notations.push([subs[c1], 1, matches[pickKanji], (0, _util.toRawKatakana)(matches[pickKanji])]);\n                      pickKanji += 1;\n                    } else {\n                      notations.push([subs[c1], 2, (0, _util.toRawHiragana)(subs[c1]), (0, _util.toRawKatakana)(subs[c1])]);\n                    }\n                  }\n                } else {\n                  notations.push([tokens[i].surface_form, 1, (0, _util.toRawHiragana)(tokens[i].reading), tokens[i].pronunciation || tokens[i].reading]);\n                }\n\n                return _context2.abrupt(\"break\", 59);\n\n              case 54:\n                for (c2 = 0; c2 < tokens[i].surface_form.length; c2++) {\n                  notations.push([tokens[i].surface_form[c2], 2, (0, _util.toRawHiragana)(tokens[i].reading[c2]), tokens[i].pronunciation && tokens[i].pronunciation[c2] || tokens[i].reading[c2]]);\n                }\n\n                return _context2.abrupt(\"break\", 59);\n\n              case 56:\n                for (c3 = 0; c3 < tokens[i].surface_form.length; c3++) {\n                  notations.push([tokens[i].surface_form[c3], 3, tokens[i].surface_form[c3], tokens[i].surface_form[c3]]);\n                }\n\n                return _context2.abrupt(\"break\", 59);\n\n              case 58:\n                throw new Error(\"Unknown strType\");\n\n              case 59:\n                i++;\n                _context2.next = 39;\n                break;\n\n              case 62:\n                result = \"\";\n                _context2.t2 = options.to;\n                _context2.next = _context2.t2 === \"katakana\" ? 66 : _context2.t2 === \"romaji\" ? 68 : _context2.t2 === \"hiragana\" ? 70 : 72;\n                break;\n\n              case 66:\n                if (options.mode === \"okurigana\") {\n                  for (n0 = 0; n0 < notations.length; n0++) {\n                    if (notations[n0][1] !== 1) {\n                      result += notations[n0][0];\n                    } else {\n                      result += notations[n0][0] + options.delimiter_start + (0, _util.toRawKatakana)(notations[n0][2]) + options.delimiter_end;\n                    }\n                  }\n                } else {\n                  // furigana\n                  for (n1 = 0; n1 < notations.length; n1++) {\n                    if (notations[n1][1] !== 1) {\n                      result += notations[n1][0];\n                    } else {\n                      result += \"<ruby>\".concat(notations[n1][0], \"<rp>\").concat(options.delimiter_start, \"</rp><rt>\").concat((0, _util.toRawKatakana)(notations[n1][2]), \"</rt><rp>\").concat(options.delimiter_end, \"</rp></ruby>\");\n                    }\n                  }\n                }\n\n                return _context2.abrupt(\"return\", result);\n\n              case 68:\n                if (options.mode === \"okurigana\") {\n                  for (n2 = 0; n2 < notations.length; n2++) {\n                    if (notations[n2][1] !== 1) {\n                      result += notations[n2][0];\n                    } else {\n                      result += notations[n2][0] + options.delimiter_start + (0, _util.toRawRomaji)(notations[n2][3], options.romajiSystem) + options.delimiter_end;\n                    }\n                  }\n                } else {\n                  // furigana\n                  result += \"<ruby>\";\n\n                  for (n3 = 0; n3 < notations.length; n3++) {\n                    result += \"\".concat(notations[n3][0], \"<rp>\").concat(options.delimiter_start, \"</rp><rt>\").concat((0, _util.toRawRomaji)(notations[n3][3], options.romajiSystem), \"</rt><rp>\").concat(options.delimiter_end, \"</rp>\");\n                  }\n\n                  result += \"</ruby>\";\n                }\n\n                return _context2.abrupt(\"return\", result);\n\n              case 70:\n                if (options.mode === \"okurigana\") {\n                  for (n4 = 0; n4 < notations.length; n4++) {\n                    if (notations[n4][1] !== 1) {\n                      result += notations[n4][0];\n                    } else {\n                      result += notations[n4][0] + options.delimiter_start + notations[n4][2] + options.delimiter_end;\n                    }\n                  }\n                } else {\n                  // furigana\n                  for (n5 = 0; n5 < notations.length; n5++) {\n                    if (notations[n5][1] !== 1) {\n                      result += notations[n5][0];\n                    } else {\n                      result += \"<ruby>\".concat(notations[n5][0], \"<rp>\").concat(options.delimiter_start, \"</rp><rt>\").concat(notations[n5][2], \"</rt><rp>\").concat(options.delimiter_end, \"</rp></ruby>\");\n                    }\n                  }\n                }\n\n                return _context2.abrupt(\"return\", result);\n\n              case 72:\n                throw new Error(\"Invalid Target Syllabary.\");\n\n              case 73:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function convert(_x2, _x3) {\n        return _convert.apply(this, arguments);\n      }\n\n      return convert;\n    }()\n  }]);\n\n  return Kuroshiro;\n}();\n\nvar Util = {\n  isHiragana: _util.isHiragana,\n  isKatakana: _util.isKatakana,\n  isKana: _util.isKana,\n  isKanji: _util.isKanji,\n  isJapanese: _util.isJapanese,\n  hasHiragana: _util.hasHiragana,\n  hasKatakana: _util.hasKatakana,\n  hasKana: _util.hasKana,\n  hasKanji: _util.hasKanji,\n  hasJapanese: _util.hasJapanese,\n  kanaToHiragna: _util.kanaToHiragna,\n  kanaToKatakana: _util.kanaToKatakana,\n  kanaToRomaji: _util.kanaToRomaji\n};\nKuroshiro.Util = Util;\nvar _default = Kuroshiro;\nexports.default = _default;\n\n},{\"./util\":5,\"@babel/runtime/regenerator\":1}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _core = _interopRequireDefault(require(\"./core\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar _default = _core.default;\nexports.default = _default;\n\n},{\"./core\":3}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.kanaToRomaji = exports.kanaToKatakana = exports.kanaToHiragna = exports.toRawRomaji = exports.toRawKatakana = exports.toRawHiragana = exports.hasJapanese = exports.hasKanji = exports.hasKana = exports.hasKatakana = exports.hasHiragana = exports.isJapanese = exports.isKanji = exports.isKana = exports.isKatakana = exports.isHiragana = exports.patchTokens = exports.getStrType = exports.ROMANIZATION_SYSTEM = void 0;\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nvar KATAKANA_HIRAGANA_SHIFT = \"\\u3041\".charCodeAt(0) - \"\\u30A1\".charCodeAt(0);\nvar HIRAGANA_KATAKANA_SHIFT = \"\\u30A1\".charCodeAt(0) - \"\\u3041\".charCodeAt(0);\nvar ROMANIZATION_SYSTEM = {\n  NIPPON: \"nippon\",\n  PASSPORT: \"passport\",\n  HEPBURN: \"hepburn\"\n};\n/**\n * Check if given char is a hiragana\n *\n * @param {string} ch Given char\n * @return {boolean} if given char is a hiragana\n */\n\nexports.ROMANIZATION_SYSTEM = ROMANIZATION_SYSTEM;\n\nvar isHiragana = function isHiragana(ch) {\n  ch = ch[0];\n  return ch >= \"\\u3040\" && ch <= \"\\u309F\";\n};\n/**\n * Check if given char is a katakana\n *\n * @param {string} ch Given char\n * @return {boolean} if given char is a katakana\n */\n\n\nexports.isHiragana = isHiragana;\n\nvar isKatakana = function isKatakana(ch) {\n  ch = ch[0];\n  return ch >= \"\\u30A0\" && ch <= \"\\u30FF\";\n};\n/**\n * Check if given char is a kana\n *\n * @param {string} ch Given char\n * @return {boolean} if given char is a kana\n */\n\n\nexports.isKatakana = isKatakana;\n\nvar isKana = function isKana(ch) {\n  return isHiragana(ch) || isKatakana(ch);\n};\n/**\n * Check if given char is a kanji\n *\n * @param {string} ch Given char\n * @return {boolean} if given char is a kanji\n */\n\n\nexports.isKana = isKana;\n\nvar isKanji = function isKanji(ch) {\n  ch = ch[0];\n  return ch >= \"\\u4E00\" && ch <= \"\\u9FCF\" || ch >= \"\\uF900\" && ch <= \"\\uFAFF\" || ch >= \"\\u3400\" && ch <= \"\\u4DBF\";\n};\n/**\n * Check if given char is a Japanese\n *\n * @param {string} ch Given char\n * @return {boolean} if given char is a Japanese\n */\n\n\nexports.isKanji = isKanji;\n\nvar isJapanese = function isJapanese(ch) {\n  return isKana(ch) || isKanji(ch);\n};\n/**\n * Check if given string has hiragana\n *\n * @param {string} str Given string\n * @return {boolean} if given string has hiragana\n */\n\n\nexports.isJapanese = isJapanese;\n\nvar hasHiragana = function hasHiragana(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (isHiragana(str[i])) return true;\n  }\n\n  return false;\n};\n/**\n * Check if given string has katakana\n *\n * @param {string} str Given string\n * @return {boolean} if given string has katakana\n */\n\n\nexports.hasHiragana = hasHiragana;\n\nvar hasKatakana = function hasKatakana(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (isKatakana(str[i])) return true;\n  }\n\n  return false;\n};\n/**\n * Check if given string has kana\n *\n * @param {string} str Given string\n * @return {boolean} if given string has kana\n */\n\n\nexports.hasKatakana = hasKatakana;\n\nvar hasKana = function hasKana(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (isKana(str[i])) return true;\n  }\n\n  return false;\n};\n/**\n * Check if given string has kanji\n *\n * @param {string} str Given string\n * @return {boolean} if given string has kanji\n */\n\n\nexports.hasKana = hasKana;\n\nvar hasKanji = function hasKanji(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (isKanji(str[i])) return true;\n  }\n\n  return false;\n};\n/**\n * Check if given string has Japanese\n *\n * @param {string} str Given string\n * @return {boolean} if given string has Japanese\n */\n\n\nexports.hasKanji = hasKanji;\n\nvar hasJapanese = function hasJapanese(str) {\n  for (var i = 0; i < str.length; i++) {\n    if (isJapanese(str[i])) return true;\n  }\n\n  return false;\n};\n/**\n * Convert kana to hiragana\n *\n * @param {string} str Given string\n * @return {string} Hiragana string\n */\n\n\nexports.hasJapanese = hasJapanese;\n\nvar toRawHiragana = function toRawHiragana(str) {\n  return _toConsumableArray(str).map(function (ch) {\n    if (ch > \"\\u30A0\" && ch < \"\\u30F7\") {\n      return String.fromCharCode(ch.charCodeAt(0) + KATAKANA_HIRAGANA_SHIFT);\n    }\n\n    return ch;\n  }).join(\"\");\n};\n/**\n * Convert kana to katakana\n *\n * @param {string} str Given string\n * @return {string} Katakana string\n */\n\n\nexports.toRawHiragana = toRawHiragana;\n\nvar toRawKatakana = function toRawKatakana(str) {\n  return _toConsumableArray(str).map(function (ch) {\n    if (ch > \"\\u3040\" && ch < \"\\u3097\") {\n      return String.fromCharCode(ch.charCodeAt(0) + HIRAGANA_KATAKANA_SHIFT);\n    }\n\n    return ch;\n  }).join(\"\");\n};\n/**\n * Convert kana to romaji\n *\n * @param {string} str Given string\n * @param {string} system To which romanization system the given string is converted\n * @return {string} Romaji string\n */\n\n\nexports.toRawKatakana = toRawKatakana;\n\nvar toRawRomaji = function toRawRomaji(str, system) {\n  system = system || ROMANIZATION_SYSTEM.HEPBURN;\n  var romajiSystem = {\n    nippon: {\n      // 数字と記号\n      \"１\": \"1\",\n      \"２\": \"2\",\n      \"３\": \"3\",\n      \"４\": \"4\",\n      \"５\": \"5\",\n      \"６\": \"6\",\n      \"７\": \"7\",\n      \"８\": \"8\",\n      \"９\": \"9\",\n      \"０\": \"0\",\n      \"！\": \"!\",\n      \"“\": \"\\\"\",\n      \"”\": \"\\\"\",\n      \"＃\": \"#\",\n      \"＄\": \"$\",\n      \"％\": \"%\",\n      \"＆\": \"&\",\n      \"’\": \"'\",\n      \"（\": \"(\",\n      \"）\": \")\",\n      \"＝\": \"=\",\n      \"～\": \"~\",\n      \"｜\": \"|\",\n      \"＠\": \"@\",\n      \"‘\": \"`\",\n      \"＋\": \"+\",\n      \"＊\": \"*\",\n      \"；\": \";\",\n      \"：\": \":\",\n      \"＜\": \"<\",\n      \"＞\": \">\",\n      \"、\": \",\",\n      \"。\": \".\",\n      \"／\": \"/\",\n      \"？\": \"?\",\n      \"＿\": \"_\",\n      \"・\": \"･\",\n      \"「\": \"\\\"\",\n      \"」\": \"\\\"\",\n      \"｛\": \"{\",\n      \"｝\": \"}\",\n      \"￥\": \"\\\\\",\n      \"＾\": \"^\",\n      // 直音-清音(ア～ノ)\n      あ: \"a\",\n      い: \"i\",\n      う: \"u\",\n      え: \"e\",\n      お: \"o\",\n      ア: \"a\",\n      イ: \"i\",\n      ウ: \"u\",\n      エ: \"e\",\n      オ: \"o\",\n      か: \"ka\",\n      き: \"ki\",\n      く: \"ku\",\n      け: \"ke\",\n      こ: \"ko\",\n      カ: \"ka\",\n      キ: \"ki\",\n      ク: \"ku\",\n      ケ: \"ke\",\n      コ: \"ko\",\n      さ: \"sa\",\n      し: \"si\",\n      す: \"su\",\n      せ: \"se\",\n      そ: \"so\",\n      サ: \"sa\",\n      シ: \"si\",\n      ス: \"su\",\n      セ: \"se\",\n      ソ: \"so\",\n      た: \"ta\",\n      ち: \"ti\",\n      つ: \"tu\",\n      て: \"te\",\n      と: \"to\",\n      タ: \"ta\",\n      チ: \"ti\",\n      ツ: \"tu\",\n      テ: \"te\",\n      ト: \"to\",\n      な: \"na\",\n      に: \"ni\",\n      ぬ: \"nu\",\n      ね: \"ne\",\n      の: \"no\",\n      ナ: \"na\",\n      ニ: \"ni\",\n      ヌ: \"nu\",\n      ネ: \"ne\",\n      ノ: \"no\",\n      // 直音-清音(ハ～ヲ)\n      は: \"ha\",\n      ひ: \"hi\",\n      ふ: \"hu\",\n      へ: \"he\",\n      ほ: \"ho\",\n      ハ: \"ha\",\n      ヒ: \"hi\",\n      フ: \"hu\",\n      ヘ: \"he\",\n      ホ: \"ho\",\n      ま: \"ma\",\n      み: \"mi\",\n      む: \"mu\",\n      め: \"me\",\n      も: \"mo\",\n      マ: \"ma\",\n      ミ: \"mi\",\n      ム: \"mu\",\n      メ: \"me\",\n      モ: \"mo\",\n      や: \"ya\",\n      ゆ: \"yu\",\n      よ: \"yo\",\n      ヤ: \"ya\",\n      ユ: \"yu\",\n      ヨ: \"yo\",\n      ら: \"ra\",\n      り: \"ri\",\n      る: \"ru\",\n      れ: \"re\",\n      ろ: \"ro\",\n      ラ: \"ra\",\n      リ: \"ri\",\n      ル: \"ru\",\n      レ: \"re\",\n      ロ: \"ro\",\n      わ: \"wa\",\n      ゐ: \"wi\",\n      ゑ: \"we\",\n      を: \"wo\",\n      ワ: \"wa\",\n      ヰ: \"wi\",\n      ヱ: \"we\",\n      ヲ: \"wo\",\n      // 直音-濁音(ガ～ボ)、半濁音(パ～ポ)\n      が: \"ga\",\n      ぎ: \"gi\",\n      ぐ: \"gu\",\n      げ: \"ge\",\n      ご: \"go\",\n      ガ: \"ga\",\n      ギ: \"gi\",\n      グ: \"gu\",\n      ゲ: \"ge\",\n      ゴ: \"go\",\n      ざ: \"za\",\n      じ: \"zi\",\n      ず: \"zu\",\n      ぜ: \"ze\",\n      ぞ: \"zo\",\n      ザ: \"za\",\n      ジ: \"zi\",\n      ズ: \"zu\",\n      ゼ: \"ze\",\n      ゾ: \"zo\",\n      だ: \"da\",\n      ぢ: \"di\",\n      づ: \"du\",\n      で: \"de\",\n      ど: \"do\",\n      ダ: \"da\",\n      ヂ: \"di\",\n      ヅ: \"du\",\n      デ: \"de\",\n      ド: \"do\",\n      ば: \"ba\",\n      び: \"bi\",\n      ぶ: \"bu\",\n      べ: \"be\",\n      ぼ: \"bo\",\n      バ: \"ba\",\n      ビ: \"bi\",\n      ブ: \"bu\",\n      ベ: \"be\",\n      ボ: \"bo\",\n      ぱ: \"pa\",\n      ぴ: \"pi\",\n      ぷ: \"pu\",\n      ぺ: \"pe\",\n      ぽ: \"po\",\n      パ: \"pa\",\n      ピ: \"pi\",\n      プ: \"pu\",\n      ペ: \"pe\",\n      ポ: \"po\",\n      // 拗音-清音(キャ～リョ)\n      きゃ: \"kya\",\n      きゅ: \"kyu\",\n      きょ: \"kyo\",\n      しゃ: \"sya\",\n      しゅ: \"syu\",\n      しょ: \"syo\",\n      ちゃ: \"tya\",\n      ちゅ: \"tyu\",\n      ちょ: \"tyo\",\n      にゃ: \"nya\",\n      にゅ: \"nyu\",\n      にょ: \"nyo\",\n      ひゃ: \"hya\",\n      ひゅ: \"hyu\",\n      ひょ: \"hyo\",\n      みゃ: \"mya\",\n      みゅ: \"myu\",\n      みょ: \"myo\",\n      りゃ: \"rya\",\n      りゅ: \"ryu\",\n      りょ: \"ryo\",\n      キャ: \"kya\",\n      キュ: \"kyu\",\n      キョ: \"kyo\",\n      シャ: \"sya\",\n      シュ: \"syu\",\n      ショ: \"syo\",\n      チャ: \"tya\",\n      チュ: \"tyu\",\n      チョ: \"tyo\",\n      ニャ: \"nya\",\n      ニュ: \"nyu\",\n      ニョ: \"nyo\",\n      ヒャ: \"hya\",\n      ヒュ: \"hyu\",\n      ヒョ: \"hyo\",\n      ミャ: \"mya\",\n      ミュ: \"myu\",\n      ミョ: \"myo\",\n      リャ: \"rya\",\n      リュ: \"ryu\",\n      リョ: \"ryo\",\n      // 拗音-濁音(ギャ～ビョ)、半濁音(ピャ～ピョ)、合拗音(クヮ、グヮ)\n      ぎゃ: \"gya\",\n      ぎゅ: \"gyu\",\n      ぎょ: \"gyo\",\n      じゃ: \"zya\",\n      じゅ: \"zyu\",\n      じょ: \"zyo\",\n      ぢゃ: \"dya\",\n      ぢゅ: \"dyu\",\n      ぢょ: \"dyo\",\n      びゃ: \"bya\",\n      びゅ: \"byu\",\n      びょ: \"byo\",\n      ぴゃ: \"pya\",\n      ぴゅ: \"pyu\",\n      ぴょ: \"pyo\",\n      くゎ: \"kwa\",\n      ぐゎ: \"gwa\",\n      ギャ: \"gya\",\n      ギュ: \"gyu\",\n      ギョ: \"gyo\",\n      ジャ: \"zya\",\n      ジュ: \"zyu\",\n      ジョ: \"zyo\",\n      ヂャ: \"dya\",\n      ヂュ: \"dyu\",\n      ヂョ: \"dyo\",\n      ビャ: \"bya\",\n      ビュ: \"byu\",\n      ビョ: \"byo\",\n      ピャ: \"pya\",\n      ピュ: \"pyu\",\n      ピョ: \"pyo\",\n      クヮ: \"kwa\",\n      グヮ: \"gwa\",\n      // 小書きの仮名、符号\n      ぁ: \"a\",\n      ぃ: \"i\",\n      ぅ: \"u\",\n      ぇ: \"e\",\n      ぉ: \"o\",\n      ゃ: \"ya\",\n      ゅ: \"yu\",\n      ょ: \"yo\",\n      ゎ: \"wa\",\n      ァ: \"a\",\n      ィ: \"i\",\n      ゥ: \"u\",\n      ェ: \"e\",\n      ォ: \"o\",\n      ャ: \"ya\",\n      ュ: \"yu\",\n      ョ: \"yo\",\n      ヮ: \"wa\",\n      ヵ: \"ka\",\n      ヶ: \"ke\",\n      ん: \"n\",\n      ン: \"n\",\n      // ー: \"\",\n      \"　\": \" \",\n      // 外来音(イェ～グォ)\n      いぇ: \"ye\",\n      // うぃ: \"\",\n      // うぇ: \"\",\n      // うぉ: \"\",\n      きぇ: \"kye\",\n      // くぁ: \"\",\n      くぃ: \"kwi\",\n      くぇ: \"kwe\",\n      くぉ: \"kwo\",\n      // ぐぁ: \"\",\n      ぐぃ: \"gwi\",\n      ぐぇ: \"gwe\",\n      ぐぉ: \"gwo\",\n      イェ: \"ye\",\n      // ウィ: \"\",\n      // ウェ: \"\",\n      // ウォ: \"\",\n      // ヴ: \"\",\n      // ヴァ: \"\",\n      // ヴィ: \"\",\n      // ヴェ: \"\",\n      // ヴォ: \"\",\n      // ヴュ: \"\",\n      // ヴョ: \"\",\n      キェ: \"kya\",\n      // クァ: \"\",\n      クィ: \"kwi\",\n      クェ: \"kwe\",\n      クォ: \"kwo\",\n      // グァ: \"\",\n      グィ: \"gwi\",\n      グェ: \"gwe\",\n      グォ: \"gwo\",\n      // 外来音(シェ～フョ)\n      しぇ: \"sye\",\n      じぇ: \"zye\",\n      すぃ: \"swi\",\n      ずぃ: \"zwi\",\n      ちぇ: \"tye\",\n      つぁ: \"twa\",\n      つぃ: \"twi\",\n      つぇ: \"twe\",\n      つぉ: \"two\",\n      // てぃ: \"ti\",\n      // てゅ: \"tyu\",\n      // でぃ: \"di\",\n      // でゅ: \"dyu\",\n      // とぅ: \"tu\",\n      // どぅ: \"du\",\n      にぇ: \"nye\",\n      ひぇ: \"hye\",\n      ふぁ: \"hwa\",\n      ふぃ: \"hwi\",\n      ふぇ: \"hwe\",\n      ふぉ: \"hwo\",\n      ふゅ: \"hwyu\",\n      ふょ: \"hwyo\",\n      シェ: \"sye\",\n      ジェ: \"zye\",\n      スィ: \"swi\",\n      ズィ: \"zwi\",\n      チェ: \"tye\",\n      ツァ: \"twa\",\n      ツィ: \"twi\",\n      ツェ: \"twe\",\n      ツォ: \"two\",\n      // ティ: \"ti\",\n      // テュ: \"tyu\",\n      // ディ: \"di\",\n      // デュ: \"dyu\",\n      // トゥ: \"tu\",\n      // ドゥ: \"du\",\n      ニェ: \"nye\",\n      ヒェ: \"hye\",\n      ファ: \"hwa\",\n      フィ: \"hwi\",\n      フェ: \"hwe\",\n      フォ: \"hwo\",\n      フュ: \"hwyu\",\n      フョ: \"hwyo\"\n    },\n    passport: {\n      // 数字と記号\n      \"１\": \"1\",\n      \"２\": \"2\",\n      \"３\": \"3\",\n      \"４\": \"4\",\n      \"５\": \"5\",\n      \"６\": \"6\",\n      \"７\": \"7\",\n      \"８\": \"8\",\n      \"９\": \"9\",\n      \"０\": \"0\",\n      \"！\": \"!\",\n      \"“\": \"\\\"\",\n      \"”\": \"\\\"\",\n      \"＃\": \"#\",\n      \"＄\": \"$\",\n      \"％\": \"%\",\n      \"＆\": \"&\",\n      \"’\": \"'\",\n      \"（\": \"(\",\n      \"）\": \")\",\n      \"＝\": \"=\",\n      \"～\": \"~\",\n      \"｜\": \"|\",\n      \"＠\": \"@\",\n      \"‘\": \"`\",\n      \"＋\": \"+\",\n      \"＊\": \"*\",\n      \"；\": \";\",\n      \"：\": \":\",\n      \"＜\": \"<\",\n      \"＞\": \">\",\n      \"、\": \",\",\n      \"。\": \".\",\n      \"／\": \"/\",\n      \"？\": \"?\",\n      \"＿\": \"_\",\n      \"・\": \"･\",\n      \"「\": \"\\\"\",\n      \"」\": \"\\\"\",\n      \"｛\": \"{\",\n      \"｝\": \"}\",\n      \"￥\": \"\\\\\",\n      \"＾\": \"^\",\n      // 直音-清音(ア～ノ)\n      あ: \"a\",\n      い: \"i\",\n      う: \"u\",\n      え: \"e\",\n      お: \"o\",\n      ア: \"a\",\n      イ: \"i\",\n      ウ: \"u\",\n      エ: \"e\",\n      オ: \"o\",\n      か: \"ka\",\n      き: \"ki\",\n      く: \"ku\",\n      け: \"ke\",\n      こ: \"ko\",\n      カ: \"ka\",\n      キ: \"ki\",\n      ク: \"ku\",\n      ケ: \"ke\",\n      コ: \"ko\",\n      さ: \"sa\",\n      し: \"shi\",\n      す: \"su\",\n      せ: \"se\",\n      そ: \"so\",\n      サ: \"sa\",\n      シ: \"shi\",\n      ス: \"su\",\n      セ: \"se\",\n      ソ: \"so\",\n      た: \"ta\",\n      ち: \"chi\",\n      つ: \"tsu\",\n      て: \"te\",\n      と: \"to\",\n      タ: \"ta\",\n      チ: \"chi\",\n      ツ: \"tsu\",\n      テ: \"te\",\n      ト: \"to\",\n      な: \"na\",\n      に: \"ni\",\n      ぬ: \"nu\",\n      ね: \"ne\",\n      の: \"no\",\n      ナ: \"na\",\n      ニ: \"ni\",\n      ヌ: \"nu\",\n      ネ: \"ne\",\n      ノ: \"no\",\n      // 直音-清音(ハ～ヲ)\n      は: \"ha\",\n      ひ: \"hi\",\n      ふ: \"fu\",\n      へ: \"he\",\n      ほ: \"ho\",\n      ハ: \"ha\",\n      ヒ: \"hi\",\n      フ: \"fu\",\n      ヘ: \"he\",\n      ホ: \"ho\",\n      ま: \"ma\",\n      み: \"mi\",\n      む: \"mu\",\n      め: \"me\",\n      も: \"mo\",\n      マ: \"ma\",\n      ミ: \"mi\",\n      ム: \"mu\",\n      メ: \"me\",\n      モ: \"mo\",\n      や: \"ya\",\n      ゆ: \"yu\",\n      よ: \"yo\",\n      ヤ: \"ya\",\n      ユ: \"yu\",\n      ヨ: \"yo\",\n      ら: \"ra\",\n      り: \"ri\",\n      る: \"ru\",\n      れ: \"re\",\n      ろ: \"ro\",\n      ラ: \"ra\",\n      リ: \"ri\",\n      ル: \"ru\",\n      レ: \"re\",\n      ロ: \"ro\",\n      わ: \"wa\",\n      ゐ: \"i\",\n      ゑ: \"e\",\n      を: \"o\",\n      ワ: \"wa\",\n      ヰ: \"i\",\n      ヱ: \"e\",\n      ヲ: \"o\",\n      // 直音-濁音(ガ～ボ)、半濁音(パ～ポ)\n      が: \"ga\",\n      ぎ: \"gi\",\n      ぐ: \"gu\",\n      げ: \"ge\",\n      ご: \"go\",\n      ガ: \"ga\",\n      ギ: \"gi\",\n      グ: \"gu\",\n      ゲ: \"ge\",\n      ゴ: \"go\",\n      ざ: \"za\",\n      じ: \"ji\",\n      ず: \"zu\",\n      ぜ: \"ze\",\n      ぞ: \"zo\",\n      ザ: \"za\",\n      ジ: \"ji\",\n      ズ: \"zu\",\n      ゼ: \"ze\",\n      ゾ: \"zo\",\n      だ: \"da\",\n      ぢ: \"ji\",\n      づ: \"zu\",\n      で: \"de\",\n      ど: \"do\",\n      ダ: \"da\",\n      ヂ: \"ji\",\n      ヅ: \"zu\",\n      デ: \"de\",\n      ド: \"do\",\n      ば: \"ba\",\n      び: \"bi\",\n      ぶ: \"bu\",\n      べ: \"be\",\n      ぼ: \"bo\",\n      バ: \"ba\",\n      ビ: \"bi\",\n      ブ: \"bu\",\n      ベ: \"be\",\n      ボ: \"bo\",\n      ぱ: \"pa\",\n      ぴ: \"pi\",\n      ぷ: \"pu\",\n      ぺ: \"pe\",\n      ぽ: \"po\",\n      パ: \"pa\",\n      ピ: \"pi\",\n      プ: \"pu\",\n      ペ: \"pe\",\n      ポ: \"po\",\n      // 拗音-清音(キャ～リョ)\n      きゃ: \"kya\",\n      きゅ: \"kyu\",\n      きょ: \"kyo\",\n      しゃ: \"sha\",\n      しゅ: \"shu\",\n      しょ: \"sho\",\n      ちゃ: \"cha\",\n      ちゅ: \"chu\",\n      ちょ: \"cho\",\n      にゃ: \"nya\",\n      にゅ: \"nyu\",\n      にょ: \"nyo\",\n      ひゃ: \"hya\",\n      ひゅ: \"hyu\",\n      ひょ: \"hyo\",\n      みゃ: \"mya\",\n      みゅ: \"myu\",\n      みょ: \"myo\",\n      りゃ: \"rya\",\n      りゅ: \"ryu\",\n      りょ: \"ryo\",\n      キャ: \"kya\",\n      キュ: \"kyu\",\n      キョ: \"kyo\",\n      シャ: \"sha\",\n      シュ: \"shu\",\n      ショ: \"sho\",\n      チャ: \"cha\",\n      チュ: \"chu\",\n      チョ: \"cho\",\n      ニャ: \"nya\",\n      ニュ: \"nyu\",\n      ニョ: \"nyo\",\n      ヒャ: \"hya\",\n      ヒュ: \"hyu\",\n      ヒョ: \"hyo\",\n      ミャ: \"mya\",\n      ミュ: \"myu\",\n      ミョ: \"myo\",\n      リャ: \"rya\",\n      リュ: \"ryu\",\n      リョ: \"ryo\",\n      // 拗音-濁音(ギャ～ビョ)、半濁音(ピャ～ピョ)、合拗音(クヮ、グヮ)\n      ぎゃ: \"gya\",\n      ぎゅ: \"gyu\",\n      ぎょ: \"gyo\",\n      じゃ: \"ja\",\n      じゅ: \"ju\",\n      じょ: \"jo\",\n      ぢゃ: \"ja\",\n      ぢゅ: \"ju\",\n      ぢょ: \"jo\",\n      びゃ: \"bya\",\n      びゅ: \"byu\",\n      びょ: \"byo\",\n      ぴゃ: \"pya\",\n      ぴゅ: \"pyu\",\n      ぴょ: \"pyo\",\n      // くゎ: \"\",\n      // ぐゎ: \"\",\n      ギャ: \"gya\",\n      ギュ: \"gyu\",\n      ギョ: \"gyo\",\n      ジャ: \"ja\",\n      ジュ: \"ju\",\n      ジョ: \"jo\",\n      ヂャ: \"ja\",\n      ヂュ: \"ju\",\n      ヂョ: \"jo\",\n      ビャ: \"bya\",\n      ビュ: \"byu\",\n      ビョ: \"byo\",\n      ピャ: \"pya\",\n      ピュ: \"pyu\",\n      ピョ: \"pyo\",\n      // クヮ: \"\",\n      // グヮ: \"\",\n      // 小書きの仮名、符号\n      ぁ: \"a\",\n      ぃ: \"i\",\n      ぅ: \"u\",\n      ぇ: \"e\",\n      ぉ: \"o\",\n      ゃ: \"ya\",\n      ゅ: \"yu\",\n      ょ: \"yo\",\n      ゎ: \"wa\",\n      ァ: \"a\",\n      ィ: \"i\",\n      ゥ: \"u\",\n      ェ: \"e\",\n      ォ: \"o\",\n      ャ: \"ya\",\n      ュ: \"yu\",\n      ョ: \"yo\",\n      ヮ: \"wa\",\n      ヵ: \"ka\",\n      ヶ: \"ke\",\n      ん: \"n\",\n      ン: \"n\",\n      // ー: \"\",\n      \"　\": \" \",\n      // 外来音(イェ～グォ)\n      // いぇ: \"\",\n      // うぃ: \"\",\n      // うぇ: \"\",\n      // うぉ: \"\",\n      // きぇ: \"\",\n      // くぁ: \"\",\n      // くぃ: \"\",\n      // くぇ: \"\",\n      // くぉ: \"\",\n      // ぐぁ: \"\",\n      // ぐぃ: \"\",\n      // ぐぇ: \"\",\n      // ぐぉ: \"\",\n      // イェ: \"\",\n      // ウィ: \"\",\n      // ウェ: \"\",\n      // ウォ: \"\",\n      ヴ: \"b\" // ヴァ: \"\",\n      // ヴィ: \"\",\n      // ヴェ: \"\",\n      // ヴォ: \"\",\n      // ヴュ: \"\",\n      // ヴョ: \"\",\n      // キェ: \"\",\n      // クァ: \"\",\n      // クィ: \"\",\n      // クェ: \"\",\n      // クォ: \"\",\n      // グァ: \"\",\n      // グィ: \"\",\n      // グェ: \"\",\n      // グォ: \"\",\n      // 外来音(シェ～フョ)\n      // しぇ: \"\",\n      // じぇ: \"\",\n      // すぃ: \"\",\n      // ずぃ: \"\",\n      // ちぇ: \"\",\n      // つぁ: \"\",\n      // つぃ: \"\",\n      // つぇ: \"\",\n      // つぉ: \"\",\n      // てぃ: \"\",\n      // てゅ: \"\",\n      // でぃ: \"\",\n      // でゅ: \"\",\n      // とぅ: \"\",\n      // どぅ: \"\",\n      // にぇ: \"\",\n      // ひぇ: \"\",\n      // ふぁ: \"\",\n      // ふぃ: \"\",\n      // ふぇ: \"\",\n      // ふぉ: \"\",\n      // ふゅ: \"\",\n      // ふょ: \"\",\n      // シェ: \"\",\n      // ジェ: \"\",\n      // スィ: \"\",\n      // ズィ: \"\",\n      // チェ: \"\",\n      // ツァ: \"\",\n      // ツィ: \"\",\n      // ツェ: \"\",\n      // ツォ: \"\",\n      // ティ: \"\",\n      // テュ: \"\",\n      // ディ: \"\",\n      // デュ: \"\",\n      // トゥ: \"\",\n      // ドゥ: \"\",\n      // ニェ: \"\",\n      // ヒェ: \"\",\n      // ファ: \"\",\n      // フィ: \"\",\n      // フェ: \"\",\n      // フォ: \"\",\n      // フュ: \"\",\n      // フョ: \"\"\n\n    },\n    hepburn: {\n      // 数字と記号\n      \"１\": \"1\",\n      \"２\": \"2\",\n      \"３\": \"3\",\n      \"４\": \"4\",\n      \"５\": \"5\",\n      \"６\": \"6\",\n      \"７\": \"7\",\n      \"８\": \"8\",\n      \"９\": \"9\",\n      \"０\": \"0\",\n      \"！\": \"!\",\n      \"“\": \"\\\"\",\n      \"”\": \"\\\"\",\n      \"＃\": \"#\",\n      \"＄\": \"$\",\n      \"％\": \"%\",\n      \"＆\": \"&\",\n      \"’\": \"'\",\n      \"（\": \"(\",\n      \"）\": \")\",\n      \"＝\": \"=\",\n      \"～\": \"~\",\n      \"｜\": \"|\",\n      \"＠\": \"@\",\n      \"‘\": \"`\",\n      \"＋\": \"+\",\n      \"＊\": \"*\",\n      \"；\": \";\",\n      \"：\": \":\",\n      \"＜\": \"<\",\n      \"＞\": \">\",\n      \"、\": \",\",\n      \"。\": \".\",\n      \"／\": \"/\",\n      \"？\": \"?\",\n      \"＿\": \"_\",\n      \"・\": \"･\",\n      \"「\": \"\\\"\",\n      \"」\": \"\\\"\",\n      \"｛\": \"{\",\n      \"｝\": \"}\",\n      \"￥\": \"\\\\\",\n      \"＾\": \"^\",\n      // 直音-清音(ア～ノ)\n      あ: \"a\",\n      い: \"i\",\n      う: \"u\",\n      え: \"e\",\n      お: \"o\",\n      ア: \"a\",\n      イ: \"i\",\n      ウ: \"u\",\n      エ: \"e\",\n      オ: \"o\",\n      か: \"ka\",\n      き: \"ki\",\n      く: \"ku\",\n      け: \"ke\",\n      こ: \"ko\",\n      カ: \"ka\",\n      キ: \"ki\",\n      ク: \"ku\",\n      ケ: \"ke\",\n      コ: \"ko\",\n      さ: \"sa\",\n      し: \"shi\",\n      す: \"su\",\n      せ: \"se\",\n      そ: \"so\",\n      サ: \"sa\",\n      シ: \"shi\",\n      ス: \"su\",\n      セ: \"se\",\n      ソ: \"so\",\n      た: \"ta\",\n      ち: \"chi\",\n      つ: \"tsu\",\n      て: \"te\",\n      と: \"to\",\n      タ: \"ta\",\n      チ: \"chi\",\n      ツ: \"tsu\",\n      テ: \"te\",\n      ト: \"to\",\n      な: \"na\",\n      に: \"ni\",\n      ぬ: \"nu\",\n      ね: \"ne\",\n      の: \"no\",\n      ナ: \"na\",\n      ニ: \"ni\",\n      ヌ: \"nu\",\n      ネ: \"ne\",\n      ノ: \"no\",\n      // 直音-清音(ハ～ヲ)\n      は: \"ha\",\n      ひ: \"hi\",\n      ふ: \"fu\",\n      へ: \"he\",\n      ほ: \"ho\",\n      ハ: \"ha\",\n      ヒ: \"hi\",\n      フ: \"fu\",\n      ヘ: \"he\",\n      ホ: \"ho\",\n      ま: \"ma\",\n      み: \"mi\",\n      む: \"mu\",\n      め: \"me\",\n      も: \"mo\",\n      マ: \"ma\",\n      ミ: \"mi\",\n      ム: \"mu\",\n      メ: \"me\",\n      モ: \"mo\",\n      や: \"ya\",\n      ゆ: \"yu\",\n      よ: \"yo\",\n      ヤ: \"ya\",\n      ユ: \"yu\",\n      ヨ: \"yo\",\n      ら: \"ra\",\n      り: \"ri\",\n      る: \"ru\",\n      れ: \"re\",\n      ろ: \"ro\",\n      ラ: \"ra\",\n      リ: \"ri\",\n      ル: \"ru\",\n      レ: \"re\",\n      ロ: \"ro\",\n      わ: \"wa\",\n      ゐ: \"i\",\n      ゑ: \"e\",\n      を: \"o\",\n      ワ: \"wa\",\n      ヰ: \"i\",\n      ヱ: \"e\",\n      ヲ: \"o\",\n      // 直音-濁音(ガ～ボ)、半濁音(パ～ポ)\n      が: \"ga\",\n      ぎ: \"gi\",\n      ぐ: \"gu\",\n      げ: \"ge\",\n      ご: \"go\",\n      ガ: \"ga\",\n      ギ: \"gi\",\n      グ: \"gu\",\n      ゲ: \"ge\",\n      ゴ: \"go\",\n      ざ: \"za\",\n      じ: \"ji\",\n      ず: \"zu\",\n      ぜ: \"ze\",\n      ぞ: \"zo\",\n      ザ: \"za\",\n      ジ: \"ji\",\n      ズ: \"zu\",\n      ゼ: \"ze\",\n      ゾ: \"zo\",\n      だ: \"da\",\n      ぢ: \"ji\",\n      づ: \"zu\",\n      で: \"de\",\n      ど: \"do\",\n      ダ: \"da\",\n      ヂ: \"ji\",\n      ヅ: \"zu\",\n      デ: \"de\",\n      ド: \"do\",\n      ば: \"ba\",\n      び: \"bi\",\n      ぶ: \"bu\",\n      べ: \"be\",\n      ぼ: \"bo\",\n      バ: \"ba\",\n      ビ: \"bi\",\n      ブ: \"bu\",\n      ベ: \"be\",\n      ボ: \"bo\",\n      ぱ: \"pa\",\n      ぴ: \"pi\",\n      ぷ: \"pu\",\n      ぺ: \"pe\",\n      ぽ: \"po\",\n      パ: \"pa\",\n      ピ: \"pi\",\n      プ: \"pu\",\n      ペ: \"pe\",\n      ポ: \"po\",\n      // 拗音-清音(キャ～リョ)\n      きゃ: \"kya\",\n      きゅ: \"kyu\",\n      きょ: \"kyo\",\n      しゃ: \"sha\",\n      しゅ: \"shu\",\n      しょ: \"sho\",\n      ちゃ: \"cha\",\n      ちゅ: \"chu\",\n      ちょ: \"cho\",\n      にゃ: \"nya\",\n      にゅ: \"nyu\",\n      にょ: \"nyo\",\n      ひゃ: \"hya\",\n      ひゅ: \"hyu\",\n      ひょ: \"hyo\",\n      みゃ: \"mya\",\n      みゅ: \"myu\",\n      みょ: \"myo\",\n      りゃ: \"rya\",\n      りゅ: \"ryu\",\n      りょ: \"ryo\",\n      キャ: \"kya\",\n      キュ: \"kyu\",\n      キョ: \"kyo\",\n      シャ: \"sha\",\n      シュ: \"shu\",\n      ショ: \"sho\",\n      チャ: \"cha\",\n      チュ: \"chu\",\n      チョ: \"cho\",\n      ニャ: \"nya\",\n      ニュ: \"nyu\",\n      ニョ: \"nyo\",\n      ヒャ: \"hya\",\n      ヒュ: \"hyu\",\n      ヒョ: \"hyo\",\n      ミャ: \"mya\",\n      ミュ: \"myu\",\n      ミョ: \"myo\",\n      リャ: \"rya\",\n      リュ: \"ryu\",\n      リョ: \"ryo\",\n      // 拗音-濁音(ギャ～ビョ)、半濁音(ピャ～ピョ)、合拗音(クヮ、グヮ)\n      ぎゃ: \"gya\",\n      ぎゅ: \"gyu\",\n      ぎょ: \"gyo\",\n      じゃ: \"ja\",\n      じゅ: \"ju\",\n      じょ: \"jo\",\n      ぢゃ: \"ja\",\n      ぢゅ: \"ju\",\n      ぢょ: \"jo\",\n      びゃ: \"bya\",\n      びゅ: \"byu\",\n      びょ: \"byo\",\n      ぴゃ: \"pya\",\n      ぴゅ: \"pyu\",\n      ぴょ: \"pyo\",\n      // くゎ: \"\",\n      // ぐゎ: \"\",\n      ギャ: \"gya\",\n      ギュ: \"gyu\",\n      ギョ: \"gyo\",\n      ジャ: \"ja\",\n      ジュ: \"ju\",\n      ジョ: \"jo\",\n      ヂャ: \"ja\",\n      ヂュ: \"ju\",\n      ヂョ: \"jo\",\n      ビャ: \"bya\",\n      ビュ: \"byu\",\n      ビョ: \"byo\",\n      ピャ: \"pya\",\n      ピュ: \"pyu\",\n      ピョ: \"pyo\",\n      // クヮ: \"\",\n      // グヮ: \"\",\n      // 小書きの仮名、符号\n      ぁ: \"a\",\n      ぃ: \"i\",\n      ぅ: \"u\",\n      ぇ: \"e\",\n      ぉ: \"o\",\n      ゃ: \"ya\",\n      ゅ: \"yu\",\n      ょ: \"yo\",\n      ゎ: \"wa\",\n      ァ: \"a\",\n      ィ: \"i\",\n      ゥ: \"u\",\n      ェ: \"e\",\n      ォ: \"o\",\n      ャ: \"ya\",\n      ュ: \"yu\",\n      ョ: \"yo\",\n      ヮ: \"wa\",\n      ヵ: \"ka\",\n      ヶ: \"ke\",\n      ん: \"n\",\n      ン: \"n\",\n      // ー: \"\",\n      \"　\": \" \",\n      // 外来音(イェ～グォ)\n      いぇ: \"ye\",\n      うぃ: \"wi\",\n      うぇ: \"we\",\n      うぉ: \"wo\",\n      きぇ: \"kye\",\n      くぁ: \"kwa\",\n      くぃ: \"kwi\",\n      くぇ: \"kwe\",\n      くぉ: \"kwo\",\n      ぐぁ: \"gwa\",\n      ぐぃ: \"gwi\",\n      ぐぇ: \"gwe\",\n      ぐぉ: \"gwo\",\n      イェ: \"ye\",\n      ウィ: \"wi\",\n      ウェ: \"we\",\n      ウォ: \"wo\",\n      ヴ: \"vu\",\n      ヴァ: \"va\",\n      ヴィ: \"vi\",\n      ヴェ: \"ve\",\n      ヴォ: \"vo\",\n      ヴュ: \"vyu\",\n      ヴョ: \"vyo\",\n      キェ: \"kya\",\n      クァ: \"kwa\",\n      クィ: \"kwi\",\n      クェ: \"kwe\",\n      クォ: \"kwo\",\n      グァ: \"gwa\",\n      グィ: \"gwi\",\n      グェ: \"gwe\",\n      グォ: \"gwo\",\n      // 外来音(シェ～フョ)\n      しぇ: \"she\",\n      じぇ: \"je\",\n      // すぃ: \"\",\n      // ずぃ: \"\",\n      ちぇ: \"che\",\n      つぁ: \"tsa\",\n      つぃ: \"tsi\",\n      つぇ: \"tse\",\n      つぉ: \"tso\",\n      てぃ: \"ti\",\n      てゅ: \"tyu\",\n      でぃ: \"di\",\n      でゅ: \"dyu\",\n      とぅ: \"tu\",\n      どぅ: \"du\",\n      にぇ: \"nye\",\n      ひぇ: \"hye\",\n      ふぁ: \"fa\",\n      ふぃ: \"fi\",\n      ふぇ: \"fe\",\n      ふぉ: \"fo\",\n      ふゅ: \"fyu\",\n      ふょ: \"fyo\",\n      シェ: \"she\",\n      ジェ: \"je\",\n      // スィ: \"\",\n      // ズィ: \"\",\n      チェ: \"che\",\n      ツァ: \"tsa\",\n      ツィ: \"tsi\",\n      ツェ: \"tse\",\n      ツォ: \"tso\",\n      ティ: \"ti\",\n      テュ: \"tyu\",\n      ディ: \"di\",\n      デュ: \"dyu\",\n      トゥ: \"tu\",\n      ドゥ: \"du\",\n      ニェ: \"nye\",\n      ヒェ: \"hye\",\n      ファ: \"fa\",\n      フィ: \"fi\",\n      フェ: \"fe\",\n      フォ: \"fo\",\n      フュ: \"fyu\",\n      フョ: \"fyo\"\n    }\n  };\n  var reg_tsu = /(っ|ッ)([bcdfghijklmnopqrstuvwyz])/gm;\n  var reg_xtsu = /っ|ッ/gm;\n  var pnt = 0;\n  var ch;\n  var r;\n  var result = \"\"; // [PASSPORT] 長音省略 「―」の場合\n\n  if (system === ROMANIZATION_SYSTEM.PASSPORT) {\n    str = str.replace(/ー/gm, \"\");\n  } // [NIPPON|HEPBURN] 撥音の特殊表記 a、i、u、e、o、y\n\n\n  if (system === ROMANIZATION_SYSTEM.NIPPON || system === ROMANIZATION_SYSTEM.HEPBURN) {\n    var reg_hatu = new RegExp(/(ん|ン)(?=あ|い|う|え|お|ア|イ|ウ|エ|オ|ぁ|ぃ|ぅ|ぇ|ぉ|ァ|ィ|ゥ|ェ|ォ|や|ゆ|よ|ヤ|ユ|ヨ|ゃ|ゅ|ょ|ャ|ュ|ョ)/g);\n    var match;\n    var indices = [];\n\n    while ((match = reg_hatu.exec(str)) !== null) {\n      indices.push(match.index + 1);\n    }\n\n    if (indices.length !== 0) {\n      var mStr = \"\";\n\n      for (var i = 0; i < indices.length; i++) {\n        if (i === 0) {\n          mStr += \"\".concat(str.slice(0, indices[i]), \"'\");\n        } else {\n          mStr += \"\".concat(str.slice(indices[i - 1], indices[i]), \"'\");\n        }\n      }\n\n      mStr += str.slice(indices[indices.length - 1]);\n      str = mStr;\n    }\n  } // [ALL] kana to roman chars\n\n\n  var max = str.length;\n\n  while (pnt <= max) {\n    if (r = romajiSystem[system][str.substring(pnt, pnt + 2)]) {\n      result += r;\n      pnt += 2;\n    } else {\n      result += (r = romajiSystem[system][ch = str.substring(pnt, pnt + 1)]) ? r : ch;\n      pnt += 1;\n    }\n  }\n\n  result = result.replace(reg_tsu, \"$2$2\"); // [PASSPORT|HEPBURN] 子音を重ねて特殊表記\n\n  if (system === ROMANIZATION_SYSTEM.PASSPORT || system === ROMANIZATION_SYSTEM.HEPBURN) {\n    result = result.replace(/cc/gm, \"tc\");\n  }\n\n  result = result.replace(reg_xtsu, \"tsu\"); // [PASSPORT|HEPBURN] 撥音の特殊表記 b、m、p\n\n  if (system === ROMANIZATION_SYSTEM.PASSPORT || system === ROMANIZATION_SYSTEM.HEPBURN) {\n    result = result.replace(/nm/gm, \"mm\");\n    result = result.replace(/nb/gm, \"mb\");\n    result = result.replace(/np/gm, \"mp\");\n  } // [NIPPON] 長音変換\n\n\n  if (system === ROMANIZATION_SYSTEM.NIPPON) {\n    result = result.replace(/aー/gm, \"â\");\n    result = result.replace(/iー/gm, \"î\");\n    result = result.replace(/uー/gm, \"û\");\n    result = result.replace(/eー/gm, \"ê\");\n    result = result.replace(/oー/gm, \"ô\");\n  } // [HEPBURN] 長音変換\n\n\n  if (system === ROMANIZATION_SYSTEM.HEPBURN) {\n    result = result.replace(/aー/gm, \"ā\");\n    result = result.replace(/iー/gm, \"ī\");\n    result = result.replace(/uー/gm, \"ū\");\n    result = result.replace(/eー/gm, \"ē\");\n    result = result.replace(/oー/gm, \"ō\");\n  }\n\n  return result;\n};\n/**\n * Get the type of given string\n *\n * @param {string} str Given string\n * @return {number} Type number. 0 for pure kanji, 1 for kanji-kana-mixed, 2 for pure kana, 3 for others\n */\n\n\nexports.toRawRomaji = toRawRomaji;\n\nvar getStrType = function getStrType(str) {\n  var hasKJ = false;\n  var hasHK = false;\n\n  for (var i = 0; i < str.length; i++) {\n    if (isKanji(str[i])) {\n      hasKJ = true;\n    } else if (isHiragana(str[i]) || isKatakana(str[i])) {\n      hasHK = true;\n    }\n  }\n\n  if (hasKJ && hasHK) return 1;\n  if (hasKJ) return 0;\n  if (hasHK) return 2;\n  return 3;\n};\n/**\n * Patch tokens for conversion\n * @param {Object} tokens Given tokens\n * @return {Object} Patched tokens\n */\n\n\nexports.getStrType = getStrType;\n\nvar patchTokens = function patchTokens(tokens) {\n  // patch for token structure\n  for (var cr = 0; cr < tokens.length; cr++) {\n    if (hasJapanese(tokens[cr].surface_form)) {\n      if (!tokens[cr].reading) {\n        if (tokens[cr].surface_form.split(\"\").every(isKana)) {\n          tokens[cr].reading = toRawKatakana(tokens[cr].surface_form);\n        } else {\n          tokens[cr].reading = tokens[cr].surface_form;\n        }\n      } else if (hasHiragana(tokens[cr].reading)) {\n        tokens[cr].reading = toRawKatakana(tokens[cr].reading);\n      }\n    } else {\n      tokens[cr].reading = tokens[cr].surface_form;\n    }\n  } // patch for 助動詞\"う\" after 動詞\n\n\n  for (var i = 0; i < tokens.length; i++) {\n    if (tokens[i].pos && tokens[i].pos === \"助動詞\" && (tokens[i].surface_form === \"う\" || tokens[i].surface_form === \"ウ\")) {\n      if (i - 1 >= 0 && tokens[i - 1].pos && tokens[i - 1].pos === \"動詞\") {\n        tokens[i - 1].surface_form += \"う\";\n\n        if (tokens[i - 1].pronunciation) {\n          tokens[i - 1].pronunciation += \"ー\";\n        } else {\n          tokens[i - 1].pronunciation = \"\".concat(tokens[i - 1].reading, \"\\u30FC\");\n        }\n\n        tokens[i - 1].reading += \"ウ\";\n        tokens.splice(i, 1);\n        i--;\n      }\n    }\n  } // patch for \"っ\" at the tail of 動詞、形容詞\n\n\n  for (var j = 0; j < tokens.length; j++) {\n    if (tokens[j].pos && (tokens[j].pos === \"動詞\" || tokens[j].pos === \"形容詞\") && tokens[j].surface_form.length > 1 && (tokens[j].surface_form[tokens[j].surface_form.length - 1] === \"っ\" || tokens[j].surface_form[tokens[j].surface_form.length - 1] === \"ッ\")) {\n      if (j + 1 < tokens.length) {\n        tokens[j].surface_form += tokens[j + 1].surface_form;\n\n        if (tokens[j].pronunciation) {\n          tokens[j].pronunciation += tokens[j + 1].pronunciation;\n        } else {\n          tokens[j].pronunciation = \"\".concat(tokens[j].reading).concat(tokens[j + 1].reading);\n        }\n\n        tokens[j].reading += tokens[j + 1].reading;\n        tokens.splice(j + 1, 1);\n        j--;\n      }\n    }\n  }\n\n  return tokens;\n};\n/**\n * Convert kana to hiragana\n *\n * @param {string} str Given string\n * @return {string} Hiragana string\n */\n\n\nexports.patchTokens = patchTokens;\n\nvar kanaToHiragna = function kanaToHiragna(str) {\n  return toRawHiragana(str);\n};\n/**\n * Convert kana to katakana\n *\n * @param {string} str Given string\n * @return {string} Katakana string\n */\n\n\nexports.kanaToHiragna = kanaToHiragna;\n\nvar kanaToKatakana = function kanaToKatakana(str) {\n  return toRawKatakana(str);\n};\n/**\n * Convert kana to romaji\n *\n * @param {string} str Given string\n * @param {string} system To which romanization system the given string is converted. [\"nippon\"|\"passport\"|\"hepburn\"]\n * @return {string} Romaji string\n */\n\n\nexports.kanaToKatakana = kanaToKatakana;\n\nvar kanaToRomaji = function kanaToRomaji(str, system) {\n  return toRawRomaji(str, system);\n};\n\nexports.kanaToRomaji = kanaToRomaji;\n\n},{}]},{},[4])(4)\n});\n","/*\n * Copyright 2023-2023 Steve Xiao (stevexmh@qq.com) and contributors.\n *\n * 本源代码文件是属于 AMLL TTML Tool 项目的一部分。\n * This source code file is a part of AMLL TTML Tool project.\n * 本项目的源代码的使用受到 GNU GENERAL PUBLIC LICENSE version 3 许可证的约束，具体可以参阅以下链接。\n * Use of this source code is governed by the GNU GPLv3 license that can be found through the following link.\n *\n * https://github.com/Steve-xmh/amll-ttml-tool/blob/main/LICENSE\n */\n\nimport kuromoji from \"kuromoji\";\nimport Kuroshiro from \"kuroshiro/dist/kuroshiro\";\n\nconsole.log(kuromoji);\n\nexport interface ParseResult {\n\tsurface_form: string;\n\tpos: string;\n\tpos_detail_1: string;\n\tpos_detail_2: string;\n\tpos_detail_3: string;\n\tconjugated_type: string;\n\tconjugated_form: string;\n\tbasic_form: string;\n\treading: string;\n\tpronunciation: string;\n\tverbose: {\n\t\tword_id: number;\n\t\tword_type: string;\n\t\tword_position: number;\n\t};\n}\n\n/**\n * Kuromoji based morphological analyzer for kuroshiro\n */\nexport class Analyzer {\n\tprivate _analyzer: any;\n\t/**\n\t * Constructor\n\t * @param {Object} [options] JSON object which have key-value pairs settings\n\t * @param {string} [options.dictPath] Path of the dictionary files\n\t */\n\tconstructor(private _dictPath: string) {\n\t\tthis._analyzer = null;\n\t}\n\n\t/**\n\t * Initialize the analyzer\n\t * @returns {Promise} Promise object represents the result of initialization\n\t */\n\tinit(): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst self = this;\n\t\t\tif (this._analyzer == null) {\n\t\t\t\tkuromoji\n\t\t\t\t\t.builder({ dicPath: this._dictPath })\n\t\t\t\t\t.build((err, newAnalyzer) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._analyzer = newAnalyzer;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treject(new Error(\"This analyzer has already been initialized.\"));\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Parse the given string\n\t * @param str input string\n\t * @returns Promise object represents the result of parsing\n\t * @example The result of parsing\n\t * [{\n\t *     \"surface_form\": \"黒白\",    // 表層形\n\t *     \"pos\": \"名詞\",               // 品詞 (part of speech)\n\t *     \"pos_detail_1\": \"一般\",      // 品詞細分類1\n\t *     \"pos_detail_2\": \"*\",        // 品詞細分類2\n\t *     \"pos_detail_3\": \"*\",        // 品詞細分類3\n\t *     \"conjugated_type\": \"*\",     // 活用型\n\t *     \"conjugated_form\": \"*\",     // 活用形\n\t *     \"basic_form\": \"黒白\",      // 基本形\n\t *     \"reading\": \"クロシロ\",       // 読み\n\t *     \"pronunciation\": \"クロシロ\",  // 発音\n\t *     \"verbose\": {                 // Other properties\n\t *         \"word_id\": 413560,\n\t *         \"word_type\": \"KNOWN\",\n\t *         \"word_position\": 1\n\t *     }\n\t * }]\n\t */\n\tparse(str = \"\"): Promise<ParseResult[]> {\n\t\treturn new Promise((resolve) => {\n\t\t\tif (str.trim() === \"\") return resolve([]);\n\t\t\tconst result = this._analyzer?.tokenize(str);\n\t\t\tfor (const w of result) {\n\t\t\t\tw.verbose = {\n\t\t\t\t\tword_id: w.word_id,\n\t\t\t\t\tword_type: w.word_type,\n\t\t\t\t\tword_position: w.word_position,\n\t\t\t\t};\n\t\t\t\t// biome-ignore lint/performance/noDelete: <explanation>\n\t\t\t\tdelete w.word_id;\n\t\t\t\t// biome-ignore lint/performance/noDelete: <explanation>\n\t\t\t\tdelete w.word_type;\n\t\t\t\t// biome-ignore lint/performance/noDelete: <explanation>\n\t\t\t\tdelete w.word_position;\n\t\t\t}\n\t\t\tresolve(result);\n\t\t});\n\t}\n}\n\nexport const kuroshiro = new Kuroshiro();\nawait kuroshiro.init(new Analyzer(\"kuromoji-dict-min\"));\n"],"names":["ViterbiNode","node_name","node_cost","start_pos","length","type","left_id","right_id","surface_form","ViterbiLattice","node","last_pos","prev_nodes","last_index","SurrogateAwareString","str","pos","ch","index","surrogate_aware_index","surrogate_aware_start_index","surrogate_aware_end_index","upper","lower","utf16_code","ViterbiBuilder","dic","sentence_str","lattice","sentence","key","trie_id","word_cost","tail","vocabulary","n","token_info_ids","i","token_info_id","surrogate_aware_tail","head_char","head_char_class","k","next_char","next_char_class","unk_ids","j","unk_id","ViterbiSearcher","connection_costs","nodes","cost","shortest_prev_node","prev_node","edge_cost","_cost","shortest_path","node_back","IpadicFormatter","word_id","position","features","token","PUNCTUATION","Tokenizer","input","sentences","text","tokens","best_path","features_line","ch2","wk","c","id","msg","transfer","cb","w","e","d","ed","err","u8","u16","i32","fleb","fdeb","clim","freb","eb","start","b","r","_a","fl","revfl","_b","fd","rev","x","hMap","cd","mb","s","l","le","co","rvb","sv","r_1","v","m","flt","fdt","flrm","fdrm","max","a","bits","p","o","bits16","shft","slc","ec","ind","nt","inflt","dat","st","buf","dict","sl","dl","noBuf","resize","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","t","lms","dms","lpos","sym","add","dsym","end","shift","dend","et","mrg","wcln","fn","fnStr","td","ks","st_1","spInd","cbfs","wrkr","fns","init","td_1","bInflt","inflateSync","pbf","gopt","guze","gzs","gzl","zule","zls","cbify","opts","flg","zs","inflate","data","ev","gunzip","gunzipSync","unzlib","unzlibSync","decompress","tds","TERM_CHAR","TERM_CODE","ROOT_ID","NOT_FOUND","BASE_SIGNED","CHECK_SIGNED","BASE_BYTES","CHECK_BYTES","MEMORY_EXPAND_RATIO","newBC","initial_size","initBase","_base","check","last_used_id","initCheck","_check","realloc","min_size","new_size","base_new_array","newArrayBuffer","base","check_new_array","first_unused_node","base_buffer","check_buffer","base_value","check_value","unused_count","size","dump_base","dump_check","DoubleArrayBuilder","record","keys","sorted","DoubleArray","buff_keys","stringToUtf8Bytes","k1","k2","b1","b2","min_length","parent_index","children_info","child_code","child_start","child_len","child_index","current_char","next_pos","parent_id","bc","code","child_id","prev_unused_id","next_unused_id","value","curr","empty_area_found","candidate_id","buffer","parent","child","result","grand_child","utf8BytesToString","arrayCopy","signed","bytes","src","src_offset","dstU8","srcU8","unicode_code","b3","b4","doublearray","module","ByteBuffer","arg","new_array","num","b0","TokenInfoDictionary","entries","dictionary_entries","entry","feature","pos_id","source","target","mapping","map_keys_size","values","map_values_size","array_buffer","token_info_id_str","ConnectionCosts","forward_dimension","backward_dimension","forward_id","backward_id","connection_costs_buffer","CharacterClass","class_id","class_name","is_always_invoke","is_grouping","max_length","InvokeDefinitionMap","invoke_def_buffer","invoke_def","character_category_definition","character_class","char_class","DEFAULT_CATEGORY","CharacterDefinition","cat_map_buffer","compat_cat_map_buffer","char_def","parsed_category_def","category","invoke","grouping","is_invoke","parsed_category_mapping","default_category","compatible_category","category_mapping","code_point","bitset","class_id_bit","default_id","classes","integer","bit","UnknownDictionary","character_definition","unk_buffer","unk_pos_buffer","unk_map_buffer","DynamicDictionaries","trie","token_info_dictionary","unknown_dictionary","builder","load","token_info_buffer","pos_buffer","target_map_buffer","cc_buffer","join","path","DictionaryLoader","dic_path","_file","loadArrayBuffer","loadData","filename","buffers","decompressAsync","resolve","reject","typed_array","BrowserDictionaryLoader","url","res","TokenizerBuilder","option","callback","ConnectionCostsBuilder","line","dimensions","costs","CATEGORY_DEF_PATTERN","CATEGORY_MAPPING_PATTERN","RANGE_CATEGORY_MAPPING_PATTERN","CharacterDefinitionBuilder","parsed_range_category_mapping","range_mapping","DictionaryBuilder","new_entry","dictionaries","unk_dictionary","words","_builder","kuromoji","f","require","u","exports","runtime","Op","hasOwn","undefined","$Symbol","iteratorSymbol","asyncIteratorSymbol","toStringTagSymbol","define","obj","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","context","Context","makeInvokeMethod","tryCatch","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","NativeIteratorPrototype","Gp","defineIteratorMethods","prototype","method","genFun","ctor","AsyncIterator","PromiseImpl","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","iter","state","doneResult","delegate","delegateResult","maybeInvokeDelegate","info","pushTryEntry","locs","resetTryEntry","object","next","iterable","iteratorMethod","skipTempReset","name","rootEntry","rootRecord","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","afterLoc","finallyLoc","tryLoc","thrown","resultName","nextLoc","_regenerator","_interopRequireDefault","_util","_typeof","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","Kuroshiro","_init","_callee","analyzer","_context","_x","_convert","_callee2","options","ROMAJI_SYSTEMS","rawTokens","romajiConv","hi","tmp","hpattern","hc","hreg","hmatches","pickKJ","hc1","notations","strType","pattern","isLastTokenKanji","subs","reg","matches","pickKanji","c1","c2","c3","n0","n1","n2","n3","n4","n5","_context2","preToken","convert","_x2","_x3","Util","_default","_core","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","minLen","_arrayLikeToArray","len","arr2","KATAKANA_HIRAGANA_SHIFT","HIRAGANA_KATAKANA_SHIFT","ROMANIZATION_SYSTEM","isHiragana","isKatakana","isKana","isKanji","isJapanese","hasHiragana","hasKatakana","hasKana","hasKanji","hasJapanese","toRawHiragana","toRawKatakana","toRawRomaji","system","romajiSystem","reg_tsu","reg_xtsu","pnt","reg_hatu","match","indices","mStr","getStrType","hasKJ","hasHK","patchTokens","cr","kanaToHiragna","kanaToKatakana","kanaToRomaji","Analyzer","_dictPath","newAnalyzer","kuroshiro"],"mappings":"uEA+BA,SAASA,GACRC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACC,CACD,KAAK,KAAOP,EACZ,KAAK,KAAOC,EACZ,KAAK,UAAYC,EACjB,KAAK,OAASC,EACd,KAAK,QAAUE,EACf,KAAK,SAAWC,EAChB,KAAK,KAAO,KACZ,KAAK,aAAeC,EAChBH,IAAS,MACZ,KAAK,cAAgB,EAErB,KAAK,cAAgB,OAAO,UAE7B,KAAK,KAAOA,CACb,CC9BA,SAASI,IAAiB,CACzB,KAAK,aAAe,GACpB,KAAK,aAAa,CAAC,EAAI,CAAC,IAAIT,GAAY,GAAI,EAAG,EAAG,EAAG,MAAO,EAAG,EAAG,EAAE,CAAC,EACrE,KAAK,QAAU,CAChB,CAMAS,GAAe,UAAU,OAAS,SAAUC,EAAM,CACjD,MAAMC,EAAWD,EAAK,UAAYA,EAAK,OAAS,EAC5C,KAAK,QAAUC,IAClB,KAAK,QAAUA,GAGhB,IAAIC,EAAa,KAAK,aAAaD,CAAQ,EACvCC,GAAc,OACjBA,EAAa,CAAA,GAEdA,EAAW,KAAKF,CAAI,EAEpB,KAAK,aAAaC,CAAQ,EAAIC,CAC/B,EAKAH,GAAe,UAAU,UAAY,UAAY,CAChD,MAAMI,EAAa,KAAK,aAAa,OACrC,KAAK,UACL,KAAK,aAAaA,CAAU,EAAI,CAC/B,IAAIb,GAAY,GAAI,EAAG,KAAK,QAAS,EAAG,MAAO,EAAG,EAAG,EAAE,CACzD,CACA,ECnCA,SAASc,GAAqBC,EAAK,CAClC,KAAK,IAAMA,EACX,KAAK,cAAgB,GAErB,QAASC,EAAM,EAAGA,EAAMD,EAAI,OAAQC,IAAO,CAC1C,MAAMC,EAAKF,EAAI,OAAOC,CAAG,EACzB,KAAK,cAAc,KAAKA,CAAG,EACvBF,GAAqB,gBAAgBG,CAAE,GAC1CD,GAED,CAED,KAAK,OAAS,KAAK,cAAc,MAClC,CAEAF,GAAqB,UAAU,MAAQ,SAAUI,EAAO,CACvD,GAAI,KAAK,cAAc,QAAUA,EAChC,MAAO,GAER,MAAMC,EAAwB,KAAK,cAAcD,CAAK,EACtD,OAAO,KAAK,IAAI,MAAMC,CAAqB,CAC5C,EAEAL,GAAqB,UAAU,OAAS,SAAUI,EAAO,CACxD,GAAI,KAAK,IAAI,QAAUA,EACtB,MAAO,GAER,MAAME,EAA8B,KAAK,cAAcF,CAAK,EACtDG,EAA4B,KAAK,cAAcH,EAAQ,CAAC,EAE9D,OAAIG,GAA6B,KACzB,KAAK,IAAI,MAAMD,CAA2B,EAE3C,KAAK,IAAI,MAAMA,EAA6BC,CAAyB,CAC7E,EAEAP,GAAqB,UAAU,WAAa,SAAUI,EAAO,CAC5D,GAAI,KAAK,cAAc,QAAUA,EAChC,MAAO,KAER,MAAMC,EAAwB,KAAK,cAAcD,CAAK,EAChDI,EAAQ,KAAK,IAAI,WAAWH,CAAqB,EACvD,IAAII,EACJ,OACCD,GAAS,OACTA,GAAS,OACTH,EAAwB,KAAK,IAAI,SAEjCI,EAAQ,KAAK,IAAI,WAAWJ,EAAwB,CAAC,EACjDI,GAAS,OAAUA,GAAS,QACvBD,EAAQ,OAAU,KAAQC,EAAQ,MAAS,MAG9CD,CACR,EAEAR,GAAqB,UAAU,SAAW,UAAY,CACrD,OAAO,KAAK,GACb,EAEAA,GAAqB,gBAAkB,SAAUG,EAAI,CACpD,MAAMO,EAAaP,EAAG,WAAW,CAAC,EAClC,OAAIO,GAAc,OAAUA,GAAc,KAM3C,EChEA,SAASC,GAAeC,EAAK,CAC5B,KAAK,KAAOA,EAAI,KAChB,KAAK,sBAAwBA,EAAI,sBACjC,KAAK,mBAAqBA,EAAI,kBAC/B,CAOAD,GAAe,UAAU,MAAQ,SAAUE,EAAc,CACxD,MAAMC,EAAU,IAAInB,GACdoB,EAAW,IAAIf,GAAqBa,CAAY,EAEtD,IAAIG,EACAC,EACAzB,EACAC,EACAyB,EACJ,QAAShB,EAAM,EAAGA,EAAMa,EAAS,OAAQb,IAAO,CAC/C,MAAMiB,EAAOJ,EAAS,MAAMb,CAAG,EACzBkB,EAAa,KAAK,KAAK,mBAAmBD,CAAI,EACpD,QAASE,EAAI,EAAGA,EAAID,EAAW,OAAQC,IAAK,CAE3CJ,EAAUG,EAAWC,CAAC,EAAE,EACxBL,EAAMI,EAAWC,CAAC,EAAE,EAEpB,MAAMC,EAAiB,KAAK,sBAAsB,WAAWL,CAAO,EACpE,QAASM,EAAI,EAAGA,EAAID,EAAe,OAAQC,IAAK,CAC/C,MAAMC,EAAgB,SAASF,EAAeC,CAAC,CAAC,EAEhD/B,EAAU,KAAK,sBAAsB,WAAW,SAASgC,CAAa,EACtE/B,EAAW,KAAK,sBAAsB,WAAW,SAChD+B,EAAgB,CACrB,EACIN,EAAY,KAAK,sBAAsB,WAAW,SACjDM,EAAgB,CACrB,EAGIV,EAAQ,OACP,IAAI5B,GACHsC,EACAN,EACAhB,EAAM,EACNc,EAAI,OACJ,QACAxB,EACAC,EACAuB,CACA,CACN,CACI,CACD,CAGD,MAAMS,EAAuB,IAAIzB,GAAqBmB,CAAI,EACpDO,EAAY,IAAI1B,GAAqByB,EAAqB,OAAO,CAAC,CAAC,EACnEE,EAAkB,KAAK,mBAAmB,OAC/CD,EAAU,SAAU,CACvB,EACE,GACCN,GAAc,MACdA,EAAW,SAAW,GACtBO,EAAgB,mBAAqB,EACpC,CAGD,GADAX,EAAMU,EAELC,EAAgB,cAAgB,GAChC,EAAIF,EAAqB,OAEzB,QAASG,EAAI,EAAGA,EAAIH,EAAqB,OAAQG,IAAK,CACrD,MAAMC,EAAYJ,EAAqB,OAAOG,CAAC,EACzCE,EAAkB,KAAK,mBAAmB,OAAOD,CAAS,EAChE,GAAIF,EAAgB,aAAeG,EAAgB,WAClD,MAEDd,GAAOa,CACP,CAGF,MAAME,EACL,KAAK,mBAAmB,WAAWJ,EAAgB,QAAQ,EAC5D,QAASK,EAAI,EAAGA,EAAID,EAAQ,OAAQC,IAAK,CACxC,MAAMC,EAAS,SAASF,EAAQC,CAAC,CAAC,EAElCxC,EAAU,KAAK,mBAAmB,WAAW,SAASyC,CAAM,EAC5DxC,EAAW,KAAK,mBAAmB,WAAW,SAASwC,EAAS,CAAC,EACjEf,EAAY,KAAK,mBAAmB,WAAW,SAASe,EAAS,CAAC,EAGlEnB,EAAQ,OACP,IAAI5B,GACH+C,EACAf,EACAhB,EAAM,EACNc,EAAI,OACJ,UACAxB,EACAC,EACAuB,EAAI,SAAU,CACd,CACN,CACI,CACD,CACD,CACD,OAAAF,EAAQ,UAAS,EAEVA,CACR,ECnHA,SAASoB,GAAgBC,EAAkB,CAC1C,KAAK,iBAAmBA,CACzB,CAOAD,GAAgB,UAAU,OAAS,SAAUpB,EAAS,CACrD,OAAAA,EAAU,KAAK,QAAQA,CAAO,EACvB,KAAK,SAASA,CAAO,CAC7B,EAEAoB,GAAgB,UAAU,QAAU,SAAUpB,EAAS,CACtD,IAAIS,EACAS,EACAJ,EACJ,IAAKL,EAAI,EAAGA,GAAKT,EAAQ,QAASS,IAAK,CACtC,MAAMa,EAAQtB,EAAQ,aAAaS,CAAC,EACpC,GAAIa,GAAS,KAGb,IAAKJ,EAAI,EAAGA,EAAII,EAAM,OAAQJ,IAAK,CAClC,MAAMpC,EAAOwC,EAAMJ,CAAC,EACpB,IAAIK,EAAO,OAAO,UACdC,EAEJ,MAAMxC,EAAagB,EAAQ,aAAalB,EAAK,UAAY,CAAC,EAC1D,GAAIE,GAAc,KAIlB,KAAK8B,EAAI,EAAGA,EAAI9B,EAAW,OAAQ8B,IAAK,CACvC,MAAMW,EAAYzC,EAAW8B,CAAC,EAE9B,IAAIY,EACA5C,EAAK,SAAW,MAAQ2C,EAAU,UAAY,MAEjD,QAAQ,IAAI,uBAAuB,EACnCC,EAAY,GAEZA,EAAY,KAAK,iBAAiB,IACjCD,EAAU,SACV3C,EAAK,OACX,EAGI,MAAM6C,EAAQF,EAAU,cAAgBC,EAAY5C,EAAK,KACrD6C,EAAQJ,IACXC,EAAqBC,EACrBF,EAAOI,EAER,CAED7C,EAAK,KAAO0C,EACZ1C,EAAK,cAAgByC,EACrB,CACD,CACD,OAAOvB,CACR,EAEAoB,GAAgB,UAAU,SAAW,SAAUpB,EAAS,CACvD,MAAM4B,EAAgB,CAAA,EAGtB,IAAIC,EAFQ7B,EAAQ,aAAaA,EAAQ,aAAa,OAAS,CAAC,EAAE,CAAC,EAE/C,KACpB,GAAI6B,GAAa,KAChB,MAAO,GAER,KAAOA,EAAU,OAAS,OAAO,CAEhC,GADAD,EAAc,KAAKC,CAAS,EACxBA,EAAU,MAAQ,KAErB,MAAO,GAERA,EAAYA,EAAU,IACtB,CAED,OAAOD,EAAc,SACtB,ECjFA,SAASE,IAAkB,CAAE,CAE7BA,GAAgB,UAAU,YAAc,SACvCC,EACAC,EACAvD,EACAwD,EACC,CACD,MAAMC,EAAQ,CAAA,EACd,OAAAA,EAAM,QAAUH,EAChBG,EAAM,UAAYzD,EAClByD,EAAM,cAAgBF,EAEtBE,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,IAAMD,EAAS,CAAC,EACtBC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,gBAAkBD,EAAS,CAAC,EAClCC,EAAM,gBAAkBD,EAAS,CAAC,EAClCC,EAAM,WAAaD,EAAS,CAAC,EAC7BC,EAAM,QAAUD,EAAS,CAAC,EAC1BC,EAAM,cAAgBD,EAAS,CAAC,EAEzBC,CACR,EAEAJ,GAAgB,UAAU,mBAAqB,SAC9CC,EACAC,EACAvD,EACAwD,EACArD,EACC,CACD,MAAMsD,EAAQ,CAAA,EACd,OAAAA,EAAM,QAAUH,EAChBG,EAAM,UAAYzD,EAClByD,EAAM,cAAgBF,EAEtBE,EAAM,aAAetD,EACrBsD,EAAM,IAAMD,EAAS,CAAC,EACtBC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,aAAeD,EAAS,CAAC,EAC/BC,EAAM,gBAAkBD,EAAS,CAAC,EAClCC,EAAM,gBAAkBD,EAAS,CAAC,EAClCC,EAAM,WAAaD,EAAS,CAAC,EAItBC,CACR,ECnDA,MAAMC,GAAc,MAOpB,SAASC,GAAUtC,EAAK,CACvB,KAAK,sBAAwBA,EAAI,sBACjC,KAAK,mBAAqBA,EAAI,mBAC9B,KAAK,gBAAkB,IAAID,GAAeC,CAAG,EAC7C,KAAK,iBAAmB,IAAIsB,GAAgBtB,EAAI,gBAAgB,EAChE,KAAK,UAAY,IAAIgC,EACtB,CAOAM,GAAU,mBAAqB,SAAUC,EAAO,CAC/C,MAAMC,EAAY,CAAA,EAClB,IAAIjC,EAAOgC,EACX,KACKhC,IAAS,IADD,CAIZ,MAAMf,EAAQe,EAAK,OAAO8B,EAAW,EACrC,GAAI7C,EAAQ,EAAG,CACdgD,EAAU,KAAKjC,CAAI,EACnB,KACA,CACDiC,EAAU,KAAKjC,EAAK,UAAU,EAAGf,EAAQ,CAAC,CAAC,EAC3Ce,EAAOA,EAAK,UAAUf,EAAQ,CAAC,CAC/B,CACD,OAAOgD,CACR,EAOAF,GAAU,UAAU,SAAW,SAAUG,EAAM,CAC9C,MAAMD,EAAYF,GAAU,mBAAmBG,CAAI,EAC7CC,EAAS,CAAA,EACf,QAAS/B,EAAI,EAAGA,EAAI6B,EAAU,OAAQ7B,IAAK,CAC1C,MAAMR,EAAWqC,EAAU7B,CAAC,EAC5B,KAAK,oBAAoBR,EAAUuC,CAAM,CACzC,CACD,OAAOA,CACR,EAEAJ,GAAU,UAAU,oBAAsB,SAAUnC,EAAUuC,EAAQ,CACjEA,GAAU,OACbA,EAAS,CAAA,GAEV,MAAMxC,EAAU,KAAK,WAAWC,CAAQ,EAClCwC,EAAY,KAAK,iBAAiB,OAAOzC,CAAO,EACtD,IAAIjB,EAAW,EACXyD,EAAO,OAAS,IACnBzD,EAAWyD,EAAOA,EAAO,OAAS,CAAC,EAAE,eAGtC,QAAStB,EAAI,EAAGA,EAAIuB,EAAU,OAAQvB,IAAK,CAC1C,MAAMpC,EAAO2D,EAAUvB,CAAC,EAExB,IAAIgB,EACAD,EACAS,EACA5D,EAAK,OAAS,SACjB4D,EAAgB,KAAK,sBAAsB,YAAY5D,EAAK,IAAI,EAC5D4D,GAAiB,KACpBT,EAAW,CAAA,EAEXA,EAAWS,EAAc,MAAM,GAAG,EAEnCR,EAAQ,KAAK,UAAU,YACtBpD,EAAK,KACLC,EAAWD,EAAK,UAChBA,EAAK,KACLmD,CACJ,GACanD,EAAK,OAAS,WAExB4D,EAAgB,KAAK,mBAAmB,YAAY5D,EAAK,IAAI,EACzD4D,GAAiB,KACpBT,EAAW,CAAA,EAEXA,EAAWS,EAAc,MAAM,GAAG,EAEnCR,EAAQ,KAAK,UAAU,mBACtBpD,EAAK,KACLC,EAAWD,EAAK,UAChBA,EAAK,KACLmD,EACAnD,EAAK,YACT,GAGGoD,EAAQ,KAAK,UAAU,YACtBpD,EAAK,KACLC,EAAWD,EAAK,UAChBA,EAAK,KACL,CAAE,CACN,EAGE0D,EAAO,KAAKN,CAAK,CACjB,CAED,OAAOM,CACR,EAOAJ,GAAU,UAAU,WAAa,SAAUG,EAAM,CAChD,OAAO,KAAK,gBAAgB,MAAMA,CAAI,CACvC,ECvIA,IAAII,GAAM,CAAA,EACNC,GAAM,SAAUC,EAAGC,EAAIC,EAAKC,EAAUC,EAAI,CAC1C,IAAIC,EAAI,IAAI,OAAOP,GAAIG,CAAE,IAAMH,GAAIG,CAAE,EAAI,IAAI,gBAAgB,IAAI,KAAK,CAClED,EAAI,iGACP,EAAE,CAAE,KAAM,kBAAmB,CAAC,EAAE,EACjC,OAAAK,EAAE,UAAY,SAAUC,EAAG,CACvB,IAAIC,EAAID,EAAE,KAAME,EAAKD,EAAE,IACvB,GAAIC,EAAI,CACJ,IAAIC,EAAM,IAAI,MAAMD,EAAG,CAAC,CAAC,EACzBC,EAAI,KAAUD,EAAG,CAAC,EAClBC,EAAI,MAAQD,EAAG,CAAC,EAChBJ,EAAGK,EAAK,IAAI,CACf,MAEGL,EAAG,KAAMG,CAAC,CACtB,EACIF,EAAE,YAAYH,EAAKC,CAAQ,EACpBE,CACX,EAGIK,EAAK,WAAYC,GAAM,YAAaC,GAAM,WAE1CC,GAAO,IAAIH,EAAG,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAgB,EAAG,EAAoB,CAAC,CAAC,EAE5II,GAAO,IAAIJ,EAAG,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAiB,EAAG,CAAC,CAAC,EAEnIK,GAAO,IAAIL,EAAG,CAAC,GAAI,GAAI,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,GAAI,EAAG,EAAE,CAAC,EAEhFM,GAAO,SAAUC,EAAIC,EAAO,CAE5B,QADIC,EAAI,IAAIR,GAAI,EAAE,EACT/C,EAAI,EAAGA,EAAI,GAAI,EAAEA,EACtBuD,EAAEvD,CAAC,EAAIsD,GAAS,GAAKD,EAAGrD,EAAI,CAAC,EAIjC,QADIwD,EAAI,IAAIR,GAAIO,EAAE,EAAE,CAAC,EACZvD,EAAI,EAAGA,EAAI,GAAI,EAAEA,EACtB,QAASS,EAAI8C,EAAEvD,CAAC,EAAGS,EAAI8C,EAAEvD,EAAI,CAAC,EAAG,EAAES,EAC/B+C,EAAE/C,CAAC,EAAMA,EAAI8C,EAAEvD,CAAC,GAAM,EAAKA,EAGnC,MAAO,CAAE,EAAGuD,EAAG,EAAGC,CAAC,CACvB,EACIC,GAAKL,GAAKH,GAAM,CAAC,EAAGS,GAAKD,GAAG,EAAGE,GAAQF,GAAG,EAE9CC,GAAG,EAAE,EAAI,IAAKC,GAAM,GAAG,EAAI,GACxB,IAACC,GAAKR,GAAKF,GAAM,CAAC,EAAGW,GAAKD,GAAG,EAE5BE,GAAM,IAAIf,GAAI,KAAK,EACvB,QAAS/C,EAAI,EAAGA,EAAI,MAAO,EAAEA,EAAG,CAE5B,IAAI+D,IAAM/D,EAAI,QAAW,GAAOA,EAAI,QAAW,EAC/C+D,IAAMA,GAAI,QAAW,GAAOA,GAAI,QAAW,EAC3CA,IAAMA,GAAI,QAAW,GAAOA,GAAI,OAAW,EAC3CD,GAAI9D,CAAC,IAAO+D,GAAI,QAAW,GAAOA,GAAI,MAAW,IAAO,CAC5D,CAIA,IAAIC,GAAQ,SAAUC,EAAIC,EAAIV,EAAG,CAO7B,QANIW,EAAIF,EAAG,OAEPjE,EAAI,EAEJoE,EAAI,IAAIrB,GAAImB,CAAE,EAEXlE,EAAImE,EAAG,EAAEnE,EACRiE,EAAGjE,CAAC,GACJ,EAAEoE,EAAEH,EAAGjE,CAAC,EAAI,CAAC,EAGrB,IAAIqE,EAAK,IAAItB,GAAImB,CAAE,EACnB,IAAKlE,EAAI,EAAGA,EAAIkE,EAAI,EAAElE,EAClBqE,EAAGrE,CAAC,EAAKqE,EAAGrE,EAAI,CAAC,EAAIoE,EAAEpE,EAAI,CAAC,GAAM,EAEtC,IAAIsE,EACJ,GAAId,EAAG,CAEHc,EAAK,IAAIvB,GAAI,GAAKmB,CAAE,EAEpB,IAAIK,EAAM,GAAKL,EACf,IAAKlE,EAAI,EAAGA,EAAImE,EAAG,EAAEnE,EAEjB,GAAIiE,EAAGjE,CAAC,EAQJ,QANIwE,EAAMxE,GAAK,EAAKiE,EAAGjE,CAAC,EAEpByE,EAAMP,EAAKD,EAAGjE,CAAC,EAEf0E,EAAIL,EAAGJ,EAAGjE,CAAC,EAAI,CAAC,KAAOyE,EAElBE,EAAID,GAAM,GAAKD,GAAO,EAAIC,GAAKC,EAAG,EAAED,EAEzCJ,EAAGR,GAAIY,CAAC,GAAKH,CAAG,EAAIC,CAInC,KAGG,KADAF,EAAK,IAAIvB,GAAIoB,CAAC,EACTnE,EAAI,EAAGA,EAAImE,EAAG,EAAEnE,EACbiE,EAAGjE,CAAC,IACJsE,EAAGtE,CAAC,EAAI8D,GAAIO,EAAGJ,EAAGjE,CAAC,EAAI,CAAC,GAAG,GAAM,GAAKiE,EAAGjE,CAAC,GAItD,OAAOsE,CACX,EAEIM,GAAM,IAAI9B,EAAG,GAAG,EACpB,QAAS9C,EAAI,EAAGA,EAAI,IAAK,EAAEA,EACvB4E,GAAI5E,CAAC,EAAI,EACb,QAASA,EAAI,IAAKA,EAAI,IAAK,EAAEA,EACzB4E,GAAI5E,CAAC,EAAI,EACb,QAASA,EAAI,IAAKA,EAAI,IAAK,EAAEA,EACzB4E,GAAI5E,CAAC,EAAI,EACb,QAASA,EAAI,IAAKA,EAAI,IAAK,EAAEA,EACzB4E,GAAI5E,CAAC,EAAI,EAEb,IAAI6E,GAAM,IAAI/B,EAAG,EAAE,EACnB,QAAS9C,EAAI,EAAGA,EAAI,GAAI,EAAEA,EACtB6E,GAAI7E,CAAC,EAAI,EAEV,IAAsC8E,GAAqBd,GAAKY,GAAK,EAAG,CAAC,EAEnCG,GAAqBf,GAAKa,GAAK,EAAG,CAAC,EAExEG,GAAM,SAAUC,EAAG,CAEnB,QADIN,EAAIM,EAAE,CAAC,EACFjF,EAAI,EAAGA,EAAIiF,EAAE,OAAQ,EAAEjF,EACxBiF,EAAEjF,CAAC,EAAI2E,IACPA,EAAIM,EAAEjF,CAAC,GAEf,OAAO2E,CACX,EAEIO,GAAO,SAAUvC,EAAGwC,EAAGR,EAAG,CAC1B,IAAIS,EAAKD,EAAI,EAAK,EAClB,OAASxC,EAAEyC,CAAC,EAAKzC,EAAEyC,EAAI,CAAC,GAAK,KAAQD,EAAI,GAAMR,CACnD,EAEIU,GAAS,SAAU1C,EAAGwC,EAAG,CACzB,IAAIC,EAAKD,EAAI,EAAK,EAClB,OAASxC,EAAEyC,CAAC,EAAKzC,EAAEyC,EAAI,CAAC,GAAK,EAAMzC,EAAEyC,EAAI,CAAC,GAAK,MAASD,EAAI,EAChE,EAEIG,GAAO,SAAUH,EAAG,CAAE,OAASA,EAAI,GAAK,EAAK,GAG7CI,GAAM,SAAUb,EAAGP,EAAG,EAAG,CACzB,OAAIA,GAAK,MAAQA,EAAI,KACjBA,EAAI,IACJ,GAAK,MAAQ,EAAIO,EAAE,UACnB,EAAIA,EAAE,QAEH,IAAI5B,EAAG4B,EAAE,SAASP,EAAG,CAAC,CAAC,CAClC,EAsBIqB,GAAK,CACL,iBACA,qBACA,yBACA,mBACA,kBACA,oBACJ,CACI,cACA,qBACA,uBACA,8BACA,oBACA,mBACA,kBAEJ,EAEI3C,EAAM,SAAU4C,EAAKnD,EAAKoD,EAAI,CAC9B,IAAIhD,EAAI,IAAI,MAAMJ,GAAOkD,GAAGC,CAAG,CAAC,EAIhC,GAHA/C,EAAE,KAAO+C,EACL,MAAM,mBACN,MAAM,kBAAkB/C,EAAGG,CAAG,EAC9B,CAAC6C,EACD,MAAMhD,EACV,OAAOA,CACX,EAEIiD,GAAQ,SAAUC,EAAKC,EAAIC,EAAKC,EAAM,CAEtC,IAAIC,EAAKJ,EAAI,OAAQK,EAAKF,EAAOA,EAAK,OAAS,EAC/C,GAAI,CAACC,GAAMH,EAAG,GAAK,CAACA,EAAG,EACnB,OAAOC,GAAO,IAAIhD,EAAG,CAAC,EAC1B,IAAIoD,EAAQ,CAACJ,EAETK,EAASD,GAASL,EAAG,GAAK,EAE1BO,EAAOP,EAAG,EAEVK,IACAJ,EAAM,IAAIhD,EAAGkD,EAAK,CAAC,GAEvB,IAAIK,EAAO,SAAUjC,EAAG,CACpB,IAAIkC,EAAKR,EAAI,OAEb,GAAI1B,EAAIkC,EAAI,CAER,IAAIC,EAAO,IAAIzD,EAAG,KAAK,IAAIwD,EAAK,EAAGlC,CAAC,CAAC,EACrCmC,EAAK,IAAIT,CAAG,EACZA,EAAMS,CACT,CACT,EAEQC,EAAQX,EAAG,GAAK,EAAGlH,EAAMkH,EAAG,GAAK,EAAGY,EAAKZ,EAAG,GAAK,EAAGa,EAAKb,EAAG,EAAGc,EAAKd,EAAG,EAAGe,EAAMf,EAAG,EAAGgB,EAAMhB,EAAG,EAE/FiB,EAAOd,EAAK,EAChB,EAAG,CACC,GAAI,CAACU,EAAI,CAELF,EAAQtB,GAAKU,EAAKjH,EAAK,CAAC,EAExB,IAAIX,EAAOkH,GAAKU,EAAKjH,EAAM,EAAG,CAAC,EAE/B,GADAA,GAAO,EACFX,EAiBA,GAAIA,GAAQ,EACb0I,EAAK5B,GAAM6B,EAAK5B,GAAM6B,EAAM,EAAGC,EAAM,UAChC7I,GAAQ,EAAG,CAEhB,IAAI+I,EAAO7B,GAAKU,EAAKjH,EAAK,EAAE,EAAI,IAAKqI,EAAQ9B,GAAKU,EAAKjH,EAAM,GAAI,EAAE,EAAI,EACnEsI,EAAKF,EAAO7B,GAAKU,EAAKjH,EAAM,EAAG,EAAE,EAAI,EACzCA,GAAO,GAKP,QAHIuI,EAAM,IAAIpE,EAAGmE,CAAE,EAEfE,EAAM,IAAIrE,EAAG,EAAE,EACV9C,EAAI,EAAGA,EAAIgH,EAAO,EAAEhH,EAEzBmH,EAAIhE,GAAKnD,CAAC,CAAC,EAAIkF,GAAKU,EAAKjH,EAAMqB,EAAI,EAAG,CAAC,EAE3CrB,GAAOqI,EAAQ,EAKf,QAHII,EAAMpC,GAAImC,CAAG,EAAGE,GAAU,GAAKD,GAAO,EAEtCE,EAAMtD,GAAKmD,EAAKC,EAAK,CAAC,EACjBpH,EAAI,EAAGA,EAAIiH,GAAK,CACrB,IAAIzD,GAAI8D,EAAIpC,GAAKU,EAAKjH,EAAK0I,CAAM,CAAC,EAElC1I,GAAO6E,GAAI,GAEX,IAAIW,EAAIX,IAAK,EAEb,GAAIW,EAAI,GACJ+C,EAAIlH,GAAG,EAAImE,MAEV,CAED,IAAI/B,EAAI,EAAGtC,EAAI,EAOf,IANIqE,GAAK,IACLrE,EAAI,EAAIoF,GAAKU,EAAKjH,EAAK,CAAC,EAAGA,GAAO,EAAGyD,EAAI8E,EAAIlH,EAAI,CAAC,GAC7CmE,GAAK,IACVrE,EAAI,EAAIoF,GAAKU,EAAKjH,EAAK,CAAC,EAAGA,GAAO,GAC7BwF,GAAK,KACVrE,EAAI,GAAKoF,GAAKU,EAAKjH,EAAK,GAAG,EAAGA,GAAO,GAClCmB,KACHoH,EAAIlH,GAAG,EAAIoC,CAClB,CACJ,CAED,IAAImF,EAAKL,EAAI,SAAS,EAAGH,CAAI,EAAGS,EAAKN,EAAI,SAASH,CAAI,EAEtDH,EAAM5B,GAAIuC,CAAE,EAEZV,EAAM7B,GAAIwC,CAAE,EACZd,EAAK1C,GAAKuD,EAAIX,EAAK,CAAC,EACpBD,EAAK3C,GAAKwD,EAAIX,EAAK,CAAC,CACvB,MAEGhE,EAAI,CAAC,MAtEE,CAEP,IAAIsB,EAAImB,GAAK3G,CAAG,EAAI,EAAGyF,EAAIwB,EAAIzB,EAAI,CAAC,EAAKyB,EAAIzB,EAAI,CAAC,GAAK,EAAIsD,EAAItD,EAAIC,EACnE,GAAIqD,EAAIzB,EAAI,CACJI,GACAvD,EAAI,CAAC,EACT,KACH,CAEGsD,GACAE,EAAKI,EAAKrC,CAAC,EAEf0B,EAAI,IAAIF,EAAI,SAASzB,EAAGsD,CAAC,EAAGhB,CAAE,EAE9BZ,EAAG,EAAIY,GAAMrC,EAAGyB,EAAG,EAAIlH,EAAM8I,EAAI,EAAG5B,EAAG,EAAIW,EAC3C,QACH,CAuDD,GAAI7H,EAAMmI,EAAM,CACRV,GACAvD,EAAI,CAAC,EACT,KACH,CACJ,CAGGsD,GACAE,EAAKI,EAAK,MAAM,EAGpB,QAFIiB,GAAO,GAAKd,GAAO,EAAGe,IAAO,GAAKd,GAAO,EACzCe,EAAOjJ,GACHiJ,EAAOjJ,EAAK,CAEhB,IAAIyD,EAAIsE,EAAGrB,GAAOO,EAAKjH,CAAG,EAAI+I,CAAG,EAAGG,EAAMzF,GAAK,EAE/C,GADAzD,GAAOyD,EAAI,GACPzD,EAAMmI,EAAM,CACRV,GACAvD,EAAI,CAAC,EACT,KACH,CAGD,GAFKT,GACDS,EAAI,CAAC,EACLgF,EAAM,IACN/B,EAAIW,GAAI,EAAIoB,UACPA,GAAO,IAAK,CACjBD,EAAOjJ,EAAK+H,EAAK,KACjB,KACH,KACI,CACD,IAAIoB,EAAMD,EAAM,IAEhB,GAAIA,EAAM,IAAK,CAEX,IAAI7H,EAAI6H,EAAM,IAAKtE,EAAIN,GAAKjD,CAAC,EAC7B8H,EAAM5C,GAAKU,EAAKjH,GAAM,GAAK4E,GAAK,CAAC,EAAIG,GAAG1D,CAAC,EACzCrB,GAAO4E,CACV,CAED,IAAIZ,EAAIgE,EAAGtB,GAAOO,EAAKjH,CAAG,EAAIgJ,EAAG,EAAGI,EAAOpF,GAAK,EAC3CA,GACDE,EAAI,CAAC,EACTlE,GAAOgE,EAAI,GACX,IAAI6E,EAAK3D,GAAGkE,CAAI,EAChB,GAAIA,EAAO,EAAG,CACV,IAAIxE,EAAIL,GAAK6E,CAAI,EACjBP,GAAMnC,GAAOO,EAAKjH,CAAG,GAAK,GAAK4E,GAAK,EAAG5E,GAAO4E,CACjD,CACD,GAAI5E,EAAMmI,EAAM,CACRV,GACAvD,EAAI,CAAC,EACT,KACH,CACGsD,GACAE,EAAKI,EAAK,MAAM,EACpB,IAAIuB,EAAMvB,EAAKqB,EACf,GAAIrB,EAAKe,EAAI,CACT,IAAIS,EAAQhC,EAAKuB,EAAIU,EAAO,KAAK,IAAIV,EAAIQ,CAAG,EAG5C,IAFIC,EAAQxB,EAAK,GACb5D,EAAI,CAAC,EACF4D,EAAKyB,EAAM,EAAEzB,EAChBX,EAAIW,CAAE,EAAIV,EAAKkC,EAAQxB,CAAE,CAChC,CACD,KAAOA,EAAKuB,EAAK,EAAEvB,EACfX,EAAIW,CAAE,EAAIX,EAAIW,EAAKe,CAAE,CAC5B,CACJ,CACD3B,EAAG,EAAIa,EAAIb,EAAG,EAAI+B,EAAM/B,EAAG,EAAIY,EAAIZ,EAAG,EAAIW,EACtCE,IACAF,EAAQ,EAAGX,EAAG,EAAIe,EAAKf,EAAG,EAAIc,EAAId,EAAG,EAAIgB,EAChD,OAAQ,CAACL,GAEV,OAAOC,GAAMX,EAAI,QAAUI,EAAQX,GAAIO,EAAK,EAAGW,CAAE,EAAIX,EAAI,SAAS,EAAGW,CAAE,CAC3E,EAoOI0B,GAAmB,IAAIrF,EAAG,CAAC,EAgM3BsF,GAAM,SAAUnD,EAAG1B,EAAG,CACtB,IAAI6B,EAAI,CAAA,EACR,QAAS/E,KAAK4E,EACVG,EAAE/E,CAAC,EAAI4E,EAAE5E,CAAC,EACd,QAASA,KAAKkD,EACV6B,EAAE/E,CAAC,EAAIkD,EAAElD,CAAC,EACd,OAAO+E,CACX,EAQIiD,GAAO,SAAUC,EAAIC,EAAOC,EAAI,CAIhC,QAHIhB,EAAKc,IACLzC,EAAKyC,EAAG,WACRG,EAAK5C,EAAG,MAAMA,EAAG,QAAQ,GAAG,EAAI,EAAGA,EAAG,YAAY,GAAG,CAAC,EAAE,QAAQ,OAAQ,EAAE,EAAE,MAAM,GAAG,EAChF7F,EAAI,EAAGA,EAAIwH,EAAG,OAAQ,EAAExH,EAAG,CAChC,IAAI0E,EAAI8C,EAAGxH,CAAC,EAAGK,EAAIoI,EAAGzI,CAAC,EACvB,GAAI,OAAO0E,GAAK,WAAY,CACxB6D,GAAS,IAAMlI,EAAI,IACnB,IAAIqI,EAAOhE,EAAE,WACb,GAAIA,EAAE,UAEF,GAAIgE,EAAK,QAAQ,eAAe,GAAK,GAAI,CACrC,IAAIC,EAAQD,EAAK,QAAQ,IAAK,CAAC,EAAI,EACnCH,GAASG,EAAK,MAAMC,EAAOD,EAAK,QAAQ,IAAKC,CAAK,CAAC,CACtD,KACI,CACDJ,GAASG,EACT,QAASjB,KAAK/C,EAAE,UACZ6D,GAAS,IAAMlI,EAAI,cAAgBoH,EAAI,IAAM/C,EAAE,UAAU+C,CAAC,EAAE,SAAQ,CAC3E,MAGDc,GAASG,CAChB,MAEGF,EAAGnI,CAAC,EAAIqE,CACf,CACD,OAAO6D,CACX,EACI3J,GAAK,CAAA,EAELgK,GAAO,SAAUlE,EAAG,CACpB,IAAIuC,EAAK,CAAA,EACT,QAAS5G,KAAKqE,EACNA,EAAErE,CAAC,EAAE,QACL4G,EAAG,MAAMvC,EAAErE,CAAC,EAAI,IAAIqE,EAAErE,CAAC,EAAE,YAAYqE,EAAErE,CAAC,CAAC,GAAG,MAAM,EAG1D,OAAO4G,CACX,EAEI4B,GAAO,SAAUC,EAAKC,EAAM1G,EAAIG,EAAI,CACpC,GAAI,CAAC5D,GAAGyD,CAAE,EAAG,CAET,QADIkG,EAAQ,GAAIS,EAAO,CAAA,EAAIrE,EAAImE,EAAI,OAAS,EACnC9I,EAAI,EAAGA,EAAI2E,EAAG,EAAE3E,EACrBuI,EAAQF,GAAKS,EAAI9I,CAAC,EAAGuI,EAAOS,CAAI,EACpCpK,GAAGyD,CAAE,EAAI,CAAE,EAAGgG,GAAKS,EAAInE,CAAC,EAAG4D,EAAOS,CAAI,EAAG,EAAGA,CAAI,CACnD,CACD,IAAIR,EAAKJ,GAAI,CAAE,EAAExJ,GAAGyD,CAAE,EAAE,CAAC,EACzB,OAAOF,GAAGvD,GAAGyD,CAAE,EAAE,EAAI,0EAA4E0G,EAAK,SAAU,EAAG,IAAK1G,EAAImG,EAAII,GAAKJ,CAAE,EAAGhG,CAAE,CAChJ,EAEIyG,GAAS,UAAY,CAAE,MAAO,CAACnG,EAAIC,GAAKC,GAAKC,GAAMC,GAAMC,GAAMO,GAAIG,GAAIiB,GAAMC,GAAMjB,GAAK0B,GAAIxB,GAAMgB,GAAKE,GAAMG,GAAQC,GAAMC,GAAK1C,EAAK8C,GAAOuD,GAAaC,GAAKC,EAAI,CAAE,EAKpKC,GAAO,UAAY,CAAE,MAAO,CAACC,GAAKC,EAAG,CAAE,EAIvCC,GAAO,UAAY,CAAE,MAAO,CAACC,EAAG,CAAE,EAElCN,GAAM,SAAU7G,EAAK,CAAE,OAAO,YAAYA,EAAK,CAACA,EAAI,MAAM,CAAC,GAE3D8G,GAAO,SAAUhE,EAAG,CAAE,OAAOA,GAAK,CAClC,IAAKA,EAAE,MAAQ,IAAItC,EAAGsC,EAAE,IAAI,EAC5B,WAAYA,EAAE,UAClB,GAEIsE,GAAQ,SAAU9D,EAAK+D,EAAMb,EAAKC,EAAM1G,EAAIG,EAAI,CAChD,IAAIC,EAAIoG,GAAKC,EAAKC,EAAM1G,EAAI,SAAUQ,EAAK+C,EAAK,CAC5CnD,EAAE,UAAS,EACXD,EAAGK,EAAK+C,CAAG,CACnB,CAAK,EACD,OAAAnD,EAAE,YAAY,CAACmD,EAAK+D,CAAI,EAAGA,EAAK,QAAU,CAAC/D,EAAI,MAAM,EAAI,CAAE,CAAA,EACpD,UAAY,CAAEnD,EAAE,UAAS,CAAG,CACvC,EAuEI6G,GAAM,SAAU3G,EAAG,EACfA,EAAE,CAAC,GAAK,IAAMA,EAAE,CAAC,GAAK,KAAOA,EAAE,CAAC,GAAK,IACrCE,EAAI,EAAG,mBAAmB,EAC9B,IAAI+G,EAAMjH,EAAE,CAAC,EACTkD,EAAK,GACL+D,EAAM,IACN/D,IAAOlD,EAAE,EAAE,EAAIA,EAAE,EAAE,GAAK,GAAK,GACjC,QAASkH,GAAMD,GAAO,EAAI,IAAMA,GAAO,EAAI,GAAIC,EAAK,EAAGA,GAAM,CAAClH,EAAEkD,GAAI,EAChE,CACJ,OAAOA,GAAM+D,EAAM,EACvB,EAEIL,GAAM,SAAU5G,EAAG,CACnB,IAAIyB,EAAIzB,EAAE,OACV,OAAQA,EAAEyB,EAAI,CAAC,EAAIzB,EAAEyB,EAAI,CAAC,GAAK,EAAIzB,EAAEyB,EAAI,CAAC,GAAK,GAAKzB,EAAEyB,EAAI,CAAC,GAAK,MAAQ,CAC5E,EAeIqF,GAAM,SAAU9G,EAAGoD,EAAM,CACzB,QAAKpD,EAAE,CAAC,EAAI,KAAO,GAAMA,EAAE,CAAC,GAAK,EAAK,IAAOA,EAAE,CAAC,GAAK,EAAIA,EAAE,CAAC,GAAK,KAC7DE,EAAI,EAAG,mBAAmB,GACzBF,EAAE,CAAC,GAAK,EAAI,IAAM,CAAC,CAACoD,GACrBlD,EAAI,EAAG,uBAAyBF,EAAE,CAAC,EAAI,GAAK,OAAS,cAAgB,aAAa,GAC9EA,EAAE,CAAC,GAAK,EAAI,GAAK,CAC7B,EAiLO,SAASmH,GAAQC,EAAMJ,EAAMnH,EAAI,CACpC,OAAKA,IACDA,EAAKmH,EAAMA,EAAO,IAClB,OAAOnH,GAAM,YACbK,EAAI,CAAC,EACF6G,GAAMK,EAAMJ,EAAM,CACrBV,EACR,EAAO,SAAUe,EAAI,CAAE,OAAOb,GAAID,GAAYc,EAAG,KAAK,CAAC,EAAGZ,GAAKY,EAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAM,EAAGxH,CAAE,CACtF,CAOO,SAAS0G,GAAYa,EAAMJ,EAAM,CACpC,OAAOhE,GAAMoE,EAAM,CAAE,EAAG,CAAG,EAAEJ,GAAQA,EAAK,IAAKA,GAAQA,EAAK,UAAU,CAC1E,CAgJO,SAASM,GAAOF,EAAMJ,EAAMnH,EAAI,CACnC,OAAKA,IACDA,EAAKmH,EAAMA,EAAO,IAClB,OAAOnH,GAAM,YACbK,EAAI,CAAC,EACF6G,GAAMK,EAAMJ,EAAM,CACrBV,GACAI,GACA,UAAY,CAAE,MAAO,CAACa,EAAU,CAAI,CAC5C,EAAO,SAAUF,EAAI,CAAE,OAAOb,GAAIe,GAAWF,EAAG,KAAK,CAAC,EAAGA,EAAG,KAAK,CAAC,CAAC,CAAC,CAAE,EAAI,EAAGxH,CAAE,CAC/E,CAOO,SAAS0H,GAAWH,EAAMJ,EAAM,CACnC,IAAI9D,EAAKyD,GAAIS,CAAI,EACjB,OAAIlE,EAAK,EAAIkE,EAAK,QACdlH,EAAI,EAAG,mBAAmB,EACvB8C,GAAMoE,EAAK,SAASlE,EAAI,EAAE,EAAG,CAAE,EAAG,GAAK8D,GAAQA,EAAK,KAAO,IAAI7G,EAAGyG,GAAIQ,CAAI,CAAC,EAAGJ,GAAQA,EAAK,UAAU,CAChH,CAgIO,SAASQ,GAAOJ,EAAMJ,EAAMnH,EAAI,CACnC,OAAKA,IACDA,EAAKmH,EAAMA,EAAO,IAClB,OAAOnH,GAAM,YACbK,EAAI,CAAC,EACF6G,GAAMK,EAAMJ,EAAM,CACrBV,GACAO,GACA,UAAY,CAAE,MAAO,CAACY,EAAU,CAAI,CAC5C,EAAO,SAAUJ,EAAI,CAAE,OAAOb,GAAIiB,GAAWJ,EAAG,KAAK,CAAC,EAAGZ,GAAKY,EAAG,KAAK,CAAC,CAAC,CAAC,CAAC,GAAM,EAAGxH,CAAE,CACrF,CAOO,SAAS4H,GAAWL,EAAMJ,EAAM,CACnC,OAAOhE,GAAMoE,EAAK,SAASN,GAAIM,EAAMJ,GAAQA,EAAK,UAAU,EAAG,EAAE,EAAG,CAAE,EAAG,CAAG,EAAEA,GAAQA,EAAK,IAAKA,GAAQA,EAAK,UAAU,CAC3H,CAwFO,SAASU,GAAWN,EAAMJ,EAAMnH,EAAI,CACvC,OAAKA,IACDA,EAAKmH,EAAMA,EAAO,IAClB,OAAOnH,GAAM,YACbK,EAAI,CAAC,EACDkH,EAAK,CAAC,GAAK,IAAMA,EAAK,CAAC,GAAK,KAAOA,EAAK,CAAC,GAAK,EAChDE,GAAOF,EAAMJ,EAAMnH,CAAE,GACnBuH,EAAK,CAAC,EAAI,KAAO,GAAMA,EAAK,CAAC,GAAK,EAAK,IAAOA,EAAK,CAAC,GAAK,EAAIA,EAAK,CAAC,GAAK,GACtED,GAAQC,EAAMJ,EAAMnH,CAAE,EACtB2H,GAAOJ,EAAMJ,EAAMnH,CAAE,CACnC,CA+BA,IAAIgG,GAAK,OAAO,YAAe,KAA6B,IAAI,YAE5D8B,GAAM,EACV,GAAI,CACA9B,GAAG,OAAOL,GAAI,CAAE,OAAQ,EAAM,CAAA,EAC9BmC,GAAM,CACV,MACU,CAAA,mCCtnDT,UAAY,CAIT,IAAIC,EAAY,KACZC,EAAY,EACZC,EAAU,EACVC,EAAY,GACZC,EAAc,GACdC,EAAe,GACfC,EAAa,EACbC,EAAc,EACdC,EAAsB,EAGtBC,EAAQ,SAAUC,EAAc,CAE5BA,GAAgB,OAChBA,EAAe,MAGnB,IAAIC,EAAW,SAAUC,EAAO7H,EAAO0E,EAAK,CACxC,QAAShI,EAAIsD,EAAOtD,EAAIgI,EAAKhI,IACzBmL,EAAMnL,CAAC,EAAI,CAAEA,EAAI,EAErB,GAAI,EAAIoL,EAAM,MAAMA,EAAM,MAAM,OAAS,CAAC,EAAG,CAEzC,QADIC,EAAeD,EAAM,MAAM,OAAS,EACjC,EAAIA,EAAM,MAAMC,CAAY,GAC/BA,IAEJF,EAAM7H,CAAK,EAAI,CAAE+H,CACpB,CACb,EAEYC,EAAY,SAAUC,EAAQjI,EAAO0E,EAAK,CAC1C,QAAShI,EAAIsD,EAAOtD,EAAIgI,EAAKhI,IACzBuL,EAAOvL,CAAC,EAAI,CAAEA,EAAI,CAElC,EAEYwL,EAAU,SAAUC,EAAU,CAE9B,IAAIC,EAAWD,EAAWV,EAGtBY,EAAiBC,EAAeC,EAAK,OAAQA,EAAK,MAAOH,CAAQ,EACrER,EAASS,EAAgBE,EAAK,MAAM,OAAQH,CAAQ,EACpDC,EAAe,IAAIE,EAAK,KAAK,EAC7BA,EAAK,MAAQ,KACbA,EAAK,MAAQF,EAEb,IAAIG,EAAkBF,EAAeR,EAAM,OAAQA,EAAM,MAAOM,CAAQ,EACxEJ,EAAUQ,EAAiBV,EAAM,MAAM,OAAQM,CAAQ,EACvDI,EAAgB,IAAIV,EAAM,KAAK,EAC/BA,EAAM,MAAQ,KACdA,EAAM,MAAQU,CAC1B,EAEYC,EAAoBtB,EAAU,EAE9BoB,EAAO,CACP,OAAQlB,EACR,MAAOE,EACP,MAAOe,EAAejB,EAAaE,EAAYI,CAAY,CACvE,EAEYG,EAAQ,CACR,OAAQR,EACR,MAAOE,EACP,MAAOc,EAAehB,EAAcE,EAAaG,CAAY,CACzE,EAGQ,OAAAY,EAAK,MAAMpB,CAAO,EAAI,EACtBW,EAAM,MAAMX,CAAO,EAAIA,EAGvBS,EAASW,EAAK,MAAOpB,EAAU,EAAGoB,EAAK,MAAM,MAAM,EAGnDP,EAAUF,EAAM,MAAOX,EAAU,EAAGW,EAAM,MAAM,MAAM,EAE/C,CACH,cAAe,UAAY,CACvB,OAAOS,EAAK,KACf,EACD,eAAgB,UAAY,CACxB,OAAOT,EAAM,KAChB,EACD,eAAgB,SAAUY,EAAa,CACnC,OAAAH,EAAK,MAAQG,EACN,IACV,EACD,gBAAiB,SAAUC,EAAc,CACrC,OAAAb,EAAM,MAAQa,EACP,IACV,EACD,KAAM,UAAY,CACd,OAAO,KAAK,IAAIJ,EAAK,MAAM,OAAQT,EAAM,MAAM,MAAM,CACxD,EACD,QAAS,SAAUvM,EAAO,CACtB,OAAIgN,EAAK,MAAM,OAAS,EAAIhN,EACjB,CAAEA,EAAQ,EAOdgN,EAAK,MAAMhN,CAAK,CAC1B,EACD,SAAU,SAAUA,EAAO,CACvB,OAAIuM,EAAM,MAAM,OAAS,EAAIvM,EAClB,CAAEA,EAAQ,EAOduM,EAAM,MAAMvM,CAAK,CAC3B,EACD,QAAS,SAAUA,EAAOqN,EAAY,CAC9BL,EAAK,MAAM,OAAS,EAAIhN,GACxB2M,EAAQ3M,CAAK,EAEjBgN,EAAK,MAAMhN,CAAK,EAAIqN,CACvB,EACD,SAAU,SAAUrN,EAAOsN,EAAa,CAChCf,EAAM,MAAM,OAAS,EAAIvM,GACzB2M,EAAQ3M,CAAK,EAEjBuM,EAAM,MAAMvM,CAAK,EAAIsN,CACxB,EACD,mBAAoB,SAAUtN,EAAO,CAIjCkN,EAAoBlN,CACvB,EACD,mBAAoB,UAAY,CAI5B,OAAOkN,CACV,EACD,OAAQ,UAAY,CAEhB,QADIvN,EAAa,KAAK,KAAI,EAAK,EAEvB,KAAK4M,EAAM,MAAM5M,CAAU,IAG/BA,IAEJqN,EAAK,MAAQA,EAAK,MAAM,SAAS,EAAGrN,EAAa,CAAC,EAClD4M,EAAM,MAAQA,EAAM,MAAM,SAAS,EAAG5M,EAAa,CAAC,CACvD,EACD,KAAM,UAAY,CAGd,QAFI4N,EAAe,EACfC,EAAOjB,EAAM,MAAM,OACdpL,EAAI,EAAGA,EAAIqM,EAAMrM,IAClBoL,EAAM,MAAMpL,CAAC,EAAI,GACjBoM,IAGR,MAAO,CACH,IAAKC,EACL,OAAQD,EACR,YAAaC,EAAOD,GAAgBC,CACxD,CACa,EACD,KAAM,UAAY,CAEd,IAAIC,EAAY,GACZC,EAAa,GAEbvM,EACJ,IAAKA,EAAI,EAAGA,EAAI6L,EAAK,MAAM,OAAQ7L,IAC/BsM,EAAYA,EAAY,IAAM,KAAK,QAAQtM,CAAC,EAEhD,IAAKA,EAAI,EAAGA,EAAIoL,EAAM,MAAM,OAAQpL,IAChCuM,EAAaA,EAAa,IAAM,KAAK,SAASvM,CAAC,EAGnD,eAAQ,IAAI,QAAUsM,CAAS,EAC/B,QAAQ,IAAI,QAAUC,CAAU,EAEzB,QAAUD,EAAY,SAAWC,CAC3C,CACb,CACA,EAMI,SAASC,EAAmBvB,EAAc,CACtC,KAAK,GAAKD,EAAMC,CAAY,EAC5B,KAAK,KAAO,EACf,CAUDuB,EAAmB,UAAU,OAAS,SAAU/M,EAAKgN,EAAQ,CACzD,YAAK,KAAK,KAAK,CAAE,EAAGhN,EAAK,EAAGgN,CAAM,CAAE,EAC7B,IACf,EASID,EAAmB,UAAU,MAAQ,SAAUE,EAAMC,EAAQ,CAMzD,GAJID,GAAQ,OACRA,EAAO,KAAK,MAGZA,GAAQ,KACR,OAAO,IAAIE,EAAY,KAAK,EAAE,EAG9BD,GAAU,OACVA,EAAS,IAIb,IAAIE,EACAH,EAAK,IAAI,SAAUrM,EAAG,CAClB,MAAO,CACH,EAAGyM,EAAkBzM,EAAE,EAAIkK,CAAS,EACpC,EAAGlK,EAAE,CACzB,CACA,CAAa,EAGL,OAAIsM,EACA,KAAK,KAAOE,EAEZ,KAAK,KACDA,EAAU,KAAK,SAAUE,EAAIC,EAAI,CAI7B,QAHIC,EAAKF,EAAG,EACRG,EAAKF,EAAG,EACRG,EAAa,KAAK,IAAIF,EAAG,OAAQC,EAAG,MAAM,EACrCvO,EAAM,EAAGA,EAAMwO,EAAYxO,IAChC,GAAIsO,EAAGtO,CAAG,IAAMuO,EAAGvO,CAAG,EAGtB,OAAOsO,EAAGtO,CAAG,EAAIuO,EAAGvO,CAAG,EAE3B,OAAOsO,EAAG,OAASC,EAAG,MAC1C,CAAiB,EAGTL,EAAY,KAEZ,KAAK,OAAOpC,EAAS,EAAG,EAAG,KAAK,KAAK,MAAM,EACpC,IAAImC,EAAY,KAAK,EAAE,CACtC,EAKIJ,EAAmB,UAAU,OAAS,SAAUY,EAAc7L,EAAU+B,EAAOvF,EAAQ,CAEnF,IAAIsP,EAAgB,KAAK,gBAAgB9L,EAAU+B,EAAOvF,CAAM,EAC5DoN,EAAQ,KAAK,oBAAoBkC,CAAa,EAElD,KAAK,MAAMD,EAAcC,EAAelC,CAAK,EAE7C,QAASnL,EAAI,EAAGA,EAAIqN,EAAc,OAAQrN,EAAIA,EAAI,EAAG,CACjD,IAAIsN,EAAaD,EAAcrN,CAAC,EAChC,GAAIsN,IAAe9C,EAGnB,KAAI+C,EAAcF,EAAcrN,EAAI,CAAC,EACjCwN,EAAYH,EAAcrN,EAAI,CAAC,EAC/ByN,EAActC,EAAQmC,EAC1B,KAAK,OAAOG,EAAalM,EAAW,EAAGgM,EAAaC,CAAS,EAChE,CACT,EAEIhB,EAAmB,UAAU,gBAAkB,SAAUjL,EAAU+B,EAAOvF,EAAQ,CAC9E,IAAI2P,EAAe,KAAK,KAAKpK,CAAK,EAAE,EAAE/B,CAAQ,EAC1CvB,EAAI,EACJqN,EAAgB,IAAI,WAAWtP,EAAS,CAAC,EAE7CsP,EAAcrN,GAAG,EAAI0N,EACrBL,EAAcrN,GAAG,EAAIsD,EAIrB,QAFIqK,EAAWrK,EACXxF,EAAYwF,EACTqK,EAAWrK,EAAQvF,EAAQ4P,IAAY,CAC1C,IAAIrN,EAAY,KAAK,KAAKqN,CAAQ,EAAE,EAAEpM,CAAQ,EAC1CmM,IAAiBpN,IACjB+M,EAAcrN,GAAG,EAAI2N,EAAW7P,EAEhCuP,EAAcrN,GAAG,EAAIM,EACrB+M,EAAcrN,GAAG,EAAI2N,EACrBD,EAAepN,EACfxC,EAAY6P,EAEnB,CACD,OAAAN,EAAcrN,GAAG,EAAI2N,EAAW7P,EAChCuP,EAAgBA,EAAc,SAAS,EAAGrN,CAAC,EAEpCqN,CACf,EAEIb,EAAmB,UAAU,MAAQ,SAAUoB,EAAWP,EAAelC,EAAO,CAE5E,IAAI0C,EAAK,KAAK,GAEdA,EAAG,QAAQD,EAAWzC,CAAK,EAE3B,IAAInL,EACJ,IAAKA,EAAI,EAAGA,EAAIqN,EAAc,OAAQrN,EAAIA,EAAI,EAAG,CAC7C,IAAI8N,EAAOT,EAAcrN,CAAC,EACtB+N,EAAW5C,EAAQ2C,EASnBE,EAAiB,CAAEH,EAAG,QAAQE,CAAQ,EACtCE,EAAiB,CAAEJ,EAAG,SAASE,CAAQ,EAOvCA,IAAaF,EAAG,qBAChBA,EAAG,SAASG,EAAgB,CAAEC,CAAc,EAG5CJ,EAAG,mBAAmBI,CAAc,EAExCJ,EAAG,QAAQI,EAAgB,CAAED,CAAc,EAE3C,IAAI5C,EAAQwC,EAIZ,GAHAC,EAAG,SAASE,EAAU3C,CAAK,EAGvB0C,IAAStD,EAAW,CACpB,IAAI1M,EAAYuP,EAAcrN,EAAI,CAAC,EAK/BkO,EAAQ,KAAK,KAAKpQ,CAAS,EAAE,EAE7BoQ,GAAS,OACTA,EAAQ,GAGZ,IAAIrC,EAAO,CAAEqC,EAAQ,EACrBL,EAAG,QAAQE,EAAUlC,CAAI,CAC5B,CACJ,CACT,EAMIW,EAAmB,UAAU,oBAAsB,SAAUa,EAAe,CAoBxE,QAlBIQ,EAAK,KAAK,GAYV1C,EACAgD,EAAON,EAAG,uBAKD,CAGT,GAFA1C,EAAQgD,EAAOd,EAAc,CAAC,EAE1BlC,EAAQ,EAAG,CACXgD,EAAO,CAAEN,EAAG,SAASM,CAAI,EAMzB,QACH,CAGD,QADIC,EAAmB,GACdpO,EAAI,EAAGA,EAAIqN,EAAc,OAAQrN,EAAIA,EAAI,EAAG,CACjD,IAAI8N,EAAOT,EAAcrN,CAAC,EACtBqO,EAAelD,EAAQ2C,EAE3B,GAAI,CAAC,KAAK,aAAaO,CAAY,EAAG,CAGlCF,EAAO,CAAEN,EAAG,SAASM,CAAI,EAKzBC,EAAmB,GACnB,KACH,CACJ,CACD,GAAIA,EAEA,OAAOjD,CAEd,CACT,EAKIqB,EAAmB,UAAU,aAAe,SAAU3N,EAAO,CACzD,IAAIgP,EAAK,KAAK,GACVzC,EAAQyC,EAAG,SAAShP,CAAK,EAM7B,OAAIA,IAAU4L,EAEH,GAEPW,EAAQ,CAOpB,EAMI,SAASwB,EAAYiB,EAAI,CACrB,KAAK,GAAKA,EACV,KAAK,GAAG,QACX,CASDjB,EAAY,UAAU,QAAU,SAAUnN,EAAK,CAE3C,IAAIoO,EAAK,KAAK,GAEdpO,GAAO8K,EAMP,QALI+D,EAASxB,EAAkBrN,CAAG,EAE9B8O,EAAS9D,EACT+D,EAAQ9D,EAEH1K,EAAI,EAAGA,EAAIsO,EAAO,OAAQtO,IAAK,CACpC,IAAI8N,EAAOQ,EAAOtO,CAAC,EAGnB,GADAwO,EAAQ,KAAK,SAASD,EAAQT,CAAI,EAC9BU,IAAU9D,EACV,MAAO,GAGX,GAAImD,EAAG,QAAQW,CAAK,GAAK,EAErB,MAAO,GAGPD,EAASC,CAGhB,CACD,MAAO,EACf,EASI5B,EAAY,UAAU,OAAS,SAAUnN,EAAK,CAE1CA,GAAO8K,EAMP,QALI+D,EAASxB,EAAkBrN,CAAG,EAE9B8O,EAAS9D,EACT+D,EAAQ9D,EAEH1K,EAAI,EAAGA,EAAIsO,EAAO,OAAQtO,IAAK,CACpC,IAAI8N,EAAOQ,EAAOtO,CAAC,EAEnB,GADAwO,EAAQ,KAAK,SAASD,EAAQT,CAAI,EAC9BU,IAAU9D,EACV,OAAOA,EAEX6D,EAASC,CACZ,CAED,IAAI3C,EAAO,KAAK,GAAG,QAAQ2C,CAAK,EAChC,OAAI3C,GAAQ,EAED,CAAEA,EAAO,EAGTnB,CAEnB,EAUIkC,EAAY,UAAU,mBAAqB,SAAUnN,EAAK,CAStD,QAPI6O,EAASxB,EAAkBrN,CAAG,EAE9B8O,EAAS9D,EACT+D,EAAQ9D,EAER+D,EAAS,CAAA,EAEJzO,EAAI,EAAGA,EAAIsO,EAAO,OAAQtO,IAAK,CACpC,IAAI8N,EAAOQ,EAAOtO,CAAC,EAInB,GAFAwO,EAAQ,KAAK,SAASD,EAAQT,CAAI,EAE9BU,IAAU9D,EAAW,CACrB6D,EAASC,EAGT,IAAIE,EAAc,KAAK,SAASF,EAAOhE,CAAS,EAEhD,GAAIkE,IAAgBhE,EAAW,CAC3B,IAAImB,EAAO,KAAK,GAAG,QAAQ6C,CAAW,EAElClL,EAAI,CAAA,EAEJqI,GAAQ,IAERrI,EAAE,EAAI,CAAEqI,EAAO,GAInBrI,EAAE,EAAImL,EAAkBC,EAAUN,EAAQ,EAAGtO,EAAI,CAAC,CAAC,EAEnDyO,EAAO,KAAKjL,CAAC,CAChB,CACD,QAChB,KACgB,MAEP,CAED,OAAOiL,CACf,EAEI7B,EAAY,UAAU,SAAW,SAAU2B,EAAQT,EAAM,CACrD,IAAIU,EAAQ,KAAK,GAAG,QAAQD,CAAM,EAAIT,EACtC,OAAI,KAAK,GAAG,SAASU,CAAK,IAAMD,EACrBC,EAEA9D,CAEnB,EAEIkC,EAAY,UAAU,KAAO,UAAY,CACrC,OAAO,KAAK,GAAG,MACvB,EAEIA,EAAY,UAAU,KAAO,UAAY,CACrC,OAAO,KAAK,GAAG,MACvB,EAEIA,EAAY,UAAU,KAAO,UAAY,CACrC,OAAO,KAAK,GAAG,MACvB,EAKI,IAAIhB,EAAiB,SAAUiD,EAAQC,EAAOzC,EAAM,CAE5C,OAAOyC,EAAK,CACR,IAAK,GACL,OAAO,IAAI,UAAUzC,CAAI,EACzB,IAAK,GACL,OAAO,IAAI,WAAWA,CAAI,EAC1B,IAAK,GACL,OAAO,IAAI,WAAWA,CAAI,EAC1B,QACA,MAAM,IAAI,WAAW,4CAA8CyC,CAAK,CAC3E,CAab,EAEQF,EAAY,SAAUG,EAAKC,EAAYjR,EAAQ,CAC/C,IAAIuQ,EAAS,IAAI,YAAYvQ,CAAM,EAC/BkR,EAAQ,IAAI,WAAWX,EAAQ,EAAGvQ,CAAM,EACxCmR,EAAQH,EAAI,SAASC,EAAYjR,CAAM,EAC3C,OAAAkR,EAAM,IAAIC,CAAK,EACRD,CACf,EASQnC,EAAoB,SAAUpO,EAAK,CAOnC,QAJIoQ,EAAQ,IAAI,WAAW,IAAI,YAAYpQ,EAAI,OAAS,CAAC,CAAC,EAEtDsB,EAAI,EAAGS,EAAI,EAERT,EAAItB,EAAI,QAAQ,CACnB,IAAIyQ,EAEAhQ,EAAaT,EAAI,WAAWsB,GAAG,EACnC,GAAIb,GAAc,OAAUA,GAAc,MAAQ,CAE9C,IAAIF,EAAQE,EACRD,EAAQR,EAAI,WAAWsB,GAAG,EAE9B,GAAId,GAAS,OAAUA,GAAS,MAC5BiQ,GACKlQ,EAAQ,OAAW,KAAY,OAC/BC,EAAQ,WAGb,QAAO,IAE3B,MAEgBiQ,EAAehQ,EAGfgQ,EAAe,IAEfL,EAAMrO,GAAG,EAAI0O,EAENA,EAAgB,MAEvBL,EAAMrO,GAAG,EAAK0O,IAAiB,EAAK,IACpCL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,KAE9BA,EAAgB,OAEvBL,EAAMrO,GAAG,EAAK0O,IAAiB,GAAM,IACrCL,EAAMrO,GAAG,EAAM0O,GAAgB,EAAK,GAAQ,IAC5CL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,KAE9BA,EAAgB,GAAK,KAE5BL,EAAMrO,GAAG,EAAK0O,IAAiB,GAAM,IACrCL,EAAMrO,GAAG,EAAM0O,GAAgB,GAAM,GAAQ,IAC7CL,EAAMrO,GAAG,EAAM0O,GAAgB,EAAK,GAAQ,IAC5CL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,IAK5C,CAED,OAAOL,EAAM,SAAS,EAAGrO,CAAC,CAClC,EASQkO,EAAoB,SAAUG,EAAO,CAMrC,QAJIpQ,EAAM,GACNoP,EAAMb,EAAIC,EAAIkC,EAAIC,EAAIpQ,EAAOC,EAC7Bc,EAAI,EAEDA,EAAI8O,EAAM,QAEb7B,EAAK6B,EAAM9O,GAAG,EAEViN,EAAK,IAELa,EAAOb,EACCA,GAAM,IAAO,GAErBC,EAAK4B,EAAM9O,GAAG,EACd8N,GAASb,EAAK,KAAS,EAAMC,EAAK,IAC1BD,GAAM,IAAO,IAErBC,EAAK4B,EAAM9O,GAAG,EACdoP,EAAKN,EAAM9O,GAAG,EACd8N,GAASb,EAAK,KAAS,IAAQC,EAAK,KAAS,EAAMkC,EAAK,KAGxDlC,EAAK4B,EAAM9O,GAAG,EACdoP,EAAKN,EAAM9O,GAAG,EACdqP,EAAKP,EAAM9O,GAAG,EACd8N,GAASb,EAAK,IAAS,IAAQC,EAAK,KAAS,IAAQkC,EAAK,KAAS,EAAMC,EAAK,IAG9EvB,EAAO,MACVpP,GAAO,OAAO,aAAaoP,CAAI,GAG/BA,GAAQ,MACR7O,EAAS,MAAU6O,GAAQ,GAC3B5O,EAAS,MAAU4O,EAAO,KAC1BpP,GAAO,OAAO,aAAaO,EAAOC,CAAK,GAI5C,OAAOR,CACf,EAIQ4Q,EAAc,CACd,QAAS,SAAUrE,EAAc,CAC7B,OAAO,IAAIuB,EAAmBvB,CAAY,CAC7C,EACD,KAAM,SAAUe,EAAaC,EAAc,CACvC,IAAI4B,EAAK7C,EAAM,CAAC,EAChB,OAAA6C,EAAG,eAAe7B,CAAW,EAC7B6B,EAAG,gBAAgB5B,CAAY,EACxB,IAAIW,EAAYiB,CAAE,CAC5B,CACT,EAOQ0B,EAAA,QAAiBD,CAGzB,6BC7vBA,MAAMxC,GAAoB,SAAUpO,EAAK,CAExC,MAAMoQ,EAAQ,IAAI,WAAWpQ,EAAI,OAAS,CAAC,EAE3C,IAAIsB,EAAI,EACJS,EAAI,EAER,KAAOT,EAAItB,EAAI,QAAQ,CACtB,IAAIyQ,EAEJ,MAAMhQ,EAAaT,EAAI,WAAWsB,GAAG,EACrC,GAAIb,GAAc,OAAUA,GAAc,MAAQ,CAEjD,MAAMF,EAAQE,EACRD,EAAQR,EAAI,WAAWsB,GAAG,EAEhC,GAAId,GAAS,OAAUA,GAAS,MAC/BiQ,GACElQ,EAAQ,OAAW,KAAY,OAAYC,EAAQ,WAGrD,QAAO,IAEX,MAEGiQ,EAAehQ,EAGZgQ,EAAe,IAElBL,EAAMrO,GAAG,EAAI0O,EACHA,EAAe,MAEzBL,EAAMrO,GAAG,EAAK0O,IAAiB,EAAK,IACpCL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,KAC3BA,EAAe,OAEzBL,EAAMrO,GAAG,EAAK0O,IAAiB,GAAM,IACrCL,EAAMrO,GAAG,EAAM0O,GAAgB,EAAK,GAAQ,IAC5CL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,KAC3BA,EAAe,GAAK,KAE9BL,EAAMrO,GAAG,EAAK0O,IAAiB,GAAM,IACrCL,EAAMrO,GAAG,EAAM0O,GAAgB,GAAM,GAAQ,IAC7CL,EAAMrO,GAAG,EAAM0O,GAAgB,EAAK,GAAQ,IAC5CL,EAAMrO,GAAG,EAAK0O,EAAe,GAAQ,IAItC,CAED,OAAOL,EAAM,SAAS,EAAGrO,CAAC,CAC3B,EAQMkO,GAAoB,SAAUG,EAAO,CAC1C,IAAIpQ,EAAM,GACNoP,EACAb,EACAC,EACAkC,EACAC,EACApQ,EACAC,EACAc,EAAI,EAER,KAAOA,EAAI8O,EAAM,QAChB7B,EAAK6B,EAAM9O,GAAG,EAEViN,EAAK,IAERa,EAAOb,EACGA,GAAM,IAAM,GAEtBC,EAAK4B,EAAM9O,GAAG,EACd8N,GAASb,EAAK,KAAS,EAAMC,EAAK,IACxBD,GAAM,IAAM,IAEtBC,EAAK4B,EAAM9O,GAAG,EACdoP,EAAKN,EAAM9O,GAAG,EACd8N,GAASb,EAAK,KAAS,IAAQC,EAAK,KAAS,EAAMkC,EAAK,KAGxDlC,EAAK4B,EAAM9O,GAAG,EACdoP,EAAKN,EAAM9O,GAAG,EACdqP,EAAKP,EAAM9O,GAAG,EACd8N,GACGb,EAAK,IAAS,IACdC,EAAK,KAAS,IACdkC,EAAK,KAAS,EACfC,EAAK,IAGJvB,EAAO,MACVpP,GAAO,OAAO,aAAaoP,CAAI,GAG/BA,GAAQ,MACR7O,EAAQ,MAAU6O,GAAQ,GAC1B5O,EAAQ,MAAU4O,EAAO,KACzBpP,GAAO,OAAO,aAAaO,EAAOC,CAAK,GAIzC,OAAOR,CACR,EAOA,SAAS8Q,EAAWC,EAAK,CACxB,IAAIxE,EACJ,GAAIwE,GAAO,KACVxE,EAAe,KAAO,aACZ,OAAOwE,GAAQ,SACzBxE,EAAewE,UACLA,aAAe,WAAY,CACrC,KAAK,OAASA,EACd,KAAK,SAAW,EAChB,MACF,KAEE,MAAM,GAAG,OAAOA,CAAG,wDAGpB,KAAK,OAAS,IAAI,WAAWxE,CAAY,EACzC,KAAK,SAAW,CACjB,CAEAuE,EAAW,UAAU,KAAO,UAAY,CACvC,OAAO,KAAK,OAAO,MACpB,EAEAA,EAAW,UAAU,WAAa,UAAY,CAC7C,MAAME,EAAY,IAAI,WAAW,KAAK,OAAO,OAAS,CAAC,EACvDA,EAAU,IAAI,KAAK,MAAM,EACzB,KAAK,OAASA,CACf,EAEAF,EAAW,UAAU,OAAS,UAAY,CACzC,YAAK,OAAS,KAAK,OAAO,SAAS,EAAG,KAAK,QAAQ,EAC5C,KAAK,MACb,EAEAA,EAAW,UAAU,IAAM,SAAUjM,EAAG,CACnC,KAAK,OAAO,OAAS,KAAK,SAAW,GACxC,KAAK,WAAU,EAEhB,KAAK,OAAO,KAAK,UAAU,EAAIA,CAChC,EAEAiM,EAAW,UAAU,IAAM,SAAU3Q,EAAO,CAK3C,OAJIA,GAAS,OACZA,EAAQ,KAAK,SACb,KAAK,UAAY,GAEd,KAAK,OAAO,OAASA,EAAQ,EACzB,EAED,KAAK,OAAOA,CAAK,CACzB,EAGA2Q,EAAW,UAAU,SAAW,SAAUG,EAAK,CAC9C,GAAI,MAASA,EACZ,KAAM,GAAGA,CAAG,uBAEb,MAAMzQ,EAAQ,IAASyQ,EACjB1Q,GAAS,MAAS0Q,IAAQ,EAChC,KAAK,IAAIzQ,CAAK,EACd,KAAK,IAAID,CAAK,CACf,EAGAuQ,EAAW,UAAU,SAAW,SAAU3Q,EAAO,CAKhD,GAJIA,GAAS,OACZA,EAAQ,KAAK,SACb,KAAK,UAAY,GAEd,KAAK,OAAO,OAASA,EAAQ,EAChC,MAAO,GAER,MAAMK,EAAQ,KAAK,OAAOL,CAAK,EAE/B,IAAIqP,GADU,KAAK,OAAOrP,EAAQ,CAAC,GACb,GAAKK,EAC3B,OAAIgP,EAAQ,QACXA,EAAQ,EAAGA,EAAQ,EAAK,QAElBA,CACR,EAGAsB,EAAW,UAAU,OAAS,SAAUG,EAAK,CAC5C,GAAI,WAAaA,EAChB,KAAM,GAAGA,CAAG,yBAEb,MAAMC,EAAK,IAAaD,EAClB1C,GAAM,MAAa0C,IAAQ,EAC3BzC,GAAM,SAAayC,IAAQ,GAC3BP,GAAM,WAAaO,IAAQ,GACjC,KAAK,IAAIC,CAAE,EACX,KAAK,IAAI3C,CAAE,EACX,KAAK,IAAIC,CAAE,EACX,KAAK,IAAIkC,CAAE,CACZ,EAGAI,EAAW,UAAU,OAAS,SAAU3Q,EAAO,CAK9C,GAJIA,GAAS,OACZA,EAAQ,KAAK,SACb,KAAK,UAAY,GAEd,KAAK,OAAO,OAASA,EAAQ,EAChC,MAAO,GAER,MAAM+Q,EAAK,KAAK,OAAO/Q,CAAK,EACtBoO,EAAK,KAAK,OAAOpO,EAAQ,CAAC,EAC1BqO,EAAK,KAAK,OAAOrO,EAAQ,CAAC,EAGhC,OAFW,KAAK,OAAOA,EAAQ,CAAC,GAElB,KAAOqO,GAAM,KAAOD,GAAM,GAAK2C,CAC9C,EAEAJ,EAAW,UAAU,QAAU,UAAY,CAC1C,MAAM7Q,EAAM,KAAK,SACjB,YAAK,UAAY,EACV,KAAK,OAAOA,CAAG,CACvB,EAEA6Q,EAAW,UAAU,UAAY,SAAU9Q,EAAK,CAC/C,MAAMoQ,EAAQhC,GAAkBpO,CAAG,EACnC,QAASsB,EAAI,EAAGA,EAAI8O,EAAM,OAAQ9O,IACjC,KAAK,IAAI8O,EAAM9O,CAAC,CAAC,EAGlB,KAAK,IAAI,CAAC,CACX,EAEAwP,EAAW,UAAU,UAAY,SAAU3Q,EAAO,CACjD,MAAMiH,EAAM,CAAA,EACZ,IAAIlH,EAIJ,IAHIC,GAAS,OACZA,EAAQ,KAAK,UAGT,OAAK,OAAO,OAASA,EAAQ,IAGjCD,EAAK,KAAK,IAAIC,GAAO,EACjBD,IAAO,KAGVkH,EAAI,KAAKlH,CAAE,EAGb,YAAK,SAAWC,EACT8P,GAAkB7I,CAAG,CAC7B,ECxQA,SAAS+J,IAAsB,CAC9B,KAAK,WAAa,IAAIL,EAAW,GAAK,KAAO,IAAI,EACjD,KAAK,WAAa,GAClB,KAAK,WAAa,IAAIA,EAAW,GAAK,KAAO,IAAI,CAClD,CAIAK,GAAoB,UAAU,gBAAkB,SAAUC,EAAS,CAClE,MAAMC,EAAqB,CAAA,EAE3B,QAAS/P,EAAI,EAAGA,EAAI8P,EAAQ,OAAQ9P,IAAK,CACxC,MAAMgQ,EAAQF,EAAQ9P,CAAC,EAEvB,GAAIgQ,EAAM,OAAS,EAClB,SAGD,MAAM7R,EAAe6R,EAAM,CAAC,EACtB/R,EAAU+R,EAAM,CAAC,EACjB9R,EAAW8R,EAAM,CAAC,EAClBrQ,EAAYqQ,EAAM,CAAC,EACnBC,EAAUD,EAAM,MAAM,CAAC,EAAE,KAAK,GAAG,EAGjC,SAAS/R,CAAO,GAAK,SAASC,CAAQ,GAAK,SAASyB,CAAS,GAClE,QAAQ,IAAIqQ,CAAK,EAGlB,MAAM/P,EAAgB,KAAK,IAC1BhC,EACAC,EACAyB,EACAxB,EACA8R,CACH,EACEF,EAAmB9P,CAAa,EAAI9B,CACpC,CAGD,YAAK,WAAW,SAChB,KAAK,WAAW,SAET4R,CACR,EAEAF,GAAoB,UAAU,IAAM,SACnC5R,EACAC,EACAyB,EACAxB,EACA8R,EACC,CACD,MAAMhQ,EAAgB,KAAK,WAAW,SAChCiQ,EAAS,KAAK,WAAW,SAE/B,YAAK,WAAW,SAASjS,CAAO,EAChC,KAAK,WAAW,SAASC,CAAQ,EACjC,KAAK,WAAW,SAASyB,CAAS,EAClC,KAAK,WAAW,OAAOuQ,CAAM,EAC7B,KAAK,WAAW,UAAU,GAAG/R,CAAY,IAAI8R,CAAO,EAAE,EAE/ChQ,CACR,EAEA4P,GAAoB,UAAU,WAAa,SAAUM,EAAQC,EAAQ,CACpE,IAAIC,EAAU,KAAK,WAAWF,CAAM,EAChCE,GAAW,OACdA,EAAU,CAAA,GAEXA,EAAQ,KAAKD,CAAM,EAEnB,KAAK,WAAWD,CAAM,EAAIE,CAC3B,EAEAR,GAAoB,UAAU,kBAAoB,UAAY,CAC7D,MAAMvB,EAAS,IAAIkB,EACbc,EAAgB,OAAO,KAAK,KAAK,UAAU,EAAE,OACnDhC,EAAO,OAAOgC,CAAa,EAC3B,UAAW7Q,KAAO,KAAK,WAAY,CAClC,MAAM8Q,EAAS,KAAK,WAAW9Q,CAAG,EAC5B+Q,EAAkBD,EAAO,OAC/BjC,EAAO,OAAO,SAAS7O,CAAG,CAAC,EAC3B6O,EAAO,OAAOkC,CAAe,EAC7B,QAASxQ,EAAI,EAAGA,EAAIuQ,EAAO,OAAQvQ,IAClCsO,EAAO,OAAOiC,EAAOvQ,CAAC,CAAC,CAExB,CACD,OAAOsO,EAAO,QACf,EAGAuB,GAAoB,UAAU,eAAiB,SAAUY,EAAc,CACtE,YAAK,WAAa,IAAIjB,EAAWiB,CAAY,EACtC,IACR,EAGAZ,GAAoB,UAAU,cAAgB,SAAUY,EAAc,CACrE,YAAK,WAAa,IAAIjB,EAAWiB,CAAY,EACtC,IACR,EAGAZ,GAAoB,UAAU,cAAgB,SAAUY,EAAc,CACrE,MAAMnC,EAAS,IAAIkB,EAAWiB,CAAY,EAI1C,IAHAnC,EAAO,SAAW,EAClB,KAAK,WAAa,GAClBA,EAAO,QAAO,EAET,EAAAA,EAAO,OAAO,OAASA,EAAO,SAAW,IADjC,CAIZ,MAAM7O,EAAM6O,EAAO,UACbkC,EAAkBlC,EAAO,UAC/B,QAAStO,EAAI,EAAGA,EAAIwQ,EAAiBxQ,IAAK,CACzC,MAAMkO,EAAQI,EAAO,UACrB,KAAK,WAAW7O,EAAKyO,CAAK,CAC1B,CACD,CACD,OAAO,IACR,EAOA2B,GAAoB,UAAU,YAAc,SAAUa,EAAmB,CACxE,MAAMzQ,EAAgB,SAASyQ,CAAiB,EAChD,GAAI,MAAMzQ,CAAa,EAEtB,MAAO,GAER,MAAMiQ,EAAS,KAAK,WAAW,OAAOjQ,EAAgB,CAAC,EACvD,OAAO,KAAK,WAAW,UAAUiQ,CAAM,CACxC,ECvIA,MAAMS,EAAgB,CACrB,YAAYC,EAAmBC,EAAoB,CAClD,KAAK,kBAAoBD,EACzB,KAAK,mBAAqBC,EAG1B,KAAK,OAAS,IAAI,WAAWD,EAAoBC,EAAqB,CAAC,EACvE,KAAK,OAAO,CAAC,EAAID,EACjB,KAAK,OAAO,CAAC,EAAIC,CACjB,CACD,IAAIC,EAAYC,EAAajQ,EAAM,CAClC,MAAMjC,EAAQiS,EAAa,KAAK,mBAAqBC,EAAc,EACnE,GAAI,KAAK,OAAO,OAASlS,EAAQ,EAChC,KAAM,kCAEP,KAAK,OAAOA,CAAK,EAAIiC,CACrB,CACD,IAAIgQ,EAAYC,EAAa,CAC5B,MAAMlS,EAAQiS,EAAa,KAAK,mBAAqBC,EAAc,EACnE,GAAI,KAAK,OAAO,OAASlS,EAAQ,EAChC,KAAM,kCAEP,OAAO,KAAK,OAAOA,CAAK,CACxB,CACD,oBAAoBmS,EAAyB,CAC5C,KAAK,kBAAoBA,EAAwB,CAAC,EAClD,KAAK,mBAAqBA,EAAwB,CAAC,EACnD,KAAK,OAASA,CACd,CACF,CC3BA,SAASC,GACRC,EACAC,EACAC,EACAC,EACAC,EACC,CACD,KAAK,SAAWJ,EAChB,KAAK,WAAaC,EAClB,KAAK,iBAAmBC,EACxB,KAAK,YAAcC,EACnB,KAAK,WAAaC,CACnB,CCdA,SAASC,IAAsB,CAC9B,KAAK,IAAM,GACX,KAAK,aAAe,EACrB,CAOAA,GAAoB,KAAO,SAAUC,EAAmB,CACvD,MAAMC,EAAa,IAAIF,GACjBG,EAAgC,CAAA,EAEhCpD,EAAS,IAAIkB,EAAWgC,CAAiB,EAC/C,KAAOlD,EAAO,SAAW,EAAIA,EAAO,KAAI,GAAI,CAC3C,MAAM4C,EAAWQ,EAA8B,OACzCN,EAAmB9C,EAAO,MAC1B+C,EAAc/C,EAAO,MACrBgD,EAAahD,EAAO,SACpB6C,EAAa7C,EAAO,YAC1BoD,EAA8B,KAC7B,IAAIT,GACHC,EACAC,EACAC,EACAC,EACAC,CACA,CACJ,CACE,CAED,OAAAG,EAAW,KAAKC,CAA6B,EAEtCD,CACR,EAMAF,GAAoB,UAAU,KAAO,SAAUG,EAA+B,CAC7E,GAAIA,GAAiC,KAGrC,QAAS1R,EAAI,EAAGA,EAAI0R,EAA8B,OAAQ1R,IAAK,CAC9D,MAAM2R,EAAkBD,EAA8B1R,CAAC,EACvD,KAAK,IAAIA,CAAC,EAAI2R,EACd,KAAK,aAAaA,EAAgB,UAAU,EAAI3R,CAChD,CACF,EAOAuR,GAAoB,UAAU,kBAAoB,SAAUL,EAAU,CACrE,OAAO,KAAK,IAAIA,CAAQ,CACzB,EAOAK,GAAoB,UAAU,OAAS,SAAUJ,EAAY,CAC5D,MAAMD,EAAW,KAAK,aAAaC,CAAU,EAC7C,OAAID,GACI,IAGT,EAMAK,GAAoB,UAAU,SAAW,UAAY,CACpD,MAAMjD,EAAS,IAAIkB,EACnB,QAASxP,EAAI,EAAGA,EAAI,KAAK,IAAI,OAAQA,IAAK,CACzC,MAAM4R,EAAa,KAAK,IAAI5R,CAAC,EAC7BsO,EAAO,IAAIsD,EAAW,gBAAgB,EACtCtD,EAAO,IAAIsD,EAAW,WAAW,EACjCtD,EAAO,OAAOsD,EAAW,UAAU,EACnCtD,EAAO,UAAUsD,EAAW,UAAU,CACtC,CACD,OAAAtD,EAAO,OAAM,EACNA,EAAO,MACf,EC5FA,MAAMuD,GAAmB,UAOzB,SAASC,IAAsB,CAC9B,KAAK,uBAAyB,IAAI,WAAW,KAAK,EAClD,KAAK,wBAA0B,IAAI,YAAY,KAAK,EACpD,KAAK,sBAAwB,IAC9B,CASAA,GAAoB,KAAO,SAC1BC,EACAC,EACAR,EACC,CACD,MAAMS,EAAW,IAAIH,GACrB,OAAAG,EAAS,uBAAyBF,EAClCE,EAAS,wBAA0BD,EACnCC,EAAS,sBAAwBV,GAAoB,KAAKC,CAAiB,EACpES,CACR,EAEAH,GAAoB,kBAAoB,SACvCZ,EACAgB,EACC,CACD,MAAMC,EAAWD,EAAoB,CAAC,EAChCE,EAAS,SAASF,EAAoB,CAAC,CAAC,EACxCG,EAAW,SAASH,EAAoB,CAAC,CAAC,EAC1CZ,EAAa,SAASY,EAAoB,CAAC,CAAC,EAClD,GAAI,CAAC,SAASE,CAAM,GAAMA,IAAW,GAAKA,IAAW,EACpD,eAAQ,IAAI,6CAA6CA,CAAM,EAAE,EAC1D,KAER,GAAI,CAAC,SAASC,CAAQ,GAAMA,IAAa,GAAKA,IAAa,EAC1D,eAAQ,IAAI,4CAA4CA,CAAQ,EAAE,EAC3D,KAER,GAAI,CAAC,SAASf,CAAU,GAAKA,EAAa,EACzC,eAAQ,IAAI,0CAA0CA,CAAU,EAAE,EAC3D,KAER,MAAMgB,EAAYF,IAAW,EACvBf,EAAcgB,IAAa,EAEjC,OAAO,IAAIpB,GACVC,EACAiB,EACAG,EACAjB,EACAC,CACF,CACA,EAEAQ,GAAoB,qBAAuB,SAAUS,EAAyB,CAC7E,MAAMjP,EAAQ,SAASiP,EAAwB,CAAC,CAAC,EAC3CC,EAAmBD,EAAwB,CAAC,EAC5CE,EACL,EAAIF,EAAwB,OAASA,EAAwB,MAAM,CAAC,EAAI,GACzE,OAAI,CAAC,SAASjP,CAAK,GAAKA,EAAQ,GAAKA,EAAQ,QAC5C,QAAQ,IAAI,yCAAyCA,CAAK,EAAE,EAEtD,CACN,MAAOA,EACP,QAASkP,EACT,WAAYC,CACd,CACA,EAEAX,GAAoB,0BAA4B,SAC/CS,EACC,CACD,MAAMjP,EAAQ,SAASiP,EAAwB,CAAC,CAAC,EAC3CvK,EAAM,SAASuK,EAAwB,CAAC,CAAC,EACzCC,EAAmBD,EAAwB,CAAC,EAC5CE,EACL,EAAIF,EAAwB,OAASA,EAAwB,MAAM,CAAC,EAAI,GACzE,OAAI,CAAC,SAASjP,CAAK,GAAKA,EAAQ,GAAKA,EAAQ,QAC5C,QAAQ,IAAI,yCAAyCA,CAAK,EAAE,GAEzD,CAAC,SAAS0E,CAAG,GAAKA,EAAM,GAAKA,EAAM,QACtC,QAAQ,IAAI,yCAAyCA,CAAG,EAAE,EAEpD,CACN,MAAO1E,EACP,IAAK0E,EACL,QAASwK,EACT,WAAYC,CACd,CACA,EAMAX,GAAoB,UAAU,qBAAuB,SACpDY,EACC,CAED,IAAIC,EACJ,GAAID,GAAoB,KACvB,QAAS1S,EAAI,EAAGA,EAAI0S,EAAiB,OAAQ1S,IAAK,CACjD,MAAMqQ,EAAUqC,EAAiB1S,CAAC,EAC5BgI,EAAMqI,EAAQ,KAAOA,EAAQ,MACnC,IAAKsC,EAAatC,EAAQ,MAAOsC,GAAc3K,EAAK2K,IAAc,CAEjE,KAAK,uBAAuBA,CAAU,EACrC,KAAK,sBAAsB,OAAOtC,EAAQ,OAAO,EAElD,QAAS5P,EAAI,EAAGA,EAAI4P,EAAQ,WAAW,OAAQ5P,IAAK,CACnD,IAAImS,EAAS,KAAK,wBAAwBD,CAAU,EACpD,MAAMF,EAAsBpC,EAAQ,WAAW5P,CAAC,EAChD,GAAIgS,GAAuB,KAC1B,SAED,MAAMvB,EACL,KAAK,sBAAsB,OAAOuB,CAAmB,EACtD,GAAIvB,GAAY,KACf,SAED,MAAM2B,EAAe,GAAK3B,EAC1B0B,EAASA,EAASC,EAClB,KAAK,wBAAwBF,CAAU,EAAIC,CAC3C,CACD,CACD,CAEF,MAAME,EAAa,KAAK,sBAAsB,OAAOjB,EAAgB,EACrE,GAAIiB,GAAc,KAGlB,IACCH,EAAa,EACbA,EAAa,KAAK,uBAAuB,OACzCA,IAGI,KAAK,uBAAuBA,CAAU,IAAM,IAE/C,KAAK,uBAAuBA,CAAU,EAAI,GAAKG,EAGlD,EAOAhB,GAAoB,UAAU,yBAA2B,SAAUlT,EAAI,CACtE,MAAMmU,EAAU,CAAA,EAOVjF,EAAOlP,EAAG,WAAW,CAAC,EAC5B,IAAIoU,EAKJ,GAJIlF,EAAO,KAAK,wBAAwB,SACvCkF,EAAU,KAAK,wBAAwBlF,CAAI,GAGxCkF,GAAW,MAAQA,IAAY,EAClC,OAAOD,EAGR,QAASE,EAAM,EAAGA,EAAM,GAAIA,IAE3B,GAAKD,GAAY,GAAKC,IAAU,KAAO,EAAG,CACzC,MAAMtB,EAAkB,KAAK,sBAAsB,kBAAkBsB,CAAG,EACxE,GAAItB,GAAmB,KACtB,SAEDoB,EAAQ,KAAKpB,CAAe,CAC5B,CAEF,OAAOoB,CACR,EAOAjB,GAAoB,UAAU,OAAS,SAAUlT,EAAI,CACpD,IAAIsS,EAEJ,MAAMpD,EAAOlP,EAAG,WAAW,CAAC,EAC5B,OAAIH,GAAqB,gBAAgBG,CAAE,EAE1CsS,EAAW,KAAK,sBAAsB,OAAOW,EAAgB,EACnD/D,EAAO,KAAK,uBAAuB,SAC7CoD,EAAW,KAAK,uBAAuBpD,CAAI,GAGxCoD,GAAY,OACfA,EAAW,KAAK,sBAAsB,OAAOW,EAAgB,GAGvD,KAAK,sBAAsB,kBAAkBX,CAAQ,CAC7D,EC/MA,SAASgC,IAAoB,CAC5B,KAAK,WAAa,IAAI1D,EAAW,GAAK,KAAO,IAAI,EACjD,KAAK,WAAa,GAClB,KAAK,WAAa,IAAIA,EAAW,GAAK,KAAO,IAAI,EACjD,KAAK,qBAAuB,IAC7B,CAGA0D,GAAkB,UAAY,OAAO,OAAOrD,GAAoB,SAAS,EAEzEqD,GAAkB,UAAU,oBAAsB,SACjDC,EACC,CACD,YAAK,qBAAuBA,EACrB,IACR,EAEAD,GAAkB,UAAU,OAAS,SAAUtU,EAAI,CAClD,OAAO,KAAK,qBAAqB,OAAOA,CAAE,CAC3C,EAEAsU,GAAkB,UAAU,yBAA2B,SAAUtU,EAAI,CACpE,OAAO,KAAK,qBAAqB,yBAAyBA,CAAE,CAC7D,EAEAsU,GAAkB,UAAU,wBAA0B,SACrDE,EACAC,EACAC,EACAvB,EACAC,EACAR,EACC,CACD,KAAK,eAAe4B,CAAU,EAC9B,KAAK,cAAcC,CAAc,EACjC,KAAK,cAAcC,CAAc,EACjC,KAAK,qBAAuBxB,GAAoB,KAC/CC,EACAC,EACAR,CACF,CACA,ECpCA,SAAS+B,GACRC,EACAC,EACA7S,EACA8S,EACC,CACGF,EACH,KAAK,KAAOA,EAEZ,KAAK,KAAOG,WAAQ,CAAC,EAAE,MAAM,CAAC,CAAE,EAAG,GAAI,EAAG,CAAC,CAAE,CAAC,EAE3CF,EACH,KAAK,sBAAwBA,EAE7B,KAAK,sBAAwB,IAAI5D,GAE9BjP,EACH,KAAK,iBAAmBA,EAGxB,KAAK,iBAAmB,IAAI+P,GAAgB,EAAG,CAAC,EAE7C+C,EACH,KAAK,mBAAqBA,EAE1B,KAAK,mBAAqB,IAAIR,EAEhC,CAGAK,GAAoB,UAAU,SAAW,SAAUvH,EAAaC,EAAc,CAC7E,YAAK,KAAO2H,GAAAA,KAAK5H,EAAaC,CAAY,EACnC,IACR,EAEAsH,GAAoB,UAAU,0BAA4B,SACzDM,EACAC,EACAC,EACC,CACD,YAAK,sBAAsB,eAAeF,CAAiB,EAC3D,KAAK,sBAAsB,cAAcC,CAAU,EACnD,KAAK,sBAAsB,cAAcC,CAAiB,EACnD,IACR,EAEAR,GAAoB,UAAU,oBAAsB,SAAUS,EAAW,CACxE,YAAK,iBAAiB,oBAAoBA,CAAS,EAC5C,IACR,EAEAT,GAAoB,UAAU,wBAA0B,SACvDH,EACAC,EACAC,EACAvB,EACAC,EACAR,EACC,CACD,YAAK,mBAAmB,wBACvB4B,EACAC,EACAC,EACAvB,EACAC,EACAR,CACF,EACQ,IACR,EC/EA,SAASyC,MAAQC,EAAM,CACtB,OAAOA,EAAK,KAAK,GAAG,CACrB,CAEA,MAAMC,EAAiB,CAItB,YAAYC,EAAU,CAIrB,KAAK,IAAM,IAAIb,GAIf,KAAK,SAAWa,CAChB,CAMD,MAAM,gBAAgBC,EAAO,CAC5B,MAAM,IAAI,MAAM,wDAAwD,CACxE,CAED,MAAM,MAAO,CACZ,MAAMhV,EAAM,KAAK,IACX+U,EAAW,KAAK,SAChBE,EAAkB,KAAK,gBACvBC,EAAkCC,GACvCF,EAAgBL,GAAKG,EAAUI,CAAQ,CAAC,EAEzC,aAAM,QAAQ,IAAI,EAChB,SAAY,CACZ,MAAMlG,EAAS,MAAMiG,EAAS,QAAQ,EAChCP,EAAY,IAAI,WAAW1F,CAAM,EACvCjP,EAAI,oBAAoB2U,CAAS,CACrC,GAAO,GACH,SAAY,CACZ,KAAM,CAAChI,EAAaC,CAAY,EAAI,MAAM,QAAQ,IACjD,CAAC,WAAY,WAAW,EAAE,IAAIsI,CAAQ,CAC3C,EACIlV,EAAI,SAAS,IAAI,WAAW2M,CAAW,EAAG,IAAI,WAAWC,CAAY,CAAC,CAC1E,GAAO,GACH,SAAY,CACZ,MAAMwI,EAAU,MAAM,QAAQ,IAC7B,CACC,UACA,cACA,cACA,eACA,iBACA,gBACN,EAAO,IAAIF,CAAQ,CACnB,EACUnB,EAAa,IAAI,WAAWqB,EAAQ,CAAC,CAAC,EACtCpB,EAAiB,IAAI,WAAWoB,EAAQ,CAAC,CAAC,EAC1CnB,EAAiB,IAAI,WAAWmB,EAAQ,CAAC,CAAC,EAC1C1C,EAAiB,IAAI,WAAW0C,EAAQ,CAAC,CAAC,EAC1CzC,EAAwB,IAAI,YAAYyC,EAAQ,CAAC,CAAC,EAClDjD,EAAoB,IAAI,WAAWiD,EAAQ,CAAC,CAAC,EAEnDpV,EAAI,wBACH+T,EACAC,EACAC,EACAvB,EACAC,EACAR,CACL,CACA,GAAO,CACP,CAAG,EAEMnS,CACP,CACF,CCxEA,SAASqV,GAAgBpG,EAAQ,CAChC,OAAO,IAAI,QAAQ,CAACqG,EAASC,IAAW,CACvCvK,GACC,IAAI,WAAWiE,CAAM,EACrB,CACC,QAAS,EACT,EACD,SAAUzL,EAAKgS,EAAa,CACvBhS,EACH+R,EAAO/R,CAAG,EAEV8R,EAAQE,EAAY,MAAM,CAE3B,CACJ,CACA,CAAE,CACF,CAOA,MAAMC,WAAgCX,EAAiB,CAMtD,MAAM,gBAAgBY,EAAK,CAC1B,MAAMC,EAAM,MAAM,MAAMD,CAAG,EAC3B,GAAI,CAACC,EAAI,GAAI,MAAM,IAAI,MAAMA,EAAI,UAAU,EAC3C,MAAMjL,EAAO,MAAMiL,EAAI,cAEvB,OADqB,MAAMN,GAAgB3K,CAAI,CAE/C,CACF,CClCA,SAASkL,GAAiBC,EAAQ,CAC7BA,EAAO,SAAW,KACrB,KAAK,SAAW,QAEhB,KAAK,SAAWA,EAAO,OAEzB,CAMAD,GAAiB,UAAU,MAAQ,SAAUE,EAAU,CACvC,IAAIhB,GAAiB,KAAK,QAAQ,EAE/C,KAAM,EACN,KAAM9U,GAAQ8V,EAAS,KAAM,IAAIxT,GAAUtC,CAAG,CAAC,CAAC,EAChD,MAAOwD,GAAQsS,EAAStS,EAAK,IAAI,CAAC,CACrC,ECrBA,SAASuS,IAAyB,CACjC,KAAK,MAAQ,EACb,KAAK,gBAAkB,IACxB,CAEAA,GAAuB,UAAU,QAAU,SAAUC,EAAM,CAC1D,GAAI,KAAK,QAAU,EAAG,CACrB,MAAMC,EAAaD,EAAK,MAAM,GAAG,EAC3BzE,EAAoB0E,EAAW,CAAC,EAChCzE,EAAqByE,EAAW,CAAC,EAEvC,GAAI1E,EAAoB,GAAKC,EAAqB,EACjD,KAAM,4BAGP,YAAK,gBAAkB,IAAIF,GAC1BC,EACAC,CACH,EACE,KAAK,QACE,IACP,CAED,MAAM0E,EAAQF,EAAK,MAAM,GAAG,EAE5B,GAAIE,EAAM,SAAW,EACpB,OAAO,KAGR,MAAMzE,EAAa,SAASyE,EAAM,CAAC,CAAC,EAC9BxE,EAAc,SAASwE,EAAM,CAAC,CAAC,EAC/BzU,EAAO,SAASyU,EAAM,CAAC,CAAC,EAE9B,GACCzE,EAAa,GACbC,EAAc,GACd,CAAC,SAASD,CAAU,GACpB,CAAC,SAASC,CAAW,GACrB,KAAK,gBAAgB,mBAAqBD,GAC1C,KAAK,gBAAgB,oBAAsBC,EAE3C,KAAM,4BAGP,YAAK,gBAAgB,IAAID,EAAYC,EAAajQ,CAAI,EACtD,KAAK,QACE,IACR,EAEAsU,GAAuB,UAAU,MAAQ,UAAY,CACpD,OAAO,KAAK,eACb,ECtDA,MAAMI,GAAuB,8BACvBC,GACL,oDACKC,GACL,uEAMD,SAASC,IAA6B,CACrC,KAAK,SAAW,IAAI7D,GACpB,KAAK,SAAS,sBAAwB,IAAIP,GAC1C,KAAK,8BAAgC,GACrC,KAAK,iBAAmB,EACzB,CAEAoE,GAA2B,UAAU,QAAU,SAAUN,EAAM,CAC9D,MAAMnD,EAAsBsD,GAAqB,KAAKH,CAAI,EAC1D,GAAInD,GAAuB,KAAM,CAChC,MAAMhB,EAAW,KAAK,8BAA8B,OAC9CU,EAAaE,GAAoB,kBACtCZ,EACAgB,CACH,EACE,GAAIN,GAAc,KACjB,OAED,KAAK,8BAA8B,KAAKA,CAAU,EAClD,MACA,CACD,MAAMW,EAA0BkD,GAAyB,KAAKJ,CAAI,EAClE,GAAI9C,GAA2B,KAAM,CACpC,MAAMlC,EAAUyB,GAAoB,qBACnCS,CACH,EACE,KAAK,iBAAiB,KAAKlC,CAAO,CAClC,CACD,MAAMuF,EACLF,GAA+B,KAAKL,CAAI,EACzC,GAAIO,GAAiC,KAAM,CAC1C,MAAMC,EAAgB/D,GAAoB,0BACzC8D,CACH,EACE,KAAK,iBAAiB,KAAKC,CAAa,CACxC,CACF,EAEAF,GAA2B,UAAU,MAAQ,UAAY,CAExD,YAAK,SAAS,sBAAsB,KAAK,KAAK,6BAA6B,EAC3E,KAAK,SAAS,qBAAqB,KAAK,gBAAgB,EACjD,KAAK,QACb,ECrCA,SAASG,IAAoB,CAG5B,KAAK,YAAc,GACnB,KAAK,YAAc,GACnB,KAAK,WAAa,IAAIV,GACtB,KAAK,WAAa,IAAIO,EACvB,CAEAG,GAAkB,UAAU,uBAAyB,SAAUT,EAAM,CACpE,MAAMU,EAAYV,EAAK,MAAM,GAAG,EAChC,YAAK,YAAY,KAAKU,CAAS,EACxB,IACR,EAMAD,GAAkB,UAAU,kBAAoB,SAAUT,EAAM,CAC/D,YAAK,WAAW,QAAQA,CAAI,EACrB,IACR,EAEAS,GAAkB,UAAU,eAAiB,SAAUT,EAAM,CAC5D,YAAK,WAAW,QAAQA,CAAI,EACrB,IACR,EAMAS,GAAkB,UAAU,cAAgB,SAAUT,EAAM,CAC3D,YAAK,YAAY,KAAKA,EAAK,MAAM,GAAG,CAAC,EAC9B,IACR,EAEAS,GAAkB,UAAU,MAAQ,UAAY,CAC/C,MAAME,EAAe,KAAK,2BACpBtC,EAAqB,KAAK,yBAEhC,OAAO,IAAIH,GACVyC,EAAa,KACbA,EAAa,sBACb,KAAK,WAAW,MAAO,EACvBtC,CACF,CACA,EAOAoC,GAAkB,UAAU,yBAA2B,UAAY,CAClE,MAAMrC,EAAwB,IAAI5D,GAG5BE,EAAqB0D,EAAsB,gBAChD,KAAK,WACP,EAEOD,EAAO,KAAK,mBAElB,UAAWvT,KAAiB8P,EAAoB,CAC/C,MAAM5R,EAAe4R,EAAmB9P,CAAa,EAC/CP,EAAU8T,EAAK,OAAOrV,CAAY,EAOxCsV,EAAsB,WAAW/T,EAASO,CAAa,CACvD,CAED,MAAO,CACN,KAAMuT,EACN,sBAAuBC,CACzB,CACA,EAEAqC,GAAkB,UAAU,uBAAyB,UAAY,CAChE,MAAMG,EAAiB,IAAI/C,GAGrBnD,EAAqBkG,EAAe,gBAAgB,KAAK,WAAW,EAEpEhE,EAAW,KAAK,WAAW,MAAK,EAEtCgE,EAAe,oBAAoBhE,CAAQ,EAE3C,UAAWhS,KAAiB8P,EAAoB,CAC/C,MAAMoB,EAAapB,EAAmB9P,CAAa,EAC7CiR,EAAWe,EAAS,sBAAsB,OAAOd,CAAU,EAOjE8E,EAAe,WAAW/E,EAAUjR,CAAa,CACjD,CAED,OAAOgW,CACR,EAOAH,GAAkB,UAAU,iBAAmB,UAAY,CAC1D,IAAIpW,EAAU,EACd,MAAMwW,EAAQ,KAAK,YAAY,IAAI,SAAUlG,EAAO,CAEnD,MAAO,CAAE,EADYA,EAAM,CAAC,EACF,EAAGtQ,GAAS,CACxC,CAAE,EAGD,OADgByW,GAAAA,QAAS,KAAO,IAAI,EACrB,MAAMD,CAAK,CAC3B,ECzIA,MAAME,GAAW,CAChB,QAAS,SAAUlB,EAAQ,CAC1B,OAAO,IAAID,GAAiBC,CAAM,CAClC,EACD,kBAAmB,UAAY,CAC9B,OAAO,IAAIY,EACX,CACF,sQC9BC,SAASO,EAAE,CAA4D9G,EAAA,QAAe8G,EAAG,CAAwO,GAAG,UAAU,CAA2B,OAAQ,UAAU,CAAC,SAAS7S,EAAEd,EAAE5C,EAAE2H,EAAE,CAAC,SAAS,EAAEzH,EAAEqW,EAAE,CAAC,GAAG,CAACvW,EAAEE,CAAC,EAAE,CAAC,GAAG,CAAC0C,EAAE1C,CAAC,EAAE,CAAC,IAAIoC,EAAc,OAAOkU,IAAnB,YAA4BA,GAAQ,GAAG,CAACD,GAAGjU,EAAE,OAAOA,EAAEpC,EAAE,EAAE,EAAE,GAAGuW,EAAE,OAAOA,EAAEvW,EAAE,EAAE,EAAE,IAAIiF,EAAE,IAAI,MAAM,uBAAuBjF,EAAE,GAAG,EAAE,MAAMiF,EAAE,KAAK,mBAAmBA,CAAC,CAAC,IAAIE,EAAErF,EAAEE,CAAC,EAAE,CAAC,QAAQ,CAAA,CAAE,EAAE0C,EAAE1C,CAAC,EAAE,CAAC,EAAE,KAAKmF,EAAE,QAAQ,SAAS3B,EAAE,CAAC,IAAI1D,EAAE4C,EAAE1C,CAAC,EAAE,CAAC,EAAEwD,CAAC,EAAE,OAAO,EAAE1D,GAAG0D,CAAC,CAAC,EAAE2B,EAAEA,EAAE,QAAQ3B,EAAEd,EAAE5C,EAAE2H,CAAC,CAAC,CAAC,OAAO3H,EAAEE,CAAC,EAAE,OAAO,CAAC,QAAQuW,EAAc,OAAOD,IAAnB,YAA4BA,GAAQtW,EAAE,EAAEA,EAAEyH,EAAE,OAAOzH,IAAI,EAAEyH,EAAEzH,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,OAAOwD,CAAC,EAAI,EAAC,CAAC,EAAE,CAAC,SAAS8S,EAAQ/G,EAAOiH,EAAQ,CACj2BjH,EAAO,QAAU+G,EAAQ,qBAAqB,CAE9C,EAAE,CAAC,sBAAsB,CAAC,CAAC,EAAE,EAAE,CAAC,SAASA,EAAQ/G,EAAOiH,EAAQ,CAQhE,IAAIC,EAAW,SAAUD,EAAS,CAGhC,IAAIE,EAAK,OAAO,UACZC,EAASD,EAAG,eACZE,EACAC,EAAU,OAAO,QAAW,WAAa,OAAS,CAAA,EAClDC,EAAiBD,EAAQ,UAAY,aACrCE,EAAsBF,EAAQ,eAAiB,kBAC/CG,EAAoBH,EAAQ,aAAe,gBAE/C,SAASI,EAAOC,EAAKzX,EAAKyO,EAAO,CAC/B,cAAO,eAAegJ,EAAKzX,EAAK,CAC9B,MAAOyO,EACP,WAAY,GACZ,aAAc,GACd,SAAU,EAChB,CAAK,EACMgJ,EAAIzX,CAAG,CACf,CACD,GAAI,CAEFwX,EAAO,CAAA,EAAI,EAAE,CACd,MAAa,CACZA,EAAS,SAASC,EAAKzX,EAAKyO,EAAO,CACjC,OAAOgJ,EAAIzX,CAAG,EAAIyO,CACxB,CACG,CAED,SAASiJ,EAAKC,EAASC,EAASC,EAAMC,EAAa,CAEjD,IAAIC,EAAiBH,GAAWA,EAAQ,qBAAqBI,EAAYJ,EAAUI,EAC/EC,EAAY,OAAO,OAAOF,EAAe,SAAS,EAClDG,EAAU,IAAIC,EAAQL,GAAe,CAAE,CAAA,EAI3C,OAAAG,EAAU,QAAUG,GAAiBT,EAASE,EAAMK,CAAO,EAEpDD,CACR,CACDlB,EAAQ,KAAOW,EAYf,SAASW,EAASxP,EAAI4O,EAAKzH,EAAK,CAC9B,GAAI,CACF,MAAO,CAAE,KAAM,SAAU,IAAKnH,EAAG,KAAK4O,EAAKzH,CAAG,EAC/C,OAAQ5M,EAAK,CACZ,MAAO,CAAE,KAAM,QAAS,IAAKA,CAAG,CACjC,CACF,CAED,IAAIkV,EAAyB,iBACzBC,EAAyB,iBACzBC,EAAoB,YACpBC,EAAoB,YAIpBC,EAAmB,CAAA,EAMvB,SAASV,GAAY,CAAE,CACvB,SAASW,GAAoB,CAAE,CAC/B,SAASC,GAA6B,CAAE,CAIxC,IAAIC,EAAoB,CAAA,EACxBA,EAAkBxB,CAAc,EAAI,UAAY,CAC9C,OAAO,IACX,EAEE,IAAIyB,EAAW,OAAO,eAClBC,EAA0BD,GAAYA,EAASA,EAAShI,EAAO,CAAA,CAAE,CAAC,CAAC,EACnEiI,GACAA,IAA4B9B,GAC5BC,EAAO,KAAK6B,EAAyB1B,CAAc,IAGrDwB,EAAoBE,GAGtB,IAAIC,EAAKJ,EAA2B,UAClCZ,EAAU,UAAY,OAAO,OAAOa,CAAiB,EACvDF,EAAkB,UAAYK,EAAG,YAAcJ,EAC/CA,EAA2B,YAAcD,EACzCA,EAAkB,YAAcnB,EAC9BoB,EACArB,EACA,mBACJ,EAIE,SAAS0B,EAAsBC,EAAW,CACxC,CAAC,OAAQ,QAAS,QAAQ,EAAE,QAAQ,SAASC,EAAQ,CACnD3B,EAAO0B,EAAWC,EAAQ,SAASnJ,EAAK,CACtC,OAAO,KAAK,QAAQmJ,EAAQnJ,CAAG,CACvC,CAAO,CACP,CAAK,CACF,CAED+G,EAAQ,oBAAsB,SAASqC,EAAQ,CAC7C,IAAIC,EAAO,OAAOD,GAAW,YAAcA,EAAO,YAClD,OAAOC,EACHA,IAASV,IAGRU,EAAK,aAAeA,EAAK,QAAU,oBACpC,EACR,EAEEtC,EAAQ,KAAO,SAASqC,EAAQ,CAC9B,OAAI,OAAO,eACT,OAAO,eAAeA,EAAQR,CAA0B,GAExDQ,EAAO,UAAYR,EACnBpB,EAAO4B,EAAQ7B,EAAmB,mBAAmB,GAEvD6B,EAAO,UAAY,OAAO,OAAOJ,CAAE,EAC5BI,CACX,EAMErC,EAAQ,MAAQ,SAAS/G,EAAK,CAC5B,MAAO,CAAE,QAASA,EACtB,EAEE,SAASsJ,EAAcrB,EAAWsB,EAAa,CAC7C,SAAS5G,EAAOwG,EAAQnJ,EAAKkF,EAASC,EAAQ,CAC5C,IAAInI,EAASqL,EAASJ,EAAUkB,CAAM,EAAGlB,EAAWjI,CAAG,EACvD,GAAIhD,EAAO,OAAS,QAClBmI,EAAOnI,EAAO,GAAG,MACZ,CACL,IAAIgC,EAAShC,EAAO,IAChByB,EAAQO,EAAO,MACnB,OAAIP,GACA,OAAOA,GAAU,UACjByI,EAAO,KAAKzI,EAAO,SAAS,EACvB8K,EAAY,QAAQ9K,EAAM,OAAO,EAAE,KAAK,SAASA,EAAO,CAC7DkE,EAAO,OAAQlE,EAAOyG,EAASC,CAAM,CACtC,EAAE,SAAS/R,EAAK,CACfuP,EAAO,QAASvP,EAAK8R,EAASC,CAAM,CAChD,CAAW,EAGIoE,EAAY,QAAQ9K,CAAK,EAAE,KAAK,SAAS+K,EAAW,CAIzDxK,EAAO,MAAQwK,EACftE,EAAQlG,CAAM,CACf,EAAE,SAASyK,EAAO,CAGjB,OAAO9G,EAAO,QAAS8G,EAAOvE,EAASC,CAAM,CACvD,CAAS,CACF,CACF,CAED,IAAIuE,EAEJ,SAASC,EAAQR,EAAQnJ,EAAK,CAC5B,SAAS4J,GAA6B,CACpC,OAAO,IAAIL,EAAY,SAASrE,EAASC,EAAQ,CAC/CxC,EAAOwG,EAAQnJ,EAAKkF,EAASC,CAAM,CAC7C,CAAS,CACF,CAED,OAAOuE,EAaLA,EAAkBA,EAAgB,KAChCE,EAGAA,CACD,EAAGA,EAA0B,CACjC,CAID,KAAK,QAAUD,CAChB,CAEDV,EAAsBK,EAAc,SAAS,EAC7CA,EAAc,UAAUhC,CAAmB,EAAI,UAAY,CACzD,OAAO,IACX,EACEP,EAAQ,cAAgBuC,EAKxBvC,EAAQ,MAAQ,SAASY,EAASC,EAASC,EAAMC,EAAayB,EAAa,CACrEA,IAAgB,SAAQA,EAAc,SAE1C,IAAIM,EAAO,IAAIP,EACb5B,EAAKC,EAASC,EAASC,EAAMC,CAAW,EACxCyB,CACN,EAEI,OAAOxC,EAAQ,oBAAoBa,CAAO,EACtCiC,EACAA,EAAK,KAAI,EAAG,KAAK,SAAS7K,EAAQ,CAChC,OAAOA,EAAO,KAAOA,EAAO,MAAQ6K,EAAK,MACnD,CAAS,CACT,EAEE,SAASzB,GAAiBT,EAASE,EAAMK,EAAS,CAChD,IAAI4B,EAAQxB,EAEZ,OAAO,SAAgBa,EAAQnJ,EAAK,CAClC,GAAI8J,IAAUtB,EACZ,MAAM,IAAI,MAAM,8BAA8B,EAGhD,GAAIsB,IAAUrB,EAAmB,CAC/B,GAAIU,IAAW,QACb,MAAMnJ,EAKR,OAAO+J,GAAU,CAClB,CAKD,IAHA7B,EAAQ,OAASiB,EACjBjB,EAAQ,IAAMlI,IAED,CACX,IAAIgK,EAAW9B,EAAQ,SACvB,GAAI8B,EAAU,CACZ,IAAIC,EAAiBC,EAAoBF,EAAU9B,CAAO,EAC1D,GAAI+B,EAAgB,CAClB,GAAIA,IAAmBvB,EAAkB,SACzC,OAAOuB,CACR,CACF,CAED,GAAI/B,EAAQ,SAAW,OAGrBA,EAAQ,KAAOA,EAAQ,MAAQA,EAAQ,YAE9BA,EAAQ,SAAW,QAAS,CACrC,GAAI4B,IAAUxB,EACZ,MAAAwB,EAAQrB,EACFP,EAAQ,IAGhBA,EAAQ,kBAAkBA,EAAQ,GAAG,CAE/C,MAAmBA,EAAQ,SAAW,UAC5BA,EAAQ,OAAO,SAAUA,EAAQ,GAAG,EAGtC4B,EAAQtB,EAER,IAAIxL,EAASqL,EAASV,EAASE,EAAMK,CAAO,EAC5C,GAAIlL,EAAO,OAAS,SAAU,CAO5B,GAJA8M,EAAQ5B,EAAQ,KACZO,EACAF,EAEAvL,EAAO,MAAQ0L,EACjB,SAGF,MAAO,CACL,MAAO1L,EAAO,IACd,KAAMkL,EAAQ,IAC1B,CAEA,MAAmBlL,EAAO,OAAS,UACzB8M,EAAQrB,EAGRP,EAAQ,OAAS,QACjBA,EAAQ,IAAMlL,EAAO,IAExB,CACP,CACG,CAMD,SAASkN,EAAoBF,EAAU9B,EAAS,CAC9C,IAAIiB,EAASa,EAAS,SAAS9B,EAAQ,MAAM,EAC7C,GAAIiB,IAAWhC,EAAW,CAKxB,GAFAe,EAAQ,SAAW,KAEfA,EAAQ,SAAW,QAAS,CAE9B,GAAI8B,EAAS,SAAS,SAGpB9B,EAAQ,OAAS,SACjBA,EAAQ,IAAMf,EACd+C,EAAoBF,EAAU9B,CAAO,EAEjCA,EAAQ,SAAW,SAGrB,OAAOQ,EAIXR,EAAQ,OAAS,QACjBA,EAAQ,IAAM,IAAI,UAChB,gDAAgD,CACnD,CAED,OAAOQ,CACR,CAED,IAAI1L,EAASqL,EAASc,EAAQa,EAAS,SAAU9B,EAAQ,GAAG,EAE5D,GAAIlL,EAAO,OAAS,QAClB,OAAAkL,EAAQ,OAAS,QACjBA,EAAQ,IAAMlL,EAAO,IACrBkL,EAAQ,SAAW,KACZQ,EAGT,IAAIyB,EAAOnN,EAAO,IAElB,GAAI,CAAEmN,EACJ,OAAAjC,EAAQ,OAAS,QACjBA,EAAQ,IAAM,IAAI,UAAU,kCAAkC,EAC9DA,EAAQ,SAAW,KACZQ,EAGT,GAAIyB,EAAK,KAGPjC,EAAQ8B,EAAS,UAAU,EAAIG,EAAK,MAGpCjC,EAAQ,KAAO8B,EAAS,QAQpB9B,EAAQ,SAAW,WACrBA,EAAQ,OAAS,OACjBA,EAAQ,IAAMf,OAKhB,QAAOgD,EAKT,OAAAjC,EAAQ,SAAW,KACZQ,CACR,CAIDO,EAAsBD,CAAE,EAExBxB,EAAOwB,EAAIzB,EAAmB,WAAW,EAOzCyB,EAAG3B,CAAc,EAAI,UAAW,CAC9B,OAAO,IACX,EAEE2B,EAAG,SAAW,UAAW,CACvB,MAAO,oBACX,EAEE,SAASoB,EAAaC,EAAM,CAC1B,IAAI9J,EAAQ,CAAE,OAAQ8J,EAAK,CAAC,CAAC,EAEzB,KAAKA,IACP9J,EAAM,SAAW8J,EAAK,CAAC,GAGrB,KAAKA,IACP9J,EAAM,WAAa8J,EAAK,CAAC,EACzB9J,EAAM,SAAW8J,EAAK,CAAC,GAGzB,KAAK,WAAW,KAAK9J,CAAK,CAC3B,CAED,SAAS+J,EAAc/J,EAAO,CAC5B,IAAIvD,EAASuD,EAAM,YAAc,GACjCvD,EAAO,KAAO,SACd,OAAOA,EAAO,IACduD,EAAM,WAAavD,CACpB,CAED,SAASmL,EAAQL,EAAa,CAI5B,KAAK,WAAa,CAAC,CAAE,OAAQ,MAAQ,CAAA,EACrCA,EAAY,QAAQsC,EAAc,IAAI,EACtC,KAAK,MAAM,EAAI,CAChB,CAEDrD,EAAQ,KAAO,SAASwD,EAAQ,CAC9B,IAAItN,EAAO,CAAA,EACX,QAASjN,KAAOua,EACdtN,EAAK,KAAKjN,CAAG,EAEf,OAAAiN,EAAK,QAAO,EAIL,SAASuN,GAAO,CACrB,KAAOvN,EAAK,QAAQ,CAClB,IAAIjN,EAAMiN,EAAK,MACf,GAAIjN,KAAOua,EACT,OAAAC,EAAK,MAAQxa,EACbwa,EAAK,KAAO,GACLA,CAEV,CAKD,OAAAA,EAAK,KAAO,GACLA,CACb,CACA,EAEE,SAAS1J,EAAO2J,EAAU,CACxB,GAAIA,EAAU,CACZ,IAAIC,EAAiBD,EAASpD,CAAc,EAC5C,GAAIqD,EACF,OAAOA,EAAe,KAAKD,CAAQ,EAGrC,GAAI,OAAOA,EAAS,MAAS,WAC3B,OAAOA,EAGT,GAAI,CAAC,MAAMA,EAAS,MAAM,EAAG,CAC3B,IAAIla,EAAI,GAAIia,EAAO,SAASA,GAAO,CACjC,KAAO,EAAEja,EAAIka,EAAS,QACpB,GAAIvD,EAAO,KAAKuD,EAAUla,CAAC,EACzB,OAAAia,EAAK,MAAQC,EAASla,CAAC,EACvBia,EAAK,KAAO,GACLA,EAIX,OAAAA,EAAK,MAAQrD,EACbqD,EAAK,KAAO,GAELA,CACjB,EAEQ,OAAOA,EAAK,KAAOA,CACpB,CACF,CAGD,MAAO,CAAE,KAAMT,GAChB,CACDhD,EAAQ,OAASjG,EAEjB,SAASiJ,IAAa,CACpB,MAAO,CAAE,MAAO5C,EAAW,KAAM,EAAI,CACtC,CAED,OAAAgB,EAAQ,UAAY,CAClB,YAAaA,EAEb,MAAO,SAASwC,EAAe,CAc7B,GAbA,KAAK,KAAO,EACZ,KAAK,KAAO,EAGZ,KAAK,KAAO,KAAK,MAAQxD,EACzB,KAAK,KAAO,GACZ,KAAK,SAAW,KAEhB,KAAK,OAAS,OACd,KAAK,IAAMA,EAEX,KAAK,WAAW,QAAQmD,CAAa,EAEjC,CAACK,EACH,QAASC,KAAQ,KAEXA,EAAK,OAAO,CAAC,IAAM,KACnB1D,EAAO,KAAK,KAAM0D,CAAI,GACtB,CAAC,MAAM,CAACA,EAAK,MAAM,CAAC,CAAC,IACvB,KAAKA,CAAI,EAAIzD,EAIpB,EAED,KAAM,UAAW,CACf,KAAK,KAAO,GAEZ,IAAI0D,EAAY,KAAK,WAAW,CAAC,EAC7BC,EAAaD,EAAU,WAC3B,GAAIC,EAAW,OAAS,QACtB,MAAMA,EAAW,IAGnB,OAAO,KAAK,IACb,EAED,kBAAmB,SAASC,EAAW,CACrC,GAAI,KAAK,KACP,MAAMA,EAGR,IAAI7C,EAAU,KACd,SAAS8C,EAAOC,EAAKC,EAAQ,CAC3B,OAAAlO,EAAO,KAAO,QACdA,EAAO,IAAM+N,EACb7C,EAAQ,KAAO+C,EAEXC,IAGFhD,EAAQ,OAAS,OACjBA,EAAQ,IAAMf,GAGT,CAAC,CAAE+D,CACX,CAED,QAAS3a,EAAI,KAAK,WAAW,OAAS,EAAGA,GAAK,EAAG,EAAEA,EAAG,CACpD,IAAIgQ,EAAQ,KAAK,WAAWhQ,CAAC,EACzByM,EAASuD,EAAM,WAEnB,GAAIA,EAAM,SAAW,OAInB,OAAOyK,EAAO,KAAK,EAGrB,GAAIzK,EAAM,QAAU,KAAK,KAAM,CAC7B,IAAI4K,EAAWjE,EAAO,KAAK3G,EAAO,UAAU,EACxC6K,EAAalE,EAAO,KAAK3G,EAAO,YAAY,EAEhD,GAAI4K,GAAYC,EAAY,CAC1B,GAAI,KAAK,KAAO7K,EAAM,SACpB,OAAOyK,EAAOzK,EAAM,SAAU,EAAI,EAC7B,GAAI,KAAK,KAAOA,EAAM,WAC3B,OAAOyK,EAAOzK,EAAM,UAAU,CAGjC,SAAU4K,GACT,GAAI,KAAK,KAAO5K,EAAM,SACpB,OAAOyK,EAAOzK,EAAM,SAAU,EAAI,UAG3B6K,GACT,GAAI,KAAK,KAAO7K,EAAM,WACpB,OAAOyK,EAAOzK,EAAM,UAAU,MAIhC,OAAM,IAAI,MAAM,wCAAwC,CAE3D,CACF,CACF,EAED,OAAQ,SAAShS,EAAMyR,EAAK,CAC1B,QAASzP,EAAI,KAAK,WAAW,OAAS,EAAGA,GAAK,EAAG,EAAEA,EAAG,CACpD,IAAIgQ,EAAQ,KAAK,WAAWhQ,CAAC,EAC7B,GAAIgQ,EAAM,QAAU,KAAK,MACrB2G,EAAO,KAAK3G,EAAO,YAAY,GAC/B,KAAK,KAAOA,EAAM,WAAY,CAChC,IAAI8K,EAAe9K,EACnB,KACD,CACF,CAEG8K,IACC9c,IAAS,SACTA,IAAS,aACV8c,EAAa,QAAUrL,GACvBA,GAAOqL,EAAa,aAGtBA,EAAe,MAGjB,IAAIrO,EAASqO,EAAeA,EAAa,WAAa,CAAA,EAItD,OAHArO,EAAO,KAAOzO,EACdyO,EAAO,IAAMgD,EAETqL,GACF,KAAK,OAAS,OACd,KAAK,KAAOA,EAAa,WAClB3C,GAGF,KAAK,SAAS1L,CAAM,CAC5B,EAED,SAAU,SAASA,EAAQsO,EAAU,CACnC,GAAItO,EAAO,OAAS,QAClB,MAAMA,EAAO,IAGf,OAAIA,EAAO,OAAS,SAChBA,EAAO,OAAS,WAClB,KAAK,KAAOA,EAAO,IACVA,EAAO,OAAS,UACzB,KAAK,KAAO,KAAK,IAAMA,EAAO,IAC9B,KAAK,OAAS,SACd,KAAK,KAAO,OACHA,EAAO,OAAS,UAAYsO,IACrC,KAAK,KAAOA,GAGP5C,CACR,EAED,OAAQ,SAAS6C,EAAY,CAC3B,QAAShb,EAAI,KAAK,WAAW,OAAS,EAAGA,GAAK,EAAG,EAAEA,EAAG,CACpD,IAAIgQ,EAAQ,KAAK,WAAWhQ,CAAC,EAC7B,GAAIgQ,EAAM,aAAegL,EACvB,YAAK,SAAShL,EAAM,WAAYA,EAAM,QAAQ,EAC9C+J,EAAc/J,CAAK,EACZmI,CAEV,CACF,EAED,MAAS,SAAS8C,EAAQ,CACxB,QAASjb,EAAI,KAAK,WAAW,OAAS,EAAGA,GAAK,EAAG,EAAEA,EAAG,CACpD,IAAIgQ,EAAQ,KAAK,WAAWhQ,CAAC,EAC7B,GAAIgQ,EAAM,SAAWiL,EAAQ,CAC3B,IAAIxO,EAASuD,EAAM,WACnB,GAAIvD,EAAO,OAAS,QAAS,CAC3B,IAAIyO,EAASzO,EAAO,IACpBsN,EAAc/J,CAAK,CACpB,CACD,OAAOkL,CACR,CACF,CAID,MAAM,IAAI,MAAM,uBAAuB,CACxC,EAED,cAAe,SAAShB,EAAUiB,EAAYC,EAAS,CACrD,YAAK,SAAW,CACd,SAAU7K,EAAO2J,CAAQ,EACzB,WAAYiB,EACZ,QAASC,CACjB,EAEU,KAAK,SAAW,SAGlB,KAAK,IAAMxE,GAGNuB,CACR,CACL,EAMS3B,CAER,EAKC,OAAOjH,GAAW,SAAWA,EAAO,QAAU,CAAE,CAClD,EAEA,GAAI,CACF,mBAAqBkH,CACtB,MAA8B,CAU7B,SAAS,IAAK,wBAAwB,EAAEA,CAAO,CAChD,CAED,EAAE,CAAA,CAAE,EAAE,EAAE,CAAC,SAASH,EAAQ/G,EAAOiH,EAAQ,CAGzC,OAAO,eAAeA,EAAS,aAAc,CAC3C,MAAO,EACT,CAAC,EACDA,EAAQ,QAAU,OAElB,IAAI6E,EAAeC,EAAuBhF,EAAQ,4BAA4B,CAAC,EAE3EiF,EAAQjF,EAAQ,QAAQ,EAE5B,SAASgF,EAAuBpE,EAAK,CACnC,OAAOA,GAAOA,EAAI,WAAaA,EAAM,CACnC,QAASA,CACb,CACC,CAED,SAASsE,EAAQtE,EAAK,CACpB,0BAEA,OAAI,OAAO,QAAW,YAAc,OAAO,OAAO,UAAa,SAC7DsE,EAAU,SAAiBtE,EAAK,CAC9B,OAAO,OAAOA,CACpB,EAEIsE,EAAU,SAAiBtE,EAAK,CAC9B,OAAOA,GAAO,OAAO,QAAW,YAAcA,EAAI,cAAgB,QAAUA,IAAQ,OAAO,UAAY,SAAW,OAAOA,CAC/H,EAGSsE,EAAQtE,CAAG,CACnB,CAED,SAASuE,EAAmBC,EAAK/G,EAASC,EAAQ+G,EAAOC,EAAQnc,EAAKgQ,EAAK,CACzE,GAAI,CACF,IAAImK,EAAO8B,EAAIjc,CAAG,EAAEgQ,CAAG,EACnBvB,EAAQ0L,EAAK,KAClB,OAAQV,EAAO,CACdtE,EAAOsE,CAAK,EACZ,MACD,CAEGU,EAAK,KACPjF,EAAQzG,CAAK,EAEb,QAAQ,QAAQA,CAAK,EAAE,KAAKyN,EAAOC,CAAM,CAE5C,CAED,SAASC,EAAkBvT,EAAI,CAC7B,OAAO,UAAY,CACjB,IAAIgP,EAAO,KACPwE,EAAO,UACX,OAAO,IAAI,QAAQ,SAAUnH,EAASC,EAAQ,CAC5C,IAAI8G,EAAMpT,EAAG,MAAMgP,EAAMwE,CAAI,EAE7B,SAASH,EAAMzN,EAAO,CACpBuN,EAAmBC,EAAK/G,EAASC,EAAQ+G,EAAOC,EAAQ,OAAQ1N,CAAK,CACtE,CAED,SAAS0N,EAAO/Y,EAAK,CACnB4Y,EAAmBC,EAAK/G,EAASC,EAAQ+G,EAAOC,EAAQ,QAAS/Y,CAAG,CACrE,CAED8Y,EAAM,MAAS,CACrB,CAAK,CACL,CACC,CAED,SAASI,EAAgBC,EAAUC,EAAa,CAC9C,GAAI,EAAED,aAAoBC,GACxB,MAAM,IAAI,UAAU,mCAAmC,CAE1D,CAED,SAASC,EAAkB9L,EAAQ+L,EAAO,CACxC,QAASnc,EAAI,EAAGA,EAAImc,EAAM,OAAQnc,IAAK,CACrC,IAAIoc,EAAaD,EAAMnc,CAAC,EACxBoc,EAAW,WAAaA,EAAW,YAAc,GACjDA,EAAW,aAAe,GACtB,UAAWA,IAAYA,EAAW,SAAW,IACjD,OAAO,eAAehM,EAAQgM,EAAW,IAAKA,CAAU,CACzD,CACF,CAED,SAASC,EAAaJ,EAAaK,EAAYC,EAAa,CAC1D,OAAID,GAAYJ,EAAkBD,EAAY,UAAWK,CAAU,EAE5DL,CACR,CAMD,IAAIO,EAAyB,UAAY,CAKvC,SAASA,GAAY,CACnBT,EAAgB,KAAMS,CAAS,EAE/B,KAAK,UAAY,IAClB,CASD,OAAAH,EAAaG,EAAW,CAAC,CACvB,IAAK,OACL,MAAO,UAAY,CACjB,IAAIC,EAAQZ,EAAgCR,EAAa,QAAQ,KAAK,SAASqB,EAAQC,EAAU,CAC/F,OAAOtB,EAAa,QAAQ,KAAK,SAAkBuB,EAAU,CAC3D,OACE,OAAQA,EAAS,KAAOA,EAAS,KAAI,CACnC,IAAK,GACH,GAAI,EAAE,CAACD,GAAYnB,EAAQmB,CAAQ,IAAM,UAAY,OAAOA,EAAS,MAAS,YAAc,OAAOA,EAAS,OAAU,YAAa,CACjIC,EAAS,KAAO,EAChB,KACD,CAED,MAAM,IAAI,MAAM,mCAAmC,EAErD,IAAK,GACH,GAAM,KAAK,WAAa,KAAO,CAC7BA,EAAS,KAAO,GAChB,KACD,CAED,OAAAA,EAAS,KAAO,EACTD,EAAS,OAElB,IAAK,GACH,KAAK,UAAYA,EACjBC,EAAS,KAAO,GAChB,MAEF,IAAK,IACH,MAAM,IAAI,MAAM,yCAAyC,EAE3D,IAAK,IACL,IAAK,MACH,OAAOA,EAAS,MACnB,CAEb,EAAWF,EAAS,IAAI,CACjB,CAAA,CAAC,EAEF,SAAS3T,EAAK8T,EAAI,CAChB,OAAOJ,EAAM,MAAM,KAAM,SAAS,CACnC,CAED,OAAO1T,CACb,EAAO,CAeP,EAAK,CACD,IAAK,UACL,MAAO,UAAY,CACjB,IAAI+T,EAAWjB,EAAgCR,EAAa,QAAQ,KAAK,SAAS0B,EAASre,EAAKse,EAAS,CACvG,IAAIC,EAAgBC,EAAWnb,EAAQob,EAAYC,EAAIC,EAAKC,EAAUC,EAAIC,GAAMC,EAAUC,EAAQC,EAAKC,EAAW5d,EAAG6d,GAASC,EAASC,EAAkBC,EAAM5b,EAAG6b,EAAKC,EAASC,EAAWC,EAAIC,EAAIC,EAAI7P,EAAQ8P,EAAIC,EAAIC,GAAIC,GAAIC,GAAIC,GACnO,OAAOvD,EAAa,QAAQ,KAAK,SAAmBwD,EAAW,CAC7D,OACE,OAAQA,EAAU,KAAOA,EAAU,KAAI,CACrC,IAAK,GASH,GARA7B,EAAUA,GAAW,GACrBA,EAAQ,GAAKA,EAAQ,IAAM,WAC3BA,EAAQ,KAAOA,EAAQ,MAAQ,SAC/BA,EAAQ,aAAeA,EAAQ,cAAgBzB,EAAM,oBAAoB,QACzEyB,EAAQ,gBAAkBA,EAAQ,iBAAmB,IACrDA,EAAQ,cAAgBA,EAAQ,eAAiB,IACjDte,EAAMA,GAAO,GAEP,CAAC,WAAY,WAAY,QAAQ,EAAE,QAAQse,EAAQ,EAAE,IAAM,GAAK,CACpE6B,EAAU,KAAO,EACjB,KACD,CAED,MAAM,IAAI,MAAM,2BAA2B,EAE7C,IAAK,GACH,GAAM,CAAC,SAAU,SAAU,YAAa,UAAU,EAAE,QAAQ7B,EAAQ,IAAI,IAAM,GAAK,CACjF6B,EAAU,KAAO,GACjB,KACD,CAED,MAAM,IAAI,MAAM,0BAA0B,EAE5C,IAAK,IAKH,GAJA5B,EAAiB,OAAO,KAAK1B,EAAM,mBAAmB,EAAE,IAAI,SAAU7Y,GAAG,CACvE,OAAO6Y,EAAM,oBAAoB7Y,EAAC,CACpD,CAAiB,EAEKua,EAAe,QAAQD,EAAQ,YAAY,IAAM,GAAK,CAC1D6B,EAAU,KAAO,GACjB,KACD,CAED,MAAM,IAAI,MAAM,8BAA8B,EAEhD,IAAK,IACH,OAAAA,EAAU,KAAO,GACV,KAAK,UAAU,MAAMngB,CAAG,EAEjC,IAAK,IAIH,GAHAwe,EAAY2B,EAAU,KACtB9c,KAAawZ,EAAM,aAAa2B,CAAS,EAErC,EAAEF,EAAQ,OAAS,UAAYA,EAAQ,OAAS,UAAW,CAC7D6B,EAAU,KAAO,GACjB,KACD,CAEDA,EAAU,GAAK7B,EAAQ,GACvB6B,EAAU,KAAOA,EAAU,KAAO,WAAa,GAAKA,EAAU,KAAO,SAAW,GAAKA,EAAU,KAAO,WAAa,GAAK,GACxH,MAEF,IAAK,IACH,GAAM7B,EAAQ,OAAS,SAAW,CAChC6B,EAAU,KAAO,GACjB,KACD,CAED,OAAOA,EAAU,OAAO,SAAU9c,EAAO,IAAI,SAAUN,GAAO,CAC5D,OAAOA,GAAM,OAC/B,CAAiB,EAAE,KAAK,EAAE,CAAC,EAEb,IAAK,IACH,OAAOod,EAAU,OAAO,SAAU9c,EAAO,IAAI,SAAUN,GAAO,CAC5D,OAAOA,GAAM,OAC/B,CAAiB,EAAE,KAAK,GAAG,CAAC,EAEd,IAAK,IAaH,GAZA0b,EAAa,SAAoB1b,GAAO,CACtC,IAAIqd,GAEJ,SAAQvD,EAAM,aAAa9Z,GAAM,YAAY,EAC3Cqd,GAAWrd,GAAM,eAAiBA,GAAM,QAExCqd,GAAWrd,GAAM,gBAGR8Z,EAAM,aAAauD,GAAU9B,EAAQ,YAAY,CAC9E,EAEsBA,EAAQ,OAAS,SAAW,CAChC6B,EAAU,KAAO,GACjB,KACD,CAED,OAAOA,EAAU,OAAO,SAAU9c,EAAO,IAAIob,CAAU,EAAE,KAAK,EAAE,CAAC,EAEnE,IAAK,IACH,OAAO0B,EAAU,OAAO,SAAU9c,EAAO,IAAIob,CAAU,EAAE,KAAK,GAAG,CAAC,EAEpE,IAAK,IACH,IAAKC,EAAK,EAAGA,EAAKrb,EAAO,OAAQqb,IAC/B,MAAQ7B,EAAM,UAAUxZ,EAAOqb,CAAE,EAAE,YAAY,EAC7C,GAAI,IAAK7B,EAAM,aAAaxZ,EAAOqb,CAAE,EAAE,YAAY,EACjDrb,EAAOqb,CAAE,EAAE,WAAc7B,EAAM,eAAexZ,EAAOqb,CAAE,EAAE,OAAO,MAC3D,CAML,IAJArb,EAAOqb,CAAE,EAAE,WAAc7B,EAAM,eAAexZ,EAAOqb,CAAE,EAAE,OAAO,EAChEC,EAAM,GACNC,EAAW,GAENC,EAAK,EAAGA,EAAKxb,EAAOqb,CAAE,EAAE,aAAa,OAAQG,OACxChC,EAAM,SAASxZ,EAAOqb,CAAE,EAAE,aAAaG,CAAE,CAAC,EAChDD,GAAY,OAEZA,MAAgB/B,EAAM,YAAYxZ,EAAOqb,CAAE,EAAE,aAAaG,CAAE,CAAC,KAAQhC,EAAM,eAAexZ,EAAOqb,CAAE,EAAE,aAAaG,CAAE,CAAC,EAAIxb,EAAOqb,CAAE,EAAE,aAAaG,CAAE,EAOvJ,GAHAC,GAAO,IAAI,OAAOF,CAAQ,EAC1BG,EAAWD,GAAK,KAAKzb,EAAOqb,CAAE,EAAE,OAAO,EAEnCK,EAAU,CAGZ,IAFAC,EAAS,EAEJC,EAAM,EAAGA,EAAM5b,EAAOqb,CAAE,EAAE,aAAa,OAAQO,OAC1CpC,EAAM,SAASxZ,EAAOqb,CAAE,EAAE,aAAaO,CAAG,CAAC,GACjDN,GAAOI,EAASC,EAAS,CAAC,EAC1BA,KAEAL,GAAOtb,EAAOqb,CAAE,EAAE,aAAaO,CAAG,EAItC5b,EAAOqb,CAAE,EAAE,QAAUC,CACtB,CACF,MAEDtb,EAAOqb,CAAE,EAAE,QAAUrb,EAAOqb,CAAE,EAAE,aAIpC,GAAMJ,EAAQ,OAAS,SAAW,CAChC6B,EAAU,KAAO,GACjB,KACD,CAED,OAAOA,EAAU,OAAO,SAAU9c,EAAO,IAAI,SAAUN,GAAO,CAC5D,OAAOA,GAAM,OAC/B,CAAiB,EAAE,KAAK,EAAE,CAAC,EAEb,IAAK,IACH,OAAOod,EAAU,OAAO,SAAU9c,EAAO,IAAI,SAAUN,GAAO,CAC5D,OAAOA,GAAM,OAC/B,CAAiB,EAAE,KAAK,GAAG,CAAC,EAEd,IAAK,IACH,MAAM,IAAI,MAAM,yBAAyB,EAE3C,IAAK,IACHod,EAAU,KAAO,GACjB,MAEF,IAAK,IACH,GAAI,EAAE7B,EAAQ,OAAS,aAAeA,EAAQ,OAAS,YAAa,CAClE6B,EAAU,KAAO,GACjB,KACD,CAEDjB,EAAY,CAAA,EAEZ5d,EAAI,EAEN,IAAK,IACH,GAAI,EAAEA,EAAI+B,EAAO,QAAS,CACxB8c,EAAU,KAAO,GACjB,KACD,CAEDhB,MAActC,EAAM,YAAYxZ,EAAO/B,CAAC,EAAE,YAAY,EACtD6e,EAAU,GAAKhB,GACfgB,EAAU,KAAOA,EAAU,KAAO,EAAI,GAAKA,EAAU,KAAO,EAAI,GAAKA,EAAU,KAAO,EAAI,GAAKA,EAAU,KAAO,EAAI,GAAK,GACzH,MAEF,IAAK,IACH,OAAAjB,EAAU,KAAK,CAAC7b,EAAO/B,CAAC,EAAE,aAAc,KAAOub,EAAM,eAAexZ,EAAO/B,CAAC,EAAE,OAAO,EAAG+B,EAAO/B,CAAC,EAAE,eAAiB+B,EAAO/B,CAAC,EAAE,OAAO,CAAC,EAC9H6e,EAAU,OAAO,QAAS,EAAE,EAErC,IAAK,IAKH,IAJAf,EAAU,GACVC,EAAmB,GACnBC,EAAO,CAAA,EAEF5b,EAAI,EAAGA,EAAIL,EAAO/B,CAAC,EAAE,aAAa,OAAQoC,OACrCmZ,EAAM,SAASxZ,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,CAAC,EACzC2b,EAMHC,EAAKA,EAAK,OAAS,CAAC,GAAKjc,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,GAJjD2b,EAAmB,GACnBD,GAAW,OACXE,EAAK,KAAKjc,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,CAAC,IAKrC2b,EAAmB,GACnBC,EAAK,KAAKjc,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,CAAC,EACnC0b,MAAevC,EAAM,YAAYxZ,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,CAAC,KAAQmZ,EAAM,eAAexZ,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,CAAC,EAAIL,EAAO/B,CAAC,EAAE,aAAaoC,CAAC,GAOhJ,GAHA6b,EAAM,IAAI,OAAO,IAAI,OAAOH,EAAS,GAAG,CAAC,EACzCI,EAAUD,EAAI,QAAS1C,EAAM,eAAexZ,EAAO/B,CAAC,EAAE,OAAO,CAAC,EAE1Dke,EAGF,IAFAC,EAAY,EAEPC,EAAK,EAAGA,EAAKJ,EAAK,OAAQI,OACrB7C,EAAM,SAASyC,EAAKI,CAAE,EAAE,CAAC,CAAC,GAChCR,EAAU,KAAK,CAACI,EAAKI,CAAE,EAAG,EAAGF,EAAQC,CAAS,KAAO5C,EAAM,eAAe2C,EAAQC,CAAS,CAAC,CAAC,CAAC,EAC9FA,GAAa,GAEbP,EAAU,KAAK,CAACI,EAAKI,CAAE,EAAG,KAAO7C,EAAM,eAAeyC,EAAKI,CAAE,CAAC,KAAO7C,EAAM,eAAeyC,EAAKI,CAAE,CAAC,CAAC,CAAC,OAIxGR,EAAU,KAAK,CAAC7b,EAAO/B,CAAC,EAAE,aAAc,KAAOub,EAAM,eAAexZ,EAAO/B,CAAC,EAAE,OAAO,EAAG+B,EAAO/B,CAAC,EAAE,eAAiB+B,EAAO/B,CAAC,EAAE,OAAO,CAAC,EAGvI,OAAO6e,EAAU,OAAO,QAAS,EAAE,EAErC,IAAK,IACH,IAAKR,EAAK,EAAGA,EAAKtc,EAAO/B,CAAC,EAAE,aAAa,OAAQqe,IAC/CT,EAAU,KAAK,CAAC7b,EAAO/B,CAAC,EAAE,aAAaqe,CAAE,EAAG,KAAO9C,EAAM,eAAexZ,EAAO/B,CAAC,EAAE,QAAQqe,CAAE,CAAC,EAAGtc,EAAO/B,CAAC,EAAE,eAAiB+B,EAAO/B,CAAC,EAAE,cAAcqe,CAAE,GAAKtc,EAAO/B,CAAC,EAAE,QAAQqe,CAAE,CAAC,CAAC,EAGlL,OAAOQ,EAAU,OAAO,QAAS,EAAE,EAErC,IAAK,IACH,IAAKP,EAAK,EAAGA,EAAKvc,EAAO/B,CAAC,EAAE,aAAa,OAAQse,IAC/CV,EAAU,KAAK,CAAC7b,EAAO/B,CAAC,EAAE,aAAase,CAAE,EAAG,EAAGvc,EAAO/B,CAAC,EAAE,aAAase,CAAE,EAAGvc,EAAO/B,CAAC,EAAE,aAAase,CAAE,CAAC,CAAC,EAGxG,OAAOO,EAAU,OAAO,QAAS,EAAE,EAErC,IAAK,IACH,MAAM,IAAI,MAAM,iBAAiB,EAEnC,IAAK,IACH7e,IACA6e,EAAU,KAAO,GACjB,MAEF,IAAK,IACHpQ,EAAS,GACToQ,EAAU,GAAK7B,EAAQ,GACvB6B,EAAU,KAAOA,EAAU,KAAO,WAAa,GAAKA,EAAU,KAAO,SAAW,GAAKA,EAAU,KAAO,WAAa,GAAK,GACxH,MAEF,IAAK,IACH,GAAI7B,EAAQ,OAAS,YACnB,IAAKuB,EAAK,EAAGA,EAAKX,EAAU,OAAQW,IAC9BX,EAAUW,CAAE,EAAE,CAAC,IAAM,EACvB9P,GAAUmP,EAAUW,CAAE,EAAE,CAAC,EAEzB9P,GAAUmP,EAAUW,CAAE,EAAE,CAAC,EAAIvB,EAAQ,mBAAsBzB,EAAM,eAAeqC,EAAUW,CAAE,EAAE,CAAC,CAAC,EAAIvB,EAAQ,kBAKhH,KAAKwB,EAAK,EAAGA,EAAKZ,EAAU,OAAQY,IAC9BZ,EAAUY,CAAE,EAAE,CAAC,IAAM,EACvB/P,GAAUmP,EAAUY,CAAE,EAAE,CAAC,EAEzB/P,GAAU,SAAS,OAAOmP,EAAUY,CAAE,EAAE,CAAC,EAAG,MAAM,EAAE,OAAOxB,EAAQ,gBAAiB,WAAW,EAAE,UAAWzB,EAAM,eAAeqC,EAAUY,CAAE,EAAE,CAAC,CAAC,EAAG,WAAW,EAAE,OAAOxB,EAAQ,cAAe,cAAc,EAKnN,OAAO6B,EAAU,OAAO,SAAUpQ,CAAM,EAE1C,IAAK,IACH,GAAIuO,EAAQ,OAAS,YACnB,IAAKyB,GAAK,EAAGA,GAAKb,EAAU,OAAQa,KAC9Bb,EAAUa,EAAE,EAAE,CAAC,IAAM,EACvBhQ,GAAUmP,EAAUa,EAAE,EAAE,CAAC,EAEzBhQ,GAAUmP,EAAUa,EAAE,EAAE,CAAC,EAAIzB,EAAQ,mBAAsBzB,EAAM,aAAaqC,EAAUa,EAAE,EAAE,CAAC,EAAGzB,EAAQ,YAAY,EAAIA,EAAQ,kBAG/H,CAIL,IAFAvO,GAAU,SAELiQ,GAAK,EAAGA,GAAKd,EAAU,OAAQc,KAClCjQ,GAAU,GAAG,OAAOmP,EAAUc,EAAE,EAAE,CAAC,EAAG,MAAM,EAAE,OAAO1B,EAAQ,gBAAiB,WAAW,EAAE,UAAWzB,EAAM,aAAaqC,EAAUc,EAAE,EAAE,CAAC,EAAG1B,EAAQ,YAAY,EAAG,WAAW,EAAE,OAAOA,EAAQ,cAAe,OAAO,EAGtNvO,GAAU,SACX,CAED,OAAOoQ,EAAU,OAAO,SAAUpQ,CAAM,EAE1C,IAAK,IACH,GAAIuO,EAAQ,OAAS,YACnB,IAAK2B,GAAK,EAAGA,GAAKf,EAAU,OAAQe,KAC9Bf,EAAUe,EAAE,EAAE,CAAC,IAAM,EACvBlQ,GAAUmP,EAAUe,EAAE,EAAE,CAAC,EAEzBlQ,GAAUmP,EAAUe,EAAE,EAAE,CAAC,EAAI3B,EAAQ,gBAAkBY,EAAUe,EAAE,EAAE,CAAC,EAAI3B,EAAQ,kBAKtF,KAAK4B,GAAK,EAAGA,GAAKhB,EAAU,OAAQgB,KAC9BhB,EAAUgB,EAAE,EAAE,CAAC,IAAM,EACvBnQ,GAAUmP,EAAUgB,EAAE,EAAE,CAAC,EAEzBnQ,GAAU,SAAS,OAAOmP,EAAUgB,EAAE,EAAE,CAAC,EAAG,MAAM,EAAE,OAAO5B,EAAQ,gBAAiB,WAAW,EAAE,OAAOY,EAAUgB,EAAE,EAAE,CAAC,EAAG,WAAW,EAAE,OAAO5B,EAAQ,cAAe,cAAc,EAKzL,OAAO6B,EAAU,OAAO,SAAUpQ,CAAM,EAE1C,IAAK,IACH,MAAM,IAAI,MAAM,2BAA2B,EAE7C,IAAK,IACL,IAAK,MACH,OAAOoQ,EAAU,MACpB,CAEb,EAAW9B,EAAU,IAAI,CAClB,CAAA,CAAC,EAEF,SAASgC,EAAQC,EAAKC,EAAK,CACzB,OAAOnC,EAAS,MAAM,KAAM,SAAS,CACtC,CAED,OAAOiC,CACb,EAAO,CACJ,CAAA,CAAC,EAEKvC,CACT,IAEI0C,EAAO,CACT,WAAY3D,EAAM,WAClB,WAAYA,EAAM,WAClB,OAAQA,EAAM,OACd,QAASA,EAAM,QACf,WAAYA,EAAM,WAClB,YAAaA,EAAM,YACnB,YAAaA,EAAM,YACnB,QAASA,EAAM,QACf,SAAUA,EAAM,SAChB,YAAaA,EAAM,YACnB,cAAeA,EAAM,cACrB,eAAgBA,EAAM,eACtB,aAAcA,EAAM,YACtB,EACAiB,EAAU,KAAO0C,EACjB,IAAIC,EAAW3C,EACfhG,EAAQ,QAAU2I,CAEjB,EAAC,CAAC,SAAS,EAAE,6BAA6B,CAAC,CAAC,EAAE,EAAE,CAAC,SAAS7I,EAAQ/G,EAAOiH,EAAQ,CAGlF,OAAO,eAAeA,EAAS,aAAc,CAC3C,MAAO,EACT,CAAC,EACDA,EAAQ,QAAU,OAElB,IAAI4I,EAAQ9D,EAAuBhF,EAAQ,QAAQ,CAAC,EAEpD,SAASgF,EAAuBpE,EAAK,CACnC,OAAOA,GAAOA,EAAI,WAAaA,EAAM,CACnC,QAASA,CACb,CACC,CAED,IAAIiI,EAAWC,EAAM,QACrB5I,EAAQ,QAAU2I,CAElB,EAAE,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,CAAC,SAAS7I,EAAQ/G,EAAOiH,EAAQ,CAGnD,OAAO,eAAeA,EAAS,aAAc,CAC3C,MAAO,EACT,CAAC,EACDA,EAAQ,aAAeA,EAAQ,eAAiBA,EAAQ,cAAgBA,EAAQ,YAAcA,EAAQ,cAAgBA,EAAQ,cAAgBA,EAAQ,YAAcA,EAAQ,SAAWA,EAAQ,QAAUA,EAAQ,YAAcA,EAAQ,YAAcA,EAAQ,WAAaA,EAAQ,QAAUA,EAAQ,OAASA,EAAQ,WAAaA,EAAQ,WAAaA,EAAQ,YAAcA,EAAQ,WAAaA,EAAQ,oBAAsB,OAEha,SAAS6I,EAAmBC,EAAK,CAC/B,OAAOC,EAAmBD,CAAG,GAAKE,EAAiBF,CAAG,GAAKG,EAA4BH,CAAG,GAAKI,GAChG,CAED,SAASA,GAAqB,CAC5B,MAAM,IAAI,UAAU;AAAA,mFAAsI,CAC3J,CAED,SAASD,EAA4Bra,EAAGua,EAAQ,CAC9C,GAAKva,EACL,IAAI,OAAOA,GAAM,SAAU,OAAOwa,EAAkBxa,EAAGua,CAAM,EAC7D,IAAI7f,EAAI,OAAO,UAAU,SAAS,KAAKsF,CAAC,EAAE,MAAM,EAAG,EAAE,EAErD,GADItF,IAAM,UAAYsF,EAAE,cAAatF,EAAIsF,EAAE,YAAY,MACnDtF,IAAM,OAASA,IAAM,MAAO,OAAO,MAAM,KAAKsF,CAAC,EACnD,GAAItF,IAAM,aAAe,2CAA2C,KAAKA,CAAC,EAAG,OAAO8f,EAAkBxa,EAAGua,CAAM,EAChH,CAED,SAASH,EAAiBlG,EAAM,CAC9B,GAAI,OAAO,OAAW,KAAeA,EAAK,OAAO,QAAQ,GAAK,MAAQA,EAAK,YAAY,GAAK,KAAM,OAAO,MAAM,KAAKA,CAAI,CACzH,CAED,SAASiG,EAAmBD,EAAK,CAC/B,GAAI,MAAM,QAAQA,CAAG,EAAG,OAAOM,EAAkBN,CAAG,CACrD,CAED,SAASM,EAAkBN,EAAKO,EAAK,EAC/BA,GAAO,MAAQA,EAAMP,EAAI,UAAQO,EAAMP,EAAI,QAE/C,QAAStf,EAAI,EAAG8f,EAAO,IAAI,MAAMD,CAAG,EAAG7f,EAAI6f,EAAK7f,IAC9C8f,EAAK9f,CAAC,EAAIsf,EAAItf,CAAC,EAGjB,OAAO8f,CACR,CAED,IAAIC,EAA0B,IAC1BC,EAA0B,GAC1BC,EAAsB,CACxB,OAAQ,SACR,SAAU,WACV,QAAS,SACX,EAQAzJ,EAAQ,oBAAsByJ,EAE9B,IAAIC,EAAa,SAAoBthB,EAAI,CACvC,OAAAA,EAAKA,EAAG,CAAC,EACFA,GAAM,KAAYA,GAAM,GACjC,EASA4X,EAAQ,WAAa0J,EAErB,IAAIC,EAAa,SAAoBvhB,EAAI,CACvC,OAAAA,EAAKA,EAAG,CAAC,EACFA,GAAM,KAAYA,GAAM,GACjC,EASA4X,EAAQ,WAAa2J,EAErB,IAAIC,EAAS,SAAgBxhB,EAAI,CAC/B,OAAOshB,EAAWthB,CAAE,GAAKuhB,EAAWvhB,CAAE,CACxC,EASA4X,EAAQ,OAAS4J,EAEjB,IAAIC,EAAU,SAAiBzhB,EAAI,CACjC,OAAAA,EAAKA,EAAG,CAAC,EACFA,GAAM,KAAYA,GAAM,KAAYA,GAAM,KAAYA,GAAM,KAAYA,GAAM,KAAYA,GAAM,GACzG,EASA4X,EAAQ,QAAU6J,EAElB,IAAIC,EAAa,SAAoB1hB,EAAI,CACvC,OAAOwhB,EAAOxhB,CAAE,GAAKyhB,EAAQzhB,CAAE,CACjC,EASA4X,EAAQ,WAAa8J,EAErB,IAAIC,EAAc,SAAqB7hB,EAAK,CAC1C,QAASsB,EAAI,EAAGA,EAAItB,EAAI,OAAQsB,IAC9B,GAAIkgB,EAAWxhB,EAAIsB,CAAC,CAAC,EAAG,MAAO,GAGjC,MAAO,EACT,EASAwW,EAAQ,YAAc+J,EAEtB,IAAIC,EAAc,SAAqB9hB,EAAK,CAC1C,QAASsB,EAAI,EAAGA,EAAItB,EAAI,OAAQsB,IAC9B,GAAImgB,EAAWzhB,EAAIsB,CAAC,CAAC,EAAG,MAAO,GAGjC,MAAO,EACT,EASAwW,EAAQ,YAAcgK,EAEtB,IAAIC,EAAU,SAAiB/hB,EAAK,CAClC,QAASsB,EAAI,EAAGA,EAAItB,EAAI,OAAQsB,IAC9B,GAAIogB,EAAO1hB,EAAIsB,CAAC,CAAC,EAAG,MAAO,GAG7B,MAAO,EACT,EASAwW,EAAQ,QAAUiK,EAElB,IAAIC,EAAW,SAAkBhiB,EAAK,CACpC,QAASsB,EAAI,EAAGA,EAAItB,EAAI,OAAQsB,IAC9B,GAAIqgB,EAAQ3hB,EAAIsB,CAAC,CAAC,EAAG,MAAO,GAG9B,MAAO,EACT,EASAwW,EAAQ,SAAWkK,EAEnB,IAAIC,EAAc,SAAqBjiB,EAAK,CAC1C,QAASsB,EAAI,EAAGA,EAAItB,EAAI,OAAQsB,IAC9B,GAAIsgB,EAAW5hB,EAAIsB,CAAC,CAAC,EAAG,MAAO,GAGjC,MAAO,EACT,EASAwW,EAAQ,YAAcmK,EAEtB,IAAIC,EAAgB,SAAuBliB,EAAK,CAC9C,OAAO2gB,EAAmB3gB,CAAG,EAAE,IAAI,SAAUE,EAAI,CAC/C,OAAIA,EAAK,KAAYA,EAAK,IACjB,OAAO,aAAaA,EAAG,WAAW,CAAC,EAAImhB,CAAuB,EAGhEnhB,CACX,CAAG,EAAE,KAAK,EAAE,CACZ,EASA4X,EAAQ,cAAgBoK,EAExB,IAAIC,EAAgB,SAAuBniB,EAAK,CAC9C,OAAO2gB,EAAmB3gB,CAAG,EAAE,IAAI,SAAUE,EAAI,CAC/C,OAAIA,EAAK,KAAYA,EAAK,IACjB,OAAO,aAAaA,EAAG,WAAW,CAAC,EAAIohB,CAAuB,EAGhEphB,CACX,CAAG,EAAE,KAAK,EAAE,CACZ,EAUA4X,EAAQ,cAAgBqK,EAExB,IAAIC,EAAc,SAAqBpiB,EAAKqiB,EAAQ,CAClDA,EAASA,GAAUd,EAAoB,QACvC,IAAIe,EAAe,CACjB,OAAQ,CAEN,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IAEL,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,IACH,EAAG,IAEH,IAAK,IAEL,GAAI,KAIJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,KAWJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAOJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAOJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,MACL,EACD,SAAU,CAER,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IAEL,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,IACH,EAAG,IACH,EAAG,IAEH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAEJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAGJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,KACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MAIJ,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,IACH,EAAG,IAEH,IAAK,IAmBL,EAAG,GA+DJ,EACD,QAAS,CAEP,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IAEL,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,IACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,MACH,EAAG,MACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KAEH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EAAG,KACH,EA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","x_google_ignoreList":[7,8,24]}