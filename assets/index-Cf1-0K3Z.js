const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./LyricEditor-BmfyCJHx.js","./naive-ui-B1s3zDcz.js","./vue-virtual-scroller.esm-BL7s1Wuc.js","./pixi-Cal6uEV8.js","./pixi-Cnq3xHD9.css","./LyricEditor-Dznh6pKe.css","./LyricSyncEditor-CVwpWnbO.js","./LyricSyncEditor-DHeUU9xy.css","./AMLLPreviewView-CNgp4rv2.js","./AMLLPreviewView-QBKdMel8.css"])))=>i.map(i=>d[i]);
var xM=Object.defineProperty;var kM=(vi,He,wi)=>He in vi?xM(vi,He,{enumerable:!0,configurable:!0,writable:!0,value:wi}):vi[He]=wi;var Fc=(vi,He,wi)=>kM(vi,typeof He!="symbol"?He+"":He,wi);import{d as Q,h as Xr,e as Vc,c as Dt,f as xe,F as Oe,i as Hc,o as hr,a as Gs,g as Qr,j as oo,r as Gt,s as Js,b as w,k as SM,l as W,n as Z,p as x,q as x1,t as Bt,v as Uc,x as TM,y as Zr,z as AM,A as MM,B as CM,C as LM,D as _M,E as De,G as xt,H as E,I as g,J as rt,N as gi,K as EM,L as Ie,M as tn,O as OM,P as k1,Q as S1,w as Xs,R as me,S as zc,U as so,V as ur,W as Qs,X as Ui,Y as DM,Z as dr,_ as fr,$ as zi,a0 as Zs,a1 as lo,a2 as ri,a3 as jc,a4 as PM,a5 as tl,a6 as RM,a7 as T1,a8 as BM,a9 as A1,aa as $c,ab as NM,ac as IM,ad as ao,ae as M1,af as WM,ag as FM,ah as C1,ai as VM,aj as co,ak as HM,al as UM,am as zM,an as jM,ao as $M,ap as qc,aq as Kc,ar as qM,as as KM,at as Yc,au as YM,av as GM,aw as JM,ax as XM,ay as QM,az as ZM}from"./naive-ui-B1s3zDcz.js";import{c as ho,g as tC}from"./pixi-Cal6uEV8.js";let Gc,en,rn,We,pr,ji,Fe,Jt,yi,Jc,nn,ie,ge,Xc,Ve,eC=(async()=>{(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();let vi,He,wi;vi="modulepreload",He=function(i,t){return new URL(i,t).href},wi={},nn=function(i,t,e){let r=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),l=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.allSettled(t.map(a=>{if(a=He(a,e),a in wi)return;wi[a]=!0;const c=a.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(e)for(let d=o.length-1;d>=0;d--){const f=o[d];if(f.href===a&&(!c||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${h}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":vi,c||(u.as="script"),u.crossOrigin="",u.href=a,l&&u.setAttribute("nonce",l),document.head.appendChild(u),c)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}function n(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return r.then(o=>{for(const s of o||[])s.status==="rejected"&&n(s.reason);return i().catch(n)})};const uo=typeof window<"u",bi=(i,t=!1)=>t?Symbol.for(i):Symbol(i),_1=(i,t,e)=>E1({l:i,k:t,s:e}),E1=i=>JSON.stringify(i).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),Nt=i=>typeof i=="number"&&isFinite(i),O1=i=>el(i)==="[object Date]",mr=i=>el(i)==="[object RegExp]",fo=i=>it(i)&&Object.keys(i).length===0,It=Object.assign;let Qc;const $i=()=>Qc||(Qc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zc(i){return i.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const D1=Object.prototype.hasOwnProperty;function po(i,t){return D1.call(i,t)}const At=Array.isArray,yt=i=>typeof i=="function",F=i=>typeof i=="string",ct=i=>typeof i=="boolean",ut=i=>i!==null&&typeof i=="object",P1=i=>ut(i)&&yt(i.then)&&yt(i.catch),th=Object.prototype.toString,el=i=>th.call(i),it=i=>el(i)==="[object Object]",R1=i=>i==null?"":At(i)||it(i)&&i.toString===th?JSON.stringify(i,null,2):String(i);function il(i,t=""){return i.reduce((e,r,n)=>n===0?e+r:e+t+r,"")}function B1(i,t){typeof console<"u"&&(console.warn("[intlify] "+i),t&&console.warn(t.stack))}const mo=i=>!ut(i)||At(i);function go(i,t){if(mo(i)||mo(t))throw new Error("Invalid value");const e=[{src:i,des:t}];for(;e.length;){const{src:r,des:n}=e.pop();Object.keys(r).forEach(o=>{ut(r[o])&&!ut(n[o])&&(n[o]=Array.isArray(r[o])?[]:{}),mo(n[o])||mo(r[o])?n[o]=r[o]:e.push({src:r[o],des:n[o]})})}}function N1(i,t,e){return{line:i,column:t,offset:e}}function rl(i,t,e){return{start:i,end:t}}const dt={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,UNHANDLED_CODEGEN_NODE_TYPE:15,UNHANDLED_MINIFIER_NODE_TYPE:16},I1=17;function yo(i,t,e={}){const{domain:r,messages:n,args:o}=e,s=i,l=new SyntaxError(String(s));return l.code=i,t&&(l.location=t),l.domain=r,l}function W1(i){throw i}const ni=" ",F1="\r",ae=`
`,V1="\u2028",H1="\u2029";function U1(i){const t=i;let e=0,r=1,n=1,o=0;const s=A=>t[A]===F1&&t[A+1]===ae,l=A=>t[A]===ae,a=A=>t[A]===H1,c=A=>t[A]===V1,h=A=>s(A)||l(A)||a(A)||c(A),u=()=>e,d=()=>r,f=()=>n,m=()=>o,v=A=>s(A)||a(A)||c(A)?ae:t[A],p=()=>v(e),y=()=>v(e+o);function b(){return o=0,h(e)&&(r++,n=0),s(e)&&e++,e++,n++,t[e]}function k(){return s(e+o)&&o++,o++,t[e+o]}function S(){e=0,r=1,n=1,o=0}function M(A=0){o=A}function L(){const A=e+o;for(;A!==e;)b();o=0}return{index:u,line:d,column:f,peekOffset:m,charAt:v,currentChar:p,currentPeek:y,next:b,peek:k,reset:S,resetPeek:M,skipToPeek:L}}const xi=void 0,iC=".",eh="'",z1="tokenizer";function j1(i,t={}){const e=t.location!==!1,r=U1(i),n=()=>r.index(),o=()=>N1(r.line(),r.column(),r.index()),s=o(),l=n(),a={currentType:13,offset:l,startLoc:s,endLoc:s,lastType:13,lastOffset:l,lastStartLoc:s,lastEndLoc:s,braceNest:0,inLinked:!1,text:""},c=()=>a,{onError:h}=t;function u(T,C,R,...H){const _=c();if(C.column+=R,C.offset+=R,h){const D=e?rl(_.startLoc,C):null,st=yo(T,D,{domain:z1,args:H});h(st)}}function d(T,C,R){T.endLoc=o(),T.currentType=C;const H={type:C};return e&&(H.loc=rl(T.startLoc,T.endLoc)),R!=null&&(H.value=R),H}const f=T=>d(T,13);function m(T,C){return T.currentChar()===C?(T.next(),C):(u(dt.EXPECTED_TOKEN,o(),0,C),"")}function v(T){let C="";for(;T.currentPeek()===ni||T.currentPeek()===ae;)C+=T.currentPeek(),T.peek();return C}function p(T){const C=v(T);return T.skipToPeek(),C}function y(T){if(T===xi)return!1;const C=T.charCodeAt(0);return C>=97&&C<=122||C>=65&&C<=90||C===95}function b(T){if(T===xi)return!1;const C=T.charCodeAt(0);return C>=48&&C<=57}function k(T,C){const{currentType:R}=C;if(R!==2)return!1;v(T);const H=y(T.currentPeek());return T.resetPeek(),H}function S(T,C){const{currentType:R}=C;if(R!==2)return!1;v(T);const H=T.currentPeek()==="-"?T.peek():T.currentPeek(),_=b(H);return T.resetPeek(),_}function M(T,C){const{currentType:R}=C;if(R!==2)return!1;v(T);const H=T.currentPeek()===eh;return T.resetPeek(),H}function L(T,C){const{currentType:R}=C;if(R!==7)return!1;v(T);const H=T.currentPeek()===".";return T.resetPeek(),H}function A(T,C){const{currentType:R}=C;if(R!==8)return!1;v(T);const H=y(T.currentPeek());return T.resetPeek(),H}function P(T,C){const{currentType:R}=C;if(!(R===7||R===11))return!1;v(T);const H=T.currentPeek()===":";return T.resetPeek(),H}function B(T,C){const{currentType:R}=C;if(R!==9)return!1;const H=()=>{const D=T.currentPeek();return D==="{"?y(T.peek()):D==="@"||D==="|"||D===":"||D==="."||D===ni||!D?!1:D===ae?(T.peek(),H()):q(T,!1)},_=H();return T.resetPeek(),_}function Y(T){v(T);const C=T.currentPeek()==="|";return T.resetPeek(),C}function q(T,C=!0){const R=(_=!1,D="")=>{const st=T.currentPeek();return st==="{"||st==="@"||!st?_:st==="|"?!(D===ni||D===ae):st===ni?(T.peek(),R(!0,ni)):st===ae?(T.peek(),R(!0,ae)):!0},H=R();return C&&T.resetPeek(),H}function j(T,C){const R=T.currentChar();return R===xi?xi:C(R)?(T.next(),R):null}function $(T){const C=T.charCodeAt(0);return C>=97&&C<=122||C>=65&&C<=90||C>=48&&C<=57||C===95||C===36}function J(T){return j(T,$)}function K(T){const C=T.charCodeAt(0);return C>=97&&C<=122||C>=65&&C<=90||C>=48&&C<=57||C===95||C===36||C===45}function nt(T){return j(T,K)}function St(T){const C=T.charCodeAt(0);return C>=48&&C<=57}function ft(T){return j(T,St)}function Et(T){const C=T.charCodeAt(0);return C>=48&&C<=57||C>=65&&C<=70||C>=97&&C<=102}function Tt(T){return j(T,Et)}function Yt(T){let C="",R="";for(;C=ft(T);)R+=C;return R}function pe(T){let C="";for(;;){const R=T.currentChar();if(R==="{"||R==="}"||R==="@"||R==="|"||!R)break;if(R===ni||R===ae)if(q(T))C+=R,T.next();else{if(Y(T))break;C+=R,T.next()}else C+=R,T.next()}return C}function Ne(T){p(T);let C="",R="";for(;C=nt(T);)R+=C;return T.currentChar()===xi&&u(dt.UNTERMINATED_CLOSING_BRACE,o(),0),R}function ii(T){p(T);let C="";return T.currentChar()==="-"?(T.next(),C+=`-${Yt(T)}`):C+=Yt(T),T.currentChar()===xi&&u(dt.UNTERMINATED_CLOSING_BRACE,o(),0),C}function Hi(T){return T!==eh&&T!==ae}function Yr(T){p(T),m(T,"'");let C="",R="";for(;C=j(T,Hi);)C==="\\"?R+=Rc(T):R+=C;const H=T.currentChar();return H===ae||H===xi?(u(dt.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,o(),0),H===ae&&(T.next(),m(T,"'")),R):(m(T,"'"),R)}function Rc(T){const C=T.currentChar();switch(C){case"\\":case"'":return T.next(),`\\${C}`;case"u":return qs(T,C,4);case"U":return qs(T,C,6);default:return u(dt.UNKNOWN_ESCAPE_SEQUENCE,o(),0,C),""}}function qs(T,C,R){m(T,C);let H="";for(let _=0;_<R;_++){const D=Tt(T);if(!D){u(dt.INVALID_UNICODE_ESCAPE_SEQUENCE,o(),0,`\\${C}${H}${T.currentChar()}`);break}H+=D}return`\\${C}${H}`}function Bc(T){return T!=="{"&&T!=="}"&&T!==ni&&T!==ae}function Nc(T){p(T);let C="",R="";for(;C=j(T,Bc);)R+=C;return R}function Ic(T){let C="",R="";for(;C=J(T);)R+=C;return R}function Ks(T){const C=R=>{const H=T.currentChar();return H==="{"||H==="@"||H==="|"||H==="("||H===")"||!H||H===ni?R:(R+=H,T.next(),C(R))};return C("")}function io(T){p(T);const C=m(T,"|");return p(T),C}function ro(T,C){let R=null;switch(T.currentChar()){case"{":return C.braceNest>=1&&u(dt.NOT_ALLOW_NEST_PLACEHOLDER,o(),0),T.next(),R=d(C,2,"{"),p(T),C.braceNest++,R;case"}":return C.braceNest>0&&C.currentType===2&&u(dt.EMPTY_PLACEHOLDER,o(),0),T.next(),R=d(C,3,"}"),C.braceNest--,C.braceNest>0&&p(T),C.inLinked&&C.braceNest===0&&(C.inLinked=!1),R;case"@":return C.braceNest>0&&u(dt.UNTERMINATED_CLOSING_BRACE,o(),0),R=Gr(T,C)||f(C),C.braceNest=0,R;default:{let H=!0,_=!0,D=!0;if(Y(T))return C.braceNest>0&&u(dt.UNTERMINATED_CLOSING_BRACE,o(),0),R=d(C,1,io(T)),C.braceNest=0,C.inLinked=!1,R;if(C.braceNest>0&&(C.currentType===4||C.currentType===5||C.currentType===6))return u(dt.UNTERMINATED_CLOSING_BRACE,o(),0),C.braceNest=0,no(T,C);if(H=k(T,C))return R=d(C,4,Ne(T)),p(T),R;if(_=S(T,C))return R=d(C,5,ii(T)),p(T),R;if(D=M(T,C))return R=d(C,6,Yr(T)),p(T),R;if(!H&&!_&&!D)return R=d(C,12,Nc(T)),u(dt.INVALID_TOKEN_IN_PLACEHOLDER,o(),0,R.value),p(T),R;break}}return R}function Gr(T,C){const{currentType:R}=C;let H=null;const _=T.currentChar();switch((R===7||R===8||R===11||R===9)&&(_===ae||_===ni)&&u(dt.INVALID_LINKED_FORMAT,o(),0),_){case"@":return T.next(),H=d(C,7,"@"),C.inLinked=!0,H;case".":return p(T),T.next(),d(C,8,".");case":":return p(T),T.next(),d(C,9,":");default:return Y(T)?(H=d(C,1,io(T)),C.braceNest=0,C.inLinked=!1,H):L(T,C)||P(T,C)?(p(T),Gr(T,C)):A(T,C)?(p(T),d(C,11,Ic(T))):B(T,C)?(p(T),_==="{"?ro(T,C)||H:d(C,10,Ks(T))):(R===7&&u(dt.INVALID_LINKED_FORMAT,o(),0),C.braceNest=0,C.inLinked=!1,no(T,C))}}function no(T,C){let R={type:13};if(C.braceNest>0)return ro(T,C)||f(C);if(C.inLinked)return Gr(T,C)||f(C);switch(T.currentChar()){case"{":return ro(T,C)||f(C);case"}":return u(dt.UNBALANCED_CLOSING_BRACE,o(),0),T.next(),d(C,3,"}");case"@":return Gr(T,C)||f(C);default:{if(Y(T))return R=d(C,1,io(T)),C.braceNest=0,C.inLinked=!1,R;if(q(T))return d(C,0,pe(T));break}}return R}function Wc(){const{currentType:T,offset:C,startLoc:R,endLoc:H}=a;return a.lastType=T,a.lastOffset=C,a.lastStartLoc=R,a.lastEndLoc=H,a.offset=n(),a.startLoc=o(),r.currentChar()===xi?d(a,13):no(r,a)}return{nextToken:Wc,currentOffset:n,currentPosition:o,context:c}}const $1="parser",q1=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function K1(i,t,e){switch(i){case"\\\\":return"\\";case"\\'":return"'";default:{const r=parseInt(t||e,16);return r<=55295||r>=57344?String.fromCodePoint(r):"\uFFFD"}}}function Y1(i={}){const t=i.location!==!1,{onError:e}=i;function r(y,b,k,S,...M){const L=y.currentPosition();if(L.offset+=S,L.column+=S,e){const A=t?rl(k,L):null,P=yo(b,A,{domain:$1,args:M});e(P)}}function n(y,b,k){const S={type:y};return t&&(S.start=b,S.end=b,S.loc={start:k,end:k}),S}function o(y,b,k,S){t&&(y.end=b,y.loc&&(y.loc.end=k))}function s(y,b){const k=y.context(),S=n(3,k.offset,k.startLoc);return S.value=b,o(S,y.currentOffset(),y.currentPosition()),S}function l(y,b){const k=y.context(),{lastOffset:S,lastStartLoc:M}=k,L=n(5,S,M);return L.index=parseInt(b,10),y.nextToken(),o(L,y.currentOffset(),y.currentPosition()),L}function a(y,b){const k=y.context(),{lastOffset:S,lastStartLoc:M}=k,L=n(4,S,M);return L.key=b,y.nextToken(),o(L,y.currentOffset(),y.currentPosition()),L}function c(y,b){const k=y.context(),{lastOffset:S,lastStartLoc:M}=k,L=n(9,S,M);return L.value=b.replace(q1,K1),y.nextToken(),o(L,y.currentOffset(),y.currentPosition()),L}function h(y){const b=y.nextToken(),k=y.context(),{lastOffset:S,lastStartLoc:M}=k,L=n(8,S,M);return b.type!==11?(r(y,dt.UNEXPECTED_EMPTY_LINKED_MODIFIER,k.lastStartLoc,0),L.value="",o(L,S,M),{nextConsumeToken:b,node:L}):(b.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,k.lastStartLoc,0,Ue(b)),L.value=b.value||"",o(L,y.currentOffset(),y.currentPosition()),{node:L})}function u(y,b){const k=y.context(),S=n(7,k.offset,k.startLoc);return S.value=b,o(S,y.currentOffset(),y.currentPosition()),S}function d(y){const b=y.context(),k=n(6,b.offset,b.startLoc);let S=y.nextToken();if(S.type===8){const M=h(y);k.modifier=M.node,S=M.nextConsumeToken||y.nextToken()}switch(S.type!==9&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(S)),S=y.nextToken(),S.type===2&&(S=y.nextToken()),S.type){case 10:S.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(S)),k.key=u(y,S.value||"");break;case 4:S.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(S)),k.key=a(y,S.value||"");break;case 5:S.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(S)),k.key=l(y,S.value||"");break;case 6:S.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(S)),k.key=c(y,S.value||"");break;default:{r(y,dt.UNEXPECTED_EMPTY_LINKED_KEY,b.lastStartLoc,0);const M=y.context(),L=n(7,M.offset,M.startLoc);return L.value="",o(L,M.offset,M.startLoc),k.key=L,o(k,M.offset,M.startLoc),{nextConsumeToken:S,node:k}}}return o(k,y.currentOffset(),y.currentPosition()),{node:k}}function f(y){const b=y.context(),k=b.currentType===1?y.currentOffset():b.offset,S=b.currentType===1?b.endLoc:b.startLoc,M=n(2,k,S);M.items=[];let L=null;do{const B=L||y.nextToken();switch(L=null,B.type){case 0:B.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(B)),M.items.push(s(y,B.value||""));break;case 5:B.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(B)),M.items.push(l(y,B.value||""));break;case 4:B.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(B)),M.items.push(a(y,B.value||""));break;case 6:B.value==null&&r(y,dt.UNEXPECTED_LEXICAL_ANALYSIS,b.lastStartLoc,0,Ue(B)),M.items.push(c(y,B.value||""));break;case 7:{const Y=d(y);M.items.push(Y.node),L=Y.nextConsumeToken||null;break}}}while(b.currentType!==13&&b.currentType!==1);const A=b.currentType===1?b.lastOffset:y.currentOffset(),P=b.currentType===1?b.lastEndLoc:y.currentPosition();return o(M,A,P),M}function m(y,b,k,S){const M=y.context();let L=S.items.length===0;const A=n(1,b,k);A.cases=[],A.cases.push(S);do{const P=f(y);L||(L=P.items.length===0),A.cases.push(P)}while(M.currentType!==13);return L&&r(y,dt.MUST_HAVE_MESSAGES_IN_PLURAL,k,0),o(A,y.currentOffset(),y.currentPosition()),A}function v(y){const b=y.context(),{offset:k,startLoc:S}=b,M=f(y);return b.currentType===13?M:m(y,k,S,M)}function p(y){const b=j1(y,It({},i)),k=b.context(),S=n(0,k.offset,k.startLoc);return t&&S.loc&&(S.loc.source=y),S.body=v(b),i.onCacheKey&&(S.cacheKey=i.onCacheKey(y)),k.currentType!==13&&r(b,dt.UNEXPECTED_LEXICAL_ANALYSIS,k.lastStartLoc,0,y[k.offset]||""),o(S,b.currentOffset(),b.currentPosition()),S}return{parse:p}}function Ue(i){if(i.type===13)return"EOF";const t=(i.value||"").replace(/\r?\n/gu,"\\n");return t.length>10?t.slice(0,9)+"\u2026":t}function G1(i,t={}){const e={ast:i,helpers:new Set};return{context:()=>e,helper:r=>(e.helpers.add(r),r)}}function ih(i,t){for(let e=0;e<i.length;e++)nl(i[e],t)}function nl(i,t){switch(i.type){case 1:ih(i.cases,t),t.helper("plural");break;case 2:ih(i.items,t);break;case 6:{nl(i.key,t),t.helper("linked"),t.helper("type");break}case 5:t.helper("interpolate"),t.helper("list");break;case 4:t.helper("interpolate"),t.helper("named");break}}function J1(i,t={}){const e=G1(i);e.helper("normalize"),i.body&&nl(i.body,e);const r=e.context();i.helpers=Array.from(r.helpers)}function X1(i){const t=i.body;return t.type===2?rh(t):t.cases.forEach(e=>rh(e)),i}function rh(i){if(i.items.length===1){const t=i.items[0];(t.type===3||t.type===9)&&(i.static=t.value,delete t.value)}else{const t=[];for(let e=0;e<i.items.length;e++){const r=i.items[e];if(!(r.type===3||r.type===9)||r.value==null)break;t.push(r.value)}if(t.length===i.items.length){i.static=il(t);for(let e=0;e<i.items.length;e++){const r=i.items[e];(r.type===3||r.type===9)&&delete r.value}}}}function gr(i){switch(i.t=i.type,i.type){case 0:{const t=i;gr(t.body),t.b=t.body,delete t.body;break}case 1:{const t=i,e=t.cases;for(let r=0;r<e.length;r++)gr(e[r]);t.c=e,delete t.cases;break}case 2:{const t=i,e=t.items;for(let r=0;r<e.length;r++)gr(e[r]);t.i=e,delete t.items,t.static&&(t.s=t.static,delete t.static);break}case 3:case 9:case 8:case 7:{const t=i;t.value&&(t.v=t.value,delete t.value);break}case 6:{const t=i;gr(t.key),t.k=t.key,delete t.key,t.modifier&&(gr(t.modifier),t.m=t.modifier,delete t.modifier);break}case 5:{const t=i;t.i=t.index,delete t.index;break}case 4:{const t=i;t.k=t.key,delete t.key;break}}delete i.type}function Q1(i,t){const{sourceMap:e,filename:r,breakLineCode:n,needIndent:o}=t,s=t.location!==!1,l={filename:r,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:n,needIndent:o,indentLevel:0};s&&i.loc&&(l.source=i.loc.source);const a=()=>l;function c(m,v){l.code+=m}function h(m,v=!0){const p=v?n:"";c(o?p+"  ".repeat(m):p)}function u(m=!0){const v=++l.indentLevel;m&&h(v)}function d(m=!0){const v=--l.indentLevel;m&&h(v)}function f(){h(l.indentLevel)}return{context:a,push:c,indent:u,deindent:d,newline:f,helper:m=>`_${m}`,needIndent:()=>l.needIndent}}function Z1(i,t){const{helper:e}=i;i.push(`${e("linked")}(`),yr(i,t.key),t.modifier?(i.push(", "),yr(i,t.modifier),i.push(", _type")):i.push(", undefined, _type"),i.push(")")}function ty(i,t){const{helper:e,needIndent:r}=i;i.push(`${e("normalize")}([`),i.indent(r());const n=t.items.length;for(let o=0;o<n&&(yr(i,t.items[o]),o!==n-1);o++)i.push(", ");i.deindent(r()),i.push("])")}function ey(i,t){const{helper:e,needIndent:r}=i;if(t.cases.length>1){i.push(`${e("plural")}([`),i.indent(r());const n=t.cases.length;for(let o=0;o<n&&(yr(i,t.cases[o]),o!==n-1);o++)i.push(", ");i.deindent(r()),i.push("])")}}function iy(i,t){t.body?yr(i,t.body):i.push("null")}function yr(i,t){const{helper:e}=i;switch(t.type){case 0:iy(i,t);break;case 1:ey(i,t);break;case 2:ty(i,t);break;case 6:Z1(i,t);break;case 8:i.push(JSON.stringify(t.value),t);break;case 7:i.push(JSON.stringify(t.value),t);break;case 5:i.push(`${e("interpolate")}(${e("list")}(${t.index}))`,t);break;case 4:i.push(`${e("interpolate")}(${e("named")}(${JSON.stringify(t.key)}))`,t);break;case 9:i.push(JSON.stringify(t.value),t);break;case 3:i.push(JSON.stringify(t.value),t);break}}const ry=(i,t={})=>{const e=F(t.mode)?t.mode:"normal",r=F(t.filename)?t.filename:"message.intl",n=!!t.sourceMap,o=t.breakLineCode!=null?t.breakLineCode:e==="arrow"?";":`
`,s=t.needIndent?t.needIndent:e!=="arrow",l=i.helpers||[],a=Q1(i,{mode:e,filename:r,sourceMap:n,breakLineCode:o,needIndent:s});a.push(e==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),a.indent(s),l.length>0&&(a.push(`const { ${il(l.map(u=>`${u}: _${u}`),", ")} } = ctx`),a.newline()),a.push("return "),yr(a,i),a.deindent(s),a.push("}"),delete i.helpers;const{code:c,map:h}=a.context();return{ast:i,code:c,map:h?h.toJSON():void 0}};function ny(i,t={}){const e=It({},t),r=!!e.jit,n=!!e.minify,o=e.optimize==null?!0:e.optimize,s=Y1(e).parse(i);return r?(o&&X1(s),n&&gr(s),{ast:s,code:""}):(J1(s,e),ry(s,e))}function oy(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&($i().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&($i().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function ol(i){return t=>sy(t,i)}function sy(i,t){const e=t.b||t.body;if((e.t||e.type)===1){const r=e,n=r.c||r.cases;return i.plural(n.reduce((o,s)=>[...o,nh(i,s)],[]))}else return nh(i,e)}function nh(i,t){const e=t.s||t.static;if(e)return i.type==="text"?e:i.normalize([e]);{const r=(t.i||t.items).reduce((n,o)=>[...n,sl(i,o)],[]);return i.normalize(r)}}function sl(i,t){const e=t.t||t.type;switch(e){case 3:{const r=t;return r.v||r.value}case 9:{const r=t;return r.v||r.value}case 4:{const r=t;return i.interpolate(i.named(r.k||r.key))}case 5:{const r=t;return i.interpolate(i.list(r.i!=null?r.i:r.index))}case 6:{const r=t,n=r.m||r.modifier;return i.linked(sl(i,r.k||r.key),n?sl(i,n):void 0,i.type)}case 7:{const r=t;return r.v||r.value}case 8:{const r=t;return r.v||r.value}default:throw new Error(`unhandled node type on format message part: ${e}`)}}const ly=i=>i;let vo=Object.create(null);const vr=i=>ut(i)&&(i.t===0||i.type===0)&&("b"in i||"body"in i);function ay(i,t={}){let e=!1;const r=t.onError||W1;return t.onError=n=>{e=!0,r(n)},{...ny(i,t),detectError:e}}function cy(i,t){if(!__INTLIFY_DROP_MESSAGE_COMPILER__&&F(i)){ct(t.warnHtmlMessage)&&t.warnHtmlMessage;const e=(t.onCacheKey||ly)(i),r=vo[e];if(r)return r;const{ast:n,detectError:o}=ay(i,{...t,location:!1,jit:!0}),s=ol(n);return o?s:vo[e]=s}else{const e=i.cacheKey;return e?vo[e]||(vo[e]=ol(i)):ol(i)}}let on=null;function hy(i){on=i}function uy(i,t,e){on&&on.emit("i18n:init",{timestamp:Date.now(),i18n:i,version:t,meta:e})}const dy=fy("function:translate");function fy(i){return t=>on&&on.emit(i,t)}const oi={INVALID_ARGUMENT:I1,INVALID_DATE_ARGUMENT:18,INVALID_ISO_DATE_ARGUMENT:19,NOT_SUPPORT_NON_STRING_MESSAGE:20,NOT_SUPPORT_LOCALE_PROMISE_VALUE:21,NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:22,NOT_SUPPORT_LOCALE_TYPE:23},py=24;function si(i){return yo(i,null,void 0)}function ll(i,t){return t.locale!=null?oh(t.locale):oh(i.locale)}let al;function oh(i){if(F(i))return i;if(yt(i)){if(i.resolvedOnce&&al!=null)return al;if(i.constructor.name==="Function"){const t=i();if(P1(t))throw si(oi.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return al=t}else throw si(oi.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw si(oi.NOT_SUPPORT_LOCALE_TYPE)}function my(i,t,e){return[...new Set([e,...At(t)?t:ut(t)?Object.keys(t):F(t)?[t]:[e]])]}function sh(i,t,e){const r=F(e)?e:sn,n=i;n.__localeChainCache||(n.__localeChainCache=new Map);let o=n.__localeChainCache.get(r);if(!o){o=[];let s=[e];for(;At(s);)s=lh(o,s,t);const l=At(t)||!it(t)?t:t.default?t.default:null;s=F(l)?[l]:l,At(s)&&lh(o,s,!1),n.__localeChainCache.set(r,o)}return o}function lh(i,t,e){let r=!0;for(let n=0;n<t.length&&ct(r);n++){const o=t[n];F(o)&&(r=gy(i,t[n],e))}return r}function gy(i,t,e){let r;const n=t.split("-");do{const o=n.join("-");r=yy(i,o,e),n.splice(-1,1)}while(n.length&&r===!0);return r}function yy(i,t,e){let r=!1;if(!i.includes(t)&&(r=!0,t)){r=t[t.length-1]!=="!";const n=t.replace(/!/g,"");i.push(n),(At(e)||it(e))&&e[n]&&(r=e[n])}return r}const ki=[];ki[0]={w:[0],i:[3,0],"[":[4],o:[7]},ki[1]={w:[1],".":[2],"[":[4],o:[7]},ki[2]={w:[2],i:[3,0],0:[3,0]},ki[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]},ki[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]},ki[5]={"'":[4,0],o:8,l:[5,0]},ki[6]={'"':[4,0],o:8,l:[6,0]};const vy=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function wy(i){return vy.test(i)}function by(i){const t=i.charCodeAt(0),e=i.charCodeAt(i.length-1);return t===e&&(t===34||t===39)?i.slice(1,-1):i}function xy(i){if(i==null)return"o";switch(i.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return i;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function ky(i){const t=i.trim();return i.charAt(0)==="0"&&isNaN(parseInt(i))?!1:wy(t)?by(t):"*"+t}function Sy(i){const t=[];let e=-1,r=0,n=0,o,s,l,a,c,h,u;const d=[];d[0]=()=>{s===void 0?s=l:s+=l},d[1]=()=>{s!==void 0&&(t.push(s),s=void 0)},d[2]=()=>{d[0](),n++},d[3]=()=>{if(n>0)n--,r=4,d[0]();else{if(n=0,s===void 0||(s=ky(s),s===!1))return!1;d[1]()}};function f(){const m=i[e+1];if(r===5&&m==="'"||r===6&&m==='"')return e++,l="\\"+m,d[0](),!0}for(;r!==null;)if(e++,o=i[e],!(o==="\\"&&f())){if(a=xy(o),u=ki[r],c=u[a]||u.l||8,c===8||(r=c[0],c[1]!==void 0&&(h=d[c[1]],h&&(l=o,h()===!1))))return;if(r===7)return t}}const ah=new Map;function Ty(i,t){return ut(i)?i[t]:null}function Ay(i,t){if(!ut(i))return null;let e=ah.get(t);if(e||(e=Sy(t),e&&ah.set(t,e)),!e)return null;const r=e.length;let n=i,o=0;for(;o<r;){const s=n[e[o]];if(s===void 0||yt(n))return null;n=s,o++}return n}const My="10.0.3",wo=-1,sn="en-US",ch="",hh=i=>`${i.charAt(0).toLocaleUpperCase()}${i.substr(1)}`;function Cy(){return{upper:(i,t)=>t==="text"&&F(i)?i.toUpperCase():t==="vnode"&&ut(i)&&"__v_isVNode"in i?i.children.toUpperCase():i,lower:(i,t)=>t==="text"&&F(i)?i.toLowerCase():t==="vnode"&&ut(i)&&"__v_isVNode"in i?i.children.toLowerCase():i,capitalize:(i,t)=>t==="text"&&F(i)?hh(i):t==="vnode"&&ut(i)&&"__v_isVNode"in i?hh(i.children):i}}let uh;function Ly(i){uh=i}let dh;function _y(i){dh=i}let fh;function Ey(i){fh=i}let ph=null;const rC=i=>{ph=i},Oy=()=>ph;let mh=null;const gh=i=>{mh=i},Dy=()=>mh;let yh=0;function Py(i={}){const t=yt(i.onWarn)?i.onWarn:B1,e=F(i.version)?i.version:My,r=F(i.locale)||yt(i.locale)?i.locale:sn,n=yt(r)?sn:r,o=At(i.fallbackLocale)||it(i.fallbackLocale)||F(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:n,s=it(i.messages)?i.messages:{[n]:{}},l=it(i.datetimeFormats)?i.datetimeFormats:{[n]:{}},a=it(i.numberFormats)?i.numberFormats:{[n]:{}},c=It({},i.modifiers||{},Cy()),h=i.pluralRules||{},u=yt(i.missing)?i.missing:null,d=ct(i.missingWarn)||mr(i.missingWarn)?i.missingWarn:!0,f=ct(i.fallbackWarn)||mr(i.fallbackWarn)?i.fallbackWarn:!0,m=!!i.fallbackFormat,v=!!i.unresolving,p=yt(i.postTranslation)?i.postTranslation:null,y=it(i.processor)?i.processor:null,b=ct(i.warnHtmlMessage)?i.warnHtmlMessage:!0,k=!!i.escapeParameter,S=yt(i.messageCompiler)?i.messageCompiler:uh,M=yt(i.messageResolver)?i.messageResolver:dh||Ty,L=yt(i.localeFallbacker)?i.localeFallbacker:fh||my,A=ut(i.fallbackContext)?i.fallbackContext:void 0,P=i,B=ut(P.__datetimeFormatters)?P.__datetimeFormatters:new Map,Y=ut(P.__numberFormatters)?P.__numberFormatters:new Map,q=ut(P.__meta)?P.__meta:{};yh++;const j={version:e,cid:yh,locale:r,fallbackLocale:o,messages:s,modifiers:c,pluralRules:h,missing:u,missingWarn:d,fallbackWarn:f,fallbackFormat:m,unresolving:v,postTranslation:p,processor:y,warnHtmlMessage:b,escapeParameter:k,messageCompiler:S,messageResolver:M,localeFallbacker:L,fallbackContext:A,onWarn:t,__meta:q};return j.datetimeFormats=l,j.numberFormats=a,j.__datetimeFormatters=B,j.__numberFormatters=Y,__INTLIFY_PROD_DEVTOOLS__&&uy(j,e,q),j}function cl(i,t,e,r,n){const{missing:o,onWarn:s}=i;if(o!==null){const l=o(i,e,t,n);return F(l)?l:t}else return t}function ln(i,t,e){const r=i;r.__localeChainCache=new Map,i.localeFallbacker(i,e,t)}function Ry(i,t){return i===t?!1:i.split("-")[0]===t.split("-")[0]}function By(i,t){const e=t.indexOf(i);if(e===-1)return!1;for(let r=e+1;r<t.length;r++)if(Ry(i,t[r]))return!0;return!1}function vh(i,...t){const{datetimeFormats:e,unresolving:r,fallbackLocale:n,onWarn:o,localeFallbacker:s}=i,{__datetimeFormatters:l}=i,[a,c,h,u]=hl(...t),d=ct(h.missingWarn)?h.missingWarn:i.missingWarn;ct(h.fallbackWarn)?h.fallbackWarn:i.fallbackWarn;const f=!!h.part,m=ll(i,h),v=s(i,n,m);if(!F(a)||a==="")return new Intl.DateTimeFormat(m,u).format(c);let p={},y,b=null;const k="datetime format";for(let L=0;L<v.length&&(y=v[L],p=e[y]||{},b=p[a],!it(b));L++)cl(i,a,y,d,k);if(!it(b)||!F(y))return r?wo:a;let S=`${y}__${a}`;fo(u)||(S=`${S}__${JSON.stringify(u)}`);let M=l.get(S);return M||(M=new Intl.DateTimeFormat(y,It({},b,u)),l.set(S,M)),f?M.formatToParts(c):M.format(c)}const wh=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function hl(...i){const[t,e,r,n]=i,o={};let s={},l;if(F(t)){const a=t.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!a)throw si(oi.INVALID_ISO_DATE_ARGUMENT);const c=a[3]?a[3].trim().startsWith("T")?`${a[1].trim()}${a[3].trim()}`:`${a[1].trim()}T${a[3].trim()}`:a[1].trim();l=new Date(c);try{l.toISOString()}catch{throw si(oi.INVALID_ISO_DATE_ARGUMENT)}}else if(O1(t)){if(isNaN(t.getTime()))throw si(oi.INVALID_DATE_ARGUMENT);l=t}else if(Nt(t))l=t;else throw si(oi.INVALID_ARGUMENT);return F(e)?o.key=e:it(e)&&Object.keys(e).forEach(a=>{wh.includes(a)?s[a]=e[a]:o[a]=e[a]}),F(r)?o.locale=r:it(r)&&(s=r),it(n)&&(s=n),[o.key||"",l,o,s]}function bh(i,t,e){const r=i;for(const n in e){const o=`${t}__${n}`;r.__datetimeFormatters.has(o)&&r.__datetimeFormatters.delete(o)}}function xh(i,...t){const{numberFormats:e,unresolving:r,fallbackLocale:n,onWarn:o,localeFallbacker:s}=i,{__numberFormatters:l}=i,[a,c,h,u]=ul(...t),d=ct(h.missingWarn)?h.missingWarn:i.missingWarn;ct(h.fallbackWarn)?h.fallbackWarn:i.fallbackWarn;const f=!!h.part,m=ll(i,h),v=s(i,n,m);if(!F(a)||a==="")return new Intl.NumberFormat(m,u).format(c);let p={},y,b=null;const k="number format";for(let L=0;L<v.length&&(y=v[L],p=e[y]||{},b=p[a],!it(b));L++)cl(i,a,y,d,k);if(!it(b)||!F(y))return r?wo:a;let S=`${y}__${a}`;fo(u)||(S=`${S}__${JSON.stringify(u)}`);let M=l.get(S);return M||(M=new Intl.NumberFormat(y,It({},b,u)),l.set(S,M)),f?M.formatToParts(c):M.format(c)}const kh=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function ul(...i){const[t,e,r,n]=i,o={};let s={};if(!Nt(t))throw si(oi.INVALID_ARGUMENT);const l=t;return F(e)?o.key=e:it(e)&&Object.keys(e).forEach(a=>{kh.includes(a)?s[a]=e[a]:o[a]=e[a]}),F(r)?o.locale=r:it(r)&&(s=r),it(n)&&(s=n),[o.key||"",l,o,s]}function Sh(i,t,e){const r=i;for(const n in e){const o=`${t}__${n}`;r.__numberFormatters.has(o)&&r.__numberFormatters.delete(o)}}const Ny=i=>i,Iy=i=>"",Wy="text",Fy=i=>i.length===0?"":il(i),Vy=R1;function Th(i,t){return i=Math.abs(i),t===2?i?i>1?1:0:1:i?Math.min(i,2):0}function Hy(i){const t=Nt(i.pluralIndex)?i.pluralIndex:-1;return i.named&&(Nt(i.named.count)||Nt(i.named.n))?Nt(i.named.count)?i.named.count:Nt(i.named.n)?i.named.n:t:t}function Uy(i,t){t.count||(t.count=i),t.n||(t.n=i)}function zy(i={}){const t=i.locale,e=Hy(i),r=ut(i.pluralRules)&&F(t)&&yt(i.pluralRules[t])?i.pluralRules[t]:Th,n=ut(i.pluralRules)&&F(t)&&yt(i.pluralRules[t])?Th:void 0,o=p=>p[r(e,p.length,n)],s=i.list||[],l=p=>s[p],a=i.named||{};Nt(i.pluralIndex)&&Uy(e,a);const c=p=>a[p];function h(p,y){return(yt(i.messages)?i.messages(p,!!y):ut(i.messages)?i.messages[p]:!1)||(i.parent?i.parent.message(p):Iy)}const u=p=>i.modifiers?i.modifiers[p]:Ny,d=it(i.processor)&&yt(i.processor.normalize)?i.processor.normalize:Fy,f=it(i.processor)&&yt(i.processor.interpolate)?i.processor.interpolate:Vy,m=it(i.processor)&&F(i.processor.type)?i.processor.type:Wy,v={list:l,named:c,plural:o,linked:(p,...y)=>{const[b,k]=y;let S="text",M="";y.length===1?ut(b)?(M=b.modifier||M,S=b.type||S):F(b)&&(M=b||M):y.length===2&&(F(b)&&(M=b||M),F(k)&&(S=k||S));const L=h(p,!0)(v),A=S==="vnode"&&At(L)&&M?L[0]:L;return M?u(M)(A,S):A},message:h,type:m,interpolate:f,normalize:d,values:It({},s,a)};return v}const Ah=()=>"",ke=i=>yt(i);function Mh(i,...t){const{fallbackFormat:e,postTranslation:r,unresolving:n,messageCompiler:o,fallbackLocale:s,messages:l}=i,[a,c]=dl(...t),h=ct(c.missingWarn)?c.missingWarn:i.missingWarn,u=ct(c.fallbackWarn)?c.fallbackWarn:i.fallbackWarn,d=ct(c.escapeParameter)?c.escapeParameter:i.escapeParameter,f=!!c.resolvedMessage,m=F(c.default)||ct(c.default)?ct(c.default)?o?a:()=>a:c.default:e?o?a:()=>a:null,v=e||m!=null&&(F(m)||yt(m)),p=ll(i,c);d&&jy(c);let[y,b,k]=f?[a,p,l[p]||{}]:Ch(i,a,p,s,u,h),S=y,M=a;if(!f&&!(F(S)||vr(S)||ke(S))&&v&&(S=m,M=S),!f&&(!(F(S)||vr(S)||ke(S))||!F(b)))return n?wo:a;let L=!1;const A=()=>{L=!0},P=ke(S)?S:Lh(i,a,b,S,M,A);if(L)return S;const B=Ky(i,b,k,c),Y=zy(B),q=$y(i,P,Y),j=r?r(q,a):q;if(__INTLIFY_PROD_DEVTOOLS__){const $={timestamp:Date.now(),key:F(a)?a:ke(S)?S.key:"",locale:b||(ke(S)?S.locale:""),format:F(S)?S:ke(S)?S.source:"",message:j};$.meta=It({},i.__meta,Oy()||{}),dy($)}return j}function jy(i){At(i.list)?i.list=i.list.map(t=>F(t)?Zc(t):t):ut(i.named)&&Object.keys(i.named).forEach(t=>{F(i.named[t])&&(i.named[t]=Zc(i.named[t]))})}function Ch(i,t,e,r,n,o){const{messages:s,onWarn:l,messageResolver:a,localeFallbacker:c}=i,h=c(i,r,e);let u={},d,f=null;const m="translate";for(let v=0;v<h.length&&(d=h[v],u=s[d]||{},(f=a(u,t))===null&&(f=u[t]),!(F(f)||vr(f)||ke(f)));v++)if(!By(d,h)){const p=cl(i,t,d,o,m);p!==t&&(f=p)}return[f,d,u]}function Lh(i,t,e,r,n,o){const{messageCompiler:s,warnHtmlMessage:l}=i;if(ke(r)){const c=r;return c.locale=c.locale||e,c.key=c.key||t,c}if(s==null){const c=()=>r;return c.locale=e,c.key=t,c}const a=s(r,qy(i,e,n,r,l,o));return a.locale=e,a.key=t,a.source=r,a}function $y(i,t,e){return t(e)}function dl(...i){const[t,e,r]=i,n={};if(!F(t)&&!Nt(t)&&!ke(t)&&!vr(t))throw si(oi.INVALID_ARGUMENT);const o=Nt(t)?String(t):(ke(t),t);return Nt(e)?n.plural=e:F(e)?n.default=e:it(e)&&!fo(e)?n.named=e:At(e)&&(n.list=e),Nt(r)?n.plural=r:F(r)?n.default=r:it(r)&&It(n,r),[o,n]}function qy(i,t,e,r,n,o){return{locale:t,key:e,warnHtmlMessage:n,onError:s=>{throw o&&o(s),s},onCacheKey:s=>_1(t,e,s)}}function Ky(i,t,e,r){const{modifiers:n,pluralRules:o,messageResolver:s,fallbackLocale:l,fallbackWarn:a,missingWarn:c,fallbackContext:h}=i,u={locale:t,modifiers:n,pluralRules:o,messages:(d,f)=>{let m=s(e,d);if(m==null&&(h||f)){const[,,v]=Ch(h||i,d,t,l,a,c);m=s(v,d)}if(F(m)||vr(m)){let v=!1;const p=Lh(i,d,t,m,d,()=>{v=!0});return v?Ah:p}else return ke(m)?m:Ah}};return i.processor&&(u.processor=i.processor),r.list&&(u.list=r.list),r.named&&(u.named=r.named),Nt(r.plural)&&(u.pluralIndex=r.plural),u}oy();const Yy="10.0.3";function Gy(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&($i().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&($i().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&($i().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&($i().__INTLIFY_PROD_DEVTOOLS__=!1)}const re={UNEXPECTED_RETURN_TYPE:py,INVALID_ARGUMENT:25,MUST_BE_CALL_SETUP_TOP:26,NOT_INSTALLED:27,REQUIRED_VALUE:28,INVALID_VALUE:29,CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:30,NOT_INSTALLED_WITH_PROVIDE:31,UNEXPECTED_ERROR:32,NOT_COMPATIBLE_LEGACY_VUE_I18N:33,NOT_AVAILABLE_COMPOSITION_IN_LEGACY:34};function ce(i,...t){return yo(i,null,void 0)}const fl=bi("__translateVNode"),pl=bi("__datetimeParts"),ml=bi("__numberParts"),_h=bi("__setPluralRules"),Eh=bi("__injectWithOption"),gl=bi("__dispose");function an(i){if(!ut(i))return i;for(const t in i)if(po(i,t))if(!t.includes("."))ut(i[t])&&an(i[t]);else{const e=t.split("."),r=e.length-1;let n=i,o=!1;for(let s=0;s<r;s++){if(e[s]in n||(n[e[s]]={}),!ut(n[e[s]])){o=!0;break}n=n[e[s]]}o||(n[e[r]]=i[t],delete i[t]),ut(n[e[r]])&&an(n[e[r]])}return i}function yl(i,t){const{messages:e,__i18n:r,messageResolver:n,flatJson:o}=t,s=it(e)?e:At(r)?{}:{[i]:{}};if(At(r)&&r.forEach(l=>{if("locale"in l&&"resource"in l){const{locale:a,resource:c}=l;a?(s[a]=s[a]||{},go(c,s[a])):go(c,s)}else F(l)&&go(JSON.parse(l),s)}),n==null&&o)for(const l in s)po(s,l)&&an(s[l]);return s}function Oh(i){return i.type}function Dh(i,t,e){let r=ut(t.messages)?t.messages:{};"__i18nGlobal"in e&&(r=yl(i.locale.value,{messages:r,__i18n:e.__i18nGlobal}));const n=Object.keys(r);n.length&&n.forEach(o=>{i.mergeLocaleMessage(o,r[o])});{if(ut(t.datetimeFormats)){const o=Object.keys(t.datetimeFormats);o.length&&o.forEach(s=>{i.mergeDateTimeFormat(s,t.datetimeFormats[s])})}if(ut(t.numberFormats)){const o=Object.keys(t.numberFormats);o.length&&o.forEach(s=>{i.mergeNumberFormat(s,t.numberFormats[s])})}}}function Ph(i){return w(SM,null,i,0)}const Rh="__INTLIFY_META__",Bh=()=>[],Jy=()=>!1;let Nh=0;function Ih(i){return(t,e,r,n)=>i(e,r,oo()||void 0,n)}const nC=()=>{const i=oo();let t=null;return i&&(t=Oh(i)[Rh])?{[Rh]:t}:null};function vl(i={}){const{__root:t,__injectWithOption:e}=i,r=t===void 0,n=i.flatJson,o=uo?Gt:Js;let s=ct(i.inheritLocale)?i.inheritLocale:!0;const l=o(t&&s?t.locale.value:F(i.locale)?i.locale:sn),a=o(t&&s?t.fallbackLocale.value:F(i.fallbackLocale)||At(i.fallbackLocale)||it(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:l.value),c=o(yl(l.value,i)),h=o(it(i.datetimeFormats)?i.datetimeFormats:{[l.value]:{}}),u=o(it(i.numberFormats)?i.numberFormats:{[l.value]:{}});let d=t?t.missingWarn:ct(i.missingWarn)||mr(i.missingWarn)?i.missingWarn:!0,f=t?t.fallbackWarn:ct(i.fallbackWarn)||mr(i.fallbackWarn)?i.fallbackWarn:!0,m=t?t.fallbackRoot:ct(i.fallbackRoot)?i.fallbackRoot:!0,v=!!i.fallbackFormat,p=yt(i.missing)?i.missing:null,y=yt(i.missing)?Ih(i.missing):null,b=yt(i.postTranslation)?i.postTranslation:null,k=t?t.warnHtmlMessage:ct(i.warnHtmlMessage)?i.warnHtmlMessage:!0,S=!!i.escapeParameter;const M=t?t.modifiers:it(i.modifiers)?i.modifiers:{};let L=i.pluralRules||t&&t.pluralRules,A;A=(()=>{r&&gh(null);const _={version:Yy,locale:l.value,fallbackLocale:a.value,messages:c.value,modifiers:M,pluralRules:L,missing:y===null?void 0:y,missingWarn:d,fallbackWarn:f,fallbackFormat:v,unresolving:!0,postTranslation:b===null?void 0:b,warnHtmlMessage:k,escapeParameter:S,messageResolver:i.messageResolver,messageCompiler:i.messageCompiler,__meta:{framework:"vue"}};_.datetimeFormats=h.value,_.numberFormats=u.value,_.__datetimeFormatters=it(A)?A.__datetimeFormatters:void 0,_.__numberFormatters=it(A)?A.__numberFormatters:void 0;const D=Py(_);return r&&gh(D),D})(),ln(A,l.value,a.value);function P(){return[l.value,a.value,c.value,h.value,u.value]}const B=Dt({get:()=>l.value,set:_=>{l.value=_,A.locale=l.value}}),Y=Dt({get:()=>a.value,set:_=>{a.value=_,A.fallbackLocale=a.value,ln(A,l.value,_)}}),q=Dt(()=>c.value),j=Dt(()=>h.value),$=Dt(()=>u.value);function J(){return yt(b)?b:null}function K(_){b=_,A.postTranslation=_}function nt(){return p}function St(_){_!==null&&(y=Ih(_)),p=_,A.missing=y}const ft=(_,D,st,Ot,cr,Ys)=>{P();let Jr;try{__INTLIFY_PROD_DEVTOOLS__,r||(A.fallbackContext=t?Dy():void 0),Jr=_(A)}finally{__INTLIFY_PROD_DEVTOOLS__,r||(A.fallbackContext=void 0)}if(st!=="translate exists"&&Nt(Jr)&&Jr===wo||st==="translate exists"&&!Jr){const[bM,oC]=D();return t&&m?Ot(t):cr(bM)}else{if(Ys(Jr))return Jr;throw ce(re.UNEXPECTED_RETURN_TYPE)}};function Et(..._){return ft(D=>Reflect.apply(Mh,null,[D,..._]),()=>dl(..._),"translate",D=>Reflect.apply(D.t,D,[..._]),D=>D,D=>F(D))}function Tt(..._){const[D,st,Ot]=_;if(Ot&&!ut(Ot))throw ce(re.INVALID_ARGUMENT);return Et(D,st,It({resolvedMessage:!0},Ot||{}))}function Yt(..._){return ft(D=>Reflect.apply(vh,null,[D,..._]),()=>hl(..._),"datetime format",D=>Reflect.apply(D.d,D,[..._]),()=>ch,D=>F(D))}function pe(..._){return ft(D=>Reflect.apply(xh,null,[D,..._]),()=>ul(..._),"number format",D=>Reflect.apply(D.n,D,[..._]),()=>ch,D=>F(D))}function Ne(_){return _.map(D=>F(D)||Nt(D)||ct(D)?Ph(String(D)):D)}const ii={normalize:Ne,interpolate:_=>_,type:"vnode"};function Hi(..._){return ft(D=>{let st;const Ot=D;try{Ot.processor=ii,st=Reflect.apply(Mh,null,[Ot,..._])}finally{Ot.processor=null}return st},()=>dl(..._),"translate",D=>D[fl](..._),D=>[Ph(D)],D=>At(D))}function Yr(..._){return ft(D=>Reflect.apply(xh,null,[D,..._]),()=>ul(..._),"number format",D=>D[ml](..._),Bh,D=>F(D)||At(D))}function Rc(..._){return ft(D=>Reflect.apply(vh,null,[D,..._]),()=>hl(..._),"datetime format",D=>D[pl](..._),Bh,D=>F(D)||At(D))}function qs(_){L=_,A.pluralRules=L}function Bc(_,D){return ft(()=>{if(!_)return!1;const st=F(D)?D:l.value,Ot=Ks(st),cr=A.messageResolver(Ot,_);return vr(cr)||ke(cr)||F(cr)},()=>[_],"translate exists",st=>Reflect.apply(st.te,st,[_,D]),Jy,st=>ct(st))}function Nc(_){let D=null;const st=sh(A,a.value,l.value);for(let Ot=0;Ot<st.length;Ot++){const cr=c.value[st[Ot]]||{},Ys=A.messageResolver(cr,_);if(Ys!=null){D=Ys;break}}return D}function Ic(_){return Nc(_)??(t?t.tm(_)||{}:{})}function Ks(_){return c.value[_]||{}}function io(_,D){if(n){const st={[_]:D};for(const Ot in st)po(st,Ot)&&an(st[Ot]);D=st[_]}c.value[_]=D,A.messages=c.value}function ro(_,D){c.value[_]=c.value[_]||{};const st={[_]:D};if(n)for(const Ot in st)po(st,Ot)&&an(st[Ot]);D=st[_],go(D,c.value[_]),A.messages=c.value}function Gr(_){return h.value[_]||{}}function no(_,D){h.value[_]=D,A.datetimeFormats=h.value,bh(A,_,D)}function Wc(_,D){h.value[_]=It(h.value[_]||{},D),A.datetimeFormats=h.value,bh(A,_,D)}function T(_){return u.value[_]||{}}function C(_,D){u.value[_]=D,A.numberFormats=u.value,Sh(A,_,D)}function R(_,D){u.value[_]=It(u.value[_]||{},D),A.numberFormats=u.value,Sh(A,_,D)}Nh++,t&&uo&&(xe(t.locale,_=>{s&&(l.value=_,A.locale=_,ln(A,l.value,a.value))}),xe(t.fallbackLocale,_=>{s&&(a.value=_,A.fallbackLocale=_,ln(A,l.value,a.value))}));const H={id:Nh,locale:B,fallbackLocale:Y,get inheritLocale(){return s},set inheritLocale(_){s=_,_&&t&&(l.value=t.locale.value,a.value=t.fallbackLocale.value,ln(A,l.value,a.value))},get availableLocales(){return Object.keys(c.value).sort()},messages:q,get modifiers(){return M},get pluralRules(){return L||{}},get isGlobal(){return r},get missingWarn(){return d},set missingWarn(_){d=_,A.missingWarn=d},get fallbackWarn(){return f},set fallbackWarn(_){f=_,A.fallbackWarn=f},get fallbackRoot(){return m},set fallbackRoot(_){m=_},get fallbackFormat(){return v},set fallbackFormat(_){v=_,A.fallbackFormat=v},get warnHtmlMessage(){return k},set warnHtmlMessage(_){k=_,A.warnHtmlMessage=_},get escapeParameter(){return S},set escapeParameter(_){S=_,A.escapeParameter=_},t:Et,getLocaleMessage:Ks,setLocaleMessage:io,mergeLocaleMessage:ro,getPostTranslationHandler:J,setPostTranslationHandler:K,getMissingHandler:nt,setMissingHandler:St,[_h]:qs};return H.datetimeFormats=j,H.numberFormats=$,H.rt=Tt,H.te=Bc,H.tm=Ic,H.d=Yt,H.n=pe,H.getDateTimeFormat=Gr,H.setDateTimeFormat=no,H.mergeDateTimeFormat=Wc,H.getNumberFormat=T,H.setNumberFormat=C,H.mergeNumberFormat=R,H[Eh]=e,H[fl]=Hi,H[pl]=Rc,H[ml]=Yr,H}function Xy(i){const t=F(i.locale)?i.locale:sn,e=F(i.fallbackLocale)||At(i.fallbackLocale)||it(i.fallbackLocale)||i.fallbackLocale===!1?i.fallbackLocale:t,r=yt(i.missing)?i.missing:void 0,n=ct(i.silentTranslationWarn)||mr(i.silentTranslationWarn)?!i.silentTranslationWarn:!0,o=ct(i.silentFallbackWarn)||mr(i.silentFallbackWarn)?!i.silentFallbackWarn:!0,s=ct(i.fallbackRoot)?i.fallbackRoot:!0,l=!!i.formatFallbackMessages,a=it(i.modifiers)?i.modifiers:{},c=i.pluralizationRules,h=yt(i.postTranslation)?i.postTranslation:void 0,u=F(i.warnHtmlInMessage)?i.warnHtmlInMessage!=="off":!0,d=!!i.escapeParameterHtml,f=ct(i.sync)?i.sync:!0;let m=i.messages;if(it(i.sharedMessages)){const M=i.sharedMessages;m=Object.keys(M).reduce((L,A)=>{const P=L[A]||(L[A]={});return It(P,M[A]),L},m||{})}const{__i18n:v,__root:p,__injectWithOption:y}=i,b=i.datetimeFormats,k=i.numberFormats,S=i.flatJson;return{locale:t,fallbackLocale:e,messages:m,flatJson:S,datetimeFormats:b,numberFormats:k,missing:r,missingWarn:n,fallbackWarn:o,fallbackRoot:s,fallbackFormat:l,modifiers:a,pluralRules:c,postTranslation:h,warnHtmlMessage:u,escapeParameter:d,messageResolver:i.messageResolver,inheritLocale:f,__i18n:v,__root:p,__injectWithOption:y}}function wl(i={}){const t=vl(Xy(i)),{__extender:e}=i,r={id:t.id,get locale(){return t.locale.value},set locale(n){t.locale.value=n},get fallbackLocale(){return t.fallbackLocale.value},set fallbackLocale(n){t.fallbackLocale.value=n},get messages(){return t.messages.value},get datetimeFormats(){return t.datetimeFormats.value},get numberFormats(){return t.numberFormats.value},get availableLocales(){return t.availableLocales},get missing(){return t.getMissingHandler()},set missing(n){t.setMissingHandler(n)},get silentTranslationWarn(){return ct(t.missingWarn)?!t.missingWarn:t.missingWarn},set silentTranslationWarn(n){t.missingWarn=ct(n)?!n:n},get silentFallbackWarn(){return ct(t.fallbackWarn)?!t.fallbackWarn:t.fallbackWarn},set silentFallbackWarn(n){t.fallbackWarn=ct(n)?!n:n},get modifiers(){return t.modifiers},get formatFallbackMessages(){return t.fallbackFormat},set formatFallbackMessages(n){t.fallbackFormat=n},get postTranslation(){return t.getPostTranslationHandler()},set postTranslation(n){t.setPostTranslationHandler(n)},get sync(){return t.inheritLocale},set sync(n){t.inheritLocale=n},get warnHtmlInMessage(){return t.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(n){t.warnHtmlMessage=n!=="off"},get escapeParameterHtml(){return t.escapeParameter},set escapeParameterHtml(n){t.escapeParameter=n},get pluralizationRules(){return t.pluralRules||{}},__composer:t,t(...n){return Reflect.apply(t.t,t,[...n])},rt(...n){return Reflect.apply(t.rt,t,[...n])},tc(...n){const[o,s,l]=n,a={plural:1};let c=null,h=null;if(!F(o))throw ce(re.INVALID_ARGUMENT);const u=o;return F(s)?a.locale=s:Nt(s)?a.plural=s:At(s)?c=s:it(s)&&(h=s),F(l)?a.locale=l:At(l)?c=l:it(l)&&(h=l),Reflect.apply(t.t,t,[u,c||h||{},a])},te(n,o){return t.te(n,o)},tm(n){return t.tm(n)},getLocaleMessage(n){return t.getLocaleMessage(n)},setLocaleMessage(n,o){t.setLocaleMessage(n,o)},mergeLocaleMessage(n,o){t.mergeLocaleMessage(n,o)},d(...n){return Reflect.apply(t.d,t,[...n])},getDateTimeFormat(n){return t.getDateTimeFormat(n)},setDateTimeFormat(n,o){t.setDateTimeFormat(n,o)},mergeDateTimeFormat(n,o){t.mergeDateTimeFormat(n,o)},n(...n){return Reflect.apply(t.n,t,[...n])},getNumberFormat(n){return t.getNumberFormat(n)},setNumberFormat(n,o){t.setNumberFormat(n,o)},mergeNumberFormat(n,o){t.mergeNumberFormat(n,o)}};return r.__extender=e,r}function Qy(i,t,e){return{beforeCreate(){const r=oo();if(!r)throw ce(re.UNEXPECTED_ERROR);const n=this.$options;if(n.i18n){const o=n.i18n;if(n.__i18n&&(o.__i18n=n.__i18n),o.__root=t,this===this.$root)this.$i18n=Wh(i,o);else{o.__injectWithOption=!0,o.__extender=e.__vueI18nExtend,this.$i18n=wl(o);const s=this.$i18n;s.__extender&&(s.__disposer=s.__extender(this.$i18n))}}else if(n.__i18n)if(this===this.$root)this.$i18n=Wh(i,n);else{this.$i18n=wl({__i18n:n.__i18n,__injectWithOption:!0,__extender:e.__vueI18nExtend,__root:t});const o=this.$i18n;o.__extender&&(o.__disposer=o.__extender(this.$i18n))}else this.$i18n=i;n.__i18nGlobal&&Dh(t,n,n),this.$t=(...o)=>this.$i18n.t(...o),this.$rt=(...o)=>this.$i18n.rt(...o),this.$tc=(...o)=>this.$i18n.tc(...o),this.$te=(o,s)=>this.$i18n.te(o,s),this.$d=(...o)=>this.$i18n.d(...o),this.$n=(...o)=>this.$i18n.n(...o),this.$tm=o=>this.$i18n.tm(o),e.__setInstance(r,this.$i18n)},mounted(){},unmounted(){const r=oo();if(!r)throw ce(re.UNEXPECTED_ERROR);const n=this.$i18n;delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,n.__disposer&&(n.__disposer(),delete n.__disposer,delete n.__extender),e.__deleteInstance(r),delete this.$i18n}}}function Wh(i,t){i.locale=t.locale||i.locale,i.fallbackLocale=t.fallbackLocale||i.fallbackLocale,i.missing=t.missing||i.missing,i.silentTranslationWarn=t.silentTranslationWarn||i.silentFallbackWarn,i.silentFallbackWarn=t.silentFallbackWarn||i.silentFallbackWarn,i.formatFallbackMessages=t.formatFallbackMessages||i.formatFallbackMessages,i.postTranslation=t.postTranslation||i.postTranslation,i.warnHtmlInMessage=t.warnHtmlInMessage||i.warnHtmlInMessage,i.escapeParameterHtml=t.escapeParameterHtml||i.escapeParameterHtml,i.sync=t.sync||i.sync,i.__composer[_h](t.pluralizationRules||i.pluralizationRules);const e=yl(i.locale,{messages:t.messages,__i18n:t.__i18n});return Object.keys(e).forEach(r=>i.mergeLocaleMessage(r,e[r])),t.datetimeFormats&&Object.keys(t.datetimeFormats).forEach(r=>i.mergeDateTimeFormat(r,t.datetimeFormats[r])),t.numberFormats&&Object.keys(t.numberFormats).forEach(r=>i.mergeNumberFormat(r,t.numberFormats[r])),i}const bl={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:i=>i==="parent"||i==="global",default:"parent"},i18n:{type:Object}};function Zy({slots:i},t){return t.length===1&&t[0]==="default"?(i.default?i.default():[]).reduce((e,r)=>[...e,...r.type===Oe?r.children:[r]],[]):t.reduce((e,r)=>{const n=i[r];return n&&(e[r]=n()),e},{})}function Fh(){return Oe}const tv=Q({name:"i18n-t",props:It({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:i=>Nt(i)||!isNaN(i)}},bl),setup(i,t){const{slots:e,attrs:r}=t,n=i.i18n||Jt({useScope:i.scope,__useComponent:!0});return()=>{const o=Object.keys(e).filter(u=>u!=="_"),s={};i.locale&&(s.locale=i.locale),i.plural!==void 0&&(s.plural=F(i.plural)?+i.plural:i.plural);const l=Zy(t,o),a=n[fl](i.keypath,l,s),c=It({},r),h=F(i.tag)||ut(i.tag)?i.tag:Fh();return Xr(h,c,a)}}}),Vh=tv;function ev(i){return At(i)&&!F(i[0])}function Hh(i,t,e,r){const{slots:n,attrs:o}=t;return()=>{const s={part:!0};let l={};i.locale&&(s.locale=i.locale),F(i.format)?s.key=i.format:ut(i.format)&&(F(i.format.key)&&(s.key=i.format.key),l=Object.keys(i.format).reduce((d,f)=>e.includes(f)?It({},d,{[f]:i.format[f]}):d,{}));const a=r(i.value,s,l);let c=[s.key];At(a)?c=a.map((d,f)=>{const m=n[d.type],v=m?m({[d.type]:d.value,index:f,parts:a}):[d.value];return ev(v)&&(v[0].key=`${d.type}-${f}`),v}):F(a)&&(c=[a]);const h=It({},o),u=F(i.tag)||ut(i.tag)?i.tag:Fh();return Xr(u,h,c)}}const iv=Q({name:"i18n-n",props:It({value:{type:Number,required:!0},format:{type:[String,Object]}},bl),setup(i,t){const e=i.i18n||Jt({useScope:i.scope,__useComponent:!0});return Hh(i,t,kh,(...r)=>e[ml](...r))}}),Uh=iv,rv=Q({name:"i18n-d",props:It({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},bl),setup(i,t){const e=i.i18n||Jt({useScope:i.scope,__useComponent:!0});return Hh(i,t,wh,(...r)=>e[pl](...r))}}),zh=rv;function nv(i,t){const e=i;if(i.mode==="composition")return e.__getInstance(t)||i.global;{const r=e.__getInstance(t);return r!=null?r.__composer:i.global.__composer}}function ov(i){const t=e=>{const{instance:r,value:n}=e;if(!r||!r.$)throw ce(re.UNEXPECTED_ERROR);const o=nv(i,r.$),s=jh(n);return[Reflect.apply(o.t,o,[...$h(s)]),o]};return{created:(e,r)=>{const[n,o]=t(r);uo&&i.global===o&&(e.__i18nWatcher=xe(o.locale,()=>{r.instance&&r.instance.$forceUpdate()})),e.__composer=o,e.textContent=n},unmounted:e=>{uo&&e.__i18nWatcher&&(e.__i18nWatcher(),e.__i18nWatcher=void 0,delete e.__i18nWatcher),e.__composer&&(e.__composer=void 0,delete e.__composer)},beforeUpdate:(e,{value:r})=>{if(e.__composer){const n=e.__composer,o=jh(r);e.textContent=Reflect.apply(n.t,n,[...$h(o)])}},getSSRProps:e=>{const[r]=t(e);return{textContent:r}}}}function jh(i){if(F(i))return{path:i};if(it(i)){if(!("path"in i))throw ce(re.REQUIRED_VALUE,"path");return i}else throw ce(re.INVALID_VALUE)}function $h(i){const{path:t,locale:e,args:r,choice:n,plural:o}=i,s={},l=r||{};return F(e)&&(s.locale=e),Nt(n)&&(s.plural=n),Nt(o)&&(s.plural=o),[t,l,s]}function sv(i,t,...e){const r=it(e[0])?e[0]:{};(!ct(r.globalInstall)||r.globalInstall)&&([Vh.name,"I18nT"].forEach(n=>i.component(n,Vh)),[Uh.name,"I18nN"].forEach(n=>i.component(n,Uh)),[zh.name,"I18nD"].forEach(n=>i.component(n,zh))),i.directive("t",ov(t))}const lv=bi("global-vue-i18n");function av(i={},t){const e=__VUE_I18N_LEGACY_API__&&ct(i.legacy)?i.legacy:__VUE_I18N_LEGACY_API__,r=ct(i.globalInjection)?i.globalInjection:!0,n=new Map,[o,s]=cv(i,e),l=bi("");function a(d){return n.get(d)||null}function c(d,f){n.set(d,f)}function h(d){n.delete(d)}const u={get mode(){return __VUE_I18N_LEGACY_API__&&e?"legacy":"composition"},async install(d,...f){if(d.__VUE_I18N_SYMBOL__=l,d.provide(d.__VUE_I18N_SYMBOL__,u),it(f[0])){const p=f[0];u.__composerExtend=p.__composerExtend,u.__vueI18nExtend=p.__vueI18nExtend}let m=null;!e&&r&&(m=yv(d,u.global)),__VUE_I18N_FULL_INSTALL__&&sv(d,u,...f),__VUE_I18N_LEGACY_API__&&e&&d.mixin(Qy(s,s.__composer,u));const v=d.unmount;d.unmount=()=>{m&&m(),u.dispose(),v()}},get global(){return s},dispose(){o.stop()},__instances:n,__getInstance:a,__setInstance:c,__deleteInstance:h};return u}Jt=function(i={}){const t=oo();if(t==null)throw ce(re.MUST_BE_CALL_SETUP_TOP);if(!t.isCE&&t.appContext.app!=null&&!t.appContext.app.__VUE_I18N_SYMBOL__)throw ce(re.NOT_INSTALLED);const e=hv(t),r=dv(e),n=Oh(t),o=uv(i,n);if(o==="global")return Dh(r,i,n),r;if(o==="parent"){let a=fv(e,t,i.__useComponent);return a==null&&(a=r),a}const s=e;let l=s.__getInstance(t);if(l==null){const a=It({},i);"__i18n"in n&&(a.__i18n=n.__i18n),r&&(a.__root=r),l=vl(a),s.__composerExtend&&(l[gl]=s.__composerExtend(l)),mv(s,t,l),s.__setInstance(t,l)}return l};function cv(i,t,e){const r=Vc(),n=__VUE_I18N_LEGACY_API__&&t?r.run(()=>wl(i)):r.run(()=>vl(i));if(n==null)throw ce(re.UNEXPECTED_ERROR);return[r,n]}function hv(i){const t=Hc(i.isCE?lv:i.appContext.app.__VUE_I18N_SYMBOL__);if(!t)throw ce(i.isCE?re.NOT_INSTALLED_WITH_PROVIDE:re.UNEXPECTED_ERROR);return t}function uv(i,t){return fo(i)?"__i18n"in t?"local":"global":i.useScope?i.useScope:"local"}function dv(i){return i.mode==="composition"?i.global:i.global.__composer}function fv(i,t,e=!1){let r=null;const n=t.root;let o=pv(t,e);for(;o!=null;){const s=i;if(i.mode==="composition")r=s.__getInstance(o);else if(__VUE_I18N_LEGACY_API__){const l=s.__getInstance(o);l!=null&&(r=l.__composer,e&&r&&!r[Eh]&&(r=null))}if(r!=null||n===o)break;o=o.parent}return r}function pv(i,t=!1){return i==null?null:t&&i.vnode.ctx||i.parent}function mv(i,t,e){hr(()=>{},t),Gs(()=>{const r=e;i.__deleteInstance(t);const n=r[gl];n&&(n(),delete r[gl])},t)}const gv=["locale","fallbackLocale","availableLocales"],qh=["t","rt","d","n","tm","te"];function yv(i,t){const e=Object.create(null);return gv.forEach(r=>{const n=Object.getOwnPropertyDescriptor(t,r);if(!n)throw ce(re.UNEXPECTED_ERROR);const o=Qr(n.value)?{get(){return n.value.value},set(s){n.value.value=s}}:{get(){return n.get&&n.get()}};Object.defineProperty(e,r,o)}),i.config.globalProperties.$i18n=e,qh.forEach(r=>{const n=Object.getOwnPropertyDescriptor(t,r);if(!n||!n.value)throw ce(re.UNEXPECTED_ERROR);Object.defineProperty(i.config.globalProperties,`$${r}`,n)}),()=>{delete i.config.globalProperties.$i18n,qh.forEach(r=>{delete i.config.globalProperties[`$${r}`]})}}if(Gy(),Ly(cy),_y(Ay),Ey(sh),__INTLIFY_PROD_DEVTOOLS__){const i=$i();i.__INTLIFY__=!0,hy(i.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}let Kh,Yh,Gh,Jh,Xh,Qh,Zh,tu,eu,iu,ru,nu,ou,su,lu,au,cu,hu,uu,du,fu,pu,mu,gu,yu,vu,wu,bu,xu,ku,Su,Tu,Au,Mu,Cu,Lu,_u,Eu,Ou,Du,Pu,Ru,Bu,Nu,Iu,Wu,Fu,Vu,Hu,Uu,zu,ju,$u,qu,Ku,Yu,Gu,Ju,Xu,Qu,Zu,td,ed,id,rd,nd,od,sd,ld,ad,cd,hd,ud,dd,fd,pd,md,gd,yd,vd,wd,bd,xd,kd,Sd,Td,Ad,Md,Cd,Ld,_d,Ed,Od,Dd,Pd,Rd,Bd,Nd,Id,Wd,Fd,Vd,Hd,Ud,zd,jd,$d,qd,Kd,Yd,Gd;Kh={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Yh=x("g",{fill:"none"},[x("path",{d:"M21.245 4.5a.75.75 0 0 0-.744.648l-.006.102l.002 13.004a.75.75 0 0 0 1.493.102l.007-.102l-.002-13.004a.75.75 0 0 0-.75-.75zM8.35 6.304l-.073-.084a.75.75 0 0 0-.976-.073l-.084.073l-4.997 4.997a.75.75 0 0 0-.073.976l.073.085l4.996 5.003a.75.75 0 0 0 1.134-.976l-.072-.084l-3.71-3.717h13.676a.75.75 0 0 0 .743-.647l.007-.102a.75.75 0 0 0-.648-.743l-.102-.007l-13.69-.001L8.277 7.28a.75.75 0 0 0 .073-.976l-.073-.084l.073.084z",fill:"currentColor"})],-1),Gh=[Yh],Jh=Q({name:"ArrowExportRtl24Regular",render:function(i,t){return W(),Z("svg",Kh,Gh)}}),Xh={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Qh=x("g",{fill:"none"},[x("path",{d:"M21.25 4.5a.75.75 0 0 1 .743.648L22 5.25v13.004a.75.75 0 0 1-1.493.102l-.007-.102V5.25a.75.75 0 0 1 .75-.75zm-8.603 1.804l.072-.084a.75.75 0 0 1 .977-.073l.084.073l4.997 4.997a.75.75 0 0 1 .073.976l-.073.085l-4.997 5.003a.75.75 0 0 1-1.133-.976l.072-.084l3.711-3.717H2.75a.75.75 0 0 1-.743-.647L2 11.755a.75.75 0 0 1 .648-.743l.102-.007l13.693-.001l-3.724-3.724a.75.75 0 0 1-.072-.976l.072-.084l-.072.084z",fill:"currentColor"})],-1),Zh=[Qh],tu=Q({name:"ArrowImport24Regular",render:function(i,t){return W(),Z("svg",Xh,Zh)}}),eu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},iu=x("g",{fill:"none"},[x("path",{d:"M19.25 2a.75.75 0 0 0-.743.648l-.007.102v5.69l-4.574-4.56a6.41 6.41 0 0 0-8.878-.179l-.186.18a6.41 6.41 0 0 0 0 9.063l8.845 8.84a.75.75 0 0 0 1.06-1.062l-8.845-8.838a4.91 4.91 0 0 1 6.766-7.112l.178.17L17.438 9.5H11.75a.75.75 0 0 0-.743.648L11 10.25c0 .38.282.694.648.743l.102.007h7.5a.75.75 0 0 0 .743-.648L20 10.25v-7.5a.75.75 0 0 0-.75-.75z",fill:"currentColor"})],-1),ru=[iu],nu=Q({name:"ArrowRedo24Regular",render:function(i,t){return W(),Z("svg",eu,ru)}}),ou={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},su=x("g",{fill:"none"},[x("path",{d:"M6.78 2.72a.75.75 0 0 1 0 1.06L4.56 6h8.69a7.75 7.75 0 1 1-7.75 7.75a.75.75 0 0 1 1.5 0a6.25 6.25 0 1 0 6.25-6.25H4.56l2.22 2.22a.75.75 0 1 1-1.06 1.06l-3.5-3.5a.75.75 0 0 1 0-1.06l3.5-3.5a.75.75 0 0 1 1.06 0z",fill:"currentColor"})],-1),lu=[su],au=Q({name:"ArrowReset24Regular",render:function(i,t){return W(),Z("svg",ou,lu)}}),cu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},hu=x("g",{fill:"none"},[x("path",{d:"M4.75 2a.75.75 0 0 1 .743.648l.007.102v5.69l4.574-4.56a6.41 6.41 0 0 1 8.879-.179l.186.18a6.41 6.41 0 0 1 0 9.063l-8.846 8.84a.75.75 0 0 1-1.06-1.062l8.845-8.838a4.91 4.91 0 0 0-6.766-7.112l-.178.17L6.562 9.5h5.688a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.648.743L12.25 11h-7.5a.75.75 0 0 1-.743-.648L4 10.25v-7.5A.75.75 0 0 1 4.75 2z",fill:"currentColor"})],-1),uu=[hu],du=Q({name:"ArrowUndo24Regular",render:function(i,t){return W(),Z("svg",cu,uu)}}),fu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},pu=x("g",{fill:"none"},[x("path",{d:"M13.75 2a2.25 2.25 0 0 1 2.245 2.096L16 4.25c0-.085-.005-.168-.014-.25h1.764A2.25 2.25 0 0 1 20 6.25v13.5A2.25 2.25 0 0 1 17.75 22H6.25A2.25 2.25 0 0 1 4 19.75V6.25A2.25 2.25 0 0 1 6.25 4h1.764c-.007.058-.01.117-.013.176L8 4.25A2.25 2.25 0 0 1 10.25 2h3.5zm0 4.5h-3.5a2.248 2.248 0 0 1-1.892-1.033l.021.033H6.25a.75.75 0 0 0-.75.75v13.5c0 .414.336.75.75.75h11.5a.75.75 0 0 0 .75-.75V6.25a.75.75 0 0 0-.75-.75h-2.129l.021-.033A2.248 2.248 0 0 1 13.75 6.5zm0-3h-3.5a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5z",fill:"currentColor"})],-1),mu=[pu],gu=Q({name:"Clipboard24Regular",render:function(i,t){return W(),Z("svg",fu,mu)}}),yu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},vu=x("g",{fill:"none"},[x("path",{d:"M12.753 2c1.158 0 2.111.875 2.234 2h1.763a2.25 2.25 0 0 1 2.245 2.096L19 6.25a.75.75 0 0 1-.647.742L18.249 7a.75.75 0 0 1-.742-.647L17.5 6.25a.75.75 0 0 0-.648-.743L16.75 5.5h-2.132a2.244 2.244 0 0 1-1.865.993H9.247c-.777 0-1.461-.393-1.865-.992L5.25 5.5a.75.75 0 0 0-.743.648L4.5 6.25v13.505c0 .38.282.693.648.743l.102.007h3a.75.75 0 0 1 .743.647l.007.102a.75.75 0 0 1-.75.75h-3a2.25 2.25 0 0 1-2.245-2.095L3 19.755V6.25a2.25 2.25 0 0 1 2.096-2.245L5.25 4h1.763a2.247 2.247 0 0 1 2.234-2h3.506zm5.997 6a2.25 2.25 0 0 1 2.245 2.096l.005.154v9.5a2.25 2.25 0 0 1-2.096 2.245L18.75 22h-6.5a2.25 2.25 0 0 1-2.245-2.096L10 19.75v-9.5a2.25 2.25 0 0 1 2.096-2.245L12.25 8h6.5zm0 1.5h-6.5a.75.75 0 0 0-.743.648l-.007.102v9.5c0 .38.282.694.648.743l.102.007h6.5a.75.75 0 0 0 .743-.648l.007-.102v-9.5a.75.75 0 0 0-.648-.743L18.75 9.5zm-5.997-6H9.247a.747.747 0 0 0 0 1.493h3.506a.747.747 0 1 0 0-1.493z",fill:"currentColor"})],-1),wu=[vu],bu=Q({name:"ClipboardPaste24Regular",render:function(i,t){return W(),Z("svg",yu,wu)}}),xu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ku=x("g",{fill:"none"},[x("path",{d:"M6.087 7.75a5.752 5.752 0 0 1 11.326 0h.087a4 4 0 0 1 3.962 4.552a6.534 6.534 0 0 0-1.597-1.364A2.501 2.501 0 0 0 17.5 9.25h-.756a.75.75 0 0 1-.75-.713a4.25 4.25 0 0 0-8.489 0a.75.75 0 0 1-.749.713H6a2.5 2.5 0 0 0 0 5h4.4a6.458 6.458 0 0 0-.357 1.5H6a4 4 0 0 1 0-8h.087zM22 16.5a5.5 5.5 0 1 0-11 0a5.5 5.5 0 0 0 11 0zm-6-3a.5.5 0 0 1 1 0v4.793l1.646-1.647a.5.5 0 0 1 .708.708l-2.5 2.5a.5.5 0 0 1-.708 0l-2.5-2.5a.5.5 0 0 1 .708-.708L16 18.293V13.5z",fill:"currentColor"})],-1),Su=[ku],Tu=Q({name:"CloudArrowDown24Regular",render:function(i,t){return W(),Z("svg",xu,Su)}}),Au={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Mu=x("g",{fill:"none"},[x("path",{d:"M6.087 7.75a5.752 5.752 0 0 1 11.326 0h.087a4 4 0 0 1 3.962 4.552a6.534 6.534 0 0 0-1.597-1.364A2.501 2.501 0 0 0 17.5 9.25h-.756a.75.75 0 0 1-.75-.713a4.25 4.25 0 0 0-8.489 0a.75.75 0 0 1-.749.713H6a2.5 2.5 0 0 0 0 5h4.4a6.458 6.458 0 0 0-.357 1.5H6a4 4 0 0 1 0-8h.087zM22 16.5a5.5 5.5 0 1 1-11 0a5.5 5.5 0 0 1 11 0zm-6-1.793V19.5a.5.5 0 0 0 1 0v-4.793l1.646 1.647a.5.5 0 0 0 .708-.708l-2.5-2.5a.5.5 0 0 0-.708 0l-2.5 2.5a.5.5 0 0 0 .708.708L16 14.707z",fill:"currentColor"})],-1),Cu=[Mu],Lu=Q({name:"CloudArrowUp24Regular",render:function(i,t){return W(),Z("svg",Au,Cu)}}),_u={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Eu=x("g",{fill:"none"},[x("path",{d:"M10 4h3a.5.5 0 0 1 0 1h-.553l-.752 6.776A2.5 2.5 0 0 1 9.21 14H6.79a2.5 2.5 0 0 1-2.485-2.224L3.552 5H3a.5.5 0 0 1 0-1h3a2 2 0 1 1 4 0zM8 3a1 1 0 0 0-1 1h2a1 1 0 0 0-1-1zM6.5 7v4a.5.5 0 0 0 1 0V7a.5.5 0 0 0-1 0zM9 6.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 1 0V7a.5.5 0 0 0-.5-.5z",fill:"currentColor"})],-1),Ou=[Eu],Du=Q({name:"Delete16Filled",render:function(i,t){return W(),Z("svg",_u,Ou)}}),Pu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ru=x("g",{fill:"none"},[x("path",{d:"M18.5 20a.5.5 0 0 1-.5.5H6a.5.5 0 0 1-.5-.5V4a.5.5 0 0 1 .5-.5h6V8a2 2 0 0 0 2 2h4.5v10zm-5-15.379L17.378 8.5H14a.5.5 0 0 1-.5-.5V4.621zm5.914 3.793l-5.829-5.828c-.026-.026-.058-.046-.085-.07a2.072 2.072 0 0 0-.219-.18c-.04-.027-.086-.045-.128-.068c-.071-.04-.141-.084-.216-.116a1.977 1.977 0 0 0-.624-.138C12.266 2.011 12.22 2 12.172 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9.828a2 2 0 0 0-.586-1.414z",fill:"currentColor"})],-1),Bu=[Ru],Nu=Q({name:"Document24Regular",render:function(i,t){return W(),Z("svg",Pu,Bu)}}),Iu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Wu=x("g",{fill:"none"},[x("path",{d:"M20 9.502V8.75a2.25 2.25 0 0 0-2.25-2.25h-5.725l-2.38-1.98A2.25 2.25 0 0 0 8.204 4H4.25A2.25 2.25 0 0 0 2 6.25l-.004 11.5A2.25 2.25 0 0 0 4.246 20H18.47a1.75 1.75 0 0 0 1.698-1.325l1.75-6.998a1.75 1.75 0 0 0-1.698-2.175H20zM4.25 5.5h3.956a.75.75 0 0 1 .48.173l2.588 2.154a.75.75 0 0 0 .48.173h5.996a.75.75 0 0 1 .75.75v.752H6.424a2.25 2.25 0 0 0-2.183 1.704l-.744 2.978L3.5 6.25a.75.75 0 0 1 .75-.75zm1.447 6.07a.75.75 0 0 1 .727-.568H20.22a.25.25 0 0 1 .242.31l-1.75 6.999a.25.25 0 0 1-.242.189H4.285a.25.25 0 0 1-.243-.31l1.655-6.62z",fill:"currentColor"})],-1),Fu=[Wu],Vu=Q({name:"FolderOpen24Regular",render:function(i,t){return W(),Z("svg",Iu,Fu)}}),Hu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Uu=x("g",{fill:"none"},[x("path",{d:"M4 3.5a.5.5 0 0 0-.5.5v1.614a.75.75 0 0 1-1.5 0V4a2 2 0 0 1 2-2h1.614a.75.75 0 0 1 0 1.5H4zm5.636-.75a.75.75 0 0 1 .75-.75H12a2 2 0 0 1 2 2v1.614a.75.75 0 0 1-1.5 0V4a.5.5 0 0 0-.5-.5h-1.614a.75.75 0 0 1-.75-.75zM2.75 9.636a.75.75 0 0 1 .75.75V12a.5.5 0 0 0 .5.5h1.614a.75.75 0 0 1 0 1.5H4a2 2 0 0 1-2-2v-1.614a.75.75 0 0 1 .75-.75zm10.5 0a.75.75 0 0 1 .75.75V12a2 2 0 0 1-2 2h-1.614a.75.75 0 1 1 0-1.5H12a.5.5 0 0 0 .5-.5v-1.614a.75.75 0 0 1 .75-.75z",fill:"currentColor"})],-1),zu=[Uu],ju=Q({name:"FullScreenMaximize16Filled",render:function(i,t){return W(),Z("svg",Hu,zu)}}),$u={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},qu=x("g",{fill:"none"},[x("path",{d:"M10.55 2.532a2.25 2.25 0 0 1 2.9 0l6.75 5.692c.507.428.8 1.057.8 1.72v9.803a1.75 1.75 0 0 1-1.75 1.75h-3.5a1.75 1.75 0 0 1-1.75-1.75v-5.5a.25.25 0 0 0-.25-.25h-3.5a.25.25 0 0 0-.25.25v5.5a1.75 1.75 0 0 1-1.75 1.75h-3.5A1.75 1.75 0 0 1 3 19.747V9.944c0-.663.293-1.292.8-1.72l6.75-5.692zm1.933 1.147a.75.75 0 0 0-.966 0L4.767 9.37a.75.75 0 0 0-.267.573v9.803c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25v-5.5c0-.967.784-1.75 1.75-1.75h3.5c.966 0 1.75.783 1.75 1.75v5.5c0 .138.112.25.25.25h3.5a.25.25 0 0 0 .25-.25V9.944a.75.75 0 0 0-.267-.573l-6.75-5.692z",fill:"currentColor"})],-1),Ku=[qu],Yu=Q({name:"Home24Regular",render:function(i,t){return W(),Z("svg",$u,Ku)}}),Gu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ju=x("g",{fill:"none"},[x("path",{d:"M12 1.999c5.524 0 10.002 4.478 10.002 10.002c0 5.523-4.478 10.001-10.002 10.001C6.476 22.002 2 17.524 2 12.001C1.999 6.477 6.476 1.999 12 1.999zm0 1.5a8.502 8.502 0 1 0 0 17.003A8.502 8.502 0 0 0 12 3.5zm-.004 7a.75.75 0 0 1 .744.648l.007.102l.004 5.502a.75.75 0 0 1-1.494.102l-.006-.101l-.004-5.502a.75.75 0 0 1 .75-.75zm.005-3.497a.999.999 0 1 1 0 1.997a.999.999 0 0 1 0-1.997z",fill:"currentColor"})],-1),Xu=[Ju],Qu=Q({name:"Info24Regular",render:function(i,t){return W(),Z("svg",Gu,Xu)}}),Zu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},td=x("g",{fill:"none"},[x("path",{d:"M6.78 4.78a.75.75 0 0 0-1.06-1.06L3.75 5.69l-.47-.47a.75.75 0 0 0-1.06 1.06l1 1a.75.75 0 0 0 1.06 0l2.5-2.5zm2.97 13.227h11.5a.75.75 0 0 1 .102 1.493l-.102.007H9.75a.75.75 0 0 1-.102-1.493l.102-.007zm0-6.507h11.5a.75.75 0 0 1 .102 1.493L21.25 13H9.75a.75.75 0 0 1-.102-1.493l.102-.007zm0-6.5h11.5a.75.75 0 0 1 .102 1.493l-.102.007H9.75a.75.75 0 0 1-.102-1.493L9.75 5zM6.78 16.72a.75.75 0 0 1 0 1.06l-2.5 2.5a.75.75 0 0 1-1.06 0l-1-1a.75.75 0 1 1 1.06-1.06l.47.47l1.97-1.97a.75.75 0 0 1 1.06 0z",fill:"currentColor"})],-1),ed=[td],id=Q({name:"MultiselectLtr24Regular",render:function(i,t){return W(),Z("svg",Zu,ed)}}),rd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},nd=x("g",{fill:"none"},[x("path",{d:"M20 2.75a.75.75 0 0 0-.965-.718l-10 3a.75.75 0 0 0-.535.718v9.877a3.5 3.5 0 1 0 1.496 2.702a.756.756 0 0 0 .004-.079v-7.942l8.5-2.55v5.87a3.5 3.5 0 1 0 1.496 2.702a.764.764 0 0 0 .004-.08V2.75z",fill:"currentColor"})],-1),od=[nd],sd=Q({name:"MusicNote224Filled",render:function(i,t){return W(),Z("svg",rd,od)}}),ld={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},ad=x("g",{fill:"none"},[x("path",{d:"M17.75 7A3.25 3.25 0 0 1 21 10.25v27.5A3.25 3.25 0 0 1 17.75 41h-5.5A3.25 3.25 0 0 1 9 37.75v-27.5A3.25 3.25 0 0 1 12.25 7h5.5zm18 0A3.25 3.25 0 0 1 39 10.25v27.5A3.25 3.25 0 0 1 35.75 41h-5.5A3.25 3.25 0 0 1 27 37.75v-27.5A3.25 3.25 0 0 1 30.25 7h5.5z",fill:"currentColor"})],-1),cd=[ad],hd=Q({name:"Pause48Filled",render:function(i,t){return W(),Z("svg",ld,cd)}}),ud={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},dd=x("g",{fill:"none"},[x("path",{d:"M16.75 8.412l24.417 12.705a3.25 3.25 0 0 1 0 5.766L16.75 39.588A3.25 3.25 0 0 1 12 36.705v-25.41a3.25 3.25 0 0 1 4.549-2.98l.201.097z",fill:"currentColor"})],-1),fd=[dd],pd=Q({name:"Play48Filled",render:function(i,t){return W(),Z("svg",ud,fd)}}),md={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},gd=x("g",{fill:"none"},[x("path",{d:"M3 5.75A2.75 2.75 0 0 1 5.75 3h9.964a3.25 3.25 0 0 1 2.299.952l2.035 2.035c.61.61.952 1.437.952 2.299v9.964A2.75 2.75 0 0 1 18.25 21H5.75A2.75 2.75 0 0 1 3 18.25V5.75zM5.75 4.5c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25H6v-5.25A2.25 2.25 0 0 1 8.25 12h7.5A2.25 2.25 0 0 1 18 14.25v5.25h.25c.69 0 1.25-.56 1.25-1.25V8.286c0-.465-.184-.91-.513-1.238l-2.035-2.035a1.75 1.75 0 0 0-.952-.49V7.25a2.25 2.25 0 0 1-2.25 2.25h-4.5A2.25 2.25 0 0 1 7 7.25V4.5H5.75zm10.75 15v-5.25a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0-.75.75v5.25h9zm-8-15v2.75c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75V4.5h-6z",fill:"currentColor"})],-1),yd=[gd],vd=Q({name:"Save24Regular",render:function(i,t){return W(),Z("svg",md,yd)}}),wd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},bd=x("g",{fill:"none"},[x("path",{d:"M20.496 5.627A2.25 2.25 0 0 1 22 7.75v10A4.25 4.25 0 0 1 17.75 22h-10a2.25 2.25 0 0 1-2.123-1.504l2.097.004H17.75a2.75 2.75 0 0 0 2.75-2.75v-10l-.004-.051V5.627zM17.246 2a2.25 2.25 0 0 1 2.25 2.25v12.997a2.25 2.25 0 0 1-2.25 2.25H4.25A2.25 2.25 0 0 1 2 17.247V4.25A2.25 2.25 0 0 1 4.25 2h12.997zm0 1.5H4.25a.75.75 0 0 0-.75.75v12.997c0 .414.336.75.75.75h12.997a.75.75 0 0 0 .75-.75V4.25a.75.75 0 0 0-.75-.75z",fill:"currentColor"})],-1),xd=[bd],kd=Q({name:"SelectAllOff24Regular",render:function(i,t){return W(),Z("svg",wd,xd)}}),Sd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Td=x("g",{fill:"none"},[x("path",{d:"M20.496 5.627A2.25 2.25 0 0 1 22 7.75v10A4.25 4.25 0 0 1 17.75 22h-10a2.25 2.25 0 0 1-2.123-1.504l2.097.004H17.75a2.75 2.75 0 0 0 2.75-2.75v-10l-.004-.051V5.627zM17.246 2a2.25 2.25 0 0 1 2.25 2.25v12.997a2.25 2.25 0 0 1-2.25 2.25H4.25A2.25 2.25 0 0 1 2 17.247V4.25A2.25 2.25 0 0 1 4.25 2h12.997zm0 1.5H4.25a.75.75 0 0 0-.75.75v12.997c0 .414.336.75.75.75h12.997a.75.75 0 0 0 .75-.75V4.25a.75.75 0 0 0-.75-.75zm-7.665 7.858L13.47 7.47a.75.75 0 0 1 1.133.976l-.073.084l-4.5 4.5a.75.75 0 0 1-1.056.004L8.9 12.95l-1.5-2a.75.75 0 0 1 1.127-.984l.073.084l.981 1.308L13.47 7.47L9.58 11.358z",fill:"currentColor"})],-1),Ad=[Td],Md=Q({name:"SelectAllOn24Regular",render:function(i,t){return W(),Z("svg",Sd,Ad)}}),Cd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Ld=x("g",{fill:"none"},[x("path",{d:"M12.013 2.25c.734.008 1.465.093 2.181.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.928 1.116l1.4-.615a.75.75 0 0 1 .85.174a9.793 9.793 0 0 1 2.204 3.792a.75.75 0 0 1-.271.825l-1.242.916a1.38 1.38 0 0 0 .001 2.226l1.243.915a.75.75 0 0 1 .271.826a9.798 9.798 0 0 1-2.203 3.792a.75.75 0 0 1-.849.175l-1.406-.617a1.38 1.38 0 0 0-1.927 1.114l-.169 1.526a.75.75 0 0 1-.572.647a9.518 9.518 0 0 1-4.405 0a.75.75 0 0 1-.572-.647l-.17-1.524a1.382 1.382 0 0 0-1.924-1.11l-1.407.616a.75.75 0 0 1-.849-.175a9.798 9.798 0 0 1-2.203-3.796a.75.75 0 0 1 .271-.826l1.244-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.272-.826a9.793 9.793 0 0 1 2.205-3.792a.75.75 0 0 1 .849-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.718-.159 1.45-.243 2.202-.252zm0 1.5a9.135 9.135 0 0 0-1.355.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.798.588c.32.842.775 1.626 1.347 2.322l.906-.397a2.882 2.882 0 0 1 4.017 2.318l.108.984c.89.15 1.799.15 2.689 0l.108-.984a2.88 2.88 0 0 1 4.02-2.322l.904.396a8.299 8.299 0 0 0 1.347-2.318l-.798-.588a2.88 2.88 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.99 8.99 0 0 0-1.333-.117zM12 8.25a3.75 3.75 0 1 1 0 7.5a3.75 3.75 0 0 1 0-7.5zm0 1.5a2.25 2.25 0 1 0 0 4.5a2.25 2.25 0 0 0 0-4.5z",fill:"currentColor"})],-1),_d=[Ld],Ed=Q({name:"Settings24Regular",render:function(i,t){return W(),Z("svg",Cd,_d)}}),Od={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48"},Dd=x("g",{fill:"none"},[x("path",{d:"M25.081 6.419C26.208 5.408 28 6.207 28 7.72V40.28c0 1.514-1.792 2.313-2.919 1.302l-8.206-7.366A4.75 4.75 0 0 0 13.702 33H9a5.25 5.25 0 0 1-5.25-5.25v-7.5C3.75 17.35 6.1 15 9 15h4.702a4.75 4.75 0 0 0 3.173-1.216l8.206-7.366zm11.257 1.977a1.25 1.25 0 0 1 1.766-.058l.011.01l-.01-.01l.001.002l.003.002l.006.006l.019.018l.06.058a14.49 14.49 0 0 1 .885.991a20.408 20.408 0 0 1 2.015 3.006C42.552 15.059 44 18.953 44 24c0 5.047-1.448 8.94-2.906 11.58a20.412 20.412 0 0 1-2.016 3.004a14.535 14.535 0 0 1-.885.992a5.518 5.518 0 0 1-.06.058l-.018.018l-.006.006l-.003.002v.001s.66-.661-.002 0a1.25 1.25 0 0 1-1.711-1.822l.002-.001l.003-.003l.032-.032c.031-.03.081-.081.147-.15c.131-.14.326-.356.563-.648a17.906 17.906 0 0 0 1.766-2.635C40.198 32.034 41.5 28.553 41.5 24c0-4.553-1.302-8.034-2.594-10.37a17.906 17.906 0 0 0-1.766-2.636a12.05 12.05 0 0 0-.71-.798a3.261 3.261 0 0 0-.032-.032l-.003-.003l-.002-.002a1.25 1.25 0 0 1-.055-1.764zM32.334 14.4a1.25 1.25 0 0 1 1.767-.066l.064.062l-.064-.06h.001l.002.002l.005.005l.014.012l.042.041a10.184 10.184 0 0 1 .59.644c.365.436.846 1.072 1.325 1.893A13.977 13.977 0 0 1 38 24c0 3.023-.963 5.426-1.92 7.068c-.48.82-.96 1.457-1.326 1.893a10.184 10.184 0 0 1-.59.644l-.019.019a1.541 1.541 0 0 1-.022.021l-.014.013l-.005.005l-.003.003l.008-.008l-.008.008a1.25 1.25 0 0 1-1.705-1.828l.002-.002l.016-.016c.017-.017.046-.045.085-.086a7.69 7.69 0 0 0 .34-.381c.29-.346.685-.866 1.081-1.545A11.477 11.477 0 0 0 35.5 24c0-2.477-.787-4.449-1.58-5.807c-.396-.68-.79-1.2-1.08-1.545a7.69 7.69 0 0 0-.426-.467l-.017-.017l.001.001a1.25 1.25 0 0 1-.064-1.765z",fill:"currentColor"})],-1),Pd=[Dd],Rd=Q({name:"Speaker248Filled",render:function(i,t){return W(),Z("svg",Od,Pd)}}),Bd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Nd=x("g",{fill:"none"},[x("path",{d:"M5 6a1 1 0 0 1 1-1h15a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1zm4 12a1 1 0 0 1 1-1h11a1 1 0 1 1 0 2H10a1 1 0 0 1-1-1zm-6-7a1 1 0 1 0 0 2h18a1 1 0 1 0 0-2H3z",fill:"currentColor"})],-1),Id=[Nd],Gc=Q({name:"TextAlignRight24Filled",render:function(i,t){return W(),Z("svg",Bd,Id)}}),Wd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Fd=x("g",{fill:"none"},[x("path",{d:"M5.25 3A2.25 2.25 0 0 0 3 5.25v13.499a2.25 2.25 0 0 0 2.25 2.25h5.914l.356-1.424l.02-.076H5.25a.75.75 0 0 1-.75-.75v-13.5a.75.75 0 0 1 .75-.75h13.499a.75.75 0 0 1 .75.75v5.983c.478-.19.993-.264 1.5-.22V5.25A2.25 2.25 0 0 0 18.748 3h-13.5zm10.104 11.999h-4.105a.75.75 0 1 0 0 1.5h2.605l1.5-1.5zm-6.605-6.75a1 1 0 1 1-2 0a1 1 0 0 1 2 0zm2.5-.75a.75.75 0 1 0 0 1.5h5.5a.75.75 0 1 0 0-1.5h-5.5zm0 3.75a.75.75 0 1 0 0 1.5h5.5a.75.75 0 1 0 0-1.5h-5.5zM7.75 13a1 1 0 1 0 0-2a1 1 0 0 0 0 2zm1 2.75a1 1 0 1 1-2 0a1 1 0 0 1 2 0zm10.35-3.08l-5.902 5.901a2.685 2.685 0 0 0-.707 1.248l-.457 1.83c-.2.797.522 1.518 1.318 1.319l1.83-.458a2.685 2.685 0 0 0 1.248-.706L22.33 15.9a2.286 2.286 0 0 0-3.233-3.232z",fill:"currentColor"})],-1),Vd=[Fd],Hd=Q({name:"TextBulletListSquareEdit24Regular",render:function(i,t){return W(),Z("svg",Wd,Vd)}}),Ud={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},zd=x("g",{fill:"none"},[x("path",{d:"M6.543 5.483a8.462 8.462 0 0 1 4.707-1.95V5.25a.75.75 0 0 0 1.5 0V3.533a8.502 8.502 0 0 1 7.735 7.967H18.75a.75.75 0 0 0 0 1.5h1.694c-.26 2.312-1.423 4.248-3.168 5.668a.75.75 0 0 0 .948 1.164c2.226-1.813 3.67-4.394 3.77-7.485a.762.762 0 0 0 .004-.156L22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 3.252 1.523 5.954 3.77 7.826a.75.75 0 0 0 .96-1.152C5.02 17.248 3.827 15.307 3.558 13H5.25a.75.75 0 0 0 0-1.5H3.514c.11-1.882.831-3.6 1.969-4.957L6.72 7.78a.75.75 0 0 0 1.06-1.06L6.543 5.483zM16.76 6.634a.646.646 0 0 0-.807.015l-.218.183a396.093 396.093 0 0 0-2.351 1.99c-.656.56-1.327 1.14-1.863 1.613c-.268.236-.504.449-.689.62a5 5 0 0 0-.42.424a1.837 1.837 0 0 0 .312 2.619a1.934 1.934 0 0 0 2.677-.306c.088-.108.205-.296.325-.497c.128-.215.285-.49.459-.798c.347-.62.768-1.392 1.175-2.145a371.614 371.614 0 0 0 1.439-2.697l.131-.249a.613.613 0 0 0-.17-.772z",fill:"currentColor"})],-1),jd=[zd],$d=Q({name:"TopSpeed24Regular",render:function(i,t){return W(),Z("svg",Ud,jd)}}),qd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},Kd=x("g",{fill:"none"},[x("path",{d:"M6 16.938v2.121L5.059 20h-2.12l3.06-3.062zm16.002-2.503v2.122L18.56 20h-.566v-1.557l4.008-4.008zM8.75 14h6.495a1.75 1.75 0 0 1 1.744 1.607l.006.143V20h-1.5v-4.25a.25.25 0 0 0-.193-.243l-.057-.007H8.75a.25.25 0 0 0-.244.193l-.006.057V20H7v-4.25a1.75 1.75 0 0 1 1.606-1.744L8.75 14zm-.729-3.584c.06.579.243 1.12.523 1.6L2 18.56v-2.122l6.021-6.022zm13.98-.484v2.123l-4.007 4.01v-.315l-.004-.168a2.733 2.733 0 0 0-.387-1.247L22 9.932zM12.056 4L2 14.06v-2.121L9.936 4h2.12zm9.946 1.432v2.123l-5.667 5.67a2.732 2.732 0 0 0-.86-.216l-.23-.009h-.6c.342-.301.632-.66.855-1.062l6.502-6.506zM12 7a3 3 0 1 1 0 6a3 3 0 0 1 0-6zm0 1.5a1.5 1.5 0 1 0 0 3a1.5 1.5 0 0 0 0-3zM7.559 4l-5.56 5.56V7.438L5.439 4h2.12zm13.497 0L15.91 9.149a3.98 3.98 0 0 0-.652-1.47L18.935 4h2.122zm-4.498 0l-2.543 2.544a3.975 3.975 0 0 0-1.6-.522L14.438 4h2.121z",fill:"currentColor"})],-1),Yd=[Kd],Gd=Q({name:"VideoBackgroundEffect24Regular",render:function(i,t){return W(),Z("svg",qd,Yd)}});var vv=!1;let Jd;const bo=i=>Jd=i,Xd=Symbol();function xl(i){return i&&typeof i=="object"&&Object.prototype.toString.call(i)==="[object Object]"&&typeof i.toJSON!="function"}var cn;(function(i){i.direct="direct",i.patchObject="patch object",i.patchFunction="patch function"})(cn||(cn={}));function wv(){const i=Vc(!0),t=i.run(()=>Gt({}));let e=[],r=[];const n=x1({install(o){bo(n),n._a=o,o.provide(Xd,n),o.config.globalProperties.$pinia=n,r.forEach(s=>e.push(s)),r=[]},use(o){return!this._a&&!vv?r.push(o):e.push(o),this},_p:e,_a:null,_e:i,_s:new Map,state:t});return n}const Qd=()=>{};function Zd(i,t,e,r=Qd){i.push(t);const n=()=>{const o=i.indexOf(t);o>-1&&(i.splice(o,1),r())};return!e&&MM()&&CM(n),n}function wr(i,...t){i.slice().forEach(e=>{e(...t)})}const bv=i=>i(),tf=Symbol(),kl=Symbol();function Sl(i,t){i instanceof Map&&t instanceof Map?t.forEach((e,r)=>i.set(r,e)):i instanceof Set&&t instanceof Set&&t.forEach(i.add,i);for(const e in t){if(!t.hasOwnProperty(e))continue;const r=t[e],n=i[e];xl(n)&&xl(r)&&i.hasOwnProperty(e)&&!Qr(r)&&!Uc(r)?i[e]=Sl(n,r):i[e]=r}return i}const xv=Symbol();function kv(i){return!xl(i)||!i.hasOwnProperty(xv)}const{assign:Si}=Object;function Sv(i){return!!(Qr(i)&&i.effect)}function Tv(i,t,e,r){const{state:n,actions:o,getters:s}=t,l=e.state.value[i];let a;function c(){l||(e.state.value[i]=n?n():{});const h=_M(e.state.value[i]);return Si(h,o,Object.keys(s||{}).reduce((u,d)=>(u[d]=x1(Dt(()=>{bo(e);const f=e._s.get(i);return s[d].call(f,f)})),u),{}))}return a=ef(i,c,t,e,r,!0),a}function ef(i,t,e={},r,n,o){let s;const l=Si({actions:{}},e),a={deep:!0};let c,h,u=[],d=[],f;const m=r.state.value[i];!o&&!m&&(r.state.value[i]={}),Gt({});let v;function p(A){let P;c=h=!1,typeof A=="function"?(A(r.state.value[i]),P={type:cn.patchFunction,storeId:i,events:f}):(Sl(r.state.value[i],A),P={type:cn.patchObject,payload:A,storeId:i,events:f});const B=v=Symbol();LM().then(()=>{v===B&&(c=!0)}),h=!0,wr(u,P,r.state.value[i])}const y=o?function(){const{state:A}=e,P=A?A():{};this.$patch(B=>{Si(B,P)})}:Qd;function b(){s.stop(),u=[],d=[],r._s.delete(i)}const k=(A,P="")=>{if(tf in A)return A[kl]=P,A;const B=function(){bo(r);const Y=Array.from(arguments),q=[],j=[];function $(nt){q.push(nt)}function J(nt){j.push(nt)}wr(d,{args:Y,name:B[kl],store:M,after:$,onError:J});let K;try{K=A.apply(this&&this.$id===i?this:M,Y)}catch(nt){throw wr(j,nt),nt}return K instanceof Promise?K.then(nt=>(wr(q,nt),nt)).catch(nt=>(wr(j,nt),Promise.reject(nt))):(wr(q,K),K)};return B[tf]=!0,B[kl]=P,B},S={_p:r,$id:i,$onAction:Zd.bind(null,d),$patch:p,$reset:y,$subscribe(A,P={}){const B=Zd(u,A,P.detached,()=>Y()),Y=s.run(()=>xe(()=>r.state.value[i],q=>{(P.flush==="sync"?h:c)&&A({storeId:i,type:cn.direct,events:f},q)},Si({},a,P)));return B},$dispose:b},M=Zr(S);r._s.set(i,M);const L=(r._a&&r._a.runWithContext||bv)(()=>r._e.run(()=>(s=Vc()).run(()=>t({action:k}))));for(const A in L){const P=L[A];if(Qr(P)&&!Sv(P)||Uc(P))o||(m&&kv(P)&&(Qr(P)?P.value=m[A]:Sl(P,m[A])),r.state.value[i][A]=P);else if(typeof P=="function"){const B=k(P,A);L[A]=B,l.actions[A]=P}}return Si(M,L),Si(Bt(M),L),Object.defineProperty(M,"$state",{get:()=>r.state.value[i],set:A=>{p(P=>{Si(P,A)})}}),r._p.forEach(A=>{Si(M,s.run(()=>A({store:M,app:r._a,pinia:r,options:l})))}),m&&o&&e.hydrate&&e.hydrate(M.$state,m),c=!0,h=!0,M}yi=function(i,t,e){let r,n;const o=typeof t=="function";typeof i=="string"?(r=i,n=o?e:t):(n=i,r=i.id);function s(l,a){const c=AM();return l=l||(c?Hc(Xd,null):null),l&&bo(l),l=Jd,l._s.has(r)||(o?ef(r,t,n,l):Tv(r,n,l)),l._s.get(r)}return s.$id=r,s},Xc=function(i){{i=Bt(i);const t={};for(const e in i){const r=i[e];(Qr(r)||Uc(r))&&(t[e]=TM(i,e))}return t}};const Av=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Mv=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Cv=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Lv(i,t){if(i==="__proto__"||i==="constructor"&&t&&typeof t=="object"&&"prototype"in t){_v(i);return}return t}function _v(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Ev(i,t={}){if(typeof i!="string")return i;const e=i.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.includes("\\"))return e.slice(1,-1);if(e.length<=9){const r=e.toLowerCase();if(r==="true")return!0;if(r==="false")return!1;if(r==="undefined")return;if(r==="null")return null;if(r==="nan")return Number.NaN;if(r==="infinity")return Number.POSITIVE_INFINITY;if(r==="-infinity")return Number.NEGATIVE_INFINITY}if(!Cv.test(i)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(Av.test(i)||Mv.test(i)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,Lv)}return JSON.parse(i)}catch(r){if(t.strict)throw r;return i}}function Ov(i,t){if(i==null)return;let e=i;for(let r=0;r<t.length;r++){if(e==null||e[t[r]]==null)return;e=e[t[r]]}return e}function Tl(i,t,e){if(e.length===0)return t;const r=e[0];return e.length>1&&(t=Tl(typeof i!="object"||i===null||!Object.prototype.hasOwnProperty.call(i,r)?Number.isInteger(Number(e[1]))?[]:{}:i[r],t,Array.prototype.slice.call(e,1))),Number.isInteger(Number(r))&&Array.isArray(i)?i.slice()[r]:Object.assign({},i,{[r]:t})}function rf(i,t){if(i==null||t.length===0)return i;if(t.length===1){if(i==null)return i;if(Number.isInteger(t[0])&&Array.isArray(i))return Array.prototype.slice.call(i,0).splice(t[0],1);const e={};for(const r in i)e[r]=i[r];return delete e[t[0]],e}if(i[t[0]]==null){if(Number.isInteger(t[0])&&Array.isArray(i))return Array.prototype.concat.call([],i);const e={};for(const r in i)e[r]=i[r];return e}return Tl(i,rf(i[t[0]],Array.prototype.slice.call(t,1)),[t[0]])}function nf(i,t){return t.map(e=>e.split(".")).map(e=>[e,Ov(i,e)]).filter(e=>!!e[1]).reduce((e,r)=>Tl(e,r[1],r[0]),{})}function of(i,t){return t.map(e=>e.split(".")).reduce((e,r)=>rf(e,r),i)}function sf(i,{storage:t,serializer:e,key:r,debug:n,pick:o,omit:s,beforeHydrate:l,afterHydrate:a},c,h=!0){try{h&&(l==null||l(c));const u=t.getItem(r);if(u){const d=e.deserialize(u),f=o?nf(d,o):d,m=s?of(f,s):f;i.$patch(m)}h&&(a==null||a(c))}catch(u){n&&console.error("[pinia-plugin-persistedstate]",u)}}function lf(i,{storage:t,serializer:e,key:r,debug:n,pick:o,omit:s}){try{const l=o?nf(i,o):i,a=s?of(l,s):l,c=e.serialize(a);t.setItem(r,c)}catch(l){n&&console.error("[pinia-plugin-persistedstate]",l)}}function Dv(i,t){const{pinia:e,store:r,options:{persist:n}}=i;if(!n)return;if(!(r.$id in e.state.value)){const s=e._s.get(r.$id.replace("__hot:",""));s&&Promise.resolve().then(()=>s.$persist());return}const o=(Array.isArray(n)?n:n===!0?[{}]:[n]).map(t);r.$hydrate=({runHooks:s=!0}={})=>{o.forEach(l=>{sf(r,l,i,s)})},r.$persist=()=>{o.forEach(s=>{lf(r.$state,s)})},o.forEach(s=>{sf(r,s,i),r.$subscribe((l,a)=>lf(a,s),{detached:!0})})}function Pv(i={}){return function(t){Dv(t,e=>({key:(i.key?i.key:r=>r)(e.key??t.store.$id),debug:e.debug??i.debug??!1,serializer:e.serializer??i.serializer??{serialize:r=>JSON.stringify(r),deserialize:r=>Ev(r)},storage:e.storage??i.storage??window.localStorage,beforeHydrate:e.beforeHydrate,afterHydrate:e.afterHydrate,pick:e.pick,omit:e.omit}))}}var Rv=Pv();const af=-1,xo=0,ko=1,So=2,Al=3,Ml=4,Cl=5,Ll=6,cf=7,hf=8,uf=typeof self=="object"?self:globalThis,Bv=(i,t)=>{const e=(n,o)=>(i.set(o,n),n),r=n=>{if(i.has(n))return i.get(n);const[o,s]=t[n];switch(o){case xo:case af:return e(s,n);case ko:{const l=e([],n);for(const a of s)l.push(r(a));return l}case So:{const l=e({},n);for(const[a,c]of s)l[r(a)]=r(c);return l}case Al:return e(new Date(s),n);case Ml:{const{source:l,flags:a}=s;return e(new RegExp(l,a),n)}case Cl:{const l=e(new Map,n);for(const[a,c]of s)l.set(r(a),r(c));return l}case Ll:{const l=e(new Set,n);for(const a of s)l.add(r(a));return l}case cf:{const{name:l,message:a}=s;return e(new uf[l](a),n)}case hf:return e(BigInt(s),n);case"BigInt":return e(Object(BigInt(s)),n)}return e(new uf[o](s),n)};return r},df=i=>Bv(new Map,i)(0),br="",{toString:Nv}={},{keys:Iv}=Object,hn=i=>{const t=typeof i;if(t!=="object"||!i)return[xo,t];const e=Nv.call(i).slice(8,-1);switch(e){case"Array":return[ko,br];case"Object":return[So,br];case"Date":return[Al,br];case"RegExp":return[Ml,br];case"Map":return[Cl,br];case"Set":return[Ll,br]}return e.includes("Array")?[ko,e]:e.includes("Error")?[cf,e]:[So,e]},To=([i,t])=>i===xo&&(t==="function"||t==="symbol"),Wv=(i,t,e,r)=>{const n=(s,l)=>{const a=r.push(s)-1;return e.set(l,a),a},o=s=>{if(e.has(s))return e.get(s);let[l,a]=hn(s);switch(l){case xo:{let h=s;switch(a){case"bigint":l=hf,h=s.toString();break;case"function":case"symbol":if(i)throw new TypeError("unable to serialize "+a);h=null;break;case"undefined":return n([af],s)}return n([l,h],s)}case ko:{if(a)return n([a,[...s]],s);const h=[],u=n([l,h],s);for(const d of s)h.push(o(d));return u}case So:{if(a)switch(a){case"BigInt":return n([a,s.toString()],s);case"Boolean":case"Number":case"String":return n([a,s.valueOf()],s)}if(t&&"toJSON"in s)return o(s.toJSON());const h=[],u=n([l,h],s);for(const d of Iv(s))(i||!To(hn(s[d])))&&h.push([o(d),o(s[d])]);return u}case Al:return n([l,s.toISOString()],s);case Ml:{const{source:h,flags:u}=s;return n([l,{source:h,flags:u}],s)}case Cl:{const h=[],u=n([l,h],s);for(const[d,f]of s)(i||!(To(hn(d))||To(hn(f))))&&h.push([o(d),o(f)]);return u}case Ll:{const h=[],u=n([l,h],s);for(const d of s)(i||!To(hn(d)))&&h.push(o(d));return u}}const{message:c}=s;return n([l,{name:a,message:c}],s)};return o},ff=(i,{json:t,lossy:e}={})=>{const r=[];return Wv(!(t||e),!!t,new Map,r)(i),r},qi=typeof structuredClone=="function"?(i,t)=>t&&("json"in t||"lossy"in t)?df(ff(i,t)):structuredClone(i):(i,t)=>df(ff(i,t));class Fv{constructor(t,e=50){Fc(this,"stack",[]);Fc(this,"stackPos",0);this.limit=e,this.stack.push(t)}push(t){this.stack.splice(++this.stackPos,0,t),this.stackPos>=this.limit&&this.stack.shift()}undo(){return this.stackPos=Math.max(0,this.stackPos-1),this.stack[this.stackPos]}redo(){return this.stackPos=Math.min(this.stack.length-1,this.stackPos+1),this.stack[this.stackPos]}}function pf(i,t){var r;const e=(window.structuredClone||qi)(Bt(t.$state));if((r=i.undo)!=null&&r.omit){for(const n of i.undo.omit)delete e[n];return e}return e}function Vv({store:i,options:t}){var r;if(!((r=t.undo)!=null&&r.enable))return;const e=new Fv(pf(t,i));i.undo=()=>{const n=qi(e.undo());i.$patch(n)},i.redo=()=>{const n=qi(e.redo());i.$patch(n)},i.record=()=>{const n=pf(t,i);e.push(n)}}let _l,mf,gf;Jc=yi("audio",{state:()=>({playing:!1,canPlay:!1,audioURL:"",currentTime:0,duration:0}),getters:{currentTimeMS:i=>Math.floor(i.currentTime)},actions:{setCurrentTime(i){this.currentTime=i}}}),Ve=yi("dialogs",{state:()=>({importFromDB:!1,submitLyric:!1,splitWord:!1,concatWords:!1,editLyricInfo:!1,importFromText:!1,metadata:!1,settings:!1})}),_l=yi("current-sync-word",{state:()=>({editMode:"edit"})}),mf=""+new URL("amll_lyric_bg-Dy4VPaCX.wasm",import.meta.url).href,gf=async(i={},t)=>{let e;if(t.startsWith("data:")){const r=t.replace(/^data:.*?base64,/,"");let n;if(typeof Buffer=="function"&&typeof Buffer.from=="function")n=Buffer.from(r,"base64");else if(typeof atob=="function"){const o=atob(r);n=new Uint8Array(o.length);for(let s=0;s<o.length;s++)n[s]=o.charCodeAt(s)}else throw new Error("Cannot decode base64-encoded data URL");e=await WebAssembly.instantiate(n,i)}else{const r=await fetch(t),n=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&n.startsWith("application/wasm"))e=await WebAssembly.instantiateStreaming(r,i);else{const o=await r.arrayBuffer();e=await WebAssembly.instantiate(o,i)}}return e.instance.exports};let X;function Hv(i){X=i}const li=new Array(128).fill(void 0);li.push(void 0,null,!0,!1);function et(i){return li[i]}let un=li.length;function Uv(i){i<132||(li[i]=un,un=i)}function ai(i){const t=et(i);return Uv(i),t}function vt(i){un===li.length&&li.push(li.length+1);const t=un;return un=li[t],li[t]=i,t}const zv=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let yf=new zv("utf-8",{ignoreBOM:!0,fatal:!0});yf.decode();let Ao=null;function Mo(){return(Ao===null||Ao.byteLength===0)&&(Ao=new Uint8Array(X.memory.buffer)),Ao}function ci(i,t){return i=i>>>0,yf.decode(Mo().subarray(i,i+t))}let hi=0;const jv=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let Co=new jv("utf-8");const $v=typeof Co.encodeInto=="function"?function(i,t){return Co.encodeInto(i,t)}:function(i,t){const e=Co.encode(i);return t.set(e),{read:i.length,written:e.length}};function Ki(i,t,e){if(e===void 0){const l=Co.encode(i),a=t(l.length,1)>>>0;return Mo().subarray(a,a+l.length).set(l),hi=l.length,a}let r=i.length,n=t(r,1)>>>0;const o=Mo();let s=0;for(;s<r;s++){const l=i.charCodeAt(s);if(l>127)break;o[n+s]=l}if(s!==r){s!==0&&(i=i.slice(s)),n=e(n,r,r=s+i.length*3,1)>>>0;const l=Mo().subarray(n+s,n+r),a=$v(i,l);s+=a.written,n=e(n,r,s,1)>>>0}return hi=s,n}function dn(i){return i==null}let xr=null;function Pt(){return(xr===null||xr.buffer.detached===!0||xr.buffer.detached===void 0&&xr.buffer!==X.memory.buffer)&&(xr=new DataView(X.memory.buffer)),xr}function El(i){const t=typeof i;if(t=="number"||t=="boolean"||i==null)return`${i}`;if(t=="string")return`"${i}"`;if(t=="symbol"){const n=i.description;return n==null?"Symbol":`Symbol(${n})`}if(t=="function"){const n=i.name;return typeof n=="string"&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(i)){const n=i.length;let o="[";n>0&&(o+=El(i[0]));for(let s=1;s<n;s++)o+=", "+El(i[s]);return o+="]",o}const e=/\[object ([^\]]+)\]/.exec(toString.call(i));let r;if(e.length>1)r=e[1];else return toString.call(i);if(r=="Object")try{return"Object("+JSON.stringify(i)+")"}catch{return"Object"}return i instanceof Error?`${i.name}: ${i.message}
${i.stack}`:r}function qv(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyAss(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function Kv(i){const t=Ki(i,X.__wbindgen_malloc,X.__wbindgen_realloc),e=hi,r=X.parseEslrc(t,e);return ai(r)}function Yv(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyEslrc(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function Gv(i){const t=Ki(i,X.__wbindgen_malloc,X.__wbindgen_realloc),e=hi,r=X.parseLrc(t,e);return ai(r)}function Jv(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyLrc(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function Xv(i){const t=Ki(i,X.__wbindgen_malloc,X.__wbindgen_realloc),e=hi,r=X.parseLys(t,e);return ai(r)}function Qv(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyLys(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function Zv(i){const t=Ki(i,X.__wbindgen_malloc,X.__wbindgen_realloc),e=hi,r=X.parseQrc(t,e);return ai(r)}function tw(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyQrc(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function ew(i){const t=Ki(i,X.__wbindgen_malloc,X.__wbindgen_realloc),e=hi,r=X.parseYrc(t,e);return ai(r)}function iw(i){let t,e;try{const o=X.__wbindgen_add_to_stack_pointer(-16);X.stringifyYrc(o,vt(i));var r=Pt().getInt32(o+4*0,!0),n=Pt().getInt32(o+4*1,!0);return t=r,e=n,ci(r,n)}finally{X.__wbindgen_add_to_stack_pointer(16),X.__wbindgen_free(t,e,1)}}function Ol(i,t){try{return i.apply(this,t)}catch(e){X.__wbindgen_exn_store(vt(e))}}function rw(i){ai(i)}function nw(i){return typeof et(i)=="bigint"}function ow(i){const t=BigInt.asUintN(64,i);return vt(t)}function sw(i,t){return et(i)===et(t)}function lw(i,t){const e=new Error(ci(i,t));return vt(e)}function aw(i){const t=et(i);return typeof t=="object"&&t!==null}function cw(i){return et(i)===void 0}function hw(i,t){return et(i)in et(t)}function uw(i,t){const e=et(t),r=typeof e=="string"?e:void 0;var n=dn(r)?0:Ki(r,X.__wbindgen_malloc,X.__wbindgen_realloc),o=hi;Pt().setInt32(i+4*1,o,!0),Pt().setInt32(i+4*0,n,!0)}function dw(i){const t=et(i);return typeof t=="boolean"?t?1:0:2}function fw(i,t){return et(i)==et(t)}function pw(i,t){const e=et(t),r=typeof e=="number"?e:void 0;Pt().setFloat64(i+8*1,dn(r)?0:r,!0),Pt().setInt32(i+4*0,!dn(r),!0)}function mw(i){return+et(i)}function gw(i){return vt(i)}function yw(i){const t=et(i);return vt(t)}function vw(i,t){const e=ci(i,t);return vt(e)}function ww(i,t){const e=et(i)[et(t)];return vt(e)}function bw(i,t,e){et(i)[ai(t)]=ai(e)}function xw(){return Ol(function(i,t){const e=et(i).call(et(t));return vt(e)},arguments)}function kw(i,t){const e=et(i)[t>>>0];return vt(e)}function Sw(i){return et(i).length}function Tw(){const i=new Array;return vt(i)}function Aw(i){return typeof et(i)=="function"}function Mw(i){const t=et(i).next;return vt(t)}function Cw(){return Ol(function(i){const t=et(i).next();return vt(t)},arguments)}function Lw(i){return et(i).done}function _w(i){const t=et(i).value;return vt(t)}function Ew(){return vt(Symbol.iterator)}function Ow(){return Ol(function(i,t){const e=Reflect.get(et(i),et(t));return vt(e)},arguments)}function Dw(){const i=new Object;return vt(i)}function Pw(i,t,e){et(i)[t>>>0]=ai(e)}function Rw(i){return Array.isArray(et(i))}function Bw(i){let t;try{t=et(i)instanceof ArrayBuffer}catch{t=!1}return t}function Nw(i){return Number.isSafeInteger(et(i))}function Iw(i){const t=et(i).buffer;return vt(t)}function Ww(i){const t=new Uint8Array(et(i));return vt(t)}function Fw(i,t,e){et(i).set(et(t),e>>>0)}function Vw(i){return et(i).length}function Hw(i){let t;try{t=et(i)instanceof Uint8Array}catch{t=!1}return t}function Uw(i,t){const e=et(t),r=typeof e=="bigint"?e:void 0;Pt().setBigInt64(i+8*1,dn(r)?BigInt(0):r,!0),Pt().setInt32(i+4*0,!dn(r),!0)}function zw(i,t){const e=El(et(t)),r=Ki(e,X.__wbindgen_malloc,X.__wbindgen_realloc),n=hi;Pt().setInt32(i+4*1,n,!0),Pt().setInt32(i+4*0,r,!0)}function jw(i,t){throw new Error(ci(i,t))}function $w(){const i=X.memory;return vt(i)}URL=globalThis.URL;const Mt=await gf({"./amll_lyric_bg.js":{__wbindgen_object_drop_ref:rw,__wbindgen_is_bigint:nw,__wbindgen_bigint_from_u64:ow,__wbindgen_jsval_eq:sw,__wbindgen_error_new:lw,__wbindgen_is_object:aw,__wbindgen_is_undefined:cw,__wbindgen_in:hw,__wbindgen_string_get:uw,__wbindgen_boolean_get:dw,__wbindgen_jsval_loose_eq:fw,__wbindgen_number_get:pw,__wbindgen_as_number:mw,__wbindgen_number_new:gw,__wbindgen_object_clone_ref:yw,__wbindgen_string_new:vw,__wbg_getwithrefkey_edc2c8960f0f1191:ww,__wbg_set_f975102236d3c502:bw,__wbg_call_1084a111329e68ce:xw,__wbg_get_3baa728f9d58d3f6:kw,__wbg_length_ae22078168b726f5:Sw,__wbg_new_a220cf903aa02ca2:Tw,__wbindgen_is_function:Aw,__wbg_next_de3e9db4440638b2:Mw,__wbg_next_f9cb570345655b9a:Cw,__wbg_done_bfda7aa8f252b39f:Lw,__wbg_value_6d39332ab4788d86:_w,__wbg_iterator_888179a48810a9fe:Ew,__wbg_get_224d16597dbbfd96:Ow,__wbg_new_525245e2b9901204:Dw,__wbg_set_673dda6c73d19609:Pw,__wbg_isArray_8364a5371e9737d8:Rw,__wbg_instanceof_ArrayBuffer_61dfc3198373c902:Bw,__wbg_isSafeInteger_7f1ed56200d90674:Nw,__wbg_buffer_b7b08af79b0b0974:Iw,__wbg_new_ea1883e1e5e86686:Ww,__wbg_set_d1e79e2388520f18:Fw,__wbg_length_8339fcf5d8ecd12e:Vw,__wbg_instanceof_Uint8Array_247a91427532499e:Hw,__wbindgen_bigint_get_as_i64:Uw,__wbindgen_debug_string:zw,__wbindgen_throw:jw,__wbindgen_memory:$w}},mf),qw=Mt.memory,Kw=Mt.stringifyAss,Yw=Mt.decryptQrcHex,Gw=Mt.parseEslrc,Jw=Mt.stringifyEslrc,Xw=Mt.parseLrc,Qw=Mt.stringifyLrc,Zw=Mt.parseLys,tb=Mt.stringifyLys,eb=Mt.parseQrc,ib=Mt.stringifyQrc,rb=Mt.parseTTML,nb=Mt.stringifyTTML,ob=Mt.parseYrc,sb=Mt.stringifyYrc,lb=Mt.wasm_start,ab=Mt.__wbindgen_malloc,cb=Mt.__wbindgen_realloc,hb=Mt.__wbindgen_add_to_stack_pointer,ub=Mt.__wbindgen_free,db=Mt.__wbindgen_exn_store,vf=Mt.__wbindgen_start,fb=Object.freeze(Object.defineProperty({__proto__:null,__wbindgen_add_to_stack_pointer:hb,__wbindgen_exn_store:db,__wbindgen_free:ub,__wbindgen_malloc:ab,__wbindgen_realloc:cb,__wbindgen_start:vf,decryptQrcHex:Yw,memory:qw,parseEslrc:Gw,parseLrc:Xw,parseLys:Zw,parseQrc:eb,parseTTML:rb,parseYrc:ob,stringifyAss:Kw,stringifyEslrc:Jw,stringifyLrc:Qw,stringifyLys:tb,stringifyQrc:ib,stringifyTTML:nb,stringifyYrc:sb,wasm_start:lb},Symbol.toStringTag,{value:"Module"}));Hv(fb),vf();let wf,bf,xf,Dl,kf;wf={app:{loadingEditPage:"Loading Edit Page",loadingSyncPage:"Loading Sync Page",loadingAMLLPreviewPage:"Loading AMLL Lyrics Preview Page"},topBar:{menu:{file:"File",newLyric:"New Lyrics",openLyric:"Open Lyrics",saveLyric:"Save Lyrics",importLyric:"Import Lyrics...",importLyricFromText:"Import via plain text",importLyricFromLrc:"Import via LRC lyrics",importLyricFromYrc:"Import via YRC lyrics",importLyricFromQrc:"Import via QRC lyrics",importLyricFromLys:"Import via Lyricify Syllable",exportLyric:"Export...",exportLyricToLrc:"Export as LRC lyrics",exportLyricToYrc:"Export as YRC lyrics",exportLyricToQrc:"Export as QRC lyrics",exportLyricToLys:"Export as Lyricify Syllable",exportLyricToAss:"Export as ASS subtitles",uploadToAMLLDB:"Upload to AMLL Lyrics Database",about:"About",edit:"Edit",undo:"Undo",redo:"Redo",selectAllLines:"Select all lines",unselectAllLines:"Deselect all lines",invertSelectAllLines:"Invert line selections",toggleBGLineOnSelectedLines:"Toggle Background Vocal for the line",toggleDuetLineOnSelectedLines:"Toggle Duet Vocal for the line",showTranslatedLyricLines:"Show lyrics translation",showRomanLyricLines:"Show lyrics pronunciation",splitWordBySimpleMethod:"Split words (simple)",splitWordByJieba:"Split words (using JieBa)",splitWordBySmartMethod:"Split words",view:"View",tool:"Tool"},modeBtns:{edit:"Edit Mode",sync:"Sync Mode",preview:"Preview Mode"},appName:"Apple Music-like Lyrics TTML Tool"},aboutModal:{appName:"Apple Music-like Lyrics TTML Tool",description:"A Word-by-Word TTML Editing and Timeline Tool for Apple Music-like Lyrics",githubBtn:"Github",tutorialBtn:"Quick Tutorial"},contextMenu:{deleteLine:"Delete selected line",insertBeforeLine:"New line before selection",insertAfterLine:"New line after selection",toggleBGLine:"Toggle Background Vocal for the line",toggleDuetLine:"Toggle Duet Vocal for the line",deleteWord:"Delete this word",splitWord:"Split this word",wipNotification:{title:"Function currently not available",content:"Give us some time and we'll give you back a new sky~"}},lyricEditor:{addNewLineBtn:"New line"},lyricLineEditor:{newWordPlaceholder:"New word",translateLinePlaceholder:"Translation",romanLinePlaceholder:"Romaji"},lyricSyncEditor:{unselectedTip:["No lyrics selected","Click on a line below to start syncing"].join(`
`)},lyricWordEditor:{empty:"Blank",space:"Space x{0}"},serviceWorkerUpdater:{needRefresh:{title:"Editor Updated! ",content:"Please click to update Editor",updateBtn:"Update"},offlineReady:{title:"Offline saved",content:"No Internet required to continue your here! "}},audioPlayerBar:{loadMusicBtn:"Load music"},lyricInfoModal:{saveBtn:"Save"},progressOverlay:{title:"Processing"},splitWordModal:{title:"Split word",splitBtn:"Split"},uploadDBDialog:{title:"Commit lyrics to AMLL Vault (Netease Cloud Music only)",ncmOnlyWarning:"This function is only for the users who use AMLL plugin for Netease Cloud Music. If you are making lyrics and plan to upload to other applications, please do so by their functions instead of here.",content:["We appreciate your contributions of lyrics.","By uploading, you are agreed to {0} and upload your content to our database! ","And your content may be used as the default TTML lyrics by the plugin.","If you decided to keep your copyright of your content, please cancel.","Fill out the form and we are taking you to the issue page on Github."].join(`
`),boldCC0:"According to CC0 agreement, completely give up on the copyright of the content",musicName:"Track name",musicNamePlaceholder:"Track name",musicNameTip:"Artist - Track, that's the recommended format.",ncmID:"Track ID on Netease Cloud Music",ncmIDPlaceholder:"Track ID",ncmIDTip:["It is copiable by right click on the AMLL plugin on Netease Cloud Music and it should be digital.","If you are uploading the same lyrics to multiple tracks, please split IDs by comma(,)"].join(`
`),uploadReason:{label:"Cause of uploading",newLyric:"New lyrics",patchLyric:"A Fix"},comment:"Comment",commentPlaceholder:"Comment",commentTip:"Is there anything more we should know about?",uploadBtn:"Upload and redirect to commit",errors:{noLyricContent:"Nothing we found in the lyrics"},errorNotification:{title:"Failed to commit lyrics",content:`Details: 
{0}`}},tutorial:{title:"Welcome to Apple Music-like Lyrics TTML Tool",content:["This TTML lyrics tool is designed for Apple Music-like Lyrics playing page of BetterNCM plugin.","We provide multiple functions for making various kinds of lyrics.","Check out our quick tutorial, we'll get you there soon: "].join(`
`),wipWarning:"This tool is still in development, please always save your project.",step1:{title:"Load lyrics",content:["Lyrics can be loaded by go to File->Upload lyrics file.","It is okay for lyrics in non-TTML format. LRC/YRC/QRC/Lyricify Syllable formats are acceptable."].join(`
`)},step2:{title:"Edit lyrics",content:["Click the {0} button to edit lyrics (by default).","You can append a new line, add new words, even split or edit them! ","Please notify that all space will be saved.","If you want to add translation or romaji, please enable by going to View->Show translation/romaji lyrics.","If you want to adjust lyrics property (toggle Background Voice or Duet), please right click or go to menu and choose from the list.","If you want to edit multiple lines at the same time, please check the lines, and go to menu."].join(`
`),editModeBtnExample:"Edit Mode"},step3:{title:"Sync Lyrics",content:["Click the {0} button to enable Sync Mode.","Load your music from file below then start syncing.","You can also slowdown the track if it goes too fast.","These are the default keymap of syncing mode: ","{1}"].join(`
`),syncModeBtnExample:"Sync Mode",shortcutsTable:{header:{key:"Key",description:"Description"},moveToPreviousWord:{key:"Key A",description:"Move back"},moveToNextWord:{key:"Key D",description:"Move next"},moveToFirstWordOfPreviousLine:{key:"Key W",description:"Move to the first word of the last line"},moveToFirstWordOfNextLine:{key:"Key S",description:"Move to the first word of the next line"},moveToPreviousWordAndCurrentTime:{key:"Key R",description:"Move back to last word, and set the current timestamp as the starting of it"},moveToNextWordAndSetCurrentTime:{key:"Key Y",description:"Move back to next word, and set the current timestamp as the starting of it"},setWordStartTimeToCurrentTime:{key:"Key F",description:"Set current timestamp as the starting of word"},moveNextAndSetWordTime:{key:"Key G",description:"Set current timestamp as the ending of current word and starting of next word, and move to next word"},moveNextAndSetWordEndTimeOnly:{key:"Key H",description:"Set current timestamp as the ending of current word, and move to next word (used to make instrumental time)"},decreasePlaybackSpeed:{key:"Key [",description:"Play as 0.25x slower"},increasePlaybackSpeed:{key:"Key ]",description:"Play as 0.25x faster"},resetPlaybackSpeed:{key:"Key '",description:"Reset to default speed"},resumeOrPauseMusic:{key:"Key Space",description:"Play/Pause music"}}},step4:{title:"Save Lyrics",content:["You can save lyrics as TTML format, as well as other mainstream formats.","BUT please remind that currently, translation and romaji will not be saved as Lyricify Syllable. Translations, rumaji and syllable timestamps will not be saved as LRC. Translations, romaji and lyrics property will not be saved as YRC/QRC."].join(`
`)},step5:{title:"Use Lyrics (Only Netease Cloud Music)",ncmOnlyWarning:"This step is only for users who use AMLL NetEase Cloud plugin, if you are editing lyrics to use lyrics on other software, please refer to the corresponding software to import and use lyrics to use lyrics! ",content:["The last thing to do is to put it in the TTML lyrics folder of the AMLL plugin, name the lyrics file as the song ID of the Netease cloud (you can get it by right-clicking and copying it in the AMLL play page) and then cut the song again to read it!","In order for more people to experience the effects of TTML lyrics, you can also upload your lyrics to {0} for download!"].join(`
`),amllTtmlDbUrlName:"SteveXMH's TTML Lyrics Vault"},ending:"Afterwards you can revisit this page via the File->About->Quick Tutorial, or come back to it if you have forgotten how to do it!",closeBtn:"I see"}},bf={app:{loadingEditPage:"\u6B63\u5728\u52A0\u8F7D\u7F16\u8F91\u9875\u9762",loadingSyncPage:"\u6B63\u5728\u52A0\u8F7D\u6253\u8F74\u9875\u9762",loadingAMLLPreviewPage:"\u6B63\u5728\u52A0\u8F7D AMLL \u9884\u89C8\u9875\u9762"},runtimeError:{title:"\u7A0B\u5E8F\u53D1\u751F\u8FD0\u884C\u9519\u8BEF",content:"\u9519\u8BEF\u4FE1\u606F\uFF1A{0}"},topBar:{menu:{file:"\u6587\u4EF6",newLyric:"\u65B0\u5EFA\u6B4C\u8BCD",openLyric:"\u6253\u5F00\u6B4C\u8BCD",openFromClipboard:"\u4ECE\u526A\u8D34\u677F\u6253\u5F00\u6B4C\u8BCD",saveLyric:"\u4FDD\u5B58\u6B4C\u8BCD",saveLyricToClipboard:"\u4FDD\u5B58\u6B4C\u8BCD\u5230\u526A\u8D34\u677F",importLyric:"\u5BFC\u5165\u6B4C\u8BCD...",importLyricFromText:"\u4ECE\u7EAF\u6587\u672C\u5BFC\u5165",importLyricFromLrc:"\u4ECE LRC \u6B4C\u8BCD\u5BFC\u5165",importLyricFromEslrc:"\u4ECE ESLyric \u6B4C\u8BCD\u5BFC\u5165",importLyricFromYrc:"\u4ECE YRC \u6B4C\u8BCD\u5BFC\u5165",importLyricFromQrc:"\u4ECE QRC \u6B4C\u8BCD\u5BFC\u5165",importLyricFromLys:"\u4ECE Lyricify Syllable \u6B4C\u8BCD\u5BFC\u5165",exportLyric:"\u5BFC\u51FA\u6B4C\u8BCD...",exportLyricToLrc:"\u5BFC\u51FA LRC \u6B4C\u8BCD",exportLyricToEslrc:"\u5BFC\u51FA ESLyric \u6B4C\u8BCD",exportLyricToYrc:"\u5BFC\u51FA YRC \u6B4C\u8BCD",exportLyricToQrc:"\u5BFC\u51FA QRC \u6B4C\u8BCD",exportLyricToLys:"\u5BFC\u51FA Lyricify Syllable \u6B4C\u8BCD",exportLyricToAss:"\u5BFC\u51FA ASS \u5B57\u5E55",importFromAMLLDB:"\u4ECE AMLL \u6B4C\u8BCD\u6570\u636E\u5E93\u5BFC\u5165\u6B4C\u8BCD",uploadToAMLLDB:"\u4E0A\u4F20\u6B4C\u8BCD\u5230 AMLL \u6B4C\u8BCD\u6570\u636E\u5E93",settings:"\u8BBE\u7F6E",about:"\u5173\u4E8E",edit:"\u7F16\u8F91",undo:"\u64A4\u9500",redo:"\u91CD\u505A",selectAllLines:"\u9009\u4E2D\u6240\u6709\u6B4C\u8BCD\u884C",unselectAllLines:"\u53D6\u6D88\u9009\u4E2D\u6240\u6709\u6B4C\u8BCD\u884C",invertSelectAllLines:"\u53CD\u9009\u6240\u6709\u6B4C\u8BCD\u884C",toggleBGLineOnSelectedLines:"\u5207\u6362\u6240\u9009\u6B4C\u8BCD\u884C\u4E3A\u80CC\u666F\u4EBA\u58F0",toggleDuetLineOnSelectedLines:"\u5207\u6362\u6240\u9009\u6B4C\u8BCD\u884C\u4E3A\u5BF9\u5531\u4EBA\u58F0",editMetadata:"\u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E",showTranslatedLyricLines:"\u663E\u793A\u7FFB\u8BD1\u6B4C\u8BCD",showRomanLyricLines:"\u663E\u793A\u97F3\u8BD1\u6B4C\u8BCD",showMachineRomanji:"\u663E\u793A\u65E5\u8BED\u53C2\u8003\u7F57\u9A6C\u5B57\u6CE8\u97F3\uFF08\u5B9E\u9A8C\u6027\uFF09",splitWordBySimpleMethod:"\u4F7F\u7528\u7B80\u5355\u65B9\u5F0F\u5BF9\u6B4C\u8BCD\u884C\u5206\u8BCD",splitWordByJieba:"\u4F7F\u7528 JieBa \u5BF9\u6B4C\u8BCD\u884C\u5206\u8BCD",splitWordBySmartMethod:"\u6B4C\u8BCD\u884C\u5206\u8BCD",view:"\u67E5\u770B",tool:"\u5DE5\u5177"},modeBtns:{edit:"\u7F16\u8F91\u6A21\u5F0F",sync:"\u6253\u8F74\u6A21\u5F0F",preview:"\u9884\u89C8\u6A21\u5F0F"},appName:"Apple Music-like Lyrics TTML Tool"},settingsDialog:{title:"\u8BBE\u7F6E",tab:{common:"\u901A\u7528",keybindings:"\u6309\u952E\u7ED1\u5B9A"},common:{showTranslateLine:"\u663E\u793A\u7FFB\u8BD1\u6B4C\u8BCD",showRomanLine:"\u663E\u793A\u97F3\u8BD1\u6B4C\u8BCD",showJpnRomaji:"\u663E\u793A\u65E5\u8BED\u53C2\u8003\u7F57\u9A6C\u5B57\u6CE8\u97F3\uFF08\u5B9E\u9A8C\u6027\uFF09",volume:"\u97F3\u91CF",speed:"\u64AD\u653E\u901F\u5EA6",timeOffset:"\u8BB0\u5F55\u65F6\u95F4\u6233\u4F4D\u79FB",timeOffsetDesc:"\u5355\u4F4D\u6BEB\u79D2\uFF0C\u6B63\u503C\u63D0\u524D\uFF0C\u8D1F\u503C\u63A8\u8FDF",uiLayoutMode:"\u754C\u9762\u5E03\u5C40\u6A21\u5F0F",uiLayoutModeDesc:"\u5982\u679C\u9700\u8981\u66F4\u52A0\u5BC6\u96C6\u7684\u754C\u9762\uFF0C\u53EF\u4EE5\u9009\u62E9\u9AD8\u7EA7\u5E03\u5C40\uFF08\u5B9E\u9A8C\u6027\uFF09",uiLayoutModeOptions:{simple:"\u7B80\u5355\u5E03\u5C40",advanced:"\u9AD8\u7EA7\u5E03\u5C40\uFF08\u5B9E\u9A8C\u6027\uFF09"},dbUploadApiBaseUrl:"\u6B4C\u8BCD\u6570\u636E\u5E93\u4E0A\u4F20 API \u7AEF\u70B9\u94FE\u63A5",dbUploadApiBaseUrlDesc:"\u5982\u679C\u60A8\u63D0\u4EA4\u6B4C\u8BCD\u540E\u53D1\u751F\u673A\u5668\u4EBA\u8BBF\u95EE\u5931\u8D25\u7684\u95EE\u9898\uFF0C\u8BF7\u8003\u8651\u4F7F\u7528\u5176\u4ED6\u57FA\u4E8E dpaste \u7684\u7AD9\u70B9\u4EE5\u521B\u5EFA\u6B4C\u8BCD\u6587\u4EF6\u77ED\u94FE"},keybindings:{resumeOrPause:"\u64AD\u653E / \u6682\u505C",seekPlayForward5s:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u8FDB 5 \u79D2",seekPlayBackward5s:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u9000 5 \u79D2",seekPlayForward1s:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u8FDB 1 \u79D2",seekPlayBackward1s:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u9000 1 \u79D2",seekPlayForward100ms:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u8FDB 0.1 \u79D2",seekPlayBackward100ms:"\u64AD\u653E\u8FDB\u5EA6\u5FEB\u9000 0.1 \u79D2",volumeUp:"\u589E\u52A0\u97F3\u91CF",volumeDown:"\u51CF\u5C0F\u97F3\u91CF",speedUp:"\u52A0\u901F\u64AD\u653E",speedDown:"\u51CF\u901F\u64AD\u653E",moveLeftWord:"\u79FB\u52A8\u5230\u4E0A\u4E00\u4E2A\u5355\u8BCD",moveRightWord:"\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD",moveUpLine:"\u79FB\u52A8\u5230\u4E0A\u4E00\u4E2A\u6B4C\u8BCD\u884C\u9996\u4F4D",moveDownLine:"\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u6B4C\u8BCD\u884C\u9996\u4F4D",seekLeftWord:"\u79FB\u52A8\u5E76\u8DF3\u8F6C\u64AD\u653E\u4F4D\u7F6E\u5230\u4E0A\u4E00\u4E2A\u5355\u8BCD\u7684\u5F00\u59CB\u65F6\u95F4",seekRightWord:"\u79FB\u52A8\u5E76\u8DF3\u8F6C\u64AD\u653E\u4F4D\u7F6E\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\u7684\u5F00\u59CB\u65F6\u95F4",setCurWordStartTime:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u5F00\u59CB\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E",stepWordAndSetTime:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\uFF0C\u6B65\u8FDB\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD",stepWordAndSetTimeAlias1:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\uFF0C\u6B65\u8FDB\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\uFF08\u53EF\u9009\uFF09",stepWordAndSetTimeAlias2:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\uFF0C\u6B65\u8FDB\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\uFF08\u53EF\u9009\uFF09",stepWordAndSetTimeAlias3:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\uFF0C\u6B65\u8FDB\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\uFF08\u53EF\u9009\uFF09",stepWordAndSetEndTime:"\u8BBE\u7F6E\u5F53\u524D\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\uFF0C\u6B65\u8FDB\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD",setLineStartTime:"\u8BBE\u7F6E\u5F53\u524D\u6B4C\u8BCD\u884C\u7684\u5F00\u59CB\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E",setLineEndTime:"\u8BBE\u7F6E\u5F53\u524D\u6B4C\u8BCD\u884C\u7684\u7ED3\u675F\u65F6\u95F4\u4E3A\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E"}},metadataDialog:{title:"\u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E",selectNew:"\u8BF7\u9009\u62E9\u65B0\u589E\u5143\u6570\u636E\u7C7B\u578B",addNew:"\u6DFB\u52A0\u65B0\u5143\u6570\u636E",addAllBatch:"\u6279\u91CF\u6DFB\u52A0\u6240\u6709\u9884\u8BBE\u5143\u6570\u636E",valuePlaceholder:"\u8BF7\u8F93\u5165\u503C",tableHead:{key:"\u5143\u6570\u636E\u7C7B\u578B",values:"\u503C"},builtinOptions:{ncmMusicId:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684\u7F51\u6613\u4E91\u97F3\u4E50 ID",qqMusicId:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684 QQ \u97F3\u4E50 ID",spotifyId:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684 Spotify \u97F3\u4E50 ID",appleMusicId:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684 Apple Music \u97F3\u4E50 ID",isrc:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684 ISRC \u7F16\u7801",musicName:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684\u6B4C\u66F2\u540D",artists:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684\u6B4C\u624B\u540D",album:"\u6B4C\u8BCD\u6240\u5339\u914D\u7684\u4E13\u8F91\u540D",ttmlAuthorGithub:"\u9010\u8BCD\u6B4C\u8BCD\u4F5C\u8005 Github ID"}},aboutModal:{appName:"Apple Music-like Lyrics TTML Tool",description:"\u4E00\u4E2A\u7528\u4E8E Apple Music-like lyrics \u751F\u6001\u7684\u9010\u8BCD\u6B4C\u8BCD TTML \u7F16\u8F91\u548C\u65F6\u95F4\u8F74\u5DE5\u5177",githubBtn:"Github",tutorialBtn:"\u7B80\u77ED\u6559\u7A0B"},contextMenu:{deleteLine:"\u5220\u9664\u9009\u5B9A\u6B4C\u8BCD\u884C",insertBeforeLine:"\u5728\u9009\u5B9A\u6B4C\u8BCD\u884C\u524D\u63D2\u5165\u65B0\u6B4C\u8BCD\u884C",insertAfterLine:"\u5728\u9009\u5B9A\u6B4C\u8BCD\u884C\u540E\u63D2\u5165\u65B0\u6B4C\u8BCD\u884C",toggleBGLine:"\u5207\u6362\u80CC\u666F\u4EBA\u58F0\u6B4C\u8BCD",toggleDuetLine:"\u5207\u6362\u5BF9\u5531\u4EBA\u58F0\u6B4C\u8BCD",deleteWord:"\u5220\u9664\u9009\u5B9A\u5355\u8BCD",splitWord:"\u5207\u5272\u5F53\u524D\u5355\u8BCD",concatWords:"\u62FC\u63A5\u5355\u8BCD",wipNotification:{title:"\u529F\u80FD\u6682\u672A\u5B9E\u73B0",content:"\u8BF7\u9759\u5019\u4F5C\u8005\u7206\u809D\u5B9E\u73B0\u5427~"}},lyricEditor:{addNewLineBtn:"\u6DFB\u52A0\u4E00\u884C\u6B4C\u8BCD"},lyricLineEditor:{newWordPlaceholder:"\u65B0\u5355\u8BCD",translateLinePlaceholder:"\u7FFB\u8BD1\u6B4C\u8BCD",romanLinePlaceholder:"\u97F3\u8BD1\u6B4C\u8BCD"},lyricSyncEditor:{unselectedTip:["\u5C1A\u672A\u9009\u4E2D\u6B4C\u8BCD","\u70B9\u51FB\u4E0B\u65B9\u7684\u6B4C\u8BCD\u884C\u4EE5\u9009\u4E2D\u6B4C\u8BCD\u5F00\u59CB\u6253\u8F74"].join(`
`)},lyricWordEditor:{empty:"\u7A7A\u767D",space:"\u7A7A\u683Cx{0}"},serviceWorkerUpdater:{needRefresh:{title:"\u7F16\u8F91\u5668\u5DF2\u66F4\u65B0\uFF01",content:"\u8BF7\u70B9\u51FB\u66F4\u65B0\u6309\u94AE\u4EE5\u66F4\u65B0\u7F16\u8F91\u5668\uFF01",updateBtn:"\u66F4\u65B0"},offlineReady:{title:"\u7F16\u8F91\u5668\u5DF2\u5B8C\u6210\u79BB\u7EBF\u7F13\u5B58\uFF01",content:"\u73B0\u5728\u5F00\u59CB\u4E0D\u9700\u8981\u7F51\u7EDC\u4E5F\u53EF\u4EE5\u8BBF\u95EE\u7F16\u8F91\u5668\u4E86\uFF01"}},audioPlayerBar:{loadMusicBtn:"\u52A0\u8F7D\u97F3\u4E50"},lyricInfoModal:{saveBtn:"\u4FDD\u5B58"},progressOverlay:{title:"\u5904\u7406\u4E2D",processingWordSpliting:"\u6B63\u5728\u8FDB\u884C\u5206\u8BCD\u64CD\u4F5C",loadingJiebaModule:"\u6B63\u5728\u52A0\u8F7D Jieba \u5206\u8BCD\u6A21\u5757\u2026\u2026",splitingWords:"\u6B63\u5728\u8FDB\u884C\u5206\u8BCD\u64CD\u4F5C ({0}/{1})",finishing:"\u6B63\u5728\u5B8C\u6210"},splitWordModal:{title:"\u62C6\u5206\u5355\u8BCD",originalWord:"\u539F\u59CB\u5355\u8BCD",delimiter:"\u5206\u9694\u7B26",tip:"\u62C6\u5206\u540E\u65B0\u5355\u8BCD\u5C06\u4F1A\u6309\u81EA\u8EAB\u5355\u8BCD\u5B57\u7B26\u5E73\u5747\u5206\u914D\u539F\u5355\u8BCD\u7684\u59CB\u672B\u65F6\u95F4\uFF0C\u5982\u6709\u7A7A\u62CD\u5219\u4F1A\u88AB\u6E05\u9664",splitBtn:"\u62C6\u5206",splitResultPreview:"\u62C6\u5206\u7ED3\u679C\u9884\u89C8"},concatWordModal:{title:"\u5408\u5E76\u5355\u8BCD",tip:"\u5408\u5E76\u65F6\u5C06\u4F1A\u5408\u5E76\u65F6\u95F4\u6233\uFF0C\u7A7A\u62CD\u53EF\u4EE5\u9009\u62E9\u5408\u5E76\u65B9\u5F0F",mergeRange:"\u5408\u5E76\u8303\u56F4",emptyBeatMergeMethod:{label:"\u7A7A\u62CD\u5408\u5E76\u65B9\u5F0F",accumulateWordBeat:"\u6309\u5355\u8BCD\u548C\u5DF2\u6709\u7A7A\u62CD\u6570\u91CF\u7D2F\u52A0",accumulateBeat:"\u4EC5\u6309\u5DF2\u6709\u7A7A\u62CD\u6570\u91CF\u7D2F\u52A0",accumulateWord:"\u4EC5\u6309\u5355\u8BCD\u6570\u91CF\u7D2F\u52A0",clear:"\u6E05\u7A7A"},concatBtn:"\u5408\u5E76",originPreview:"\u539F\u59CB\u5355\u8BCD\u9884\u89C8",concatResultPreview:"\u5408\u5E76\u7ED3\u679C\u9884\u89C8"},importPlainTextModal:{title:"\u4ECE\u7EAF\u6587\u672C\u5BFC\u5165\u6B4C\u8BCD",textPlaceholder:"\u7EAF\u6587\u672C\u6B4C\u8BCD\u5185\u5BB9",importMode:"\u5BFC\u5165\u6A21\u5F0F",lyricOnly:"\u4EC5\u6B4C\u8BCD",lyricWithTranslation:"\u6B4C\u8BCD\u548C\u7FFB\u8BD1\u6B4C\u8BCD",lyricWithRoman:"\u6B4C\u8BCD\u548C\u97F3\u8BD1\u6B4C\u8BCD",lyricWithTranslationAndRoman:"\u6B4C\u8BCD\u548C\u7FFB\u8BD1\u3001\u97F3\u8BD1\u6B4C\u8BCD",lyricSplitMode:"\u6B4C\u8BCD\u5206\u884C\uFF08\u7FFB\u8BD1\u548C\u97F3\u8BD1\uFF09\u6A21\u5F0F",sameLineWithSeparator:"\u540C\u884C\u5206\u9694",sameLineSeparator:"\u6B4C\u8BCD\u884C\u5206\u9694\u7B26",sameLineSeparatorPlaceholder:"\u7559\u7A7A\u5219\u4E0D\u5206\u9694",interleavedLine:"\u591A\u884C\u4EA4\u9519\u5206\u9694",swapTransAndRoman:"\u4EA4\u6362\u7FFB\u8BD1\u884C\u548C\u97F3\u8BD1\u884C",wordSeparator:"\u5355\u8BCD\u5206\u9694\u7B26",wordSeparatorPlaceholder:"\u7559\u7A7A\u5219\u4E0D\u5206\u9694",importBtn:"\u5BFC\u5165\u6B4C\u8BCD",enablePrefixMarkup:"\u542F\u7528\u7279\u6B8A\u524D\u7F00",bgLinePrefix:"\u80CC\u666F\u6B4C\u8BCD\u524D\u7F00",duetLinePrefix:"\u5BF9\u5531\u6B4C\u8BCD\u524D\u7F00",emptyBeat:"\u542F\u7528\u7A7A\u62CD",emptyBeatMark:"\u7A7A\u62CD\u7B26\u53F7"},uploadDBDialog:{title:"\u63D0\u4EA4\u6B4C\u8BCD\u5230 AMLL \u6B4C\u8BCD\u6570\u636E\u5E93\uFF08\u4EC5\u7B80\u4F53\u4E2D\u6587\u7528\u6237\uFF09",chineseUserOnlyWarning:"\u672C\u529F\u80FD\u4EC5\u4F7F\u7528 AMLL \u6B4C\u8BCD\u6570\u636E\u5E93\u7684\u7B80\u4F53\u4E2D\u6587\u7528\u6237\u53EF\u7528\uFF0C\u5982\u679C\u60A8\u662F\u4E3A\u4E86\u5728\u5176\u4ED6\u8F6F\u4EF6\u4E0A\u4F7F\u7528\u6B4C\u8BCD\u800C\u7F16\u8F91\u6B4C\u8BCD\u7684\u8BDD\uFF0C\u8BF7\u53C2\u8003\u5BF9\u5E94\u7684\u8F6F\u4EF6\u63D0\u4EA4\u6B4C\u8BCD\u7684\u65B9\u5F0F\u6765\u63D0\u4EA4\u6B4C\u8BCD\u54E6\uFF01",issuesWarning:"\u68C0\u6D4B\u5230\u5F53\u524D\u6B4C\u8BCD\u5305\u542B\u4EE5\u4E0B\u95EE\u9898\uFF0C\u8BF7\u5168\u90E8\u89E3\u51B3\u540E\u91CD\u8BD5\uFF1A",noMusicIdWarning:`\u6CA1\u6709\u5728\u6B4C\u8BCD\u5143\u6570\u636E\u4E2D\u627E\u5230\u4EFB\u4F55\u5E73\u53F0\u7684\u97F3\u4E50ID\uFF01
\u8BF7\u5728\u9876\u90E8\u83DC\u5355 \u7F16\u8F91 - \u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E \u4E2D\u6DFB\u52A0\u97F3\u4E50ID\uFF01`,noMusicNameWarning:`\u6CA1\u6709\u5728\u6B4C\u8BCD\u5143\u6570\u636E\u4E2D\u627E\u5230\u97F3\u4E50\u540D\u79F0\uFF01
\u8BF7\u5728\u9876\u90E8\u83DC\u5355 \u7F16\u8F91 - \u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E \u4E2D\u6DFB\u52A0\u97F3\u4E50\u540D\u79F0\uFF01`,noArtistWarning:`\u6CA1\u6709\u5728\u6B4C\u8BCD\u5143\u6570\u636E\u4E2D\u627E\u5230\u6B4C\u624B\u540D\u79F0\uFF01
\u8BF7\u5728\u9876\u90E8\u83DC\u5355 \u7F16\u8F91 - \u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E \u4E2D\u6DFB\u52A0\u6B4C\u624B\u540D\u79F0\uFF01`,noAlbumWarning:`\u6CA1\u6709\u5728\u6B4C\u8BCD\u5143\u6570\u636E\u4E2D\u627E\u5230\u4E13\u8F91\u540D\u79F0\uFF01
\u8BF7\u5728\u9876\u90E8\u83DC\u5355 \u7F16\u8F91 - \u7F16\u8F91\u6B4C\u8BCD\u5143\u6570\u636E \u4E2D\u6DFB\u52A0\u4E13\u8F91\u540D\u79F0\uFF01`,unknownArtists:"\u672A\u77E5\u6B4C\u624B",unknownMusicName:"\u672A\u77E5\u97F3\u4E50",content:["\u9996\u5148\uFF0C\u611F\u8C22\u60A8\u7684\u6177\u6168\u6B4C\u8BCD\u8D21\u732E\uFF01","\u901A\u8FC7\u63D0\u4EA4\uFF0C\u4F60\u5C06\u9ED8\u8BA4\u540C\u610F {0} \u5E76\u63D0\u4EA4\u5230\u6B4C\u8BCD\u6570\u636E\u5E93\uFF01","\u5E76\u4E14\u6B4C\u8BCD\u5C06\u4F1A\u5728\u4EE5\u540E\u88AB AMLL \u7CFB\u7A0B\u5E8F\u4F5C\u4E3A\u9ED8\u8BA4 TTML \u6B4C\u8BCD\u6E90\u83B7\u53D6\uFF01","\u5982\u679C\u60A8\u5BF9\u6B4C\u8BCD\u6240\u6709\u6743\u6BD4\u8F83\u770B\u91CD\u7684\u8BDD\uFF0C\u8BF7\u52FF\u63D0\u4EA4\u6B4C\u8BCD\u54E6\uFF01","\u8BF7\u8F93\u5165\u4EE5\u4E0B\u63D0\u4EA4\u4FE1\u606F\u7136\u540E\u8DF3\u8F6C\u5230 Github \u8BAE\u9898\u63D0\u4EA4\u9875\u9762\uFF01"].join(`
`),boldCC0:"\u4F7F\u7528 CC0 \u5171\u4EAB\u534F\u8BAE\u5B8C\u5168\u653E\u5F03\u6B4C\u8BCD\u6240\u6709\u6743",musicName:"\u97F3\u4E50\u540D\u79F0",musicNamePlaceholder:"\u97F3\u4E50\u540D\u79F0",musicNameTip:"\u63A8\u8350\u4F7F\u7528 \u6B4C\u624B - \u6B4C\u66F2 \u683C\u5F0F\uFF0C\u65B9\u4FBF\u4ED3\u5E93\u7BA1\u7406\u5458\u786E\u8BA4\u4F60\u7684\u6B4C\u66F2\u662F\u5426\u5B58\u5728",generateFromMetadata:"\u4ECE\u5143\u6570\u636E\u751F\u6210",ncmIDTip:["\u53EF\u4EE5\u901A\u8FC7\u5728 AMLL \u63D2\u4EF6\u5185\u53F3\u952E\u590D\u5236\u97F3\u4E50 ID \u5F97\u5230\uFF0C\u5E94\u8BE5\u90FD\u662F\u7EAF\u6570\u5B57","\u5982\u679C\u9700\u8981\u540C\u65F6\u63D0\u4EA4\u5230\u591A\u4E2A\u6B4C\u66F2\u4E0A\uFF0C\u53EF\u4EE5\u4EE5\u82F1\u6587\u9017\u53F7\u5206\u9694 ID"].join(`
`),uploadReason:{label:"\u63D0\u4EA4\u7F18\u7531",newLyric:"\u65B0\u6B4C\u8BCD\u63D0\u4EA4",patchLyric:"\u4FEE\u6B63\u5DF2\u6709\u6B4C\u8BCD"},comment:"\u5907\u6CE8",commentPlaceholder:"\u5907\u6CE8",commentTip:"\u6709\u4EC0\u4E48\u9700\u8981\u8865\u5145\u8BF4\u660E\u7684\u5462\uFF1F",uploadBtn:"\u4E0A\u4F20\u5E76\u8DF3\u8F6C\u63D0\u4EA4",errors:{noLyricContent:"\u6B4C\u8BCD\u8FD8\u4EC0\u4E48\u90FD\u6CA1\u6709\u5462\uFF1F"},errorNotification:{title:"\u6B4C\u8BCD\u63D0\u4EA4\u5931\u8D25\uFF01",content:`\u9519\u8BEF\u539F\u56E0\uFF1A
{0}`}},tutorial:{title:"\u6B22\u8FCE\u4F7F\u7528 Apple Music-like Lyrics TTML \u6B4C\u8BCD\u5DE5\u5177\uFF01",content:["\u672C\u5DE5\u5177\u662F\u9488\u5BF9 BetterNCM \u63D2\u4EF6 Apple Music-like Lyrics \u64AD\u653E\u9875\u9762\u63D2\u4EF6\u800C\u4E13\u95E8\u8BBE\u8BA1\u7684 TTML \u6B4C\u8BCD\u5DE5\u5177\uFF01","\u56E0\u4E3A\u529F\u80FD\u76F8\u5BF9\u8F83\u591A\uFF0C\u6240\u4EE5\u4E5F\u9002\u5408\u7528\u6765\u5236\u4F5C\u5404\u79CD\u683C\u5F0F\u7684\u6B4C\u8BCD\u54E6\uFF01","\u4EE5\u4E0B\u662F\u7B80\u77ED\u7684\u4F7F\u7528\u65B9\u5F0F\uFF0C\u5E0C\u671B\u53EF\u4EE5\u8BA9\u60A8\u5FEB\u901F\u4E0A\u624B\u4F7F\u7528\u5B83\uFF01"].join(`
`),wipWarning:"\u672C\u5DE5\u5177\u4ECD\u5728\u5F00\u53D1\u5F53\u4E2D\uFF0C\u4ECD\u6709\u5F88\u591A\u7F3A\u5931\u7684\u529F\u80FD\u548C BUG\uFF0C\u8BF7\u4EC5\u7528\u4F5C\u5C1D\u9C9C\u7528\u9014\uFF0C\u5E76\u968F\u65F6\u4FDD\u5B58\u4F60\u7684\u6B4C\u8BCD\u6587\u4EF6\u4EE5\u9632\u4E07\u4E00\uFF01",step1:{title:"\u52A0\u8F7D\u6B4C\u8BCD",content:["\u60A8\u53EF\u4EE5\u901A\u8FC7\u5DE6\u4E0A\u89D2\u7684\u83DC\u5355 - \u6587\u4EF6 - \u6253\u5F00\u6B4C\u8BCD\u6765\u52A0\u8F7D\u6B4C\u8BCD\u54E6\uFF01","\u5982\u679C\u60A8\u7684\u6B4C\u8BCD\u4E0D\u662F TTML \u683C\u5F0F\u4E5F\u6CA1\u6709\u5173\u7CFB\uFF0C\u6B4C\u8BCD\u5DE5\u5177\u652F\u6301\u4ECE \u7EAF\u6587\u672C/LRC/YRC/QRC/Lyricify Syllable \u683C\u5F0F\u5BFC\u5165\u6B4C\u8BCD\u54E6\uFF01"].join(`
`)},step2:{title:"\u7F16\u8F91\u6B4C\u8BCD",content:["\u70B9\u51FB\u4E0A\u65B9\u7684 {0} \u6309\u94AE\u5373\u53EF\u8FDB\u5165\u7F16\u8F91\u6A21\u5F0F\uFF0C\u4E00\u822C\u9ED8\u8BA4\u90FD\u662F\u7F16\u8F91\u6A21\u5F0F\u3002","\u60A8\u53EF\u4EE5\u589E\u52A0\u65B0\u7684\u6B4C\u8BCD\u884C\uFF0C\u589E\u52A0\u65B0\u7684\u5355\u8BCD\uFF0C\u53EF\u4EE5\u5BF9\u5176\u62C6\u5206\uFF0C\u5206\u8BCD\uFF0C\u7F16\u8F91\u54E6\uFF01","\u8981\u7559\u610F\u7684\u662F\uFF0C\u6700\u540E\u4FDD\u5B58\u7684\u683C\u5F0F\u4F1A\u5C06\u4EFB\u4F55\u7A7A\u683C\u90FD\u5B8C\u6574\u4FDD\u7559\uFF0C\u6240\u4EE5\u8981\u7559\u610F\u82F1\u6587\u5355\u8BCD\u7684\u7A7A\u683C\u95F4\u9699\u54E6\uFF01","\u5982\u679C\u9700\u8981\u589E\u52A0\u7FFB\u8BD1\u6B4C\u8BCD\u884C\u548C\u97F3\u8BD1\u6B4C\u8BCD\u884C\uFF0C\u53EF\u4EE5\u901A\u8FC7\u83DC\u5355 \u67E5\u770B - \u663E\u793A\u7FFB\u8BD1/\u97F3\u8BD1\u6B4C\u8BCD \u9009\u9879\u6765\u663E\u793A\u54E6\uFF01","\u5982\u679C\u9700\u8981\u6807\u8BB0\u6B4C\u8BCD\u884C\u7684\u5C5E\u6027\uFF08\u662F\u5426\u4E3A\u80CC\u666F\u4EBA\u58F0\u6216\u5BF9\u5531\u4EBA\u58F0\uFF09\uFF0C\u53EF\u4EE5\u53F3\u952E\u6B4C\u8BCD\u884C\uFF0C\u9009\u62E9 \u5207\u6362\u6240\u9009\u6B4C\u8BCD\u884C\u4E3A\u80CC\u666F\u4EBA\u58F0/\u5207\u6362\u6240\u9009\u6B4C\u8BCD\u884C\u4E3A\u5BF9\u5531\u4EBA\u58F0 \u6216\u8005 \u4F7F\u7528\u7F16\u8F91\u83DC\u5355\u6765\u5207\u6362\u3002","\u5982\u679C\u9700\u8981\u6279\u91CF\u64CD\u4F5C\u6B4C\u8BCD\uFF0C\u53EF\u4EE5\u70B9\u51FB\u6B4C\u8BCD\u884C\u5DE6\u4FA7\u7684\u9009\u62E9\u6846\u6765\u9009\u4E2D\u6B4C\u8BCD\u884C\uFF0C\u7136\u540E\u4F7F\u7528\u7F16\u8F91\u83DC\u5355\u7684\u64CD\u4F5C\u6279\u91CF\u5904\u7406\u6B4C\u8BCD\u54E6\uFF01"].join(`
`),editModeBtnExample:"\u7F16\u8F91\u6A21\u5F0F"},step3:{title:"\u6B4C\u8BCD\u6253\u8F74",content:["\u70B9\u51FB\u4E0A\u65B9\u7684 {0} \u6309\u94AE\u5373\u53EF\u8FDB\u5165\u6253\u8F74\u6A21\u5F0F\uFF01","\u5728\u4E0B\u65B9\u7684\u97F3\u4E50\u64AD\u653E\u680F\u91CC\u52A0\u8F7D\u597D\u97F3\u4E50\uFF0C\u5C31\u53EF\u4EE5\u5F00\u59CB\u64AD\u653E\u6253\u8F74\u4E86\u3002","\u5982\u679C\u97F3\u4E50\u592A\u5FEB\uFF0C\u4E5F\u53EF\u4EE5\u5728\u97F3\u4E50\u64AD\u653E\u680F\u7684\u53F3\u4FA7\u8C03\u8282\u64AD\u653E\u901F\u5EA6\uFF0C\u8FD9\u6837\u624B\u5C31\u80FD\u8DDF\u4E0A\u4E86~","\u4EE5\u4E0B\u662F\u684C\u9762\u7248\u672C\u7684\u9ED8\u8BA4\u6253\u8F74\u6309\u952E\u8BBE\u7F6E\uFF1A","{1}"].join(`
`),syncModeBtnExample:"\u6253\u8F74\u6A21\u5F0F",shortcutsTable:{header:{key:"\u6309\u952E",description:"\u8BF4\u660E"},moveToPreviousWord:{key:"\u6309\u952E A",description:"\u79FB\u52A8\u5230\u4E0A\u4E00\u4E2A\u5355\u8BCD"},moveToNextWord:{key:"\u6309\u952E D",description:"\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD"},moveToFirstWordOfPreviousLine:{key:"\u6309\u952E W",description:"\u79FB\u52A8\u5230\u4E0A\u4E00\u884C\u6B4C\u8BCD\u7684\u7B2C\u4E00\u4E2A\u5355\u8BCD"},moveToFirstWordOfNextLine:{key:"\u6309\u952E S",description:"\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\u7684\u7B2C\u4E00\u4E2A\u5355\u8BCD"},moveToPreviousWordAndCurrentTime:{key:"\u6309\u952E R",description:"\u79FB\u52A8\u5230\u4E0A\u4E00\u4E2A\u5355\u8BCD\uFF0C\u5E76\u8BBE\u7F6E\u64AD\u653E\u4F4D\u7F6E\u4E3A\u76EE\u6807\u5355\u8BCD\u7684\u200B\u8D77\u59CB\u65F6\u95F4"},moveToNextWordAndSetCurrentTime:{key:"\u6309\u952E Y",description:"\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\uFF0C\u5E76\u8BBE\u7F6E\u64AD\u653E\u4F4D\u7F6E\u4E3A\u76EE\u6807\u5355\u8BCD\u7684\u200B\u8D77\u59CB\u65F6\u95F4"},setWordStartTimeToCurrentTime:{key:"\u6309\u952E F",description:"\u8BB0\u5F55\u5F53\u524D\u65F6\u95F4\u4E3A\u5F53\u524D\u5355\u8BCD\u7684\u8D77\u59CB\u65F6\u95F4"},moveNextAndSetWordTime:{key:"\u6309\u952E G",description:"\u8BB0\u5F55\u5F53\u524D\u65F6\u95F4\u4E3A\u5F53\u524D\u5355\u8BCD\u7684\u7ED3\u675F\u65F6\u95F4\u548C\u4E0B\u4E00\u4E2A\u5355\u8BCD\u7684\u8D77\u59CB\u65F6\u95F4\uFF0C\u5E76\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD"},moveNextAndSetWordEndTimeOnly:{key:"\u6309\u952E H",description:"\u8BB0\u5F55\u5F53\u524D\u65F6\u95F4\u4E3A\u5F53\u524D\u5355\u8BCD\u7684\u7ED3\u675F\u65F6\u95F4\uFF0C\u5E76\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u5355\u8BCD\uFF08\u7528\u4E8E\u7A7A\u51FA\u95F4\u594F\u65F6\u95F4\uFF09"},decreasePlaybackSpeed:{key:"\u6309\u952E [",description:"\u5C06\u64AD\u653E\u901F\u5EA6\u964D\u4F4E 0.25x"},increasePlaybackSpeed:{key:"\u6309\u952E ]",description:"\u5C06\u64AD\u653E\u901F\u5EA6\u589E\u52A0 0.25x"},resetPlaybackSpeed:{key:"\u6309\u952E '",description:"\u8BBE\u7F6E\u64AD\u653E\u901F\u5EA6\u4E3A\u539F\u901F"},resumeOrPauseMusic:{key:"\u7A7A\u683C",description:"\u64AD\u653E / \u6682\u505C\u97F3\u4E50"}}},step4:{title:"\u4FDD\u5B58\u6B4C\u8BCD",content:["\u548C\u52A0\u8F7D\u6B4C\u8BCD\u7C7B\u4F3C\uFF0C\u60A8\u53EF\u4EE5\u5C06\u6B4C\u8BCD\u4FDD\u5B58\u4E3A TTML \u683C\u5F0F\uFF0C\u4E5F\u53EF\u4EE5\u5BFC\u51FA\u5230\u5176\u4ED6\u4E3B\u6D41\u6B4C\u8BCD\u683C\u5F0F\u3002","\u4F46\u662F\u76EE\u524D Lyricify Syllable \u683C\u5F0F\u4F1A\u4E22\u5931\u7FFB\u8BD1\u548C\u97F3\u8BD1\u6587\u672C\uFF0C\u5BFC\u51FA\u6210 LRC \u683C\u5F0F\u4F1A\u4E22\u5931\u7FFB\u8BD1\u3001\u97F3\u8BD1\u6587\u672C\u3001\u9010\u8BCD\u6B4C\u8BCD\u7684\u5355\u8BCD\u4FE1\u606F\u548C\u6B4C\u8BCD\u884C\u5C5E\u6027\u4FE1\u606F\uFF0C\u800C\u5BFC\u51FA\u6210 YRC/QRC \u683C\u5F0F\u4F1A\u4E22\u5931\u7FFB\u8BD1\u3001\u97F3\u8BD1\u6587\u672C\u548C\u6B4C\u8BCD\u884C\u7684\u5C5E\u6027\u4FE1\u606F\uFF0C\u8981\u7559\u610F\u54E6\uFF01"].join(`
`)},step5:{title:"\u4F7F\u7528\u6B4C\u8BCD\uFF08\u4EC5\u7B80\u4F53\u4E2D\u6587\u7528\u6237\uFF09",ncmOnlyWarning:"\u672C\u6B65\u9AA4\u4EC5\u4F7F\u7528 AMLL \u63D2\u4EF6\u7684\u7B80\u4F53\u4E2D\u6587\u7528\u6237\u53EF\u53C2\u8003\u64CD\u4F5C\uFF0C\u5982\u679C\u60A8\u662F\u4E3A\u4E86\u5728\u5176\u4ED6\u8F6F\u4EF6\u4E0A\u4F7F\u7528\u6B4C\u8BCD\u800C\u7F16\u8F91\u6B4C\u8BCD\u7684\u8BDD\uFF0C\u8BF7\u53C2\u8003\u5BF9\u5E94\u7684\u8F6F\u4EF6\u5BFC\u5165\u4F7F\u7528\u6B4C\u8BCD\u7684\u65B9\u5F0F\u6765\u4F7F\u7528\u6B4C\u8BCD\u54E6\uFF01",content:["\u6700\u540E\u5C31\u662F\u653E\u5230 AMLL \u63D2\u4EF6\u7684 TTML \u6B4C\u8BCD\u6587\u4EF6\u5939\u5185\uFF0C\u5C06\u6B4C\u8BCD\u6587\u4EF6\u547D\u540D\u4E3A\u7F51\u6613\u4E91\u7684\u6B4C\u66F2 ID\uFF08\u53EF\u4EE5\u901A\u8FC7 AMLL \u64AD\u653E\u9875\u9762\u5185\u53F3\u952E\u590D\u5236\u5F97\u5230\uFF09\u540E\u91CD\u65B0\u5207\u6B4C\u5373\u53EF\u8BFB\u53D6\uFF01","\u4E3A\u4E86\u8BA9\u66F4\u591A\u4EBA\u80FD\u591F\u4F53\u9A8C\u5230 TTML \u6B4C\u8BCD\u5E26\u6765\u7684\u6548\u679C\uFF0C\u60A8\u4E5F\u53EF\u4EE5\u5C06\u60A8\u7684\u6B4C\u8BCD\u4E0A\u4F20\u5230 {0} \u4E0A\uFF0C\u4F9B\u5927\u5BB6\u4E0B\u8F7D\u4F7F\u7528\u54E6\uFF01"].join(`
`),amllTtmlDbUrlName:"SteveXMH \u7684 TTML \u6B4C\u8BCD\u4ED3\u5E93"},ending:"\u4E4B\u540E\u60A8\u53EF\u4EE5\u901A\u8FC7\u5DE6\u4E0A\u89D2\u7684 \u6587\u4EF6\u83DC\u5355 - \u5173\u4E8E - \u7B80\u77ED\u6559\u7A0B \u518D\u6B21\u8BBF\u95EE\u672C\u9875\u9762\uFF0C\u5982\u679C\u5FD8\u8BB0\u600E\u4E48\u64CD\u4F5C\u4E86\u53EF\u4EE5\u518D\u6765\u770B\u770B\u54E6\uFF01",closeBtn:"\u6211\u77E5\u9053\u4E86"},importFromAMLLDB:{title:"\u4ECE AMLL \u6B4C\u8BCD\u6570\u636E\u5E93\u5BFC\u5165\u6B4C\u8BCD",description:"\u5BFC\u5165\u6210\u529F\u5C06\u4F1A\u8986\u76D6\u5F53\u524D\u6B4C\u8BCD\u5185\u5BB9\uFF0C\u8BF7\u6CE8\u610F\u4FDD\u5B58\u5DF2\u6709\u6B4C\u8BCD\uFF01",musicID:{placeholder:"\u97F3\u4E50 ID"},importBtn:"\u5BFC\u5165"},shortcutInput:{none:"\u65E0\u7ED1\u5B9A",recording:"\u8BF7\u6309\u4E0B\u4EFB\u610F\u952E..."}},xf={legacy:!1,globalInjection:!0,silentFallbackWarn:!0,locale:navigator.language,fallbackLocale:[...navigator.languages,"zh-CN"],messages:{"zh-CN":bf,"en-US":wf}},ie=av(xf),Dl=()=>new Promise(i=>requestAnimationFrame(i)),kf=/^(((?<hour>[0-9]+):)?(?<min>[0-9]+):)?(?<sec>[0-9]+([.:]([0-9]{1,3}))?)$/;function kr(i){var e,r,n;const t=kf.exec(i);if(t){const o=Number(((e=t.groups)==null?void 0:e.hour)||"0"),s=Number(((r=t.groups)==null?void 0:r.min)||"0"),l=Number(((n=t.groups)==null?void 0:n.sec.replace(/:/,"."))||"0");return Math.floor((o*3600+s*60+l)*1e3)}throw new TypeError(`\u65F6\u95F4\u6233\u5B57\u7B26\u4E32\u89E3\u6790\u5931\u8D25\uFF1A${i}`)}function Vt(i){let t=i;if(!Number.isSafeInteger(t)||t<0)throw new Error(`Invalid timestamp: ${t}`);if(t===1/0)return"99:99.999";t=i/1e3;const e=t%60;t=(t-e)/60;const r=t%60,n=(t-r)/60,o=n.toString().padStart(2,"0"),s=r.toString().padStart(2,"0"),l=e.toFixed(3).padStart(6,"0");return n>0?`${o}:${s}:${l}`:`${s}:${l}`}function Pl(i){const t=new DOMParser().parseFromString(i,"application/xml");console.log(t);let e="v1";const r=[];for(const s of t.querySelectorAll("meta"))if(s.tagName==="amll:meta"){const l=s.getAttribute("key");if(l){const a=s.getAttribute("value");if(a){const c=r.find(h=>h.key===l);c?c.value.push(a):r.push({key:l,value:[a]})}}}for(const s of t.querySelectorAll("ttm\\:agent"))if(s.getAttribute("type")==="person"){const l=s.getAttribute("xml:id");l&&(e=l)}const n=[];function o(s,l=!1,a=!1){var f,m;const c={words:[],translatedLyric:"",romanLyric:"",isBG:l,isDuet:l?a:!!s.getAttribute("ttm:agent")&&s.getAttribute("ttm:agent")!==e,startTime:0,endTime:0};let h=!1;const u=s.getAttribute("begin"),d=s.getAttribute("end");u&&d?(c.startTime=kr(u),c.endTime=kr(d)):(c.startTime=c.words.reduce((v,p)=>Math.min(v,p.startTime),1/0),c.endTime=c.words.reduce((v,p)=>Math.max(v,p.endTime),0));for(const v of s.childNodes)if(v.nodeType===Node.TEXT_NODE){const p=v.textContent??"";c.words.push({word:p,startTime:p.trim().length>0?c.startTime:0,endTime:p.trim().length>0?c.endTime:0})}else if(v.nodeType===Node.ELEMENT_NODE){const p=v,y=p.getAttribute("ttm:role");if(p.nodeName==="span"&&y)y==="x-bg"?(o(p,!0,c.isDuet),h=!0):y==="x-translation"?c.translatedLyric=p.innerHTML:y==="x-roman"&&(c.romanLyric=p.innerHTML);else if(p.hasAttribute("begin")&&p.hasAttribute("end")){const b={word:v.textContent??"",startTime:kr(p.getAttribute("begin")??""),endTime:kr(p.getAttribute("end")??"")},k=p.getAttribute("amll:empty-beat");k&&(b.emptyBeat=Number(k)),c.words.push(b)}}if(c.isBG){const v=c.words[0];(f=v==null?void 0:v.word)!=null&&f.startsWith("(")&&(v.word=v.word.substring(1),v.word.length===0&&c.words.shift());const p=c.words[c.words.length-1];(m=p==null?void 0:p.word)!=null&&m.endsWith(")")&&(p.word=p.word.substring(0,p.word.length-1),p.word.length===0&&c.words.pop())}if(h){const v=n.pop();n.push(c),v&&n.push(v)}else n.push(c)}for(const s of t.querySelectorAll("body p[begin][end]"))o(s);return console.log(n,r),{metadata:r,lyricLines:n}}function pb(i,t=!1){var p,y,b;const e=[],r=i.lyricLines;let n=[];for(const k of r)k.words.length===0&&n.length>0?(e.push(n),n=[]):n.push(k);n.length>0&&e.push(n);const o=new Document;function s(k){const S=o.createElement("span");return S.setAttribute("begin",Vt(k.startTime)),S.setAttribute("end",Vt(k.endTime)),k.emptyBeat&&S.setAttribute("amll:empty-beat",`${k.emptyBeat}`),S.appendChild(o.createTextNode(k.word)),S}const l=o.createElement("tt");l.setAttribute("xmlns","http://www.w3.org/ns/ttml"),l.setAttribute("xmlns:ttm","http://www.w3.org/ns/ttml#metadata"),l.setAttribute("xmlns:amll","http://www.example.com/ns/amll"),l.setAttribute("xmlns:itunes","http://music.apple.com/lyric-ttml-internal"),o.appendChild(l);const a=o.createElement("head");l.appendChild(a);const c=o.createElement("body"),h=!!r.find(k=>k.isDuet),u=o.createElement("metadata"),d=o.createElement("ttm:agent");if(d.setAttribute("type","person"),d.setAttribute("xml:id","v1"),u.appendChild(d),h){const k=o.createElement("ttm:agent");k.setAttribute("type","other"),k.setAttribute("xml:id","v2"),u.appendChild(k)}for(const k of i.metadata)for(const S of k.value){const M=o.createElement("amll:meta");M.setAttribute("key",k.key),M.setAttribute("value",S),u.appendChild(M)}a.appendChild(u);let f=0;const m=((p=r[r.length-1])==null?void 0:p.endTime)??0;c.setAttribute("dur",Vt(m));const v=r.some(k=>k.words.filter(S=>S.word.trim().length>0).length>1);for(const k of e){const S=o.createElement("div"),M=((y=k[0])==null?void 0:y.startTime)??0,L=((b=k[k.length-1])==null?void 0:b.endTime)??0;S.setAttribute("begin",Vt(M)),S.setAttribute("end",Vt(L));for(let A=0;A<k.length;A++){const P=k[A],B=o.createElement("p"),Y=P.startTime??0,q=P.endTime;if(B.setAttribute("begin",Vt(Y)),B.setAttribute("end",Vt(q)),B.setAttribute("ttm:agent",P.isDuet?"v2":"v1"),B.setAttribute("itunes:key",`L${++f}`),v){let $=1/0,J=0;for(const K of P.words)if(K.word.trim().length===0)B.appendChild(o.createTextNode(K.word));else{const nt=s(K);B.appendChild(nt),$=Math.min($,K.startTime),J=Math.max(J,K.endTime)}B.setAttribute("begin",Vt(P.startTime)),B.setAttribute("end",Vt(P.endTime))}else{const $=P.words[0];B.appendChild(o.createTextNode($.word)),B.setAttribute("begin",Vt($.startTime)),B.setAttribute("end",Vt($.endTime))}const j=k[A+1];if(j!=null&&j.isBG){A++;const $=j,J=o.createElement("span");if(J.setAttribute("ttm:role","x-bg"),v){let K=1/0,nt=0;for(let St=0;St<$.words.length;St++){const ft=$.words[St];if(ft.word.trim().length===0)J.appendChild(o.createTextNode(ft.word));else{const Et=s(ft);St===0?Et.prepend(o.createTextNode("(")):St===$.words.length-1&&Et.appendChild(o.createTextNode(")")),J.appendChild(Et),K=Math.min(K,ft.startTime),nt=Math.max(nt,ft.endTime)}}J.setAttribute("begin",Vt(K)),J.setAttribute("end",Vt(nt))}else{const K=$.words[0];J.appendChild(o.createTextNode(`(${K.word})`)),J.setAttribute("begin",Vt(K.startTime)),J.setAttribute("end",Vt(K.endTime))}if($.translatedLyric){const K=o.createElement("span");K.setAttribute("ttm:role","x-translation"),K.setAttribute("xml:lang","zh-CN"),K.appendChild(o.createTextNode($.translatedLyric)),J.appendChild(K)}if($.romanLyric){const K=o.createElement("span");K.setAttribute("ttm:role","x-roman"),K.appendChild(o.createTextNode($.romanLyric)),J.appendChild(K)}B.appendChild(J)}if(P.translatedLyric){const $=o.createElement("span");$.setAttribute("ttm:role","x-translation"),$.setAttribute("xml:lang","zh-CN"),$.appendChild(o.createTextNode(P.translatedLyric)),B.appendChild($)}if(P.romanLyric){const $=o.createElement("span");$.setAttribute("ttm:role","x-roman"),$.appendChild(o.createTextNode(P.romanLyric)),B.appendChild($)}S.appendChild(B)}c.appendChild(S)}if(l.appendChild(c),console.log(l),t){const k=new DOMParser().parseFromString(['<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">','  <xsl:strip-space elements="*"/>','  <xsl:template match="para[content-style][not(text())]">','    <xsl:value-of select="normalize-space(.)"/>',"  </xsl:template>",'  <xsl:template match="node()|@*">','    <xsl:copy><xsl:apply-templates select="node()|@*"/></xsl:copy>',"  </xsl:template>",'  <xsl:output indent="yes"/>',"</xsl:stylesheet>"].join(`
`),"application/xml"),S=new XSLTProcessor;S.importStylesheet(k);const M=S.transformToDocument(o);return new XMLSerializer().serializeToString(M)}return new XMLSerializer().serializeToString(o)}const Sf=yi("progress",{state:()=>({currentProgresses:[]}),actions:{newProgress(i){return this.currentProgresses.push({label:i,progress:0,parent:void 0}),this.currentProgresses[this.currentProgresses.length-1]},finishProgress(i){this.currentProgresses.splice(this.currentProgresses.indexOf(i),1)}}});function fn(i){return{...i,words:i.words.map(t=>({...t})),selected:!1}}We=yi("editing-lyric",{state:()=>({artists:[],lyrics:[],metadata:[]}),undo:{enable:!0},getters:{lineWithIds:i=>i.lyrics.map((t,e)=>({...t,words:t.words.map((r,n)=>({...r,lineIndex:e,id:n})),id:e})),lineForPreview:i=>i.lyrics.map(t=>{var e,r,n,o;return{startTime:((r=(e=t.words)==null?void 0:e[0])==null?void 0:r.startTime)??0,endTime:((o=(n=t.words)==null?void 0:n[t.words.length-1])==null?void 0:o.endTime)??0,words:t.words.map(s=>({startTime:s.startTime,endTime:s.endTime,word:s.word})),isBG:t.isBG,isDuet:t.isDuet,romanLyric:t.romanLyric,translatedLyric:t.translatedLyric}}),hasLineWithMoreWords:i=>!!i.lyrics.find(t=>t.words.length>1)},actions:{reset(){this.artists.splice(0,this.artists.length),this.lyrics.splice(0,this.lyrics.length),this.metadata=[],this.record()},isDirty(){return this.artists.length>0||this.lyrics.length>0||this.metadata.length>0},loadLyric(i){this.artists=[],this.lyrics=i.lyricLines.map(t=>({...t,selected:!1})),this.metadata=i.metadata,this.record()},loadLRC(i){this.artists=[],this.lyrics=Gv(i).map(fn),this.metadata=[],this.record()},loadESLRC(i){this.artists=[],this.lyrics=Kv(i).map(fn),this.metadata=[],this.record()},loadYRC(i){this.artists=[],this.lyrics=ew(i).map(fn),this.metadata=[],this.record()},loadQRC(i){this.artists=[],this.lyrics=Zv(i).map(fn),this.metadata=[],this.record()},loadLYS(i){this.artists=[],this.lyrics=Xv(i).map(fn),this.metadata=[],this.record()},addNewLine(){this.lyrics.push({words:[],translatedLyric:"",romanLyric:"",isBG:!1,isDuet:!1,selected:!1,startTime:0,endTime:0}),this.record()},insertNewLineAt(i){this.lyrics.splice(i,0,{words:[],translatedLyric:"",romanLyric:"",isBG:!1,isDuet:!1,selected:!1,startTime:0,endTime:0}),this.record()},reorderWord(i,t,e){const r=this.lyrics[i];if(r!=null&&r.words[t]){const n=r.words.splice(t,1)[0];r.words.splice(e,0,n),this.record()}},selectLine(i){this.lyrics[i]&&(this.lyrics[i].selected=!0)},selectAllLine(){for(const i of this.lyrics)i.selected=!0},unselectAllLine(){for(const i of this.lyrics)i.selected=!1},invertSelectAllLine(){for(const i of this.lyrics)i.selected=!i.selected},removeLine(i){this.lyrics[i]&&(this.lyrics.splice(i,1),this.record())},addNewWord(i,t){this.lyrics[i]&&(this.lyrics[i].words.push({startTime:0,endTime:0,word:t}),this.record())},modifyWord(i,t,e){this.lyrics[i]&&this.lyrics[i].words[t]&&(this.lyrics[i].words[t].word=e,this.record())},modifyWordEmptyBeat(i,t,e){this.lyrics[i]&&this.lyrics[i].words[t]&&(this.lyrics[i].words[t].emptyBeat=e===0?void 0:e,this.record())},modifyTranslatedLine(i,t){this.lyrics[i]&&(this.lyrics[i].translatedLyric=t,this.record())},modifyRomanLine(i,t){this.lyrics[i]&&(this.lyrics[i].romanLyric=t,this.record())},toggleSelectedLineBackground(){const i=this.lyrics.filter(t=>t.selected&&!t.isBG).length>0;for(const t of this.lyrics)t.selected&&(t.isBG=i)},toggleSelectedLineDuet(){const i=this.lyrics.filter(t=>t.selected&&!t.isDuet).length>0;for(const t of this.lyrics)t.selected&&(t.isDuet=i)},removeWord(i,t){this.lyrics[i]&&(this.lyrics[i].words.splice(t,1),this.record())},setWordTime(i,t,e){var r,n,o;if((o=(n=(r=this.lyrics)==null?void 0:r[i])==null?void 0:n.words)!=null&&o[t]){this.lyrics[i].words[t].startTime=e,t>0&&(this.lyrics[i].words[t-1].endTime=e);let s=i,l=t;do l>0?l--:s>0&&(l=this.lyrics[--s].words.length-1);while(this.lyrics[s].words[l].word.trim().length===0);(s!==i||l!==t)&&(this.lyrics[s].words[l].endTime=e),this.record()}},setWordEndTime(i,t,e){var r,n,o;(o=(n=(r=this.lyrics)==null?void 0:r[i])==null?void 0:n.words)!=null&&o[t]&&(this.lyrics[i].words[t].endTime=e,this.record())},setWordTimeNoLast(i,t,e){var r,n,o;(o=(n=(r=this.lyrics)==null?void 0:r[i])==null?void 0:n.words)!=null&&o[t]&&(this.lyrics[i].words[t].startTime=e,this.record())},splitWord(i,t,e){var r,n,o;if((o=(n=(r=this.lyrics)==null?void 0:r[i])==null?void 0:n.words)!=null&&o[t]){const s=Bt(this.lyrics[i].words[t]),l={...s},a={...s};l.word=s.word.slice(0,e),a.word=s.word.slice(e);const c=s.endTime-s.startTime;a.startTime=l.endTime=s.startTime+c/s.word.length*e,this.lyrics[i].words.splice(t,1,l,a),this.record()}},roundTimeStamps(){for(const i of this.lyrics){i.startTime=Math.round(i.startTime),i.endTime=Math.round(i.endTime);for(const t of i.words)t.startTime=Math.round(t.startTime),t.endTime=Math.round(t.endTime),t.emptyBeat!==void 0&&(t.emptyBeat=Math.round(t.emptyBeat))}},toTTML(){var t;this.roundTimeStamps();const i=[];for(let e=0;e<this.lyrics.length;e++){if(this.lyrics[e].isBG&&((t=this.lyrics[e-1])!=null&&t.isBG))throw new TypeError(`\u7B2C ${e} \u884C\u80CC\u666F\u4EBA\u58F0\u6B4C\u8BCD\u91CD\u590D\uFF0C\u6BCF\u884C\u666E\u901A\u6B4C\u8BCD\u53EA\u80FD\u62E5\u6709\u4E00\u4E2A\u80CC\u666F\u4EBA\u58F0\u6B4C\u8BCD`);i.push(Bt(this.lyrics[e]))}return console.log(qi(i)),pb({lyricLines:i,metadata:Bt(this.metadata)})},toLRC(){this.roundTimeStamps();const i=Bt(this.lyrics);return Jv(i)},toESLRC(){this.roundTimeStamps();const i=Bt(this.lyrics);return Yv(i)},toYRC(){this.roundTimeStamps();const i=Bt(this.lyrics);return iw(i)},toQRC(){this.roundTimeStamps();const i=Bt(this.lyrics);return tw(i)},toLYS(){this.roundTimeStamps();const i=Bt(this.lyrics);return Qv(i)},toASS(){this.roundTimeStamps();const i=Bt(this.lyrics);return qv(i)},splitLineBySimpleMethod(){const i=this.lyrics.map(r=>({...Bt(r),words:Bt(r.words).map(n=>({...n}))})),t=[],e=/^[A-z\u00C0-\u00ff'.,-\/#!$%^&*;:{}=\-_`~()]+$/;for(const r of i){const n=r.words.flatMap(l=>l.word.split(""));console.log(n);const o=[];let s={word:"",startTime:0,endTime:0};for(const l of n)/^\s+$/.test(l)?(s.word.trim().length>0&&o.push(s),s={word:" ",startTime:0,endTime:0}):e.test(l)?e.test(s.word)?s.word+=l:(s.word.length>0&&o.push(s),s={word:l,startTime:0,endTime:0}):(s.word.length>0&&o.push(s),s={word:l,startTime:0,endTime:0});s.word.length>0&&o.push(s),t.push({...r,words:o,selected:!1})}console.log(t),this.lyrics=t,this.record()},async splitLineByJieba(){const i=Sf(),t=i.newProgress(ie.global.t("progressOverlay.processingWordSpliting")),e=[],r=this.lyrics.filter(s=>s.selected).length;let n=0;t.label=ie.global.t("progressOverlay.loadingJiebaModule");const{cut:o}=await nn(async()=>{const{cut:s}=await import("./jieba_rs_wasm-C3TEExWA.js");return{cut:s}},[],import.meta.url);for(let s=0;s<this.lyrics.length;s++){const l={...Bt(this.lyrics[s])};if(!l.selected){e.push(l);continue}l.words=l.words.flatMap(a=>{const c=o(a.word,!0),h=(a.endTime-a.startTime)/a.word.length,u=[];let d=0;for(const f of c)u.push({startTime:a.startTime+d*h,endTime:a.startTime+(d+f.length)*h,word:f}),d+=f.length;return u}),t.label=ie.global.t("progressOverlay.splitingWords",[++n,r]),t.progress=n/r,e.push(l),s%5===0&&await Dl()}t.label=ie.global.t("progressOverlay.finishing"),await Dl(),this.lyrics=e,i.finishProgress(t),this.record()},splitLineBySmartMethod(){const i=this.lyrics.map(o=>({...Bt(o),words:Bt(o.words).map(s=>({...s}))})),t=[],e=/^[A-z\u00C0-\u00ff'.,-\/#!$%^&*;:{}=\-_`~()]+$/,r=/[ぁぃぅぇぉゕゖっゃゅょゎ]+|[ァィゥェォヵㇰヶㇱㇲッㇳㇴㇵㇶㇷㇷ゚ㇸㇹㇺャュョㇻㇼㇽㇾㇿヮー]+|[んン’”。、￥＃！＄％＾＆＊；：｛｝「」＝＿｀〜（）]+/u,n=/[가-힣]+/u;for(const o of i){const s=o.words.flatMap(c=>c.word.split(""));console.log(s);const l=[];let a={word:"",startTime:0,endTime:0};for(const c of s)/^\s+$/.test(c)?(a.word.trim().length>0&&(a.word=a.word.trim()+" ",l.push(a)),a={word:"",startTime:0,endTime:0}):e.test(c)?e.test(a.word)?a.word+=c:(a.word.length>0&&l.push(a),a={word:c,startTime:0,endTime:0}):n.test(c)?(a.word+=c,a.emptyBeat=a.word.length-1):r.test(c)?a.word+=c:(a.word.length>0&&l.push(a),a={word:c,startTime:0,endTime:0});a.word.length>0&&l.push(a),t.push({...o,words:l,selected:!1})}console.log(t),this.lyrics=t,this.record()}}}),pr=yi("right-click-lyric-line",{state:()=>({show:!1,selectedLine:0,selectedWord:0,x:0,y:0}),actions:{showMenuForLyric(i,t,e,r){this.show=!0,this.selectedLine=i,this.selectedWord=t,this.x=e,this.y=r}}}),en=(i=>(i.Simple="simple",i.Advanced="advanced",i))(en||{});let Lo;ji=yi("settings",{state:()=>({showTranslateLine:!1,showRomanLine:!1,showJpnRomaji:!1,volume:.5,speed:1,timeOffset:0,showingTutorial:!0,uiLayoutMode:"simple",dbUploadApiBaseUrl:"https://dpaste.org/api/",keybindings:{resumeOrPause:["Space"],seekPlayForward5s:["ArrowRight"],seekPlayBackward5s:["ArrowLeft"],seekPlayForward1s:[],seekPlayBackward1s:[],seekPlayForward100ms:[],seekPlayBackward100ms:[],volumeUp:["ArrowUp"],volumeDown:["ArrowDown"],speedUp:["BracketLeft"],speedDown:["BracketRight"],openMusicFile:[],openLyricFile:[],saveLyricFile:[],moveLeftWord:["KeyA"],moveRightWord:["KeyD"],moveUpLine:["KeyW"],moveDownLine:["KeyS"],seekLeftWord:["KeyR"],seekRightWord:["KeyY"],setCurWordStartTime:["KeyF"],stepWordAndSetTime:["KeyG"],stepWordAndSetTimeAlias1:[],stepWordAndSetTimeAlias2:[],stepWordAndSetTimeAlias3:[],stepWordAndSetEndTime:["KeyH"],setLineStartTime:["KeyV"],setLineEndTime:["KeyN"]}}),persist:!0}),Lo=wv(),Lo.use(Vv),Lo.use(Rv);function mb(i){return i.join(" + ")}const Sr=new Set,Tr=new Set,Rl=new Map;let Bl=0;window.addEventListener("keydown",i=>{if(console.log("Key down",i.code),Tf(i)){Tr.clear(),Sr.clear();return}Tr.size===0&&(Bl=i.timeStamp),Tr.add(i.code),Sr.add(i.code)}),window.addEventListener("keyup",i=>{if(Tf(i)){Tr.clear(),Sr.clear();return}if(console.log(Tr.size),Sr.size>0){const t=[...Sr].join(" + ");Sr.clear();const e=Rl.get(t);if(e){const r=i.timeStamp-Bl,n={downTime:Bl,downTimeOffset:r};for(const o of e)try{o(n)}catch(s){console.warn("Error in key binding ",t,"callback",s)}i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation()}}Tr.clear()});function Tf(i){const t=i.target||i.srcElement,e=t==null?void 0:t.tagName;return(t==null?void 0:t.isContentEditable)||e==="INPUT"||e==="SELECT"||e==="TEXTAREA"||!!pn||!!mn}function gb(i,t){if(i.length===0)return()=>{};const e=[...i].join(" + ");let r=Rl.get(e);return r||(r=new Set,Rl.set(e,r)),console.log("Registering",e),r.add(t),()=>{r==null||r.delete(t)}}ge=function(i,t){xe(()=>i,(e,r,n)=>{n(gb(e,t))},{immediate:!0})};let pn,mn;function _o(){pn&&(window.removeEventListener("keydown",pn),pn=void 0),mn&&(window.removeEventListener("keyup",mn),mn=void 0)}function yb(){return new Promise((i,t)=>{_o();const e=new Set,r=new Set,n=s=>{e.add(s.code),r.add(s.code),s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation()},o=s=>{r.delete(s.code),r.size===0&&(_o(),r.has("Escape")?t(new Error("User canceled")):i([...e])),s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation()};pn=n,mn=o,window.addEventListener("keydown",n),window.addEventListener("keyup",o)})}let Af,Mf,Cf;Af={class:"hide-if-small"},Mf=Q({__name:"AudioPlayerBar",setup(i){const t=Gt(),e=Gt(new Audio),r=ji(),n=Jc(),o=Gt(null);n.$onAction(a=>{a.name==="setCurrentTime"&&(e.value.currentTime=a.args[0]/1e3)}),r.$subscribe(()=>{e.value.playbackRate=Math.max(.25,Math.min(4,r.speed)),e.value.volume=Math.max(0,Math.min(1,r.volume))},{flush:"post"});function s(a){const c=a<0,h=Math.abs(a|0),u=h%60,d=Math.floor((h-u)/60),f="0".repeat(2-u.toString().length)+u;return`${c?"-":""}${d}:${f}`}function l(a){n.audioURL.length>0&&URL.revokeObjectURL(n.audioURL),n.canPlay=!1,e.value.pause(),a.file.file&&(t.value=a.file,n.audioURL=URL.createObjectURL(a.file.file),e.value.src=n.audioURL)}return hr(()=>{e.value.addEventListener("canplay",()=>{n.canPlay=!0,n.duration=e.value.duration*1e3,e.value.playbackRate=Math.max(.25,Math.min(4,r.speed)),e.value.volume=Math.max(0,Math.min(1,r.volume))}),e.value.addEventListener("play",()=>{n.playing=!0}),e.value.addEventListener("pause",()=>{n.playing=!1});let a=Gt(0);e.value.addEventListener("timeupdate",()=>{n.currentTime=e.value.currentTime*1e3,a.value&&cancelAnimationFrame(a.value);const c=()=>{n.playing&&(n.currentTime=e.value.currentTime*1e3,a.value=requestAnimationFrame(c))};a.value=requestAnimationFrame(c)}),e.value.playbackRate=Math.max(.25,Math.min(4,r.speed)),e.value.volume=Math.max(0,Math.min(1,r.volume))}),ge(r.keybindings.resumeOrPause,()=>{e.value.paused?e.value.play():e.value.pause()}),ge(r.keybindings.volumeUp,()=>{r.volume=Math.min(1,Math.max(0,r.volume+.1))}),ge(r.keybindings.volumeDown,()=>{r.volume=Math.min(1,Math.max(0,r.volume-.1))}),ge(r.keybindings.seekPlayForward5s,()=>{e.value.seekable&&(e.value.currentTime=Math.min(e.value.duration,e.value.currentTime+5))}),ge(r.keybindings.seekPlayBackward5s,()=>{e.value.seekable&&(e.value.currentTime=Math.max(0,e.value.currentTime-5))}),ge(r.keybindings.seekPlayForward1s,()=>{e.value.seekable&&(e.value.currentTime=Math.min(e.value.duration,e.value.currentTime+1))}),ge(r.keybindings.seekPlayBackward1s,()=>{e.value.seekable&&(e.value.currentTime=Math.max(0,e.value.currentTime-1))}),ge(r.keybindings.seekPlayForward100ms,()=>{e.value.seekable&&(e.value.currentTime=Math.min(e.value.duration,e.value.currentTime+.1))}),ge(r.keybindings.seekPlayBackward100ms,()=>{e.value.seekable&&(e.value.currentTime=Math.max(0,e.value.currentTime-.1))}),ge(r.keybindings.speedUp,()=>{r.speed=Math.max(.25,Math.min(4,r.speed+.25))}),ge(r.keybindings.speedDown,()=>{r.speed=Math.max(.25,Math.min(4,r.speed-.25))}),ge(r.keybindings.openMusicFile,()=>{var a;(a=o.value)==null||a.openOpenFileDialog()}),Gs(()=>{n.audioURL.length>0&&URL.revokeObjectURL(n.audioURL),e.value.pause(),e.value.remove()}),(a,c)=>{const h=De("i18n-t");return W(),xt(g(OM),{bordered:"",class:"audio-player-bar"},{default:E(()=>[w(g(EM),{ref_key:"uploadRef",ref:o,"default-upload":!1,multiple:!1,"show-file-list":!1,style:{width:"unset"},onChange:l},{default:E(()=>[t.value?(W(),xt(g(rt),{key:1,circle:"",quaternary:""},{default:E(()=>[w(g(gi),{size:"18"},{default:E(()=>[w(g(sd))]),_:1})]),_:1})):(W(),xt(g(rt),{key:0},{default:E(()=>[w(h,{keypath:"audioPlayerBar.loadMusicBtn"})]),_:1}))]),_:1},512),w(g(rt),{disabled:!g(n).canPlay,circle:"",quaternary:"",onClick:c[0]||(c[0]=u=>g(n).playing?e.value.pause():e.value.play())},{default:E(()=>[w(g(gi),{size:"18"},{default:E(()=>[g(n).playing?(W(),xt(g(hd),{key:0})):(W(),xt(g(pd),{key:1}))]),_:1})]),_:1},8,["disabled"]),x("div",null,Ie(s(g(n).currentTime/1e3)),1),w(g(tn),{disabled:!g(n).canPlay,"format-tooltip":u=>s(u),max:e.value.duration,value:Math.floor(g(n).currentTime/1e3),"onUpdate:value":c[1]||(c[1]=u=>{g(n).setCurrentTime(u*1e3)})},null,8,["disabled","format-tooltip","max","value"]),x("div",Af,Ie(s((g(n).currentTime-g(n).duration)/1e3)),1),w(g(gi),{class:"hide-if-small",size:"18"},{default:E(()=>[w(g($d))]),_:1}),w(g(tn),{"format-tooltip":u=>`${u.toFixed(2)}x`,max:4,min:.25,step:.25,value:g(r).speed,class:"hide-if-small",style:{"max-width":"100px"},"onUpdate:value":c[2]||(c[2]=u=>{g(r).speed=u,e.value.playbackRate=u})},null,8,["format-tooltip","value"]),w(g(gi),{class:"hide-if-small",size:"18"},{default:E(()=>[w(g(Rd))]),_:1}),w(g(tn),{"format-tooltip":u=>`${u*100|0}%`,max:1,min:0,step:.01,value:g(r).volume,class:"hide-if-small",style:{"max-width":"100px"},"onUpdate:value":c[3]||(c[3]=u=>{g(r).volume=u,e.value.volume=u})},null,8,["format-tooltip","value"])]),_:1})}}}),Fe=(i,t)=>{const e=i.__vccOpts||i;for(const[r,n]of t)e[r]=n;return e},Cf=Fe(Mf,[["__scopeId","data-v-ee036cd4"]]);function vb(i,t,e){const{children:r}=t;return delete t.children,arguments.length>2&&(t.key=e),Xr(i,t,r)}let Lf,_f,Nl,Ef,Of,Df,Pf,Rf,Bf,Nf,If;rn=Q({__name:"TimeStampInput",props:{value:{},valueModifiers:{}},emits:k1(["update:modelValue"],["update:value"]),setup(i,{emit:t}){const e=S1(i,"value"),r=t,n=Gt(""),o=Dt(()=>{try{return kr(n.value),!0}catch{return!1}});function s(){if(e.value!==void 0)try{n.value=Vt(e.value)}catch{n.value=""}}hr(s),Xs(s);function l(){try{const a=kr(n.value),c=a!==e.value;e.value=a,n.value=Vt(e.value),c&&r("update:modelValue",e.value)}catch{s()}}return(a,c)=>(W(),xt(g(me),{value:n.value,"onUpdate:value":c[0]||(c[0]=h=>n.value=h),status:o.value?void 0:"error",placeholder:"0:00.000",onBlur:l},null,8,["value","status"]))}}),Lf={class:"context-menu-word-edit"},_f=Q({__name:"ContextMenuWordEdit",setup(i){const t=pr(),e=We(),r=Zr({word:"",emptyBeat:0,startTime:0,endTime:0});hr(()=>{var l,a;const s=(a=(l=e.lyrics[t.selectedLine])==null?void 0:l.words)==null?void 0:a[t.selectedWord];console.log("selectedWord",qi(Bt(s))),r.word=(s==null?void 0:s.word)??"",r.emptyBeat=(s==null?void 0:s.emptyBeat)??0,r.startTime=(s==null?void 0:s.startTime)??0,r.endTime=(s==null?void 0:s.endTime)??0}),Gs(()=>{var l,a;const s=(a=(l=e.lyrics[t.selectedLine])==null?void 0:l.words)==null?void 0:a[t.selectedWord];if(s){const c=r.startTime!==s.startTime||r.endTime!==s.endTime;s.startTime=r.startTime,s.endTime=r.endTime,c&&e.record()}});function n(){e.modifyWordEmptyBeat(t.selectedLine,t.selectedWord,r.emptyBeat)}function o(){e.modifyWord(t.selectedLine,t.selectedWord,r.word)}return(s,l)=>(W(),Z("div",Lf,[l[4]||(l[4]=x("div",null,"\u5185\u5BB9",-1)),w(g(me),{value:r.word,"onUpdate:value":l[0]||(l[0]=a=>r.word=a),placeholder:"",size:"small",onBlur:o},null,8,["value"]),l[5]||(l[5]=x("div",null,"\u7A7A\u62CD",-1)),w(g(zc),{value:r.emptyBeat,"onUpdate:value":l[1]||(l[1]=a=>r.emptyBeat=a),min:0,step:1,placeholder:"0",size:"small",style:{"max-width":"7em"},onBlur:n},null,8,["value"]),l[6]||(l[6]=x("div",null,"\u5355\u8BCD\u5F00\u59CB\u65F6\u95F4",-1)),w(rn,{value:r.startTime,"onUpdate:value":l[2]||(l[2]=a=>r.startTime=a)},null,8,["value"]),l[7]||(l[7]=x("div",null,"\u5355\u8BCD\u7ED3\u675F\u65F6\u95F4",-1)),w(rn,{value:r.endTime,"onUpdate:value":l[3]||(l[3]=a=>r.endTime=a)},null,8,["value"])]))}}),Nl=Fe(_f,[["__scopeId","data-v-b36c4c97"]]),Ef={class:"context-menu-line-edit"},Of=Q({__name:"ContextMenu",setup(i){const t=[{label:ie.global.t("contextMenu.deleteLine"),key:"delete-line"},{label:ie.global.t("contextMenu.insertBeforeLine"),key:"insert-before-line"},{label:ie.global.t("contextMenu.insertAfterLine"),key:"insert-after-line"},{label:ie.global.t("contextMenu.toggleBGLine"),key:"toggle-bg-line"},{label:ie.global.t("contextMenu.toggleDuetLine"),key:"toggle-duet-line"}],e=[{type:"render",render:()=>vb(Nl,{})},{label:ie.global.t("contextMenu.deleteWord"),key:"delete-word"},{label:ie.global.t("contextMenu.splitWord"),key:"split-word"},{type:"divider"},...t],r=pr(),n=so(),o=We(),s=Ve(),l=ji(),a=Zr({lineStartTime:0,lineEndTime:0});Xs(()=>{const h=o.lyrics[r.selectedLine];h&&(a.lineStartTime=h.startTime,a.lineEndTime=h.endTime)});function c(){n.error({title:ie.global.t("contextMenu.wipNotification.title"),content:ie.global.t("contextMenu.wipNotification.content"),duration:4e3}),r.show=!1}return hr(()=>{const h=o.lyrics[r.selectedLine];h&&(a.lineStartTime=h.startTime,a.lineEndTime=h.endTime)}),Gs(()=>{const h=o.lyrics[r.selectedLine];if(h){const u=h.startTime!==a.lineStartTime||h.endTime!==a.lineEndTime;h.startTime=a.lineStartTime,h.endTime=a.lineEndTime,u&&o.record()}}),(h,u)=>{const d=De("i18n-t");return W(),xt(g(DM),{arrow:!1,options:g(r).selectedWord===-1?t:e,show:g(r).show,x:g(r).x,y:g(r).y,class:"context-menu",placement:"bottom-start",style:{padding:"4px"},trigger:"manual",onClickoutside:u[10]||(u[10]=f=>g(r).show=!1)},{default:E(()=>{var f,m;return[g(l).uiLayoutMode===g(en).Simple?(W(),Z(Oe,{key:0},[g(r).selectedWord!==-1?(W(),xt(Nl,{key:0})):ur("",!0),g(r).selectedWord!==-1?(W(),xt(g(Qs),{key:1,style:{margin:"4px 0"}})):ur("",!0),x("div",Ef,[u[11]||(u[11]=x("div",null,"\u884C\u5F00\u59CB\u65F6\u95F4",-1)),w(rn,{value:a.lineStartTime,"onUpdate:value":[u[0]||(u[0]=v=>a.lineStartTime=v),h.onTimeUpdate]},null,8,["value","onUpdate:value"]),u[12]||(u[12]=x("div",null,"\u884C\u7ED3\u675F\u65F6\u95F4",-1)),w(rn,{value:a.lineEndTime,"onUpdate:value":[u[1]||(u[1]=v=>a.lineEndTime=v),h.onTimeUpdate]},null,8,["value","onUpdate:value"])]),w(g(Qs),{style:{margin:"4px 0"}})],64)):ur("",!0),w(g(Ui),{tag:"button",onClick:u[2]||(u[2]=()=>{g(o).removeWord(g(r).selectedLine,g(r).selectedWord),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.deleteWord"})]),_:1}),w(g(Ui),{tag:"button",onClick:u[3]||(u[3]=()=>{g(s).splitWord=!0,g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.splitWord"})]),_:1}),((m=(f=g(o).lyrics[g(r).selectedLine])==null?void 0:f.words)==null?void 0:m.length)>1?(W(),xt(g(Ui),{key:1,tag:"button",onClick:u[4]||(u[4]=()=>{g(s).concatWords=!0,g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.concatWords",onClick:c})]),_:1})):ur("",!0),w(g(Qs),{style:{margin:"4px 0"}}),w(g(Ui),{tag:"button",onClick:u[5]||(u[5]=()=>{g(o).removeLine(g(r).selectedLine),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.deleteLine"})]),_:1}),w(g(Ui),{tag:"button",onClick:u[6]||(u[6]=()=>{g(o).insertNewLineAt(g(r).selectedLine),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.insertBeforeLine"})]),_:1}),w(g(Ui),{tag:"button",onClick:u[7]||(u[7]=()=>{g(o).insertNewLineAt(g(r).selectedLine+1),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.insertAfterLine"})]),_:1}),w(g(Ui),{tag:"button",onClick:u[8]||(u[8]=()=>{const v=g(o).lyrics[g(r).selectedLine];v&&(v.isBG=!v.isBG),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.toggleBGLine"})]),_:1}),w(g(Ui),{tag:"button",onClick:u[9]||(u[9]=()=>{const v=g(o).lyrics[g(r).selectedLine];v&&(v.isDuet=!v.isDuet),g(r).show=!1})},{default:E(()=>[w(d,{keypath:"contextMenu.toggleDuetLine"})]),_:1})]}),_:1},8,["options","show","x","y"])}}}),Df=Fe(Of,[["__scopeId","data-v-52d2d7f8"]]),Pf={class:"word-preview"},Rf={class:"word-preview"},Bf=Q({__name:"ConcatWordModal",setup(i){const t=We(),e=pr(),r=Ve(),n=Gt([0,0]),o=Gt("accumulate-word-beat"),{t:s}=Jt({useScope:"global"}),l=[{label:s("concatWordModal.emptyBeatMergeMethod.accumulateWordBeat"),value:"accumulate-word-beat"},{label:s("concatWordModal.emptyBeatMergeMethod.accumulateBeat"),value:"accumulate-beat"},{label:s("concatWordModal.emptyBeatMergeMethod.accumulateWord"),value:"accumulate-word"},{label:s("concatWordModal.emptyBeatMergeMethod.clear"),value:"clear"}],a=Dt(()=>Math.min(...n.value)),c=Dt(()=>Math.max(...n.value)),h=Dt(()=>{var f,m;return((m=(f=t.lyrics[e.selectedLine])==null?void 0:f.words)==null?void 0:m.map(v=>v.word))??[]}),u=Dt(()=>{const f=[...h.value],m=f.slice(a.value,c.value+1).join("");return f.splice(a.value,c.value-a.value+1,m),f});function d(){const f=t.lyrics[e.selectedLine];if(f){const m=a.value,v=c.value,p=f.words.slice(m,v+1);if(p.length>1){const y=p[0].startTime,b=p[p.length-1].endTime,k={word:p.map(M=>M.word).join(""),startTime:y,endTime:b};switch(o.value){case"accumulate-word":k.emptyBeat=p.length-1;break;case"accumulate-beat":k.emptyBeat=p.reduce((M,L)=>M+(L.emptyBeat??0),0);break;case"accumulate-word-beat":k.emptyBeat=p.length-1+p.reduce((M,L)=>M+(L.emptyBeat??0),0);break}const S=(window.structuredClone||qi)(Bt(f.words));S.splice(m,v-m+1,k),f.words=S,t.record()}}r.concatWords=!1}return(f,m)=>{const v=De("i18n-t");return W(),xt(g(ri),{segmented:{footer:"soft"},show:g(r).concatWords,title:g(s)("concatWordModal.title"),preset:"card",style:{"max-width":"600px"},"transform-origin":"center",onClose:m[2]||(m[2]=p=>g(r).concatWords=!1)},{footer:E(()=>[w(g(rt),{type:"primary",onClick:d},{default:E(()=>[w(v,{keypath:"concatWordModal.concatBtn"})]),_:1})]),default:E(()=>[w(g(dr),{style:{"margin-bottom":"1em"},type:"info"},{default:E(()=>[w(v,{keypath:"concatWordModal.tip"})]),_:1}),w(g(zi),{style:{"margin-bottom":"1em"},vertical:""},{default:E(()=>[x("div",null,[w(v,{keypath:"concatWordModal.originPreview"})]),x("div",Pf,[(W(!0),Z(Oe,null,fr(h.value,(p,y)=>(W(),Z("span",{class:jc({"merge-word":y>=a.value&&y<=c.value})},Ie(p),3))),256))])]),_:1}),w(g(Zs),{label:g(s)("concatWordModal.mergeRange")},{default:E(()=>[w(g(tn),{value:n.value,"onUpdate:value":m[0]||(m[0]=p=>n.value=p),"format-tooltip":p=>`${p+1}`,max:h.value.length-1,min:0,step:1,range:""},null,8,["value","format-tooltip","max"])]),_:1},8,["label"]),w(g(Zs),{label:g(s)("concatWordModal.emptyBeatMergeMethod.label")},{default:E(()=>[w(g(lo),{value:o.value,"onUpdate:value":m[1]||(m[1]=p=>o.value=p),options:l},null,8,["value"])]),_:1},8,["label"]),w(g(zi),{vertical:""},{default:E(()=>[x("div",null,[w(v,{keypath:"concatWordModal.concatResultPreview"})]),x("div",Rf,[(W(!0),Z(Oe,null,fr(u.value,(p,y)=>(W(),Z("span",{class:jc({"merge-word":y===a.value})},Ie(p),3))),256))])]),_:1})]),_:1},8,["show","title"])}}}),Nf=Fe(Bf,[["__scopeId","data-v-dfbd8069"]]),If=Q({__name:"ImportFromDBDialog",setup(i){const t=Gt(0),e=We(),r=Gt(!1),n=so(),o=Ve(),{t:s}=Jt({useScope:"global"});async function l(){r.value=!0;const a=t.value;try{const c=await fetch(`https://raw.githubusercontent.com/Steve-xmh/amll-ttml-db/main/lyrics/${a}.ttml`);if(c.status===200){const h=await c.text();e.loadLyric(Pl(h)),n.success({title:"\u6B4C\u8BCD\u5BFC\u5165\u6210\u529F\uFF01",duration:3e3}),o.importFromDB=!1}else n.error({title:`\u5BFC\u5165 ID \u4E3A ${a} \u7684\u6B4C\u8BCD\u5931\u8D25`,content:"\u8BF7\u6C42\u8FD4\u56DE\u7684\u54CD\u5E94\u72B6\u6001\u7801\u4E0D\u6210\u529F\uFF0C\u6B4C\u8BCD\u6587\u4EF6\u53EF\u80FD\u4E0D\u5B58\u5728",duration:3e3})}catch(c){n.error({title:`\u5BFC\u5165 ID \u4E3A ${a} \u7684\u6B4C\u8BCD\u5931\u8D25`,content:`${c}`,duration:5e3})}r.value=!1}return(a,c)=>{const h=De("i18n-t");return W(),xt(g(ri),{show:g(o).importFromDB,title:g(s)("importFromAMLLDB.title"),preset:"card",style:{"max-width":"400px"},"transform-origin":"center",onClose:c[1]||(c[1]=u=>g(o).importFromDB=!1)},{action:E(()=>[w(g(rt),{loading:r.value,onClick:l},{default:E(()=>[w(h,{keypath:"importFromAMLLDB.importBtn"})]),_:1},8,["loading"])]),default:E(()=>[w(g(zi),{vertical:""},{default:E(()=>[w(g(dr),{type:"warning"},{default:E(()=>[w(h,{keypath:"importFromAMLLDB.description"})]),_:1}),w(g(zc),{value:t.value,"onUpdate:value":c[0]||(c[0]=u=>t.value=u),disabled:r.value,placeholder:g(s)("importFromAMLLDB.musicID.placeholder"),"show-button":!1},null,8,["value","disabled","placeholder"])]),_:1})]),_:1},8,["show","title"])}}});class ht{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,r){[t,e]=Ar(this,t,e);let n=[];return this.decompose(0,t,n,2),r.length&&r.decompose(0,r.length,n,3),this.decompose(e,this.length,n,1),ze.from(n,this.length-(e-t)+r.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=Ar(this,t,e);let r=[];return this.decompose(t,e,r,0),ze.from(r,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),r=this.length-this.scanIdentical(t,-1),n=new gn(this),o=new gn(t);for(let s=e,l=e;;){if(n.next(s),o.next(s),s=0,n.lineBreak!=o.lineBreak||n.done!=o.done||n.value!=o.value)return!1;if(l+=n.value.length,n.done||l>=r)return!0}}iter(t=1){return new gn(this,t)}iterRange(t,e=this.length){return new Ff(this,t,e)}iterLines(t,e){let r;if(t==null)r=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;r=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Vf(r)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?ht.empty:t.length<=32?new Lt(t):ze.from(Lt.split(t,[]))}}class Lt extends ht{constructor(t,e=wb(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,r,n){for(let o=0;;o++){let s=this.text[o],l=n+s.length;if((e?r:l)>=t)return new bb(n,l,r,s);n=l+1,r++}}decompose(t,e,r,n){let o=t<=0&&e>=this.length?this:new Lt(Wf(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let s=r.pop(),l=Eo(o.text,s.text.slice(),0,o.length);if(l.length<=32)r.push(new Lt(l,s.length+o.length));else{let a=l.length>>1;r.push(new Lt(l.slice(0,a)),new Lt(l.slice(a)))}}else r.push(o)}replace(t,e,r){if(!(r instanceof Lt))return super.replace(t,e,r);[t,e]=Ar(this,t,e);let n=Eo(this.text,Eo(r.text,Wf(this.text,0,t)),e),o=this.length+r.length-(e-t);return n.length<=32?new Lt(n,o):ze.from(Lt.split(n,[]),o)}sliceString(t,e=this.length,r=`
`){[t,e]=Ar(this,t,e);let n="";for(let o=0,s=0;o<=e&&s<this.text.length;s++){let l=this.text[s],a=o+l.length;o>t&&s&&(n+=r),t<a&&e>o&&(n+=l.slice(Math.max(0,t-o),e-o)),o=a+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let r=[],n=-1;for(let o of t)r.push(o),n+=o.length+1,r.length==32&&(e.push(new Lt(r,n)),r=[],n=-1);return n>-1&&e.push(new Lt(r,n)),e}}class ze extends ht{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let r of t)this.lines+=r.lines}lineInner(t,e,r,n){for(let o=0;;o++){let s=this.children[o],l=n+s.length,a=r+s.lines-1;if((e?a:l)>=t)return s.lineInner(t,e,r,n);n=l+1,r=a+1}}decompose(t,e,r,n){for(let o=0,s=0;s<=e&&o<this.children.length;o++){let l=this.children[o],a=s+l.length;if(t<=a&&e>=s){let c=n&((s<=t?1:0)|(a>=e?2:0));s>=t&&a<=e&&!c?r.push(l):l.decompose(t-s,e-s,r,c)}s=a+1}}replace(t,e,r){if([t,e]=Ar(this,t,e),r.lines<this.lines)for(let n=0,o=0;n<this.children.length;n++){let s=this.children[n],l=o+s.length;if(t>=o&&e<=l){let a=s.replace(t-o,e-o,r),c=this.lines-s.lines+a.lines;if(a.lines<c>>4&&a.lines>c>>6){let h=this.children.slice();return h[n]=a,new ze(h,this.length-(e-t)+r.length)}return super.replace(o,l,a)}o=l+1}return super.replace(t,e,r)}sliceString(t,e=this.length,r=`
`){[t,e]=Ar(this,t,e);let n="";for(let o=0,s=0;o<this.children.length&&s<=e;o++){let l=this.children[o],a=s+l.length;s>t&&o&&(n+=r),t<a&&e>s&&(n+=l.sliceString(t-s,e-s,r)),s=a+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof ze))return 0;let r=0,[n,o,s,l]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,o+=e){if(n==s||o==l)return r;let a=this.children[n],c=t.children[o];if(a!=c)return r+a.scanIdentical(c,e);r+=a.length+1}}static from(t,e=t.reduce((r,n)=>r+n.length+1,-1)){let r=0;for(let f of t)r+=f.lines;if(r<32){let f=[];for(let m of t)m.flatten(f);return new Lt(f,e)}let n=Math.max(32,r>>5),o=n<<1,s=n>>1,l=[],a=0,c=-1,h=[];function u(f){let m;if(f.lines>o&&f instanceof ze)for(let v of f.children)u(v);else f.lines>s&&(a>s||!a)?(d(),l.push(f)):f instanceof Lt&&a&&(m=h[h.length-1])instanceof Lt&&f.lines+m.lines<=32?(a+=f.lines,c+=f.length+1,h[h.length-1]=new Lt(m.text.concat(f.text),m.length+1+f.length)):(a+f.lines>n&&d(),a+=f.lines,c+=f.length+1,h.push(f))}function d(){a!=0&&(l.push(h.length==1?h[0]:ze.from(h,c)),c=-1,a=h.length=0)}for(let f of t)u(f);return d(),l.length==1?l[0]:new ze(l,e)}}ht.empty=new Lt([""],0);function wb(i){let t=-1;for(let e of i)t+=e.length+1;return t}function Eo(i,t,e=0,r=1e9){for(let n=0,o=0,s=!0;o<i.length&&n<=r;o++){let l=i[o],a=n+l.length;a>=e&&(a>r&&(l=l.slice(0,r-n)),n<e&&(l=l.slice(e-n)),s?(t[t.length-1]+=l,s=!1):t.push(l)),n=a+1}return t}function Wf(i,t,e){return Eo(i,[""],t,e)}class gn{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Lt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,n=this.nodes[r],o=this.offsets[r],s=o>>1,l=n instanceof Lt?n.text.length:n.children.length;if(s==(e>0?l:0)){if(r==0)return this.done=!0,this.value="",this;e>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((o&1)==(e>0?0:1)){if(this.offsets[r]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof Lt){let a=n.text[s+(e<0?-1:0)];if(this.offsets[r]+=e,a.length>Math.max(0,t))return this.value=t==0?a:e>0?a.slice(t):a.slice(0,a.length-t),this;t-=a.length}else{let a=n.children[s+(e<0?-1:0)];t>a.length?(t-=a.length,this.offsets[r]+=e):(e<0&&this.offsets[r]--,this.nodes.push(a),this.offsets.push(e>0?1:(a instanceof Lt?a.text.length:a.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Ff{constructor(t,e,r){this.value="",this.done=!1,this.cursor=new gn(t,e>r?-1:1),this.pos=e>r?t.length:0,this.from=Math.min(e,r),this.to=Math.max(e,r)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let r=e<0?this.pos-this.from:this.to-this.pos;t>r&&(t=r),r-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=r?n:e<0?n.slice(n.length-r):n.slice(0,r),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Vf{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:r,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(ht.prototype[Symbol.iterator]=function(){return this.iter()},gn.prototype[Symbol.iterator]=Ff.prototype[Symbol.iterator]=Vf.prototype[Symbol.iterator]=function(){return this});class bb{constructor(t,e,r,n){this.from=t,this.to=e,this.number=r,this.text=n}get length(){return this.to-this.from}}function Ar(i,t,e){return t=Math.max(0,Math.min(i.length,t)),[t,Math.max(t,Math.min(i.length,e))]}let Mr="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(i=>i?parseInt(i,36):1);for(let i=1;i<Mr.length;i++)Mr[i]+=Mr[i-1];function xb(i){for(let t=1;t<Mr.length;t+=2)if(Mr[t]>i)return Mr[t-1]<=i;return!1}function Hf(i){return i>=127462&&i<=127487}const Uf=8205;function Ht(i,t,e=!0,r=!0){return(e?zf:kb)(i,t,r)}function zf(i,t,e){if(t==i.length)return t;t&&jf(i.charCodeAt(t))&&$f(i.charCodeAt(t-1))&&t--;let r=Ut(i,t);for(t+=Se(r);t<i.length;){let n=Ut(i,t);if(r==Uf||n==Uf||e&&xb(n))t+=Se(n),r=n;else if(Hf(n)){let o=0,s=t-2;for(;s>=0&&Hf(Ut(i,s));)o++,s-=2;if(o%2==0)break;t+=2}else break}return t}function kb(i,t,e){for(;t>0;){let r=zf(i,t-2,e);if(r<t)return r;t--}return 0}function jf(i){return i>=56320&&i<57344}function $f(i){return i>=55296&&i<56320}function Ut(i,t){let e=i.charCodeAt(t);if(!$f(e)||t+1==i.length)return e;let r=i.charCodeAt(t+1);return jf(r)?(e-55296<<10)+(r-56320)+65536:e}function Il(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function Se(i){return i<65536?1:2}const Wl=/\r\n?|\n/;var ne=function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i}(ne||(ne={}));class je{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let r=this.sections[e+1];t+=r<0?this.sections[e]:r}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,r=0,n=0;e<this.sections.length;){let o=this.sections[e++],s=this.sections[e++];s<0?(t(r,n,o),n+=o):n+=s,r+=o}}iterChangedRanges(t,e=!1){Fl(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let r=this.sections[e++],n=this.sections[e++];n<0?t.push(r,n):t.push(n,r)}return new je(t)}composeDesc(t){return this.empty?t:t.empty?this:qf(this,t)}mapDesc(t,e=!1){return t.empty?this:Vl(this,t,e)}mapPos(t,e=-1,r=ne.Simple){let n=0,o=0;for(let s=0;s<this.sections.length;){let l=this.sections[s++],a=this.sections[s++],c=n+l;if(a<0){if(c>t)return o+(t-n);o+=l}else{if(r!=ne.Simple&&c>=t&&(r==ne.TrackDel&&n<t&&c>t||r==ne.TrackBefore&&n<t||r==ne.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!l)return t==n||e<0?o:o+a;o+=a}n=c}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return o}touchesRange(t,e=t){for(let r=0,n=0;r<this.sections.length&&n<=e;){let o=this.sections[r++],s=this.sections[r++],l=n+o;if(s>=0&&n<=e&&l>=t)return n<t&&l>e?"cover":!0;n=l}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let r=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+r+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new je(t)}static create(t){return new je(t)}}class Wt extends je{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Fl(this,(e,r,n,o,s)=>t=t.replace(n,n+(r-e),s),!1),t}mapDesc(t,e=!1){return Vl(this,t,e,!0)}invert(t){let e=this.sections.slice(),r=[];for(let n=0,o=0;n<e.length;n+=2){let s=e[n],l=e[n+1];if(l>=0){e[n]=l,e[n+1]=s;let a=n>>1;for(;r.length<a;)r.push(ht.empty);r.push(s?t.slice(o,o+s):ht.empty)}o+=s}return new Wt(e,r)}compose(t){return this.empty?t:t.empty?this:qf(this,t,!0)}map(t,e=!1){return t.empty?this:Vl(this,t,e,!0)}iterChanges(t,e=!1){Fl(this,t,e)}get desc(){return je.create(this.sections)}filter(t){let e=[],r=[],n=[],o=new yn(this);t:for(let s=0,l=0;;){let a=s==t.length?1e9:t[s++];for(;l<a||l==a&&o.len==0;){if(o.done)break t;let h=Math.min(o.len,a-l);Xt(n,h,-1);let u=o.ins==-1?-1:o.off==0?o.ins:0;Xt(e,h,u),u>0&&Ti(r,e,o.text),o.forward(h),l+=h}let c=t[s++];for(;l<c;){if(o.done)break t;let h=Math.min(o.len,c-l);Xt(e,h,-1),Xt(n,h,o.ins==-1?-1:o.off==0?o.ins:0),o.forward(h),l+=h}}return{changes:new Wt(e,r),filtered:je.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let r=this.sections[e],n=this.sections[e+1];n<0?t.push(r):n==0?t.push([r]):t.push([r].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,r){let n=[],o=[],s=0,l=null;function a(h=!1){if(!h&&!n.length)return;s<e&&Xt(n,e-s,-1);let u=new Wt(n,o);l=l?l.compose(u.map(l)):u,n=[],o=[],s=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof Wt){if(h.length!=e)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${e})`);a(),l=l?l.compose(h.map(l)):h}else{let{from:u,to:d=u,insert:f}=h;if(u>d||u<0||d>e)throw new RangeError(`Invalid change range ${u} to ${d} (in doc of length ${e})`);let m=f?typeof f=="string"?ht.of(f.split(r||Wl)):f:ht.empty,v=m.length;if(u==d&&v==0)return;u<s&&a(),u>s&&Xt(n,u-s,-1),Xt(n,d-u,v),Ti(o,n,m),s=d}}return c(t),a(!l),l}static empty(t){return new Wt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],r=[];for(let n=0;n<t.length;n++){let o=t[n];if(typeof o=="number")e.push(o,-1);else{if(!Array.isArray(o)||typeof o[0]!="number"||o.some((s,l)=>l&&typeof s!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(o.length==1)e.push(o[0],0);else{for(;r.length<n;)r.push(ht.empty);r[n]=ht.of(o.slice(1)),e.push(o[0],r[n].length)}}}return new Wt(e,r)}static createSet(t,e){return new Wt(t,e)}}function Xt(i,t,e,r=!1){if(t==0&&e<=0)return;let n=i.length-2;n>=0&&e<=0&&e==i[n+1]?i[n]+=t:t==0&&i[n]==0?i[n+1]+=e:r?(i[n]+=t,i[n+1]+=e):i.push(t,e)}function Ti(i,t,e){if(e.length==0)return;let r=t.length-2>>1;if(r<i.length)i[i.length-1]=i[i.length-1].append(e);else{for(;i.length<r;)i.push(ht.empty);i.push(e)}}function Fl(i,t,e){let r=i.inserted;for(let n=0,o=0,s=0;s<i.sections.length;){let l=i.sections[s++],a=i.sections[s++];if(a<0)n+=l,o+=l;else{let c=n,h=o,u=ht.empty;for(;c+=l,h+=a,a&&r&&(u=u.append(r[s-2>>1])),!(e||s==i.sections.length||i.sections[s+1]<0);)l=i.sections[s++],a=i.sections[s++];t(n,c,o,h,u),n=c,o=h}}}function Vl(i,t,e,r=!1){let n=[],o=r?[]:null,s=new yn(i),l=new yn(t);for(let a=-1;;)if(s.ins==-1&&l.ins==-1){let c=Math.min(s.len,l.len);Xt(n,c,-1),s.forward(c),l.forward(c)}else if(l.ins>=0&&(s.ins<0||a==s.i||s.off==0&&(l.len<s.len||l.len==s.len&&!e))){let c=l.len;for(Xt(n,l.ins,-1);c;){let h=Math.min(s.len,c);s.ins>=0&&a<s.i&&s.len<=h&&(Xt(n,0,s.ins),o&&Ti(o,n,s.text),a=s.i),s.forward(h),c-=h}l.next()}else if(s.ins>=0){let c=0,h=s.len;for(;h;)if(l.ins==-1){let u=Math.min(h,l.len);c+=u,h-=u,l.forward(u)}else if(l.ins==0&&l.len<h)h-=l.len,l.next();else break;Xt(n,c,a<s.i?s.ins:0),o&&a<s.i&&Ti(o,n,s.text),a=s.i,s.forward(s.len-h)}else{if(s.done&&l.done)return o?Wt.createSet(n,o):je.create(n);throw new Error("Mismatched change set lengths")}}function qf(i,t,e=!1){let r=[],n=e?[]:null,o=new yn(i),s=new yn(t);for(let l=!1;;){if(o.done&&s.done)return n?Wt.createSet(r,n):je.create(r);if(o.ins==0)Xt(r,o.len,0,l),o.next();else if(s.len==0&&!s.done)Xt(r,0,s.ins,l),n&&Ti(n,r,s.text),s.next();else{if(o.done||s.done)throw new Error("Mismatched change set lengths");{let a=Math.min(o.len2,s.len),c=r.length;if(o.ins==-1){let h=s.ins==-1?-1:s.off?0:s.ins;Xt(r,a,h,l),n&&h&&Ti(n,r,s.text)}else s.ins==-1?(Xt(r,o.off?0:o.len,a,l),n&&Ti(n,r,o.textBit(a))):(Xt(r,o.off?0:o.len,s.off?0:s.ins,l),n&&!s.off&&Ti(n,r,s.text));l=(o.ins>a||s.ins>=0&&s.len>a)&&(l||r.length>c),o.forward2(a),s.forward(a)}}}}class yn{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?ht.empty:t[e]}textBit(t){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length&&!t?ht.empty:e[r].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Yi{constructor(t,e,r){this.from=t,this.to=e,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let r,n;return this.empty?r=n=t.mapPos(this.from,e):(r=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),r==this.from&&n==this.to?this:new Yi(r,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return O.range(t,e);let r=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return O.range(this.anchor,r)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return O.range(t.anchor,t.head)}static create(t,e,r){return new Yi(t,e,r)}}class O{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:O.create(this.ranges.map(r=>r.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(t.ranges[r],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new O([this.main],0)}addRange(t,e=!0){return O.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let r=this.ranges.slice();return r[e]=t,O.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new O(t.ranges.map(e=>Yi.fromJSON(e)),t.main)}static single(t,e=t){return new O([O.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,n=0;n<t.length;n++){let o=t[n];if(o.empty?o.from<=r:o.from<r)return O.normalized(t.slice(),e);r=o.to}return new O(t,e)}static cursor(t,e=0,r,n){return Yi.create(t,t,(e==0?0:e<0?8:16)|(r==null?7:Math.min(6,r))|(n??16777215)<<6)}static range(t,e,r,n){let o=(r??16777215)<<6|(n==null?7:Math.min(6,n));return e<t?Yi.create(e,t,48|o):Yi.create(t,e,(e>t?8:0)|o)}static normalized(t,e=0){let r=t[e];t.sort((n,o)=>n.from-o.from),e=t.indexOf(r);for(let n=1;n<t.length;n++){let o=t[n],s=t[n-1];if(o.empty?o.from<=s.to:o.from<s.to){let l=s.from,a=Math.max(o.to,s.to);n<=e&&e--,t.splice(--n,2,o.anchor>o.head?O.range(a,l):O.range(l,a))}}return new O(t,e)}}function Kf(i,t){for(let e of i.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let Hl=0;class U{constructor(t,e,r,n,o){this.combine=t,this.compareInput=e,this.compare=r,this.isStatic=n,this.id=Hl++,this.default=t([]),this.extensions=typeof o=="function"?o(this):o}get reader(){return this}static define(t={}){return new U(t.combine||(e=>e),t.compareInput||((e,r)=>e===r),t.compare||(t.combine?(e,r)=>e===r:Ul),!!t.static,t.enables)}of(t){return new Oo([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Oo(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Oo(t,this,2,e)}from(t,e){return e||(e=r=>r),this.compute([t],r=>e(r.field(t)))}}function Ul(i,t){return i==t||i.length==t.length&&i.every((e,r)=>e===t[r])}class Oo{constructor(t,e,r,n){this.dependencies=t,this.facet=e,this.type=r,this.value=n,this.id=Hl++}dynamicSlot(t){var e;let r=this.value,n=this.facet.compareInput,o=this.id,s=t[o]>>1,l=this.type==2,a=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?a=!0:u=="selection"?c=!0:((e=t[u.id])!==null&&e!==void 0?e:1)&1||h.push(t[u.id]);return{create(u){return u.values[s]=r(u),1},update(u,d){if(a&&d.docChanged||c&&(d.docChanged||d.selection)||zl(u,h)){let f=r(u);if(l?!Yf(f,u.values[s],n):!n(f,u.values[s]))return u.values[s]=f,1}return 0},reconfigure:(u,d)=>{let f,m=d.config.address[o];if(m!=null){let v=Po(d,m);if(this.dependencies.every(p=>p instanceof U?d.facet(p)===u.facet(p):p instanceof zt?d.field(p,!1)==u.field(p,!1):!0)||(l?Yf(f=r(u),v,n):n(f=r(u),v)))return u.values[s]=v,0}else f=r(u);return u.values[s]=f,1}}}}function Yf(i,t,e){if(i.length!=t.length)return!1;for(let r=0;r<i.length;r++)if(!e(i[r],t[r]))return!1;return!0}function zl(i,t){let e=!1;for(let r of t)bn(i,r)&1&&(e=!0);return e}function Sb(i,t,e){let r=e.map(a=>i[a.id]),n=e.map(a=>a.type),o=r.filter(a=>!(a&1)),s=i[t.id]>>1;function l(a){let c=[];for(let h=0;h<r.length;h++){let u=Po(a,r[h]);if(n[h]==2)for(let d of u)c.push(d);else c.push(u)}return t.combine(c)}return{create(a){for(let c of r)bn(a,c);return a.values[s]=l(a),1},update(a,c){if(!zl(a,o))return 0;let h=l(a);return t.compare(h,a.values[s])?0:(a.values[s]=h,1)},reconfigure(a,c){let h=zl(a,r),u=c.config.facets[t.id],d=c.facet(t);if(u&&!h&&Ul(e,u))return a.values[s]=d,0;let f=l(a);return t.compare(f,d)?(a.values[s]=d,0):(a.values[s]=f,1)}}}const Gf=U.define({static:!0});class zt{constructor(t,e,r,n,o){this.id=t,this.createF=e,this.updateF=r,this.compareF=n,this.spec=o,this.provides=void 0}static define(t){let e=new zt(Hl++,t.create,t.update,t.compare||((r,n)=>r===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Gf).find(r=>r.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:r=>(r.values[e]=this.create(r),1),update:(r,n)=>{let o=r.values[e],s=this.updateF(o,n);return this.compareF(o,s)?0:(r.values[e]=s,1)},reconfigure:(r,n)=>n.config.address[this.id]!=null?(r.values[e]=n.field(this),0):(r.values[e]=this.create(r),1)}}init(t){return[this,Gf.of({field:this,create:t})]}get extension(){return this}}const Gi={lowest:4,low:3,default:2,high:1,highest:0};function vn(i){return t=>new Jf(t,i)}const Ji={highest:vn(Gi.highest),high:vn(Gi.high),default:vn(Gi.default),low:vn(Gi.low),lowest:vn(Gi.lowest)};class Jf{constructor(t,e){this.inner=t,this.prec=e}}class wn{of(t){return new jl(this,t)}reconfigure(t){return wn.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class jl{constructor(t,e){this.compartment=t,this.inner=e}}class Do{constructor(t,e,r,n,o,s){for(this.base=t,this.compartments=e,this.dynamicSlots=r,this.address=n,this.staticValues=o,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,r){let n=[],o=Object.create(null),s=new Map;for(let d of Tb(t,e,s))d instanceof zt?n.push(d):(o[d.facet.id]||(o[d.facet.id]=[])).push(d);let l=Object.create(null),a=[],c=[];for(let d of n)l[d.id]=c.length<<1,c.push(f=>d.slot(f));let h=r==null?void 0:r.config.facets;for(let d in o){let f=o[d],m=f[0].facet,v=h&&h[d]||[];if(f.every(p=>p.type==0))if(l[m.id]=a.length<<1|1,Ul(v,f))a.push(r.facet(m));else{let p=m.combine(f.map(y=>y.value));a.push(r&&m.compare(p,r.facet(m))?r.facet(m):p)}else{for(let p of f)p.type==0?(l[p.id]=a.length<<1|1,a.push(p.value)):(l[p.id]=c.length<<1,c.push(y=>p.dynamicSlot(y)));l[m.id]=c.length<<1,c.push(p=>Sb(p,m,f))}}let u=c.map(d=>d(l));return new Do(t,s,u,l,a,o)}}function Tb(i,t,e){let r=[[],[],[],[],[]],n=new Map;function o(s,l){let a=n.get(s);if(a!=null){if(a<=l)return;let c=r[a].indexOf(s);c>-1&&r[a].splice(c,1),s instanceof jl&&e.delete(s.compartment)}if(n.set(s,l),Array.isArray(s))for(let c of s)o(c,l);else if(s instanceof jl){if(e.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(s.compartment)||s.inner;e.set(s.compartment,c),o(c,l)}else if(s instanceof Jf)o(s.inner,s.prec);else if(s instanceof zt)r[l].push(s),s.provides&&o(s.provides,l);else if(s instanceof Oo)r[l].push(s),s.facet.extensions&&o(s.facet.extensions,Gi.default);else{let c=s.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);o(c,l)}}return o(i,Gi.default),r.reduce((s,l)=>s.concat(l))}function bn(i,t){if(t&1)return 2;let e=t>>1,r=i.status[e];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;i.status[e]=4;let n=i.computeSlot(i,i.config.dynamicSlots[e]);return i.status[e]=2|n}function Po(i,t){return t&1?i.config.staticValues[t>>1]:i.values[t>>1]}const Xf=U.define(),$l=U.define({combine:i=>i.some(t=>t),static:!0}),Qf=U.define({combine:i=>i.length?i[0]:void 0,static:!0}),Zf=U.define(),tp=U.define(),ep=U.define(),ip=U.define({combine:i=>i.length?i[0]:!1});class ui{constructor(t,e){this.type=t,this.value=e}static define(){return new Ab}}class Ab{of(t){return new ui(this,t)}}class Mb{constructor(t){this.map=t}of(t){return new tt(this,t)}}class tt{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new tt(this.type,e)}is(t){return this.type==t}static define(t={}){return new Mb(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let r=[];for(let n of t){let o=n.map(e);o&&r.push(o)}return r}}tt.reconfigure=tt.define(),tt.appendConfig=tt.define();class Ft{constructor(t,e,r,n,o,s){this.startState=t,this.changes=e,this.selection=r,this.effects=n,this.annotations=o,this.scrollIntoView=s,this._doc=null,this._state=null,r&&Kf(r,e.newLength),o.some(l=>l.type==Ft.time)||(this.annotations=o.concat(Ft.time.of(Date.now())))}static create(t,e,r,n,o,s){return new Ft(t,e,r,n,o,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Ft.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Ft.time=ui.define(),Ft.userEvent=ui.define(),Ft.addToHistory=ui.define(),Ft.remote=ui.define();function Cb(i,t){let e=[];for(let r=0,n=0;;){let o,s;if(r<i.length&&(n==t.length||t[n]>=i[r]))o=i[r++],s=i[r++];else if(n<t.length)o=t[n++],s=t[n++];else return e;!e.length||e[e.length-1]<o?e.push(o,s):e[e.length-1]<s&&(e[e.length-1]=s)}}function rp(i,t,e){var r;let n,o,s;return e?(n=t.changes,o=Wt.empty(t.changes.length),s=i.changes.compose(t.changes)):(n=t.changes.map(i.changes),o=i.changes.mapDesc(t.changes,!0),s=i.changes.compose(n)),{changes:s,selection:t.selection?t.selection.map(o):(r=i.selection)===null||r===void 0?void 0:r.map(n),effects:tt.mapEffects(i.effects,n).concat(tt.mapEffects(t.effects,o)),annotations:i.annotations.length?i.annotations.concat(t.annotations):t.annotations,scrollIntoView:i.scrollIntoView||t.scrollIntoView}}function ql(i,t,e){let r=t.selection,n=Cr(t.annotations);return t.userEvent&&(n=n.concat(Ft.userEvent.of(t.userEvent))),{changes:t.changes instanceof Wt?t.changes:Wt.of(t.changes||[],e,i.facet(Qf)),selection:r&&(r instanceof O?r:O.single(r.anchor,r.head)),effects:Cr(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function np(i,t,e){let r=ql(i,t.length?t[0]:{},i.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let o=1;o<t.length;o++){t[o].filter===!1&&(e=!1);let s=!!t[o].sequential;r=rp(r,ql(i,t[o],s?r.changes.newLength:i.doc.length),s)}let n=Ft.create(i,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return _b(e?Lb(n):n)}function Lb(i){let t=i.startState,e=!0;for(let n of t.facet(Zf)){let o=n(i);if(o===!1){e=!1;break}Array.isArray(o)&&(e=e===!0?o:Cb(e,o))}if(e!==!0){let n,o;if(e===!1)o=i.changes.invertedDesc,n=Wt.empty(t.doc.length);else{let s=i.changes.filter(e);n=s.changes,o=s.filtered.mapDesc(s.changes).invertedDesc}i=Ft.create(t,n,i.selection&&i.selection.map(o),tt.mapEffects(i.effects,o),i.annotations,i.scrollIntoView)}let r=t.facet(tp);for(let n=r.length-1;n>=0;n--){let o=r[n](i);o instanceof Ft?i=o:Array.isArray(o)&&o.length==1&&o[0]instanceof Ft?i=o[0]:i=np(t,Cr(o),!1)}return i}function _b(i){let t=i.startState,e=t.facet(ep),r=i;for(let n=e.length-1;n>=0;n--){let o=e[n](i);o&&Object.keys(o).length&&(r=rp(r,ql(t,o,i.changes.newLength),!0))}return r==i?i:Ft.create(t,i.changes,i.selection,r.effects,r.annotations,r.scrollIntoView)}const Eb=[];function Cr(i){return i==null?Eb:Array.isArray(i)?i:[i]}var kt=function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i}(kt||(kt={}));const Ob=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Kl;try{Kl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Db(i){if(Kl)return Kl.test(i);for(let t=0;t<i.length;t++){let e=i[t];if(/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Ob.test(e)))return!0}return!1}function Pb(i){return t=>{if(!/\S/.test(t))return kt.Space;if(Db(t))return kt.Word;for(let e=0;e<i.length;e++)if(t.indexOf(i[e])>-1)return kt.Word;return kt.Other}}class ot{constructor(t,e,r,n,o,s){this.config=t,this.doc=e,this.selection=r,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=o,s&&(s._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)bn(this,l<<1);this.computeSlot=null}field(t,e=!0){let r=this.config.address[t.id];if(r==null){if(e)throw new RangeError("Field is not present in this state");return}return bn(this,r),Po(this,r)}update(...t){return np(this,t,!0)}applyTransaction(t){let e=this.config,{base:r,compartments:n}=e;for(let l of t.effects)l.is(wn.reconfigure)?(e&&(n=new Map,e.compartments.forEach((a,c)=>n.set(c,a)),e=null),n.set(l.value.compartment,l.value.extension)):l.is(tt.reconfigure)?(e=null,r=l.value):l.is(tt.appendConfig)&&(e=null,r=Cr(r).concat(l.value));let o;e?o=t.startState.values.slice():(e=Do.resolve(r,n,this),o=new ot(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(l,a)=>a.reconfigure(l,this),null).values);let s=t.startState.facet($l)?t.newSelection:t.newSelection.asSingle();new ot(e,t.newDoc,s,o,(l,a)=>a.update(l,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:O.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,r=t(e.ranges[0]),n=this.changes(r.changes),o=[r.range],s=Cr(r.effects);for(let l=1;l<e.ranges.length;l++){let a=t(e.ranges[l]),c=this.changes(a.changes),h=c.map(n);for(let d=0;d<l;d++)o[d]=o[d].map(h);let u=n.mapDesc(c,!0);o.push(a.range.map(u)),n=n.compose(h),s=tt.mapEffects(s,h).concat(tt.mapEffects(Cr(a.effects),u))}return{changes:n,selection:O.create(o,e.mainIndex),effects:s}}changes(t=[]){return t instanceof Wt?t:Wt.of(t,this.doc.length,this.facet(ot.lineSeparator))}toText(t){return ht.of(t.split(this.facet(ot.lineSeparator)||Wl))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(bn(this,e),Po(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let r in t){let n=t[r];n instanceof zt&&this.config.address[n.id]!=null&&(e[r]=n.spec.toJSON(this.field(t[r]),this))}return e}static fromJSON(t,e={},r){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(r){for(let o in r)if(Object.prototype.hasOwnProperty.call(t,o)){let s=r[o],l=t[o];n.push(s.init(a=>s.spec.fromJSON(l,a)))}}return ot.create({doc:t.doc,selection:O.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Do.resolve(t.extensions||[],new Map),r=t.doc instanceof ht?t.doc:ht.of((t.doc||"").split(e.staticFacet(ot.lineSeparator)||Wl)),n=t.selection?t.selection instanceof O?t.selection:O.single(t.selection.anchor,t.selection.head):O.single(0);return Kf(n,r.length),e.staticFacet($l)||(n=n.asSingle()),new ot(e,r,n,e.dynamicSlots.map(()=>null),(o,s)=>s.create(o),null)}get tabSize(){return this.facet(ot.tabSize)}get lineBreak(){return this.facet(ot.lineSeparator)||`
`}get readOnly(){return this.facet(ip)}phrase(t,...e){for(let r of this.facet(ot.phrases))if(Object.prototype.hasOwnProperty.call(r,t)){t=r[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(r,n)=>{if(n=="$")return"$";let o=+(n||1);return!o||o>e.length?r:e[o-1]})),t}languageDataAt(t,e,r=-1){let n=[];for(let o of this.facet(Xf))for(let s of o(this,e,r))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return Pb(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:r,length:n}=this.doc.lineAt(t),o=this.charCategorizer(t),s=t-r,l=t-r;for(;s>0;){let a=Ht(e,s,!1);if(o(e.slice(a,s))!=kt.Word)break;s=a}for(;l<n;){let a=Ht(e,l);if(o(e.slice(l,a))!=kt.Word)break;l=a}return s==l?null:O.range(s+r,l+r)}}ot.allowMultipleSelections=$l,ot.tabSize=U.define({combine:i=>i.length?i[0]:4}),ot.lineSeparator=Qf,ot.readOnly=ip,ot.phrases=U.define({compare(i,t){let e=Object.keys(i),r=Object.keys(t);return e.length==r.length&&e.every(n=>i[n]==t[n])}}),ot.languageData=Xf,ot.changeFilter=Zf,ot.transactionFilter=tp,ot.transactionExtender=ep,wn.reconfigure=tt.define();function $e(i,t,e={}){let r={};for(let n of i)for(let o of Object.keys(n)){let s=n[o],l=r[o];if(l===void 0)r[o]=s;else if(!(l===s||s===void 0))if(Object.hasOwnProperty.call(e,o))r[o]=e[o](l,s);else throw new Error("Config merge conflict for field "+o)}for(let n in t)r[n]===void 0&&(r[n]=t[n]);return r}class Xi{eq(t){return this==t}range(t,e=t){return Yl.create(t,e,this)}}Xi.prototype.startSide=Xi.prototype.endSide=0,Xi.prototype.point=!1,Xi.prototype.mapMode=ne.TrackDel;let Yl=class L1{constructor(t,e,r){this.from=t,this.to=e,this.value=r}static create(t,e,r){return new L1(t,e,r)}};function Gl(i,t){return i.from-t.from||i.value.startSide-t.value.startSide}class Jl{constructor(t,e,r,n){this.from=t,this.to=e,this.value=r,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,r,n=0){let o=r?this.to:this.from;for(let s=n,l=o.length;;){if(s==l)return s;let a=s+l>>1,c=o[a]-t||(r?this.value[a].endSide:this.value[a].startSide)-e;if(a==s)return c>=0?s:l;c>=0?l=a:s=a+1}}between(t,e,r,n){for(let o=this.findIndex(e,-1e9,!0),s=this.findIndex(r,1e9,!1,o);o<s;o++)if(n(this.from[o]+t,this.to[o]+t,this.value[o])===!1)return!1}map(t,e){let r=[],n=[],o=[],s=-1,l=-1;for(let a=0;a<this.value.length;a++){let c=this.value[a],h=this.from[a]+t,u=this.to[a]+t,d,f;if(h==u){let m=e.mapPos(h,c.startSide,c.mapMode);if(m==null||(d=f=m,c.startSide!=c.endSide&&(f=e.mapPos(h,c.endSide),f<d)))continue}else if(d=e.mapPos(h,c.startSide),f=e.mapPos(u,c.endSide),d>f||d==f&&c.startSide>0&&c.endSide<=0)continue;(f-d||c.endSide-c.startSide)<0||(s<0&&(s=d),c.point&&(l=Math.max(l,f-d)),r.push(c),n.push(d-s),o.push(f-s))}return{mapped:r.length?new Jl(n,o,r,l):null,pos:s}}}class at{constructor(t,e,r,n){this.chunkPos=t,this.chunk=e,this.nextLayer=r,this.maxPoint=n}static create(t,e,r,n){return new at(t,e,r,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:r=!1,filterFrom:n=0,filterTo:o=this.length}=t,s=t.filter;if(e.length==0&&!s)return this;if(r&&(e=e.slice().sort(Gl)),this.isEmpty)return e.length?at.of(e):this;let l=new sp(this,null,-1).goto(0),a=0,c=[],h=new Ai;for(;l.value||a<e.length;)if(a<e.length&&(l.from-e[a].from||l.startSide-e[a].value.startSide)>=0){let u=e[a++];h.addInner(u.from,u.to,u.value)||c.push(u)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==e.length||this.chunkEnd(l.chunkIndex)<e[a].from)&&(!s||n>this.chunkEnd(l.chunkIndex)||o<this.chunkPos[l.chunkIndex])&&h.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!s||n>l.to||o<l.from||s(l.from,l.to,l.value))&&(h.addInner(l.from,l.to,l.value)||c.push(Yl.create(l.from,l.to,l.value))),l.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?at.empty:this.nextLayer.update({add:c,filter:s,filterFrom:n,filterTo:o}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],r=[],n=-1;for(let s=0;s<this.chunk.length;s++){let l=this.chunkPos[s],a=this.chunk[s],c=t.touchesRange(l,l+a.length);if(c===!1)n=Math.max(n,a.maxPoint),e.push(a),r.push(t.mapPos(l));else if(c===!0){let{mapped:h,pos:u}=a.map(l,t);h&&(n=Math.max(n,h.maxPoint),e.push(h),r.push(u))}}let o=this.nextLayer.map(t);return e.length==0?o:new at(r,e,o||at.empty,n)}between(t,e,r){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let o=this.chunkPos[n],s=this.chunk[n];if(e>=o&&t<=o+s.length&&s.between(o,t-o,e-o,r)===!1)return}this.nextLayer.between(t,e,r)}}iter(t=0){return xn.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return xn.from(t).goto(e)}static compare(t,e,r,n,o=-1){let s=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=o),l=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=o),a=op(s,l,r),c=new kn(s,a,o),h=new kn(l,a,o);r.iterGaps((u,d,f)=>lp(c,u,h,d,f,n)),r.empty&&r.length==0&&lp(c,0,h,0,0,n)}static eq(t,e,r=0,n){n==null&&(n=999999999);let o=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0),s=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0);if(o.length!=s.length)return!1;if(!o.length)return!0;let l=op(o,s),a=new kn(o,l,0).goto(r),c=new kn(s,l,0).goto(r);for(;;){if(a.to!=c.to||!Ql(a.active,c.active)||a.point&&(!c.point||!a.point.eq(c.point)))return!1;if(a.to>n)return!0;a.next(),c.next()}}static spans(t,e,r,n,o=-1){let s=new kn(t,null,o).goto(e),l=e,a=s.openStart;for(;;){let c=Math.min(s.to,r);if(s.point){let h=s.activeForPoint(s.to),u=s.pointFrom<e?h.length+1:s.point.startSide<0?h.length:Math.min(h.length,a);n.point(l,c,s.point,h,u,s.pointRank),a=Math.min(s.openEnd(c),h.length)}else c>l&&(n.span(l,c,s.active,a),a=s.openEnd(c));if(s.to>r)return a+(s.point&&s.to>r?1:0);l=s.to,s.next()}}static of(t,e=!1){let r=new Ai;for(let n of t instanceof Yl?[t]:e?Rb(t):t)r.add(n.from,n.to,n.value);return r.finish()}static join(t){if(!t.length)return at.empty;let e=t[t.length-1];for(let r=t.length-2;r>=0;r--)for(let n=t[r];n!=at.empty;n=n.nextLayer)e=new at(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}at.empty=new at([],[],null,-1);function Rb(i){if(i.length>1)for(let t=i[0],e=1;e<i.length;e++){let r=i[e];if(Gl(t,r)>0)return i.slice().sort(Gl);t=r}return i}at.empty.nextLayer=at.empty;class Ai{finishChunk(t){this.chunks.push(new Jl(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,r){this.addInner(t,e,r)||(this.nextLayer||(this.nextLayer=new Ai)).add(t,e,r)}addInner(t,e,r){let n=t-this.lastTo||r.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=r,this.lastFrom=t,this.lastTo=e,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let r=e.value.length-1;return this.last=e.value[r],this.lastFrom=e.from[r]+t,this.lastTo=e.to[r]+t,!0}finish(){return this.finishInner(at.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=at.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function op(i,t,e){let r=new Map;for(let o of i)for(let s=0;s<o.chunk.length;s++)o.chunk[s].maxPoint<=0&&r.set(o.chunk[s],o.chunkPos[s]);let n=new Set;for(let o of t)for(let s=0;s<o.chunk.length;s++){let l=r.get(o.chunk[s]);l!=null&&(e?e.mapPos(l):l)==o.chunkPos[s]&&!(e!=null&&e.touchesRange(l,l+o.chunk[s].length))&&n.add(o.chunk[s])}return n}class sp{constructor(t,e,r,n=0){this.layer=t,this.skip=e,this.minPoint=r,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,r){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!r||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],r=t+e.from[this.rangeIndex];if(this.from=r,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class xn{constructor(t){this.heap=t}static from(t,e=null,r=-1){let n=[];for(let o=0;o<t.length;o++)for(let s=t[o];!s.isEmpty;s=s.nextLayer)s.maxPoint>=r&&n.push(new sp(s,e,r,o));return n.length==1?n[0]:new xn(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let r of this.heap)r.goto(t,e);for(let r=this.heap.length>>1;r>=0;r--)Xl(this.heap,r);return this.next(),this}forward(t,e){for(let r of this.heap)r.forward(t,e);for(let r=this.heap.length>>1;r>=0;r--)Xl(this.heap,r);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Xl(this.heap,0)}}}function Xl(i,t){for(let e=i[t];;){let r=(t<<1)+1;if(r>=i.length)break;let n=i[r];if(r+1<i.length&&n.compare(i[r+1])>=0&&(n=i[r+1],r++),e.compare(n)<0)break;i[r]=e,i[t]=n,t=r}}class kn{constructor(t,e,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=xn.from(t,e,r)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Ro(this.active,t),Ro(this.activeTo,t),Ro(this.activeRank,t),this.minActive=ap(this.active,this.activeTo)}addActive(t){let e=0,{value:r,to:n,rank:o}=this.cursor;for(;e<this.activeRank.length&&(o-this.activeRank[e]||n-this.activeTo[e])>0;)e++;Bo(this.active,e,r),Bo(this.activeTo,e,n),Bo(this.activeRank,e,o),t&&Bo(t,e,this.cursor.from),this.minActive=ap(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),r&&Ro(r,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(r),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let n=r.length-1;n>=0&&r[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>t||this.activeTo[r]==t&&this.active[r].endSide>=this.point.endSide)&&e.push(this.active[r]);return e.reverse()}openEnd(t){let e=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>t;r--)e++;return e}}function lp(i,t,e,r,n,o){i.goto(t),e.goto(r);let s=r+n,l=r,a=r-t;for(;;){let c=i.to+a-e.to||i.endSide-e.endSide,h=c<0?i.to+a:e.to,u=Math.min(h,s);if(i.point||e.point?i.point&&e.point&&(i.point==e.point||i.point.eq(e.point))&&Ql(i.activeForPoint(i.to),e.activeForPoint(e.to))||o.comparePoint(l,u,i.point,e.point):u>l&&!Ql(i.active,e.active)&&o.compareRange(l,u,i.active,e.active),h>s)break;l=h,c<=0&&i.next(),c>=0&&e.next()}}function Ql(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!=t[e]&&!i[e].eq(t[e]))return!1;return!0}function Ro(i,t){for(let e=t,r=i.length-1;e<r;e++)i[e]=i[e+1];i.pop()}function Bo(i,t,e){for(let r=i.length-1;r>=t;r--)i[r+1]=i[r];i[t]=e}function ap(i,t){let e=-1,r=1e9;for(let n=0;n<t.length;n++)(t[n]-r||i[n].endSide-i[e].endSide)<0&&(e=n,r=t[n]);return e}function Lr(i,t,e=i.length){let r=0;for(let n=0;n<e;)i.charCodeAt(n)==9?(r+=t-r%t,n++):(r++,n=Ht(i,n));return r}function Zl(i,t,e,r){for(let n=0,o=0;;){if(o>=t)return n;if(n==i.length)break;o+=i.charCodeAt(n)==9?e-o%e:1,n=Ht(i,n)}return r===!0?-1:i.length}const ta="\u037C",cp=typeof Symbol>"u"?"__"+ta:Symbol.for(ta),ea=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),hp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Mi{constructor(t,e){this.rules=[];let{finish:r}=e||{};function n(s){return/^@/.test(s)?[s]:s.split(/,\s*/)}function o(s,l,a,c){let h=[],u=/^@(\w+)\b/.exec(s[0]),d=u&&u[1]=="keyframes";if(u&&l==null)return a.push(s[0]+";");for(let f in l){let m=l[f];if(/&/.test(f))o(f.split(/,\s*/).map(v=>s.map(p=>v.replace(/&/,p))).reduce((v,p)=>v.concat(p)),m,a);else if(m&&typeof m=="object"){if(!u)throw new RangeError("The value of a property ("+f+") should be a primitive value.");o(n(f),m,h,d)}else m!=null&&h.push(f.replace(/_.*/,"").replace(/[A-Z]/g,v=>"-"+v.toLowerCase())+": "+m+";")}(h.length||d)&&a.push((r&&!u&&!c?s.map(r):s).join(", ")+" {"+h.join(" ")+"}")}for(let s in t)o(n(s),t[s],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=hp[cp]||1;return hp[cp]=t+1,ta+t.toString(36)}static mount(t,e,r){let n=t[ea],o=r&&r.nonce;n?o&&n.setNonce(o):n=new Bb(t,o),n.mount(Array.isArray(e)?e:[e],t)}}let up=new Map;class Bb{constructor(t,e){let r=t.ownerDocument||t,n=r.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let o=up.get(r);if(o)return t[ea]=o;this.sheet=new n.CSSStyleSheet,up.set(r,this)}else this.styleTag=r.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[ea]=this}mount(t,e){let r=this.sheet,n=0,o=0;for(let s=0;s<t.length;s++){let l=t[s],a=this.modules.indexOf(l);if(a<o&&a>-1&&(this.modules.splice(a,1),o--,a=-1),a==-1){if(this.modules.splice(o++,0,l),r)for(let c=0;c<l.rules.length;c++)r.insertRule(l.rules[c],n++)}else{for(;o<a;)n+=this.modules[o++].rules.length;n+=l.rules.length,o++}}if(r)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let s="";for(let a=0;a<this.modules.length;a++)s+=this.modules[a].getRules()+`
`;this.styleTag.textContent=s;let l=e.head||e;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}for(var Ci={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Sn={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Nb=typeof navigator<"u"&&/Mac/.test(navigator.platform),Ib=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),jt=0;jt<10;jt++)Ci[48+jt]=Ci[96+jt]=String(jt);for(var jt=1;jt<=24;jt++)Ci[jt+111]="F"+jt;for(var jt=65;jt<=90;jt++)Ci[jt]=String.fromCharCode(jt+32),Sn[jt]=String.fromCharCode(jt);for(var ia in Ci)Sn.hasOwnProperty(ia)||(Sn[ia]=Ci[ia]);function Wb(i){var t=Nb&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||Ib&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",e=!t&&i.key||(i.shiftKey?Sn:Ci)[i.keyCode]||i.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function Tn(i){let t;return i.nodeType==11?t=i.getSelection?i:i.ownerDocument:t=i,t.getSelection()}function ra(i,t){return t?i==t||i.contains(t.nodeType!=1?t.parentNode:t):!1}function No(i,t){if(!t.anchorNode)return!1;try{return ra(i,t.anchorNode)}catch{return!1}}function _r(i){return i.nodeType==3?Zi(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function An(i,t,e,r){return e?dp(i,t,e,r,-1)||dp(i,t,e,r,1):!1}function Qi(i){for(var t=0;;t++)if(i=i.previousSibling,!i)return t}function Io(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function dp(i,t,e,r,n){for(;;){if(i==e&&t==r)return!0;if(t==(n<0?0:qe(i))){if(i.nodeName=="DIV")return!1;let o=i.parentNode;if(!o||o.nodeType!=1)return!1;t=Qi(i)+(n<0?0:1),i=o}else if(i.nodeType==1){if(i=i.childNodes[t+(n<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;t=n<0?qe(i):0}else return!1}}function qe(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Mn(i,t){let e=t?i.left:i.right;return{left:e,right:e,top:i.top,bottom:i.bottom}}function Fb(i){let t=i.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function fp(i,t){let e=t.width/i.offsetWidth,r=t.height/i.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-i.offsetWidth)<1)&&(e=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(t.height-i.offsetHeight)<1)&&(r=1),{scaleX:e,scaleY:r}}function Vb(i,t,e,r,n,o,s,l){let a=i.ownerDocument,c=a.defaultView||window;for(let h=i,u=!1;h&&!u;)if(h.nodeType==1){let d,f=h==a.body,m=1,v=1;if(f)d=Fb(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let b=h.getBoundingClientRect();({scaleX:m,scaleY:v}=fp(h,b)),d={left:b.left,right:b.left+h.clientWidth*m,top:b.top,bottom:b.top+h.clientHeight*v}}let p=0,y=0;if(n=="nearest")t.top<d.top?(y=-(d.top-t.top+s),e>0&&t.bottom>d.bottom+y&&(y=t.bottom-d.bottom+y+s)):t.bottom>d.bottom&&(y=t.bottom-d.bottom+s,e<0&&t.top-y<d.top&&(y=-(d.top+y-t.top+s)));else{let b=t.bottom-t.top,k=d.bottom-d.top;y=(n=="center"&&b<=k?t.top+b/2-k/2:n=="start"||n=="center"&&e<0?t.top-s:t.bottom-k+s)-d.top}if(r=="nearest"?t.left<d.left?(p=-(d.left-t.left+o),e>0&&t.right>d.right+p&&(p=t.right-d.right+p+o)):t.right>d.right&&(p=t.right-d.right+o,e<0&&t.left<d.left+p&&(p=-(d.left+p-t.left+o))):p=(r=="center"?t.left+(t.right-t.left)/2-(d.right-d.left)/2:r=="start"==l?t.left-o:t.right-(d.right-d.left)+o)-d.left,p||y)if(f)c.scrollBy(p,y);else{let b=0,k=0;if(y){let S=h.scrollTop;h.scrollTop+=y/v,k=(h.scrollTop-S)*v}if(p){let S=h.scrollLeft;h.scrollLeft+=p/m,b=(h.scrollLeft-S)*m}t={left:t.left-b,top:t.top-k,right:t.right-b,bottom:t.bottom-k},b&&Math.abs(b-p)<1&&(r="nearest"),k&&Math.abs(k-y)<1&&(n="nearest")}if(f)break;h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function Hb(i){let t=i.ownerDocument,e,r;for(let n=i.parentNode;n&&!(n==t.body||e&&r);)if(n.nodeType==1)!r&&n.scrollHeight>n.clientHeight&&(r=n),!e&&n.scrollWidth>n.clientWidth&&(e=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:e,y:r}}class Ub{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:r}=t;this.set(e,Math.min(t.anchorOffset,e?qe(e):0),r,Math.min(t.focusOffset,r?qe(r):0))}set(t,e,r,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=r,this.focusOffset=n}}let Er=null;function pp(i){if(i.setActive)return i.setActive();if(Er)return i.focus(Er);let t=[];for(let e=i;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(i.focus(Er==null?{get preventScroll(){return Er={preventScroll:!0},!0}}:void 0),!Er){Er=!1;for(let e=0;e<t.length;){let r=t[e++],n=t[e++],o=t[e++];r.scrollTop!=n&&(r.scrollTop=n),r.scrollLeft!=o&&(r.scrollLeft=o)}}}let mp;function Zi(i,t,e=t){let r=mp||(mp=document.createRange());return r.setEnd(i,e),r.setStart(i,t),r}function Or(i,t,e,r){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0};r&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=r);let o=new KeyboardEvent("keydown",n);o.synthetic=!0,i.dispatchEvent(o);let s=new KeyboardEvent("keyup",n);return s.synthetic=!0,i.dispatchEvent(s),o.defaultPrevented||s.defaultPrevented}function zb(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function gp(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function jb(i,t){let e=t.focusNode,r=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=r)return!1;for(r=Math.min(r,qe(e));;)if(r){if(e.nodeType!=1)return!1;let n=e.childNodes[r-1];n.contentEditable=="false"?r--:(e=n,r=qe(e))}else{if(e==i)return!0;r=Qi(e),e=e.parentNode}}function yp(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function vp(i,t){for(let e=i,r=t;;){if(e.nodeType==3&&r>0)return{node:e,offset:r};if(e.nodeType==1&&r>0){if(e.contentEditable=="false")return null;e=e.childNodes[r-1],r=qe(e)}else if(e.parentNode&&!Io(e))r=Qi(e),e=e.parentNode;else return null}}function wp(i,t){for(let e=i,r=t;;){if(e.nodeType==3&&r<e.nodeValue.length)return{node:e,offset:r};if(e.nodeType==1&&r<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[r],r=0}else if(e.parentNode&&!Io(e))r=Qi(e)+1,e=e.parentNode;else return null}}class Qt{constructor(t,e,r=!0){this.node=t,this.offset=e,this.precise=r}static before(t,e){return new Qt(t.parentNode,Qi(t),e)}static after(t,e){return new Qt(t.parentNode,Qi(t)+1,e)}}const na=[];class pt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let r of this.children){if(r==t)return e;e+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let r=this.dom,n=null,o;for(let s of this.children){if(s.flags&7){if(!s.dom&&(o=n?n.nextSibling:r.firstChild)){let l=pt.get(o);(!l||!l.parent&&l.canReuseDOM(s))&&s.reuseDOM(o)}s.sync(t,e),s.flags&=-8}if(o=n?n.nextSibling:r.firstChild,e&&!e.written&&e.node==r&&o!=s.dom&&(e.written=!0),s.dom.parentNode==r)for(;o&&o!=s.dom;)o=bp(o);else r.insertBefore(s.dom,o);n=s.dom}for(o=n?n.nextSibling:r.firstChild,o&&e&&e.node==r&&(e.written=!0);o;)o=bp(o)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(t,e),r.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let r;if(t==this.dom)r=this.dom.childNodes[e];else{let n=qe(t)==0?0:e==0?-1:1;for(;;){let o=t.parentNode;if(o==this.dom)break;n==0&&o.firstChild!=o.lastChild&&(t==o.firstChild?n=-1:n=1),t=o}n<0?r=t:r=t.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!pt.get(r);)r=r.nextSibling;if(!r)return this.length;for(let n=0,o=0;;n++){let s=this.children[n];if(s.dom==r)return o;o+=s.length+s.breakAfter}}domBoundsAround(t,e,r=0){let n=-1,o=-1,s=-1,l=-1;for(let a=0,c=r,h=r;a<this.children.length;a++){let u=this.children[a],d=c+u.length;if(c<t&&d>e)return u.domBoundsAround(t,e,c);if(d>=t&&n==-1&&(n=a,o=c),c>e&&u.dom.parentNode==this.dom){s=a,l=h;break}h=d,c=d+u.breakAfter}return{from:o,to:l<0?r+this.length:l,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,r=na){this.markDirty();for(let n=t;n<e;n++){let o=this.children[n];o.parent==this&&r.indexOf(o)<0&&o.destroy()}this.children.splice(t,e-t,...r);for(let n=0;n<r.length;n++)r[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new xp(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,r,n,o,s){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}pt.prototype.breakAfter=0;function bp(i){let t=i.nextSibling;return i.parentNode.removeChild(i),t}class xp{constructor(t,e,r){this.children=t,this.pos=e,this.i=r,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function kp(i,t,e,r,n,o,s,l,a){let{children:c}=i,h=c.length?c[t]:null,u=o.length?o[o.length-1]:null,d=u?u.breakAfter:s;if(!(t==r&&h&&!s&&!d&&o.length<2&&h.merge(e,n,o.length?u:null,e==0,l,a))){if(r<c.length){let f=c[r];f&&(n<f.length||f.breakAfter&&(u!=null&&u.breakAfter))?(t==r&&(f=f.split(n),n=0),!d&&u&&f.merge(0,n,u,!0,0,a)?o[o.length-1]=f:((n||f.children.length&&!f.children[0].length)&&f.merge(0,n,null,!1,0,a),o.push(f))):f!=null&&f.breakAfter&&(u?u.breakAfter=1:s=1),r++}for(h&&(h.breakAfter=s,e>0&&(!s&&o.length&&h.merge(e,h.length,o[0],!1,l,0)?h.breakAfter=o.shift().breakAfter:(e<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(e,h.length,null,!1,l,0),t++));t<r&&o.length;)if(c[r-1].become(o[o.length-1]))r--,o.pop(),a=o.length?0:l;else if(c[t].become(o[0]))t++,o.shift(),l=o.length?0:a;else break;!o.length&&t&&r<c.length&&!c[t-1].breakAfter&&c[r].merge(0,0,c[t-1],!1,l,a)&&t--,(t<r||o.length)&&i.replaceChildren(t,r,o)}}function Sp(i,t,e,r,n,o){let s=i.childCursor(),{i:l,off:a}=s.findPos(e,1),{i:c,off:h}=s.findPos(t,-1),u=t-e;for(let d of r)u+=d.length;i.length+=u,kp(i,c,h,l,a,r,0,n,o)}let he=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},oa=typeof document<"u"?document:{documentElement:{style:{}}};const sa=/Edge\/(\d+)/.exec(he.userAgent),Tp=/MSIE \d/.test(he.userAgent),la=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(he.userAgent),Wo=!!(Tp||la||sa),Ap=!Wo&&/gecko\/(\d+)/i.test(he.userAgent),aa=!Wo&&/Chrome\/(\d+)/.exec(he.userAgent),Mp="webkitFontSmoothing"in oa.documentElement.style,Cp=!Wo&&/Apple Computer/.test(he.vendor),Lp=Cp&&(/Mobile\/\w+/.test(he.userAgent)||he.maxTouchPoints>2);var z={mac:Lp||/Mac/.test(he.platform),windows:/Win/.test(he.platform),linux:/Linux|X11/.test(he.platform),ie:Wo,ie_version:Tp?oa.documentMode||6:la?+la[1]:sa?+sa[1]:0,gecko:Ap,gecko_version:Ap?+(/Firefox\/(\d+)/.exec(he.userAgent)||[0,0])[1]:0,chrome:!!aa,chrome_version:aa?+aa[1]:0,ios:Lp,android:/Android\b/.test(he.userAgent),webkit:Mp,safari:Cp,webkit_version:Mp?+(/\bAppleWebKit\/(\d+)/.exec(he.userAgent)||[0,0])[1]:0,tabSize:oa.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const $b=256;class Pe extends pt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,r){return this.flags&8||r&&(!(r instanceof Pe)||this.length-(e-t)+r.length>$b||r.flags&8)?!1:(this.text=this.text.slice(0,t)+(r?r.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Pe(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Qt(this.dom,t)}domBoundsAround(t,e,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return qb(this.dom,t,e)}}class di extends pt{constructor(t,e=[],r=0){super(),this.mark=t,this.children=e,this.length=r;for(let n of e)n.setParent(this)}setAttrs(t){if(gp(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,r,n,o,s){return r&&(!(r instanceof di&&r.mark.eq(this.mark))||t&&o<=0||e<this.length&&s<=0)?!1:(Sp(this,t,e,r?r.children.slice():[],o-1,s-1),this.markDirty(),!0)}split(t){let e=[],r=0,n=-1,o=0;for(let l of this.children){let a=r+l.length;a>t&&e.push(r<t?l.split(t-r):l),n<0&&r>=t&&(n=o),r=a,o++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new di(this.mark,e,s)}domAtPos(t){return _p(this,t)}coordsAt(t,e){return Op(this,t,e)}}function qb(i,t,e){let r=i.nodeValue.length;t>r&&(t=r);let n=t,o=t,s=0;t==0&&e<0||t==r&&e>=0?z.chrome||z.gecko||(t?(n--,s=1):o<r&&(o++,s=-1)):e<0?n--:o<r&&o++;let l=Zi(i,n,o).getClientRects();if(!l.length)return null;let a=l[(s?s<0:e>=0)?0:l.length-1];return z.safari&&!s&&a.width==0&&(a=Array.prototype.find.call(l,c=>c.width)||a),s?Mn(a,s<0):a||null}class Li extends pt{static create(t,e,r){return new Li(t,e,r)}constructor(t,e,r){super(),this.widget=t,this.length=e,this.side=r,this.prevWidget=null}split(t){let e=Li.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,r,n,o,s){return r&&(!(r instanceof Li)||!this.widget.compare(r.widget)||t>0&&o<=0||e<this.length&&s<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-e),!0)}become(t){return t instanceof Li&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return ht.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,r=e&&e.state.doc,n=this.posAtStart;return r?r.slice(n,n+this.length):ht.empty}domAtPos(t){return(this.length?t==0:this.side>0)?Qt.before(this.dom):Qt.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let r=this.widget.coordsAt(this.dom,t,e);if(r)return r;let n=this.dom.getClientRects(),o=null;if(!n.length)return null;let s=this.side?this.side<0:t>0;for(let l=s?n.length-1:0;o=n[l],!(t>0?l==0:l==n.length-1||o.top<o.bottom);l+=s?-1:1);return Mn(o,!s)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Dr extends pt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Dr&&t.side==this.side}split(){return new Dr(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Qt.before(this.dom):Qt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ht.empty}get isHidden(){return!0}}Pe.prototype.children=Li.prototype.children=Dr.prototype.children=na;function _p(i,t){let e=i.dom,{children:r}=i,n=0;for(let o=0;n<r.length;n++){let s=r[n],l=o+s.length;if(!(l==o&&s.getSide()<=0)){if(t>o&&t<l&&s.dom.parentNode==e)return s.domAtPos(t-o);if(t<=o)break;o=l}}for(let o=n;o>0;o--){let s=r[o-1];if(s.dom.parentNode==e)return s.domAtPos(s.length)}for(let o=n;o<r.length;o++){let s=r[o];if(s.dom.parentNode==e)return s.domAtPos(0)}return new Qt(e,0)}function Ep(i,t,e){let r,{children:n}=i;e>0&&t instanceof di&&n.length&&(r=n[n.length-1])instanceof di&&r.mark.eq(t.mark)?Ep(r,t.children[0],e-1):(n.push(t),t.setParent(i)),i.length+=t.length}function Op(i,t,e){let r=null,n=-1,o=null,s=-1;function l(c,h){for(let u=0,d=0;u<c.children.length&&d<=h;u++){let f=c.children[u],m=d+f.length;m>=h&&(f.children.length?l(f,h-d):(!o||o.isHidden&&e>0)&&(m>h||d==m&&f.getSide()>0)?(o=f,s=h-d):(d<h||d==m&&f.getSide()<0&&!f.isHidden)&&(r=f,n=h-d)),d=m}}l(i,t);let a=(e<0?r:o)||r||o;return a?a.coordsAt(Math.max(0,a==r?n:s),e):Kb(i)}function Kb(i){let t=i.dom.lastChild;if(!t)return i.dom.getBoundingClientRect();let e=_r(t);return e[e.length-1]||null}function ca(i,t){for(let e in i)e=="class"&&t.class?t.class+=" "+i.class:e=="style"&&t.style?t.style+=";"+i.style:t[e]=i[e];return t}const Dp=Object.create(null);function Fo(i,t,e){if(i==t)return!0;i||(i=Dp),t||(t=Dp);let r=Object.keys(i),n=Object.keys(t);if(r.length-(e&&r.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let o of r)if(o!=e&&(n.indexOf(o)==-1||i[o]!==t[o]))return!1;return!0}function ha(i,t,e){let r=!1;if(t)for(let n in t)e&&n in e||(r=!0,n=="style"?i.style.cssText="":i.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(r=!0,n=="style"?i.style.cssText=e[n]:i.setAttribute(n,e[n]));return r}function Yb(i){let t=Object.create(null);for(let e=0;e<i.attributes.length;e++){let r=i.attributes[e];t[r.name]=r.value}return t}class fi{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var oe=function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i}(oe||(oe={}));class G extends Xi{constructor(t,e,r,n){super(),this.startSide=t,this.endSide=e,this.widget=r,this.spec=n}get heightRelevant(){return!1}static mark(t){return new Cn(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),r=!!t.block;return e+=r&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new _i(t,e,e,r,t.widget||null,!1)}static replace(t){let e=!!t.block,r,n;if(t.isBlockGap)r=-5e8,n=4e8;else{let{start:o,end:s}=Pp(t,e);r=(o?e?-3e8:-1:5e8)-1,n=(s?e?2e8:1:-6e8)+1}return new _i(t,r,n,e,t.widget||null,!0)}static line(t){return new Ln(t)}static set(t,e=!1){return at.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}G.none=at.empty;class Cn extends G{constructor(t){let{start:e,end:r}=Pp(t);super(e?-1:5e8,r?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,r;return this==t||t instanceof Cn&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((r=t.attrs)===null||r===void 0?void 0:r.class))&&Fo(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}Cn.prototype.point=!1;class Ln extends G{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Ln&&this.spec.class==t.spec.class&&Fo(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}Ln.prototype.mapMode=ne.TrackBefore,Ln.prototype.point=!0;class _i extends G{constructor(t,e,r,n,o,s){super(e,r,o,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?ne.TrackBefore:ne.TrackAfter:ne.TrackDel}get type(){return this.startSide!=this.endSide?oe.WidgetRange:this.startSide<=0?oe.WidgetBefore:oe.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof _i&&Gb(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}_i.prototype.point=!0;function Pp(i,t=!1){let{inclusiveStart:e,inclusiveEnd:r}=i;return e==null&&(e=i.inclusive),r==null&&(r=i.inclusive),{start:e??t,end:r??t}}function Gb(i,t){return i==t||!!(i&&t&&i.compare(t))}function ua(i,t,e,r=0){let n=e.length-1;n>=0&&e[n]+r>=i?e[n]=Math.max(e[n],t):e.push(i,t)}class Rt extends pt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,r,n,o,s){if(r){if(!(r instanceof Rt))return!1;this.dom||r.transferDOM(this)}return n&&this.setDeco(r?r.attrs:null),Sp(this,t,e,r?r.children.slice():[],o,s),!0}split(t){let e=new Rt;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i:r,off:n}=this.childPos(t);n&&(e.append(this.children[r].split(n),0),this.children[r].merge(n,this.children[r].length,null,!1,0,0),r++);for(let o=r;o<this.children.length;o++)e.append(this.children[o],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Fo(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Ep(this,t,e)}addLineDeco(t){let e=t.spec.attributes,r=t.spec.class;e&&(this.attrs=ca(e,this.attrs||{})),r&&(this.attrs=ca({class:r},this.attrs||{}))}domAtPos(t){return _p(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var r;this.dom?this.flags&4&&(gp(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(ha(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&pt.get(n)instanceof di;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((r=pt.get(n))===null||r===void 0?void 0:r.isEditable)==!1&&(!z.ios||!this.children.some(o=>o instanceof Pe))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let r of this.children){if(!(r instanceof Pe)||/[^ -~]/.test(r.text))return null;let n=_r(r.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let r=Op(this,t,e);if(!this.children.length&&r&&this.parent){let{heightOracle:n}=this.parent.view.viewState,o=r.bottom-r.top;if(Math.abs(o-n.lineHeight)<2&&n.textHeight<o){let s=(o-n.textHeight)/2;return{top:r.top+s,bottom:r.bottom-s,left:r.left,right:r.left}}}return r}become(t){return t instanceof Rt&&this.children.length==0&&t.children.length==0&&Fo(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let r=0,n=0;r<t.children.length;r++){let o=t.children[r],s=n+o.length;if(s>=e){if(o instanceof Rt)return o;if(s>e)break}n=s+o.breakAfter}return null}}class pi extends pt{constructor(t,e,r){super(),this.widget=t,this.length=e,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(t,e,r,n,o,s){return r&&(!(r instanceof pi)||!this.widget.compare(r.widget)||t>0&&o<=0||e<this.length&&s<=0)?!1:(this.length=t+(r?r.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?Qt.before(this.dom):Qt.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let r=new pi(this.widget,e,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return na}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ht.empty}domBoundsAround(){return null}become(t){return t instanceof pi&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof da?null:Mn(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:r}=this.deco;return e==r?!1:t<0?e<0:r>0}}class da extends fi{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class _n{constructor(t,e,r,n){this.doc=t,this.pos=e,this.end=r,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof pi&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Rt),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Vo(new Dr(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof pi)&&this.getLine()}buildText(t,e,r){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:s,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(s){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-r)),this.getLine().append(Vo(new Pe(this.text.slice(this.textOff,this.textOff+n)),e),r),this.atCursorPos=!0,this.textOff+=n,t-=n,r=0}}span(t,e,r,n){this.buildText(e-t,r,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,r,n,o,s){if(this.disallowBlockEffectsFor[s]&&r instanceof _i){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=e-t;if(r instanceof _i)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new pi(r.widget||Pr.block,l,r));else{let a=Li.create(r.widget||Pr.inline,l,l?0:r.startSide),c=this.atCursorPos&&!a.isEditable&&o<=n.length&&(t<e||r.startSide>0),h=!a.isEditable&&(t<e||o>n.length||r.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(u.append(Vo(new Dr(1),n),o),o=n.length+Math.max(0,o-n.length)),u.append(Vo(a,n),o),this.atCursorPos=h,this.pendingBuffer=h?t<e||o>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=o)}static build(t,e,r,n,o){let s=new _n(t,e,r,o);return s.openEnd=at.spans(n,e,r,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function Vo(i,t){for(let e of t)i=new di(e,[i],i.length);return i}class Pr extends fi{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Pr.inline=new Pr("span"),Pr.block=new Pr("div");var wt=function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i}(wt||(wt={}));const tr=wt.LTR,fa=wt.RTL;function Rp(i){let t=[];for(let e=0;e<i.length;e++)t.push(1<<+i[e]);return t}const Jb=Rp("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Xb=Rp("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),pa=Object.create(null),Ke=[];for(let i of["()","[]","{}"]){let t=i.charCodeAt(0),e=i.charCodeAt(1);pa[t]=e,pa[e]=-t}function Bp(i){return i<=247?Jb[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?Xb[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const Qb=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ei{get dir(){return this.level%2?fa:tr}constructor(t,e,r){this.from=t,this.to=e,this.level=r}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,r,n){let o=-1;for(let s=0;s<t.length;s++){let l=t[s];if(l.from<=e&&l.to>=e){if(l.level==r)return s;(o<0||(n!=0?n<0?l.from<e:l.to>e:t[o].level>l.level))&&(o=s)}}if(o<0)throw new RangeError("Index out of range");return o}}function Np(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++){let r=i[e],n=t[e];if(r.from!=n.from||r.to!=n.to||r.direction!=n.direction||!Np(r.inner,n.inner))return!1}return!0}const mt=[];function Zb(i,t,e,r,n){for(let o=0;o<=r.length;o++){let s=o?r[o-1].to:t,l=o<r.length?r[o].from:e,a=o?256:n;for(let c=s,h=a,u=a;c<l;c++){let d=Bp(i.charCodeAt(c));d==512?d=h:d==8&&u==4&&(d=16),mt[c]=d==4?2:d,d&7&&(u=d),h=d}for(let c=s,h=a,u=a;c<l;c++){let d=mt[c];if(d==128)c<l-1&&h==mt[c+1]&&h&24?d=mt[c]=h:mt[c]=256;else if(d==64){let f=c+1;for(;f<l&&mt[f]==64;)f++;let m=c&&h==8||f<e&&mt[f]==8?u==1?1:8:256;for(let v=c;v<f;v++)mt[v]=m;c=f-1}else d==8&&u==1&&(mt[c]=1);h=d,d&7&&(u=d)}}}function tx(i,t,e,r,n){let o=n==1?2:1;for(let s=0,l=0,a=0;s<=r.length;s++){let c=s?r[s-1].to:t,h=s<r.length?r[s].from:e;for(let u=c,d,f,m;u<h;u++)if(f=pa[d=i.charCodeAt(u)])if(f<0){for(let v=l-3;v>=0;v-=3)if(Ke[v+1]==-f){let p=Ke[v+2],y=p&2?n:p&4?p&1?o:n:0;y&&(mt[u]=mt[Ke[v]]=y),l=v;break}}else{if(Ke.length==189)break;Ke[l++]=u,Ke[l++]=d,Ke[l++]=a}else if((m=mt[u])==2||m==1){let v=m==n;a=v?0:1;for(let p=l-3;p>=0;p-=3){let y=Ke[p+2];if(y&2)break;if(v)Ke[p+2]|=2;else{if(y&4)break;Ke[p+2]|=4}}}}}function ex(i,t,e,r){for(let n=0,o=r;n<=e.length;n++){let s=n?e[n-1].to:i,l=n<e.length?e[n].from:t;for(let a=s;a<l;){let c=mt[a];if(c==256){let h=a+1;for(;;)if(h==l){if(n==e.length)break;h=e[n++].to,l=n<e.length?e[n].from:t}else if(mt[h]==256)h++;else break;let u=o==1,d=(h<t?mt[h]:r)==1,f=u==d?u?1:2:r;for(let m=h,v=n,p=v?e[v-1].to:i;m>a;)m==p&&(m=e[--v].from,p=v?e[v-1].to:i),mt[--m]=f;a=h}else o=c,a++}}}function ma(i,t,e,r,n,o,s){let l=r%2?2:1;if(r%2==n%2)for(let a=t,c=0;a<e;){let h=!0,u=!1;if(c==o.length||a<o[c].from){let v=mt[a];v!=l&&(h=!1,u=v==16)}let d=!h&&l==1?[]:null,f=h?r:r+1,m=a;t:for(;;)if(c<o.length&&m==o[c].from){if(u)break t;let v=o[c];if(!h)for(let p=v.to,y=c+1;;){if(p==e)break t;if(y<o.length&&o[y].from==p)p=o[y++].to;else{if(mt[p]==l)break t;break}}if(c++,d)d.push(v);else{v.from>a&&s.push(new Ei(a,v.from,f));let p=v.direction==tr!=!(f%2);ga(i,p?r+1:r,n,v.inner,v.from,v.to,s),a=v.to}m=v.to}else{if(m==e||(h?mt[m]!=l:mt[m]==l))break;m++}d?ma(i,a,m,r+1,n,d,s):a<m&&s.push(new Ei(a,m,f)),a=m}else for(let a=e,c=o.length;a>t;){let h=!0,u=!1;if(!c||a>o[c-1].to){let v=mt[a-1];v!=l&&(h=!1,u=v==16)}let d=!h&&l==1?[]:null,f=h?r:r+1,m=a;t:for(;;)if(c&&m==o[c-1].to){if(u)break t;let v=o[--c];if(!h)for(let p=v.from,y=c;;){if(p==t)break t;if(y&&o[y-1].to==p)p=o[--y].from;else{if(mt[p-1]==l)break t;break}}if(d)d.push(v);else{v.to<a&&s.push(new Ei(v.to,a,f));let p=v.direction==tr!=!(f%2);ga(i,p?r+1:r,n,v.inner,v.from,v.to,s),a=v.from}m=v.from}else{if(m==t||(h?mt[m-1]!=l:mt[m-1]==l))break;m--}d?ma(i,m,a,r+1,n,d,s):m<a&&s.push(new Ei(m,a,f)),a=m}}function ga(i,t,e,r,n,o,s){let l=t%2?2:1;Zb(i,n,o,r,l),tx(i,n,o,r,l),ex(n,o,r,l),ma(i,n,o,t,e,r,s)}function ix(i,t,e){if(!i)return[new Ei(0,0,t==fa?1:0)];if(t==tr&&!e.length&&!Qb.test(i))return Ip(i.length);if(e.length)for(;i.length>mt.length;)mt[mt.length]=256;let r=[],n=t==tr?0:1;return ga(i,n,n,e,0,i.length,r),r}function Ip(i){return[new Ei(0,i,0)]}let Wp="";function rx(i,t,e,r,n){var o;let s=r.head-i.from,l=Ei.find(t,s,(o=r.bidiLevel)!==null&&o!==void 0?o:-1,r.assoc),a=t[l],c=a.side(n,e);if(s==c){let d=l+=n?1:-1;if(d<0||d>=t.length)return null;a=t[l=d],s=a.side(!n,e),c=a.side(n,e)}let h=Ht(i.text,s,a.forward(n,e));(h<a.from||h>a.to)&&(h=c),Wp=i.text.slice(Math.min(s,h),Math.max(s,h));let u=l==(n?t.length-1:0)?null:t[l+(n?1:-1)];return u&&h==c&&u.level+(n?0:1)<a.level?O.cursor(u.side(!n,e)+i.from,u.forward(n,e)?1:-1,u.level):O.cursor(h+i.from,a.forward(n,e)?-1:1,a.level)}function nx(i,t,e){for(let r=t;r<e;r++){let n=Bp(i.charCodeAt(r));if(n==1)return tr;if(n==2||n==4)return fa}return tr}const Fp=U.define(),Vp=U.define(),Hp=U.define(),Up=U.define(),ya=U.define(),zp=U.define(),jp=U.define(),va=U.define(),wa=U.define(),$p=U.define({combine:i=>i.some(t=>t)}),qp=U.define({combine:i=>i.some(t=>t)}),Kp=U.define();class Rr{constructor(t,e="nearest",r="nearest",n=5,o=5,s=!1){this.range=t,this.y=e,this.x=r,this.yMargin=n,this.xMargin=o,this.isSnapshot=s}map(t){return t.empty?this:new Rr(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Rr(O.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Ho=tt.define({map:(i,t)=>i.map(t)}),Yp=tt.define();function ue(i,t,e){let r=i.facet(Up);r.length?r[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const Oi=U.define({combine:i=>i.length?i[0]:!0});let ox=0;const En=U.define();class _t{constructor(t,e,r,n,o){this.id=t,this.create=e,this.domEventHandlers=r,this.domEventObservers=n,this.extension=o(this)}static define(t,e){const{eventHandlers:r,eventObservers:n,provide:o,decorations:s}=e||{};return new _t(ox++,t,r,n,l=>{let a=[En.of(l)];return s&&a.push(On.of(c=>{let h=c.plugin(l);return h?s(h):G.none})),o&&a.push(o(l)),a})}static fromClass(t,e){return _t.define(r=>new t(r),e)}}class ba{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(r){if(ue(e.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){ue(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(r){ue(t.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Gp=U.define(),xa=U.define(),On=U.define(),Jp=U.define(),ka=U.define(),Xp=U.define();function Qp(i,t){let e=i.state.facet(Xp);if(!e.length)return e;let r=e.map(o=>o instanceof Function?o(i):o),n=[];return at.spans(r,t.from,t.to,{point(){},span(o,s,l,a){let c=o-t.from,h=s-t.from,u=n;for(let d=l.length-1;d>=0;d--,a--){let f=l[d].spec.bidiIsolate,m;if(f==null&&(f=nx(t.text,c,h)),a>0&&u.length&&(m=u[u.length-1]).to==c&&m.direction==f)m.to=h,u=m.inner;else{let v={from:c,to:h,direction:f,inner:[]};u.push(v),u=v.inner}}}}),n}const Zp=U.define();function tm(i){let t=0,e=0,r=0,n=0;for(let o of i.state.facet(Zp)){let s=o(i);s&&(s.left!=null&&(t=Math.max(t,s.left)),s.right!=null&&(e=Math.max(e,s.right)),s.top!=null&&(r=Math.max(r,s.top)),s.bottom!=null&&(n=Math.max(n,s.bottom)))}return{left:t,right:e,top:r,bottom:n}}const Dn=U.define();class Te{constructor(t,e,r,n){this.fromA=t,this.toA=e,this.fromB=r,this.toB=n}join(t){return new Te(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,r=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>r.toA)){if(n.toA<r.fromA)break;r=r.join(n),t.splice(e-1,1)}}return t.splice(e,0,r),t}static extendWithRanges(t,e){if(e.length==0)return t;let r=[];for(let n=0,o=0,s=0,l=0;;n++){let a=n==t.length?null:t[n],c=s-l,h=a?a.fromB:1e9;for(;o<e.length&&e[o]<h;){let u=e[o],d=e[o+1],f=Math.max(l,u),m=Math.min(h,d);if(f<=m&&new Te(f+c,m+c,f,m).addToSet(r),d>h)break;o+=2}if(!a)return r;new Te(a.fromA,a.toA,a.fromB,a.toB).addToSet(r),s=a.toA,l=a.toB}}}class Uo{constructor(t,e,r){this.view=t,this.state=e,this.transactions=r,this.flags=0,this.startState=t.state,this.changes=Wt.empty(this.startState.doc.length);for(let o of r)this.changes=this.changes.compose(o.changes);let n=[];this.changes.iterChangedRanges((o,s,l,a)=>n.push(new Te(o,s,l,a))),this.changedRanges=n}static create(t,e,r){return new Uo(t,e,r)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class em extends pt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=G.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Rt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Te(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let r=t.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?n=this.domChanged.newSel.head:!dx(t.changes,this.hasComposition)&&!t.selectionSet&&(n=t.state.selection.main.head));let o=n>-1?lx(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;r=new Te(c,h,t.changes.mapPos(c,-1),t.changes.mapPos(h,1)).addToSet(r.slice())}this.hasComposition=o?{from:o.range.fromB,to:o.range.toB}:null,(z.ie||z.chrome)&&!o&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let s=this.decorations,l=this.updateDeco(),a=hx(s,l,t.changes);return r=Te.extendWithRanges(r,a),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,t.startState.doc.length,o),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,r);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let s=z.chrome||z.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,s),this.flags&=-8,s&&(s.written||n.selectionRange.focusNode!=s.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(s=>s.flags&=-9);let o=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let s of this.children)s instanceof pi&&s.widget instanceof da&&o.push(s.dom);n.updateGaps(o)}updateChildren(t,e,r){let n=r?r.range.addToSet(t.slice()):t,o=this.childCursor(e);for(let s=n.length-1;;s--){let l=s>=0?n[s]:null;if(!l)break;let{fromA:a,toA:c,fromB:h,toB:u}=l,d,f,m,v;if(r&&r.range.fromB<u&&r.range.toB>h){let S=_n.build(this.view.state.doc,h,r.range.fromB,this.decorations,this.dynamicDecorationMap),M=_n.build(this.view.state.doc,r.range.toB,u,this.decorations,this.dynamicDecorationMap);f=S.breakAtStart,m=S.openStart,v=M.openEnd;let L=this.compositionView(r);M.breakAtStart?L.breakAfter=1:M.content.length&&L.merge(L.length,L.length,M.content[0],!1,M.openStart,0)&&(L.breakAfter=M.content[0].breakAfter,M.content.shift()),S.content.length&&L.merge(0,0,S.content[S.content.length-1],!0,0,S.openEnd)&&S.content.pop(),d=S.content.concat(L).concat(M.content)}else({content:d,breakAtStart:f,openStart:m,openEnd:v}=_n.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:p,off:y}=o.findPos(c,1),{i:b,off:k}=o.findPos(a,-1);kp(this,b,k,p,y,d,f,m,v)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let r of e.effects)r.is(Yp)&&(this.editContextFormatting=r.value)}compositionView(t){let e=new Pe(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new di(n,[e],e.length);let r=new Rt;return r.append(e,0),r}fixCompositionDOM(t){let e=(o,s)=>{s.flags|=8|(s.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(s);let l=pt.get(o);l&&l!=s&&(l.dom=null),s.setDOM(o)},r=this.childPos(t.range.fromB,1),n=this.children[r.i];e(t.line,n);for(let o=t.marks.length-1;o>=-1;o--)r=n.childPos(r.off,1),n=n.children[r.i],e(o>=0?t.marks[o].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,n=r==this.dom,o=!n&&No(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(n||e||o))return;let s=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),c=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(z.gecko&&l.empty&&!this.hasComposition&&sx(a)){let u=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(u,a.node.childNodes[a.offset]||null)),a=c=new Qt(u,0),s=!0}let h=this.view.observer.selectionRange;(s||!h.focusNode||(!An(a.node,a.offset,h.anchorNode,h.anchorOffset)||!An(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,l))&&(this.view.observer.ignore(()=>{z.android&&z.chrome&&this.dom.contains(h.focusNode)&&ux(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=Tn(this.view.root);if(u)if(l.empty){if(z.gecko){let d=ax(a.node,a.offset);if(d&&d!=3){let f=(d==1?vp:wp)(a.node,a.offset);f&&(a=new Qt(f.node,f.offset))}}u.collapse(a.node,a.offset),l.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=l.bidiLevel)}else if(u.extend){u.collapse(a.node,a.offset);try{u.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();l.anchor>l.head&&([a,c]=[c,a]),d.setEnd(c.node,c.offset),d.setStart(a.node,a.offset),u.removeAllRanges(),u.addRange(d)}o&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(a,c)),this.impreciseAnchor=a.precise?null:new Qt(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new Qt(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&An(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,r=Tn(t.root),{anchorNode:n,anchorOffset:o}=t.observer.selectionRange;if(!r||!e.empty||!e.assoc||!r.modify)return;let s=Rt.find(this,e.head);if(!s)return;let l=s.posAtStart;if(e.head==l||e.head==l+s.length)return;let a=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!a||!c||a.bottom>c.top)return;let h=this.domAtPos(e.head+e.assoc);r.collapse(h.node,h.offset),r.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&r.collapse(n,o)}moveToLine(t){let e=this.dom,r;if(t.node!=e)return t;for(let n=t.offset;!r&&n<e.childNodes.length;n++){let o=pt.get(e.childNodes[n]);o instanceof Rt&&(r=o.domAtPos(0))}for(let n=t.offset-1;!r&&n>=0;n--){let o=pt.get(e.childNodes[n]);o instanceof Rt&&(r=o.domAtPos(o.length))}return r?new Qt(r.node,r.offset,!0):t}nearest(t){for(let e=t;e;){let r=pt.get(e);if(r&&r.rootView==this)return r;e=e.parentNode}return null}posFromDOM(t,e){let r=this.nearest(t);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(t,e)+r.posAtStart}domAtPos(t){let{i:e,off:r}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(r<n.length||n instanceof Rt)break;e++,r=0}return this.children[e].domAtPos(r)}coordsAt(t,e){let r=null,n=0;for(let o=this.length,s=this.children.length-1;s>=0;s--){let l=this.children[s],a=o-l.breakAfter,c=a-l.length;if(a<t)break;if(c<=t&&(c<t||l.covers(-1))&&(a>t||l.covers(1))&&(!r||l instanceof Rt&&!(r instanceof Rt&&e>=0)))r=l,n=c;else if(r&&c==t&&a==t&&l instanceof pi&&Math.abs(e)<2){if(l.deco.startSide<0)break;s&&(r=null)}o=c}return r?r.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:r}=this.childPos(t,1),n=this.children[e];if(!(n instanceof Rt))return null;for(;n.children.length;){let{i:l,off:a}=n.childPos(r,1);for(;;l++){if(l==n.children.length)return null;if((n=n.children[l]).length)break}r=a}if(!(n instanceof Pe))return null;let o=Ht(n.text,r);if(o==r)return null;let s=Zi(n.dom,r,o).getClientRects();for(let l=0;l<s.length;l++){let a=s[l];if(l==s.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(t){let e=[],{from:r,to:n}=t,o=this.view.contentDOM.clientWidth,s=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==wt.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],d=c+u.length;if(d>n)break;if(c>=r){let f=u.dom.getBoundingClientRect();if(e.push(f.height),s){let m=u.dom.lastChild,v=m?_r(m):[];if(v.length){let p=v[v.length-1],y=a?p.right-f.left:f.right-p.left;y>l&&(l=y,this.minWidth=o,this.minWidthFrom=c,this.minWidthTo=d)}}}c=d+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?wt.RTL:wt.LTR}measureTextSize(){for(let o of this.children)if(o instanceof Rt){let s=o.measureTextSize();if(s)return s}let t=document.createElement("div"),e,r,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let o=_r(t.firstChild)[0];e=t.getBoundingClientRect().height,r=o?o.width/27:7,n=o?o.height:e,t.remove()}),{lineHeight:e,charWidth:r,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new xp(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let r=0,n=0;;n++){let o=n==e.viewports.length?null:e.viewports[n],s=o?o.from-1:this.length;if(s>r){let l=(e.lineBlockAt(s).bottom-e.lineBlockAt(r).top)/this.view.scaleY;t.push(G.replace({widget:new da(l),block:!0,inclusive:!0,isBlockGap:!0}).range(r,s))}if(!o)break;r=o.to+1}return G.set(t)}updateDeco(){let t=1,e=this.view.state.facet(On).map(o=>(this.dynamicDecorationMap[t++]=typeof o=="function")?o(this.view):o),r=!1,n=this.view.state.facet(Jp).map((o,s)=>{let l=typeof o=="function";return l&&(r=!0),l?o(this.view):o});for(n.length&&(this.dynamicDecorationMap[t++]=r,e.push(at.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(Kp))try{if(c(this.view,t.range,t))return!0}catch(h){ue(this.view.state,h,"scroll handler")}let{range:e}=t,r=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!r)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(r={left:Math.min(r.left,n.left),top:Math.min(r.top,n.top),right:Math.max(r.right,n.right),bottom:Math.max(r.bottom,n.bottom)});let o=tm(this.view),s={left:r.left-o.left,top:r.top-o.top,right:r.right+o.right,bottom:r.bottom+o.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;Vb(this.view.scrollDOM,s,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,l),-l),Math.max(Math.min(t.yMargin,a),-a),this.view.textDirection==wt.LTR)}}function sx(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function im(i,t){let e=i.observer.selectionRange;if(!e.focusNode)return null;let r=vp(e.focusNode,e.focusOffset),n=wp(e.focusNode,e.focusOffset),o=r||n;if(n&&r&&n.node!=r.node){let l=pt.get(n.node);if(!l||l instanceof Pe&&l.text!=n.node.nodeValue)o=n;else if(i.docView.lastCompositionAfterCursor){let a=pt.get(r.node);!a||a instanceof Pe&&a.text!=r.node.nodeValue||(o=n)}}if(i.docView.lastCompositionAfterCursor=o!=r,!o)return null;let s=t-o.offset;return{from:s,to:s+o.node.nodeValue.length,node:o.node}}function lx(i,t,e){let r=im(i,e);if(!r)return null;let{node:n,from:o,to:s}=r,l=n.nodeValue;if(/[\n\r]/.test(l)||i.state.doc.sliceString(r.from,r.to)!=l)return null;let a=t.invertedDesc,c=new Te(a.mapPos(o),a.mapPos(s),o,s),h=[];for(let u=n.parentNode;;u=u.parentNode){let d=pt.get(u);if(d instanceof di)h.push({node:u,deco:d.mark});else{if(d instanceof Rt||u.nodeName=="DIV"&&u.parentNode==i.contentDOM)return{range:c,text:n,marks:h,line:u};if(u!=i.contentDOM)h.push({node:u,deco:new Cn({inclusive:!0,attributes:Yb(u),tagName:u.tagName.toLowerCase()})});else return null}}}function ax(i,t){return i.nodeType!=1?0:(t&&i.childNodes[t-1].contentEditable=="false"?1:0)|(t<i.childNodes.length&&i.childNodes[t].contentEditable=="false"?2:0)}let cx=class{constructor(){this.changes=[]}compareRange(i,t){ua(i,t,this.changes)}comparePoint(i,t){ua(i,t,this.changes)}};function hx(i,t,e){let r=new cx;return at.compare(i,t,e,r),r.changes}function ux(i,t){for(let e=i;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function dx(i,t){let e=!1;return t&&i.iterChangedRanges((r,n)=>{r<t.to&&n>t.from&&(e=!0)}),e}function fx(i,t,e=1){let r=i.charCategorizer(t),n=i.doc.lineAt(t),o=t-n.from;if(n.length==0)return O.cursor(t);o==0?e=1:o==n.length&&(e=-1);let s=o,l=o;e<0?s=Ht(n.text,o,!1):l=Ht(n.text,o);let a=r(n.text.slice(s,l));for(;s>0;){let c=Ht(n.text,s,!1);if(r(n.text.slice(c,s))!=a)break;s=c}for(;l<n.length;){let c=Ht(n.text,l);if(r(n.text.slice(l,c))!=a)break;l=c}return O.range(s+n.from,l+n.from)}function px(i,t){return t.left>i?t.left-i:Math.max(0,i-t.right)}function mx(i,t){return t.top>i?t.top-i:Math.max(0,i-t.bottom)}function Sa(i,t){return i.top<t.bottom-1&&i.bottom>t.top+1}function rm(i,t){return t<i.top?{top:t,left:i.left,right:i.right,bottom:i.bottom}:i}function nm(i,t){return t>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:t}:i}function Ta(i,t,e){let r,n,o,s,l=!1,a,c,h,u;for(let m=i.firstChild;m;m=m.nextSibling){let v=_r(m);for(let p=0;p<v.length;p++){let y=v[p];n&&Sa(n,y)&&(y=rm(nm(y,n.bottom),n.top));let b=px(t,y),k=mx(e,y);if(b==0&&k==0)return m.nodeType==3?om(m,t,e):Ta(m,t,e);if(!r||s>k||s==k&&o>b){r=m,n=y,o=b,s=k;let S=k?e<y.top?-1:1:b?t<y.left?-1:1:0;l=!S||(S>0?p<v.length-1:p>0)}b==0?e>y.bottom&&(!h||h.bottom<y.bottom)?(a=m,h=y):e<y.top&&(!u||u.top>y.top)&&(c=m,u=y):h&&Sa(h,y)?h=nm(h,y.bottom):u&&Sa(u,y)&&(u=rm(u,y.top))}}if(h&&h.bottom>=e?(r=a,n=h):u&&u.top<=e&&(r=c,n=u),!r)return{node:i,offset:0};let d=Math.max(n.left,Math.min(n.right,t));if(r.nodeType==3)return om(r,d,e);if(l&&r.contentEditable!="false")return Ta(r,d,e);let f=Array.prototype.indexOf.call(i.childNodes,r)+(t>=(n.left+n.right)/2?1:0);return{node:i,offset:f}}function om(i,t,e){let r=i.nodeValue.length,n=-1,o=1e9,s=0;for(let l=0;l<r;l++){let a=Zi(i,l,l+1).getClientRects();for(let c=0;c<a.length;c++){let h=a[c];if(h.top==h.bottom)continue;s||(s=t-h.left);let u=(h.top>e?h.top-e:e-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&u<o){let d=t>=(h.left+h.right)/2,f=d;if((z.chrome||z.gecko)&&Zi(i,l).getBoundingClientRect().left==h.right&&(f=!d),u<=0)return{node:i,offset:l+(f?1:0)};n=l+(f?1:0),o=u}}}return{node:i,offset:n>-1?n:s>0?i.nodeValue.length:0}}function sm(i,t,e,r=-1){var n,o;let s=i.contentDOM.getBoundingClientRect(),l=s.top+i.viewState.paddingTop,a,{docHeight:c}=i.viewState,{x:h,y:u}=t,d=u-l;if(d<0)return 0;if(d>c)return i.state.doc.length;for(let S=i.viewState.heightOracle.textHeight/2,M=!1;a=i.elementAtHeight(d),a.type!=oe.Text;)for(;d=r>0?a.bottom+S:a.top-S,!(d>=0&&d<=c);){if(M)return e?null:0;M=!0,r=-r}u=l+d;let f=a.from;if(f<i.viewport.from)return i.viewport.from==0?0:e?null:lm(i,s,a,h,u);if(f>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:e?null:lm(i,s,a,h,u);let m=i.dom.ownerDocument,v=i.root.elementFromPoint?i.root:m,p=v.elementFromPoint(h,u);p&&!i.contentDOM.contains(p)&&(p=null),p||(h=Math.max(s.left+1,Math.min(s.right-1,h)),p=v.elementFromPoint(h,u),p&&!i.contentDOM.contains(p)&&(p=null));let y,b=-1;if(p&&((n=i.docView.nearest(p))===null||n===void 0?void 0:n.isEditable)!=!1){if(m.caretPositionFromPoint){let S=m.caretPositionFromPoint(h,u);S&&({offsetNode:y,offset:b}=S)}else if(m.caretRangeFromPoint){let S=m.caretRangeFromPoint(h,u);S&&({startContainer:y,startOffset:b}=S,(!i.contentDOM.contains(y)||z.safari&&gx(y,b,h)||z.chrome&&yx(y,b,h))&&(y=void 0))}y&&(b=Math.min(qe(y),b))}if(!y||!i.docView.dom.contains(y)){let S=Rt.find(i.docView,f);if(!S)return d>a.top+a.height/2?a.to:a.from;({node:y,offset:b}=Ta(S.dom,h,u))}let k=i.docView.nearest(y);if(!k)return null;if(k.isWidget&&((o=k.dom)===null||o===void 0?void 0:o.nodeType)==1){let S=k.dom.getBoundingClientRect();return t.y<S.top||t.y<=S.bottom&&t.x<=(S.left+S.right)/2?k.posAtStart:k.posAtEnd}else return k.localPosFromDOM(y,b)+k.posAtStart}function lm(i,t,e,r,n){let o=Math.round((r-t.left)*i.defaultCharacterWidth);if(i.lineWrapping&&e.height>i.defaultLineHeight*1.5){let l=i.viewState.heightOracle.textHeight,a=Math.floor((n-e.top-(i.defaultLineHeight-l)*.5)/l);o+=a*i.viewState.heightOracle.lineLength}let s=i.state.sliceDoc(e.from,e.to);return e.from+Zl(s,o,i.state.tabSize)}function gx(i,t,e){let r;if(i.nodeType!=3||t!=(r=i.nodeValue.length))return!1;for(let n=i.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return Zi(i,r-1,r).getBoundingClientRect().left>e}function yx(i,t,e){if(t!=0)return!1;for(let n=i;;){let o=n.parentNode;if(!o||o.nodeType!=1||o.firstChild!=n)return!1;if(o.classList.contains("cm-line"))break;n=o}let r=i.nodeType==1?i.getBoundingClientRect():Zi(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return e-r.left>5}function Aa(i,t){let e=i.lineBlockAt(t);if(Array.isArray(e.type)){for(let r of e.type)if(r.to>t||r.to==t&&(r.to==e.to||r.type==oe.Text))return r}return e}function vx(i,t,e,r){let n=Aa(i,t.head),o=!r||n.type!=oe.Text||!(i.lineWrapping||n.widgetLineBreaks)?null:i.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(o){let s=i.dom.getBoundingClientRect(),l=i.textDirectionAt(n.from),a=i.posAtCoords({x:e==(l==wt.LTR)?s.right-1:s.left+1,y:(o.top+o.bottom)/2});if(a!=null)return O.cursor(a,e?-1:1)}return O.cursor(e?n.to:n.from,e?-1:1)}function am(i,t,e,r){let n=i.state.doc.lineAt(t.head),o=i.bidiSpans(n),s=i.textDirectionAt(n.from);for(let l=t,a=null;;){let c=rx(n,o,s,l,e),h=Wp;if(!c){if(n.number==(e?i.state.doc.lines:1))return l;h=`
`,n=i.state.doc.line(n.number+(e?1:-1)),o=i.bidiSpans(n),c=i.visualLineSide(n,!e)}if(a){if(!a(h))return l}else{if(!r)return c;a=r(h)}l=c}}function wx(i,t,e){let r=i.state.charCategorizer(t),n=r(e);return o=>{let s=r(o);return n==kt.Space&&(n=s),n==s}}function bx(i,t,e,r){let n=t.head,o=e?1:-1;if(n==(e?i.state.doc.length:0))return O.cursor(n,t.assoc);let s=t.goalColumn,l,a=i.contentDOM.getBoundingClientRect(),c=i.coordsAtPos(n,t.assoc||-1),h=i.documentTop;if(c)s==null&&(s=c.left-a.left),l=o<0?c.top:c.bottom;else{let f=i.viewState.lineBlockAt(n);s==null&&(s=Math.min(a.right-a.left,i.defaultCharacterWidth*(n-f.from))),l=(o<0?f.top:f.bottom)+h}let u=a.left+s,d=r??i.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let m=l+(d+f)*o,v=sm(i,{x:u,y:m},!1,o);if(m<a.top||m>a.bottom||(o<0?v<n:v>n)){let p=i.docView.coordsForChar(v),y=!p||m<p.top?-1:1;return O.cursor(v,y,void 0,s)}}}function zo(i,t,e){for(;;){let r=0;for(let n of i)n.between(t-1,t+1,(o,s,l)=>{if(t>o&&t<s){let a=r||e||(t-o<s-t?-1:1);t=a<0?o:s,r=a}});if(!r)return t}}function Ma(i,t,e){let r=zo(i.state.facet(ka).map(n=>n(i)),e.from,t.head>e.from?-1:1);return r==e.from?e:O.cursor(r,r<e.from?1:-1)}const Pn="\uFFFF";class xx{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(ot.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Pn}readRange(t,e){if(!t)return this;let r=t.parentNode;for(let n=t;;){this.findPointBefore(r,n);let o=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let l=pt.get(n),a=pt.get(s);(l&&a?l.breakAfter:(l?l.breakAfter:Io(n))||Io(s)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>o)&&this.lineBreak(),n=s}return this.findPointBefore(r,e),this}readTextNode(t){let e=t.nodeValue;for(let r of this.points)r.node==t&&(r.pos=this.text.length+Math.min(r.offset,e.length));for(let r=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,s=1,l;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,r),s=this.lineSeparator.length):(l=n.exec(e))&&(o=l.index,s=l[0].length),this.append(e.slice(r,o<0?e.length:o)),o<0)break;if(this.lineBreak(),s>1)for(let a of this.points)a.node==t&&a.pos>this.text.length&&(a.pos-=s-1);r=o+s}}readNode(t){if(t.cmIgnore)return;let e=pt.get(t),r=e&&e.overrideDOMText;if(r!=null){this.findPointInside(t,r.length);for(let n=r.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let r of this.points)r.node==t&&t.childNodes[r.offset]==e&&(r.pos=this.text.length)}findPointInside(t,e){for(let r of this.points)(t.nodeType==3?r.node==t:t.contains(r.node))&&(r.pos=this.text.length+(kx(t,r.node,r.offset)?e:0))}}function kx(i,t,e){for(;;){if(!t||e<qe(t))return!1;if(t==i)return!0;e=Qi(t)+1,t=t.parentNode}}class cm{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Sx{constructor(t,e,r,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:o,impreciseAnchor:s}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,r,0))){let l=o||s?[]:Mx(t),a=new xx(l,t.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=Cx(l,this.bounds.from)}else{let l=t.observer.selectionRange,a=o&&o.node==l.focusNode&&o.offset==l.focusOffset||!ra(t.contentDOM,l.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(l.focusNode,l.focusOffset),c=s&&s.node==l.anchorNode&&s.offset==l.anchorOffset||!ra(t.contentDOM,l.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(l.anchorNode,l.anchorOffset),h=t.viewport;if((z.ios||z.chrome)&&t.state.selection.main.empty&&a!=c&&(h.from>0||h.to<t.state.doc.length)){let u=Math.min(a,c),d=Math.max(a,c),f=h.from-u,m=h.to-d;(f==0||f==1||u==0)&&(m==0||m==-1||d==t.state.doc.length)&&(a=0,c=t.state.doc.length)}this.newSel=O.single(c,a)}}}function hm(i,t){let e,{newSel:r}=t,n=i.state.selection.main,o=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(t.bounds){let{from:s,to:l}=t.bounds,a=n.from,c=null;(o===8||z.android&&t.text.length<l-s)&&(a=n.to,c="end");let h=Ax(i.state.doc.sliceString(s,l,Pn),t.text,a-s,c);h&&(z.chrome&&o==13&&h.toB==h.from+2&&t.text.slice(h.from,h.toB)==Pn+Pn&&h.toB--,e={from:s+h.from,to:s+h.toA,insert:ht.of(t.text.slice(h.from,h.toB).split(Pn))})}else r&&(!i.hasFocus&&i.state.facet(Oi)||r.main.eq(n))&&(r=null);if(!e&&!r)return!1;if(!e&&t.typeOver&&!n.empty&&r&&r.main.empty?e={from:n.from,to:n.to,insert:i.state.doc.slice(n.from,n.to)}:e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:i.state.doc.slice(n.from,e.from).append(e.insert).append(i.state.doc.slice(e.to,n.to))}:(z.mac||z.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(r&&e.insert.length==2&&(r=O.single(r.main.anchor-1,r.main.head-1)),e={from:n.from,to:n.to,insert:ht.of([" "])}):z.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&i.lineWrapping&&(r&&(r=O.single(r.main.anchor-1,r.main.head-1)),e={from:n.from,to:n.to,insert:ht.of([" "])}),e)return Ca(i,e,r,o);if(r&&!r.main.eq(n)){let s=!1,l="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(s=!0),l=i.inputState.lastSelectionOrigin),i.dispatch({selection:r,scrollIntoView:s,userEvent:l}),!0}else return!1}function Ca(i,t,e,r=-1){if(z.ios&&i.inputState.flushIOSKey(t))return!0;let n=i.state.selection.main;if(z.android&&(t.to==n.to&&(t.from==n.from||t.from==n.from-1&&i.state.sliceDoc(t.from,n.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Or(i.contentDOM,"Enter",13)||(t.from==n.from-1&&t.to==n.to&&t.insert.length==0||r==8&&t.insert.length<t.to-t.from&&t.to>n.head)&&Or(i.contentDOM,"Backspace",8)||t.from==n.from&&t.to==n.to+1&&t.insert.length==0&&Or(i.contentDOM,"Delete",46)))return!0;let o=t.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let s,l=()=>s||(s=Tx(i,t,e));return i.state.facet(zp).some(a=>a(i,t.from,t.to,o,l))||i.dispatch(l()),!0}function Tx(i,t,e){let r,n=i.state,o=n.selection.main;if(t.from>=o.from&&t.to<=o.to&&t.to-t.from>=(o.to-o.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&i.inputState.composing<0){let l=o.from<t.from?n.sliceDoc(o.from,t.from):"",a=o.to>t.to?n.sliceDoc(t.to,o.to):"";r=n.replaceSelection(i.state.toText(l+t.insert.sliceString(0,void 0,i.state.lineBreak)+a))}else{let l=n.changes(t),a=e&&e.main.to<=l.newLength?e.main:void 0;if(n.selection.ranges.length>1&&i.inputState.composing>=0&&t.to<=o.to&&t.to>=o.to-10){let c=i.state.sliceDoc(t.from,t.to),h,u=e&&im(i,e.main.head);if(u){let m=t.insert.length-(t.to-t.from);h={from:u.from,to:u.to-m}}else h=i.state.doc.lineAt(o.head);let d=o.to-t.to,f=o.to-o.from;r=n.changeByRange(m=>{if(m.from==o.from&&m.to==o.to)return{changes:l,range:a||m.map(l)};let v=m.to-d,p=v-c.length;if(m.to-m.from!=f||i.state.sliceDoc(p,v)!=c||m.to>=h.from&&m.from<=h.to)return{range:m};let y=n.changes({from:p,to:v,insert:t.insert}),b=m.to-o.to;return{changes:y,range:a?O.range(Math.max(0,a.anchor+b),Math.max(0,a.head+b)):m.map(y)}})}else r={changes:l,selection:a&&n.selection.replaceRange(a)}}let s="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,s+=".compose",i.inputState.compositionFirstChange&&(s+=".start",i.inputState.compositionFirstChange=!1)),n.update(r,{userEvent:s,scrollIntoView:!0})}function Ax(i,t,e,r){let n=Math.min(i.length,t.length),o=0;for(;o<n&&i.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==n&&i.length==t.length)return null;let s=i.length,l=t.length;for(;s>0&&l>0&&i.charCodeAt(s-1)==t.charCodeAt(l-1);)s--,l--;if(r=="end"){let a=Math.max(0,o-Math.min(s,l));e-=s+a-o}if(s<o&&i.length<t.length){let a=e<=o&&e>=s?o-e:0;o-=a,l=o+(l-s),s=o}else if(l<o){let a=e<=o&&e>=l?o-e:0;o-=a,s=o+(s-l),l=o}return{from:o,toA:s,toB:l}}function Mx(i){let t=[];if(i.root.activeElement!=i.contentDOM)return t;let{anchorNode:e,anchorOffset:r,focusNode:n,focusOffset:o}=i.observer.selectionRange;return e&&(t.push(new cm(e,r)),(n!=e||o!=r)&&t.push(new cm(n,o))),t}function Cx(i,t){if(i.length==0)return null;let e=i[0].pos,r=i.length==2?i[1].pos:e;return e>-1&&r>-1?O.single(e+t,r+t):null}class Lx{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,z.safari&&t.contentDOM.addEventListener("input",()=>null),z.gecko&&jx(t.contentDOM.ownerDocument)}handleEvent(t){!Nx(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||this.runHandlers(t.type,t)}runHandlers(t,e){let r=this.handlers[t];if(r){for(let n of r.observers)n(this.view,e);for(let n of r.handlers){if(e.defaultPrevented)break;if(n(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=_x(t),r=this.handlers,n=this.view.contentDOM;for(let o in e)if(o!="scroll"){let s=!e[o].handlers.length,l=r[o];l&&s!=!l.handlers.length&&(n.removeEventListener(o,this.handleEvent),l=null),l||n.addEventListener(o,this.handleEvent,{passive:s})}for(let o in r)o!="scroll"&&!e[o]&&n.removeEventListener(o,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&fm.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),z.android&&z.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return z.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=dm.find(r=>r.keyCode==t.keyCode))&&!t.ctrlKey||Ex.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Or(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:z.safari&&!z.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function um(i,t){return(e,r)=>{try{return t.call(i,r,e)}catch(n){ue(e.state,n)}}}function _x(i){let t=Object.create(null);function e(r){return t[r]||(t[r]={observers:[],handlers:[]})}for(let r of i){let n=r.spec;if(n&&n.domEventHandlers)for(let o in n.domEventHandlers){let s=n.domEventHandlers[o];s&&e(o).handlers.push(um(r.value,s))}if(n&&n.domEventObservers)for(let o in n.domEventObservers){let s=n.domEventObservers[o];s&&e(o).observers.push(um(r.value,s))}}for(let r in Re)e(r).handlers.push(Re[r]);for(let r in Ae)e(r).observers.push(Ae[r]);return t}const dm=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ex="dthko",fm=[16,17,18,20,91,92,224,225],jo=6;function $o(i){return Math.max(0,i)*.7+8}function Ox(i,t){return Math.max(Math.abs(i.clientX-t.clientX),Math.abs(i.clientY-t.clientY))}class Dx{constructor(t,e,r,n){this.view=t,this.startEvent=e,this.style=r,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=Hb(t.contentDOM),this.atoms=t.state.facet(ka).map(s=>s(t));let o=t.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(ot.allowMultipleSelections)&&Px(t,e),this.dragging=Bx(t,e)&&km(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Ox(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,r=0,n=0,o=0,s=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:s}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:o,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=tm(this.view);t.clientX-a.left<=n+jo?e=-$o(n-t.clientX):t.clientX+a.right>=s-jo&&(e=$o(t.clientX-s)),t.clientY-a.top<=o+jo?r=-$o(o-t.clientY):t.clientY+a.bottom>=l-jo&&(r=$o(t.clientY-l)),this.setScrollSpeed(e,r)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let r=0;r<t.ranges.length;r++){let n=t.ranges[r],o=null;if(n.empty){let s=zo(this.atoms,n.from,0);s!=n.from&&(o=O.cursor(s,-1))}else{let s=zo(this.atoms,n.from,-1),l=zo(this.atoms,n.to,1);(s!=n.from||l!=n.to)&&(o=O.range(n.from==n.anchor?s:l,n.from==n.head?s:l))}o&&(e||(e=t.ranges.slice()),e[r]=o)}return e?O.create(e,t.mainIndex):t}select(t){let{view:e}=this,r=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!r.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Px(i,t){let e=i.state.facet(Fp);return e.length?e[0](t):z.mac?t.metaKey:t.ctrlKey}function Rx(i,t){let e=i.state.facet(Vp);return e.length?e[0](t):z.mac?!t.altKey:!t.ctrlKey}function Bx(i,t){let{main:e}=i.state.selection;if(e.empty)return!1;let r=Tn(i.root);if(!r||r.rangeCount==0)return!0;let n=r.getRangeAt(0).getClientRects();for(let o=0;o<n.length;o++){let s=n[o];if(s.left<=t.clientX&&s.right>=t.clientX&&s.top<=t.clientY&&s.bottom>=t.clientY)return!0}return!1}function Nx(i,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,r;e!=i.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(r=pt.get(e))&&r.ignoreEvent(t))return!1;return!0}const Re=Object.create(null),Ae=Object.create(null),pm=z.ie&&z.ie_version<15||z.ios&&z.webkit_version<604;function Ix(i){let t=i.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{i.focus(),e.remove(),mm(i,e.value)},50)}function qo(i,t,e){for(let r of i.facet(t))e=r(e,i);return e}function mm(i,t){t=qo(i.state,va,t);let{state:e}=i,r,n=1,o=e.toText(t),s=o.lines==e.selection.ranges.length;if(La!=null&&e.selection.ranges.every(l=>l.empty)&&La==o.toString()){let l=-1;r=e.changeByRange(a=>{let c=e.doc.lineAt(a.from);if(c.from==l)return{range:a};l=c.from;let h=e.toText((s?o.line(n++).text:t)+e.lineBreak);return{changes:{from:c.from,insert:h},range:O.cursor(a.from+h.length)}})}else s?r=e.changeByRange(l=>{let a=o.line(n++);return{changes:{from:l.from,to:l.to,insert:a.text},range:O.cursor(l.from+a.length)}}):r=e.replaceSelection(o);i.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Ae.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft},Re.keydown=(i,t)=>(i.inputState.setSelectionOrigin("select"),t.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1),Ae.touchstart=(i,t)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")},Ae.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")},Re.mousedown=(i,t)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let r of i.state.facet(Hp))if(e=r(i,t),e)break;if(!e&&t.button==0&&(e=Vx(i,t)),e){let r=!i.hasFocus;i.inputState.startMouseSelection(new Dx(i,t,e,r)),r&&i.observer.ignore(()=>{pp(i.contentDOM);let o=i.root.activeElement;o&&!o.contains(i.contentDOM)&&o.blur()});let n=i.inputState.mouseSelection;if(n)return n.start(t),n.dragging===!1}return!1};function gm(i,t,e,r){if(r==1)return O.cursor(t,e);if(r==2)return fx(i.state,t,e);{let n=Rt.find(i.docView,t),o=i.state.doc.lineAt(n?n.posAtEnd:t),s=n?n.posAtStart:o.from,l=n?n.posAtEnd:o.to;return l<i.state.doc.length&&l==o.to&&l++,O.range(s,l)}}let ym=(i,t,e)=>t>=e.top&&t<=e.bottom&&i>=e.left&&i<=e.right;function Wx(i,t,e,r){let n=Rt.find(i.docView,t);if(!n)return 1;let o=t-n.posAtStart;if(o==0)return 1;if(o==n.length)return-1;let s=n.coordsAt(o,-1);if(s&&ym(e,r,s))return-1;let l=n.coordsAt(o,1);return l&&ym(e,r,l)?1:s&&s.bottom>=r?-1:1}function vm(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:Wx(i,e,t.clientX,t.clientY)}}const Fx=z.ie&&z.ie_version<=11;let wm=null,bm=0,xm=0;function km(i){if(!Fx)return i.detail;let t=wm,e=xm;return wm=i,xm=Date.now(),bm=!t||e>Date.now()-400&&Math.abs(t.clientX-i.clientX)<2&&Math.abs(t.clientY-i.clientY)<2?(bm+1)%3:1}function Vx(i,t){let e=vm(i,t),r=km(t),n=i.state.selection;return{update(o){o.docChanged&&(e.pos=o.changes.mapPos(e.pos),n=n.map(o.changes))},get(o,s,l){let a=vm(i,o),c,h=gm(i,a.pos,a.bias,r);if(e.pos!=a.pos&&!s){let u=gm(i,e.pos,e.bias,r),d=Math.min(u.from,h.from),f=Math.max(u.to,h.to);h=d<h.from?O.range(d,f):O.range(f,d)}return s?n.replaceRange(n.main.extend(h.from,h.to)):l&&r==1&&n.ranges.length>1&&(c=Hx(n,a.pos))?c:l?n.addRange(h):O.create([h])}}}function Hx(i,t){for(let e=0;e<i.ranges.length;e++){let{from:r,to:n}=i.ranges[e];if(r<=t&&n>=t)return O.create(i.ranges.slice(0,e).concat(i.ranges.slice(e+1)),i.mainIndex==e?0:i.mainIndex-(i.mainIndex>e?1:0))}return null}Re.dragstart=(i,t)=>{let{selection:{main:e}}=i.state;if(t.target.draggable){let n=i.docView.nearest(t.target);if(n&&n.isWidget){let o=n.posAtStart,s=o+n.length;(o>=e.to||s<=e.from)&&(e=O.range(o,s))}}let{inputState:r}=i;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",qo(i.state,wa,i.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1},Re.dragend=i=>(i.inputState.draggedContent=null,!1);function Sm(i,t,e,r){if(e=qo(i.state,va,e),!e)return;let n=i.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:o}=i.inputState,s=r&&o&&Rx(i,t)?{from:o.from,to:o.to}:null,l={from:n,insert:e},a=i.state.changes(s?[s,l]:l);i.focus(),i.dispatch({changes:a,selection:{anchor:a.mapPos(n,-1),head:a.mapPos(n,1)},userEvent:s?"move.drop":"input.drop"}),i.inputState.draggedContent=null}Re.drop=(i,t)=>{if(!t.dataTransfer)return!1;if(i.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let r=Array(e.length),n=0,o=()=>{++n==e.length&&Sm(i,t,r.filter(s=>s!=null).join(i.state.lineBreak),!1)};for(let s=0;s<e.length;s++){let l=new FileReader;l.onerror=o,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(r[s]=l.result),o()},l.readAsText(e[s])}return!0}else{let r=t.dataTransfer.getData("Text");if(r)return Sm(i,t,r,!0),!0}return!1},Re.paste=(i,t)=>{if(i.state.readOnly)return!0;i.observer.flush();let e=pm?null:t.clipboardData;return e?(mm(i,e.getData("text/plain")||e.getData("text/uri-list")),!0):(Ix(i),!1)};function Ux(i,t){let e=i.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout(()=>{r.remove(),i.focus()},50)}function zx(i){let t=[],e=[],r=!1;for(let n of i.selection.ranges)n.empty||(t.push(i.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:o}of i.selection.ranges){let s=i.doc.lineAt(o);s.number>n&&(t.push(s.text),e.push({from:s.from,to:Math.min(i.doc.length,s.to+1)})),n=s.number}r=!0}return{text:qo(i,wa,t.join(i.lineBreak)),ranges:e,linewise:r}}let La=null;Re.copy=Re.cut=(i,t)=>{let{text:e,ranges:r,linewise:n}=zx(i.state);if(!e&&!n)return!1;La=n?e:null,t.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let o=pm?null:t.clipboardData;return o?(o.clearData(),o.setData("text/plain",e),!0):(Ux(i,e),!1)};const Tm=ui.define();function Am(i,t){let e=[];for(let r of i.facet(jp)){let n=r(i,t);n&&e.push(n)}return e?i.update({effects:e,annotations:Tm.of(!0)}):null}function Mm(i){setTimeout(()=>{let t=i.hasFocus;if(t!=i.inputState.notifiedFocused){let e=Am(i.state,t);e?i.dispatch(e):i.update([])}},10)}Ae.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),Mm(i)},Ae.blur=i=>{i.observer.clearSelectionRange(),Mm(i)},Ae.compositionstart=Ae.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))},Ae.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,z.chrome&&z.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))},Ae.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()},Re.beforeinput=(i,t)=>{var e,r;if(t.inputType=="insertReplacementText"&&i.observer.editContext){let o=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),s=t.getTargetRanges();if(o&&s.length){let l=s[0],a=i.posAtDOM(l.startContainer,l.startOffset),c=i.posAtDOM(l.endContainer,l.endOffset);return Ca(i,{from:a,to:c,insert:i.state.toText(o)},null),!0}}let n;if(z.chrome&&z.android&&(n=dm.find(o=>o.inputType==t.inputType))&&(i.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let o=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>o+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return z.ios&&t.inputType=="deleteContentForward"&&i.observer.flushSoon(),z.safari&&t.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>Ae.compositionend(i,t),20),!1};const Cm=new Set;function jx(i){Cm.has(i)||(Cm.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const Lm=["pre-wrap","normal","pre-line","break-spaces"];let Br=!1;function _m(){Br=!1}class $x{constructor(t){this.lineWrapping=t,this.doc=ht.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let r=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((e-t-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return Lm.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let r=0;r<t.length;r++){let n=t[r];n<0?r++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,r,n,o,s){let l=Lm.indexOf(t)>-1,a=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=e,this.charWidth=r,this.textHeight=n,this.lineLength=o,a){this.heightSamples={};for(let c=0;c<s.length;c++){let h=s[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class qx{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Ye{constructor(t,e,r,n,o){this.from=t,this.length=e,this.top=r,this.height=n,this._content=o}get type(){return typeof this._content=="number"?oe.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof _i?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new Ye(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var bt=function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i}(bt||(bt={}));const Ko=.001;class se{constructor(t,e,r=2){this.length=t,this.height=e,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Ko&&(Br=!0),this.height=t)}replace(t,e,r){return se.of(r)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,r,n){let o=this,s=r.doc;for(let l=n.length-1;l>=0;l--){let{fromA:a,toA:c,fromB:h,toB:u}=n[l],d=o.lineAt(a,bt.ByPosNoHeight,r.setDoc(e),0,0),f=d.to>=c?d:o.lineAt(c,bt.ByPosNoHeight,r,0,0);for(u+=f.to-c,c=f.to;l>0&&d.from<=n[l-1].toA;)a=n[l-1].fromA,h=n[l-1].fromB,l--,a<d.from&&(d=o.lineAt(a,bt.ByPosNoHeight,r,0,0));h+=d.from-a,a=d.from;let m=_a.build(r.setDoc(s),t,h,u);o=Yo(o,o.replace(a,c,m))}return o.updateHeight(r,0)}static empty(){return new ye(0,0)}static of(t){if(t.length==1)return t[0];let e=0,r=t.length,n=0,o=0;for(;;)if(e==r)if(n>o*2){let l=t[e-1];l.break?t.splice(--e,1,l.left,null,l.right):t.splice(--e,1,l.left,l.right),r+=1+l.break,n-=l.size}else if(o>n*2){let l=t[r];l.break?t.splice(r,1,l.left,null,l.right):t.splice(r,1,l.left,l.right),r+=2+l.break,o-=l.size}else break;else if(n<o){let l=t[e++];l&&(n+=l.size)}else{let l=t[--r];l&&(o+=l.size)}let s=0;return t[e-1]==null?(s=1,e--):t[e]==null&&(s=1,r++),new Kx(se.of(t.slice(0,e)),s,se.of(t.slice(r)))}}function Yo(i,t){return i==t?i:(i.constructor!=t.constructor&&(Br=!0),t)}se.prototype.size=1;class Em extends se{constructor(t,e,r){super(t,e),this.deco=r}blockAt(t,e,r,n){return new Ye(n,this.length,r,this.height,this.deco||0)}lineAt(t,e,r,n,o){return this.blockAt(0,r,n,o)}forEachLine(t,e,r,n,o,s){t<=o+this.length&&e>=o&&s(this.blockAt(0,r,n,o))}updateHeight(t,e=0,r=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ye extends Em{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,r,n){return new Ye(n,this.length,r,this.height,this.breaks)}replace(t,e,r){let n=r[0];return r.length==1&&(n instanceof ye||n instanceof $t&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof $t?n=new ye(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):se.of(r)}updateHeight(t,e=0,r=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class $t extends se{constructor(t){super(t,0)}heightMetrics(t,e){let r=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,o=n-r+1,s,l=0;if(t.lineWrapping){let a=Math.min(this.height,t.lineHeight*o);s=a/o,this.length>o+1&&(l=(this.height-a)/(this.length-o-1))}else s=this.height/o;return{firstLine:r,lastLine:n,perLine:s,perChar:l}}blockAt(t,e,r,n){let{firstLine:o,lastLine:s,perLine:l,perChar:a}=this.heightMetrics(e,n);if(e.lineWrapping){let c=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-r)/this.height))*this.length)),h=e.doc.lineAt(c),u=l+h.length*a,d=Math.max(r,t-u/2);return new Ye(h.from,h.length,d,u,0)}else{let c=Math.max(0,Math.min(s-o,Math.floor((t-r)/l))),{from:h,length:u}=e.doc.line(o+c);return new Ye(h,u,r+l*c,l,0)}}lineAt(t,e,r,n,o){if(e==bt.ByHeight)return this.blockAt(t,r,n,o);if(e==bt.ByPosNoHeight){let{from:f,to:m}=r.doc.lineAt(t);return new Ye(f,m-f,0,0,0)}let{firstLine:s,perLine:l,perChar:a}=this.heightMetrics(r,o),c=r.doc.lineAt(t),h=l+c.length*a,u=c.number-s,d=n+l*u+a*(c.from-o-u);return new Ye(c.from,c.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,r,n,o,s){t=Math.max(t,o),e=Math.min(e,o+this.length);let{firstLine:l,perLine:a,perChar:c}=this.heightMetrics(r,o);for(let h=t,u=n;h<=e;){let d=r.doc.lineAt(h);if(h==t){let m=d.number-l;u+=a*m+c*(t-o-m)}let f=a+c*d.length;s(new Ye(d.from,d.length,u,f,0)),u+=f,h=d.to+1}}replace(t,e,r){let n=this.length-e;if(n>0){let o=r[r.length-1];o instanceof $t?r[r.length-1]=new $t(o.length+n):r.push(null,new $t(n-1))}if(t>0){let o=r[0];o instanceof $t?r[0]=new $t(t+o.length):r.unshift(new $t(t-1),null)}return se.of(r)}decomposeLeft(t,e){e.push(new $t(t-1),null)}decomposeRight(t,e){e.push(null,new $t(this.length-t-1))}updateHeight(t,e=0,r=!1,n){let o=e+this.length;if(n&&n.from<=e+this.length&&n.more){let s=[],l=Math.max(e,n.from),a=-1;for(n.from>e&&s.push(new $t(n.from-e-1).updateHeight(t,e));l<=o&&n.more;){let h=t.doc.lineAt(l).length;s.length&&s.push(null);let u=n.heights[n.index++];a==-1?a=u:Math.abs(u-a)>=Ko&&(a=-2);let d=new ye(h,u);d.outdated=!1,s.push(d),l+=h+1}l<=o&&s.push(null,new $t(o-l).updateHeight(t,l));let c=se.of(s);return(a<0||Math.abs(c.height-this.height)>=Ko||Math.abs(a-this.heightMetrics(t,e).perLine)>=Ko)&&(Br=!0),Yo(this,c)}else(r||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Kx extends se{constructor(t,e,r){super(t.length+e+r.length,t.height+r.height,e|(t.outdated||r.outdated?2:0)),this.left=t,this.right=r,this.size=t.size+r.size}get break(){return this.flags&1}blockAt(t,e,r,n){let o=r+this.left.height;return t<o?this.left.blockAt(t,e,r,n):this.right.blockAt(t,e,o,n+this.left.length+this.break)}lineAt(t,e,r,n,o){let s=n+this.left.height,l=o+this.left.length+this.break,a=e==bt.ByHeight?t<s:t<l,c=a?this.left.lineAt(t,e,r,n,o):this.right.lineAt(t,e,r,s,l);if(this.break||(a?c.to<l:c.from>l))return c;let h=e==bt.ByPosNoHeight?bt.ByPosNoHeight:bt.ByPos;return a?c.join(this.right.lineAt(l,h,r,s,l)):this.left.lineAt(l,h,r,n,o).join(c)}forEachLine(t,e,r,n,o,s){let l=n+this.left.height,a=o+this.left.length+this.break;if(this.break)t<a&&this.left.forEachLine(t,e,r,n,o,s),e>=a&&this.right.forEachLine(t,e,r,l,a,s);else{let c=this.lineAt(a,bt.ByPos,r,n,o);t<c.from&&this.left.forEachLine(t,c.from-1,r,n,o,s),c.to>=t&&c.from<=e&&s(c),e>c.to&&this.right.forEachLine(c.to+1,e,r,l,a,s)}}replace(t,e,r){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,r),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,r));let o=[];t>0&&this.decomposeLeft(t,o);let s=o.length;for(let l of r)o.push(l);if(t>0&&Om(o,s-1),e<this.length){let l=o.length;this.decomposeRight(e,o),Om(o,l)}return se.of(o)}decomposeLeft(t,e){let r=this.left.length;if(t<=r)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(r++,t>=r&&e.push(null)),t>r&&this.right.decomposeLeft(t-r,e)}decomposeRight(t,e){let r=this.left.length,n=r+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<r&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?se.of(this.break?[t,null,e]:[t,e]):(this.left=Yo(this.left,t),this.right=Yo(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,r=!1,n){let{left:o,right:s}=this,l=e+o.length+this.break,a=null;return n&&n.from<=e+o.length&&n.more?a=o=o.updateHeight(t,e,r,n):o.updateHeight(t,e,r),n&&n.from<=l+s.length&&n.more?a=s=s.updateHeight(t,l,r,n):s.updateHeight(t,l,r),a?this.balanced(o,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Om(i,t){let e,r;i[t]==null&&(e=i[t-1])instanceof $t&&(r=i[t+1])instanceof $t&&i.splice(t-1,3,new $t(e.length+1+r.length))}const Yx=5;class _a{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let r=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof ye?n.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new ye(r-this.pos,-1)),this.writtenTo=r,e>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,r){if(t<e||r.heightRelevant){let n=r.widget?r.widget.estimatedHeight:0,o=r.widget?r.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let s=e-t;r.block?this.addBlock(new Em(s,n,r)):(s||o||n>=Yx)&&this.addLineDeco(n,o,s)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new ye(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let r=new $t(e-t);return this.oracle.doc.lineAt(t).to==e&&(r.flags|=4),r}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof ye)return t;let e=new ye(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,r){let n=this.ensureLine();n.length+=r,n.collapsed+=r,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+r}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof ye)&&!this.isCovered?this.nodes.push(new ye(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=t;for(let n of this.nodes)n instanceof ye&&n.updateHeight(this.oracle,r),r+=n?n.length:1;return this.nodes}static build(t,e,r,n){let o=new _a(r,t);return at.spans(e,r,n,o,0),o.finish(r)}}function Gx(i,t,e){let r=new Jx;return at.compare(i,t,e,r,0),r.changes}class Jx{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,r,n){(t<e||r&&r.heightRelevant||n&&n.heightRelevant)&&ua(t,e,this.changes,5)}}function Xx(i,t){let e=i.getBoundingClientRect(),r=i.ownerDocument,n=r.defaultView||window,o=Math.max(0,e.left),s=Math.min(n.innerWidth,e.right),l=Math.max(0,e.top),a=Math.min(n.innerHeight,e.bottom);for(let c=i.parentNode;c&&c!=r.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let d=h.getBoundingClientRect();o=Math.max(o,d.left),s=Math.min(s,d.right),l=Math.max(l,d.top),a=Math.min(c==i.parentNode?n.innerHeight:a,d.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:o-e.left,right:Math.max(o,s)-e.left,top:l-(e.top+t),bottom:Math.max(l,a)-(e.top+t)}}function Qx(i,t){let e=i.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class Ea{constructor(t,e,r){this.from=t,this.to=e,this.size=r}static same(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],o=e[r];if(n.from!=o.from||n.to!=o.to||n.size!=o.size)return!1}return!0}draw(t,e){return G.replace({widget:new Zx(this.size*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Zx extends fi{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Dm{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Pm,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=wt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(xa).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new $x(e),this.stateDeco=t.facet(On).filter(r=>typeof r!="function"),this.heightMap=se.empty().applyChanges(this.stateDeco,ht.empty,this.heightOracle.setDoc(t.doc),[new Te(0,0,0,t.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=G.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let r=0;r<=1;r++){let n=r?e.head:e.anchor;if(!t.some(({from:o,to:s})=>n>=o&&n<=s)){let{from:o,to:s}=this.lineBlockAt(n);t.push(new Go(o,s))}}return this.viewports=t.sort((r,n)=>r.from-n.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Pm:new Oa(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Rn(t,this.scaler))})}update(t,e=null){this.state=t.state;let r=this.stateDeco;this.stateDeco=this.state.facet(On).filter(h=>typeof h!="function");let n=t.changedRanges,o=Te.extendWithRanges(n,Gx(r,this.stateDeco,t?t.changes:Wt.empty(this.state.doc.length))),s=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);_m(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),o),(this.heightMap.height!=s||Br)&&(t.flags|=2),l?(this.scrollAnchorPos=t.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=o.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<a.from||e.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,e));let c=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(qp)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,r=window.getComputedStyle(e),n=this.heightOracle,o=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?wt.RTL:wt.LTR;let s=this.heightOracle.mustRefreshForWrapping(o),l=e.getBoundingClientRect(),a=s||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let c=0,h=0;if(l.width&&l.height){let{scaleX:S,scaleY:M}=fp(e,l);(S>.005&&Math.abs(this.scaleX-S)>.005||M>.005&&Math.abs(this.scaleY-M)>.005)&&(this.scaleX=S,this.scaleY=M,c|=8,s=a=!0)}let u=(parseInt(r.paddingTop)||0)*this.scaleY,d=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=d)&&(this.paddingTop=u,this.paddingBottom=d,c|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(a=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=8);let f=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=yp(t.scrollDOM);let m=(this.printing?Qx:Xx)(e,this.paddingTop),v=m.top-this.pixelViewport.top,p=m.bottom-this.pixelViewport.bottom;this.pixelViewport=m;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let b=l.width;if((this.contentDOMWidth!=b||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=t.scrollDOM.clientHeight,c|=8),a){let S=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(S)&&(s=!0),s||n.lineWrapping&&Math.abs(b-this.contentDOMWidth)>n.charWidth){let{lineHeight:M,charWidth:L,textHeight:A}=t.docView.measureTextSize();s=M>0&&n.refresh(o,M,L,A,b/L,S),s&&(t.docView.minWidth=0,c|=8)}v>0&&p>0?h=Math.max(v,p):v<0&&p<0&&(h=Math.min(v,p)),_m();for(let M of this.viewports){let L=M.from==this.viewport.from?S:t.docView.measureVisibleLineHeights(M);this.heightMap=(s?se.empty().applyChanges(this.stateDeco,ht.empty,this.heightOracle,[new Te(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,s,new qx(M.from,L))}Br&&(c|=2)}let k=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return k&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||k)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let r=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,o=this.heightOracle,{visibleTop:s,visibleBottom:l}=this,a=new Go(n.lineAt(s-r*1e3,bt.ByHeight,o,0,0).from,n.lineAt(l+(1-r)*1e3,bt.ByHeight,o,0,0).to);if(e){let{head:c}=e.range;if(c<a.from||c>a.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=n.lineAt(c,bt.ByPos,o,0,0),d;e.y=="center"?d=(u.top+u.bottom)/2-h/2:e.y=="start"||e.y=="nearest"&&c<a.from?d=u.top:d=u.bottom-h,a=new Go(n.lineAt(d-1e3/2,bt.ByHeight,o,0,0).from,n.lineAt(d+h+1e3/2,bt.ByHeight,o,0,0).to)}}return a}mapViewport(t,e){let r=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Go(this.heightMap.lineAt(r,bt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,bt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},r=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,bt.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(e,bt.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:l}=this;return(t==0||n<=s-Math.max(10,Math.min(-r,250)))&&(e==this.state.doc.length||o>=l+Math.max(10,Math.min(r,250)))&&n>s-2*1e3&&o<l+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let r=[];for(let n of t)e.touchesRange(n.from,n.to)||r.push(new Ea(e.mapPos(n.from),e.mapPos(n.to),n.size));return r}ensureLineGaps(t,e){let r=this.heightOracle.lineWrapping,n=r?1e4:2e3,o=n>>1,s=n<<1;if(this.defaultTextDirection!=wt.LTR&&!r)return[];let l=[],a=(h,u,d,f)=>{if(u-h<o)return;let m=this.state.selection.main,v=[m.from];m.empty||v.push(m.to);for(let y of v)if(y>h&&y<u){a(h,y-10,d,f),a(y+10,u,d,f);return}let p=e2(t,y=>y.from>=d.from&&y.to<=d.to&&Math.abs(y.from-h)<o&&Math.abs(y.to-u)<o&&!v.some(b=>y.from<b&&y.to>b));if(!p){if(u<d.to&&e&&r&&e.visibleRanges.some(y=>y.from<=u&&y.to>=u)){let y=e.moveToLineBoundary(O.cursor(u),!1,!0).head;y>h&&(u=y)}p=new Ea(h,u,this.gapSize(d,h,u,f))}l.push(p)},c=h=>{if(h.length<s||h.type!=oe.Text)return;let u=t2(h.from,h.to,this.stateDeco);if(u.total<s)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,f,m;if(r){let v=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,p,y;if(d!=null){let b=Xo(u,d),k=((this.visibleBottom-this.visibleTop)/2+v)/h.height;p=b-k,y=b+k}else p=(this.visibleTop-h.top-v)/h.height,y=(this.visibleBottom-h.top+v)/h.height;f=Jo(u,p),m=Jo(u,y)}else{let v=u.total*this.heightOracle.charWidth,p=n*this.heightOracle.charWidth,y,b;if(d!=null){let k=Xo(u,d),S=((this.pixelViewport.right-this.pixelViewport.left)/2+p)/v;y=k-S,b=k+S}else y=(this.pixelViewport.left-p)/v,b=(this.pixelViewport.right+p)/v;f=Jo(u,y),m=Jo(u,b)}f>h.from&&a(h.from,f,h,u),m<h.to&&a(m,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return l}gapSize(t,e,r,n){let o=Xo(n,r)-Xo(n,e);return this.heightOracle.lineWrapping?t.height*o:n.total*this.heightOracle.charWidth*o}updateLineGaps(t){Ea.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=G.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];at.spans(t,this.viewport.from,this.viewport.to,{span(n,o){e.push({from:n,to:o})},point(){}},20);let r=e.length!=this.visibleRanges.length||this.visibleRanges.some((n,o)=>n.from!=e[o].from||n.to!=e[o].to);return this.visibleRanges=e,r?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||Rn(this.heightMap.lineAt(t,bt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||Rn(this.heightMap.lineAt(this.scaler.fromDOM(t),bt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Rn(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Go{constructor(t,e){this.from=t,this.to=e}}function t2(i,t,e){let r=[],n=i,o=0;return at.spans(e,i,t,{span(){},point(s,l){s>n&&(r.push({from:n,to:s}),o+=s-n),n=l}},20),n<t&&(r.push({from:n,to:t}),o+=t-n),{total:o,ranges:r}}function Jo({total:i,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let r=Math.floor(i*e);for(let n=0;;n++){let{from:o,to:s}=t[n],l=s-o;if(r<=l)return o+r;r-=l}}function Xo(i,t){let e=0;for(let{from:r,to:n}of i.ranges){if(t<=n){e+=t-r;break}e+=n-r}return e/i.total}function e2(i,t){for(let e of i)if(t(e))return e}const Pm={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};class Oa{constructor(t,e,r){let n=0,o=0,s=0;this.viewports=r.map(({from:l,to:a})=>{let c=e.lineAt(l,bt.ByPos,t,0,0).top,h=e.lineAt(a,bt.ByPos,t,0,0).bottom;return n+=h-c,{from:l,to:a,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let l of this.viewports)l.domTop=s+(l.top-o)*this.scale,s=l.domBottom=l.domTop+(l.bottom-l.top),o=l.bottom}toDOM(t){for(let e=0,r=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.top)return n+(t-r)*this.scale;if(t<=o.bottom)return o.domTop+(t-o.top);r=o.bottom,n=o.domBottom}}fromDOM(t){for(let e=0,r=0,n=0;;e++){let o=e<this.viewports.length?this.viewports[e]:null;if(!o||t<o.domTop)return r+(t-n)/this.scale;if(t<=o.domBottom)return o.top+(t-o.domTop);r=o.bottom,n=o.domBottom}}eq(t){return t instanceof Oa?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,r)=>e.from==t.viewports[r].from&&e.to==t.viewports[r].to):!1}}function Rn(i,t){if(t.scale==1)return i;let e=t.toDOM(i.top),r=t.toDOM(i.bottom);return new Ye(i.from,i.length,e,r-e,Array.isArray(i._content)?i._content.map(n=>Rn(n,t)):i._content)}const Qo=U.define({combine:i=>i.join(" ")}),Da=U.define({combine:i=>i.indexOf(!0)>-1}),Pa=Mi.newName(),Rm=Mi.newName(),Bm=Mi.newName(),Nm={"&light":"."+Rm,"&dark":"."+Bm};function Ra(i,t,e){return new Mi(t,{finish(r){return/&/.test(r)?r.replace(/&\w*/,n=>{if(n=="&")return i;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):i+" "+r}})}const i2=Ra("."+Pa,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Nm),r2={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ba=z.ie&&z.ie_version<=11;class n2{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new Ub,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let r of e)this.queue.push(r);(z.ie&&z.ie_version<=11||z.ios&&t.composing)&&e.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&t.constructor.EDIT_CONTEXT!==!1&&!(z.chrome&&z.chrome_version<126)&&(this.editContext=new s2(t),t.state.facet(Oi)&&(t.contentDOM.editContext=this.editContext.editContext)),Ba&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,r)=>e!=t[r]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,n=this.selectionRange;if(r.state.facet(Oi)?r.root.activeElement!=this.dom:!No(this.dom,n))return;let o=n.anchorNode&&r.docView.nearest(n.anchorNode);if(o&&o.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(z.ie&&z.ie_version<=11||z.android&&z.chrome)&&!r.state.selection.main.empty&&n.focusNode&&An(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Tn(t.root);if(!e)return!1;let r=z.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&o2(this.view,e)||e;if(!r||this.selectionRange.eq(r))return!1;let n=No(this.dom,r);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&jb(this.dom,r)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(r),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let r=this.dom;r;)if(r.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==r?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=e)r.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,r2),Ba&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ba&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var r;if(!this.delayedAndroidKey){let n=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=o.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&o.force&&Or(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,r=-1,n=!1;for(let o of t){let s=this.readMutation(o);s&&(s.typeOver&&(n=!0),e==-1?{from:e,to:r}=s:(e=Math.min(s.from,e),r=Math.max(s.to,r)))}return{from:e,to:r,typeOver:n}}readChange(){let{from:t,to:e,typeOver:r}=this.processRecords(),n=this.selectionChanged&&No(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let o=new Sx(this.view,t,e,r);return this.view.docView.domChanged={newSel:o.newSel?o.newSel.main:null},o}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let r=this.view.state,n=hm(this.view,e);return this.view.state==r&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let r=Im(e,t.previousSibling||t.target.previousSibling,-1),n=Im(e,t.nextSibling||t.target.nextSibling,1);return{from:r?e.posAfter(r):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Oi)!=t.state.facet(Oi)&&(t.view.contentDOM.editContext=t.state.facet(Oi)?this.editContext.editContext:null))}destroy(){var t,e,r;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Im(i,t,e){for(;t;){let r=pt.get(t);if(r&&r.parent==i)return r;let n=t.parentNode;t=n!=i.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function Wm(i,t){let e=t.startContainer,r=t.startOffset,n=t.endContainer,o=t.endOffset,s=i.docView.domAtPos(i.state.selection.main.anchor);return An(s.node,s.offset,n,o)&&([e,r,n,o]=[n,o,e,r]),{anchorNode:e,anchorOffset:r,focusNode:n,focusOffset:o}}function o2(i,t){if(t.getComposedRanges){let n=t.getComposedRanges(i.root)[0];if(n)return Wm(i,n)}let e=null;function r(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",r,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",r,!0),e?Wm(i,e):null}class s2{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=r=>{let{anchor:n}=t.state.selection.main,o={from:this.toEditorPos(r.updateRangeStart),to:this.toEditorPos(r.updateRangeEnd),insert:ht.of(r.text.split(`
`))};o.from==this.from&&n<this.from?o.from=n:o.to==this.to&&n>this.to&&(o.to=n),!(o.from==o.to&&!o.insert.length)&&(this.pendingContextChange=o,t.state.readOnly||Ca(t,o,O.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd))),this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state)))},this.handlers.characterboundsupdate=r=>{let n=[],o=null;for(let s=this.toEditorPos(r.rangeStart),l=this.toEditorPos(r.rangeEnd);s<l;s++){let a=t.coordsForChar(s);o=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||o||new DOMRect,n.push(o)}e.updateCharacterBounds(r.rangeStart,n)},this.handlers.textformatupdate=r=>{let n=[];for(let o of r.getTextFormats()){let s=o.underlineStyle,l=o.underlineThickness;if(s!="None"&&l!="None"){let a=`text-decoration: underline ${s=="Dashed"?"dashed ":s=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;n.push(G.mark({attributes:{style:a}}).range(this.toEditorPos(o.rangeStart),this.toEditorPos(o.rangeEnd)))}}t.dispatch({effects:Yp.of(G.set(n))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{t.inputState.composing=-1,t.inputState.compositionFirstChange=null};for(let r in this.handlers)e.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let n=Tn(r.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,r=!1,n=this.pendingContextChange;return t.changes.iterChanges((o,s,l,a,c)=>{if(r)return;let h=c.length-(s-o);if(n&&s>=n.to)if(n.from==o&&n.to==s&&n.insert.eq(c)){n=this.pendingContextChange=null,e+=h,this.to+=h;return}else n=null,this.revertPending(t.state);if(o+=e,s+=e,s<=this.from)this.from+=h,this.to+=h;else if(o<this.to){if(o<this.from||s>this.to||this.to-this.from+c.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(o),this.toContextPos(s),c.toString()),this.to+=h}e+=h}),n&&!r&&this.revertPending(t.state),!r}update(t){let e=this.pendingContextChange;!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.resetRange(t.state),this.editContext.updateText(0,this.editContext.text.length,t.state.doc.sliceString(this.from,this.to)),this.setSelection(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(r,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t){return t+this.from}toContextPos(t){return t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class V{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:r}=t;this.dispatchTransactions=t.dispatchTransactions||r&&(n=>n.forEach(o=>r(o,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||zb(t.parent)||document,this.viewState=new Dm(t.state||ot.create(t)),t.scrollTo&&t.scrollTo.is(Ho)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(En).map(n=>new ba(n));for(let n of this.plugins)n.update(this);this.observer=new n2(this),this.inputState=new Lx(this),this.inputState.ensureHandlers(this.plugins),this.docView=new em(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof Ft?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,r=!1,n,o=this.state;for(let d of t){if(d.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=d.state}if(this.destroyed){this.viewState.state=o;return}let s=this.hasFocus,l=0,a=null;t.some(d=>d.annotation(Tm))?(this.inputState.notifiedFocused=s,l=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,a=Am(o,s),a||(l=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(h=null)):this.observer.clear(),o.facet(ot.phrases)!=this.state.facet(ot.phrases))return this.setState(o);n=Uo.create(this,o,t),n.flags|=l;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let d of t){if(u&&(u=u.map(d.changes)),d.scrollIntoView){let{main:f}=d.state.selection;u=new Rr(f.empty?f:O.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of d.effects)f.is(Ho)&&(u=f.value.clip(this.state))}this.viewState.update(n,u),this.bidiCache=Zo.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(Dn)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(Qo)!=n.state.facet(Qo)&&(this.viewState.mustMeasureContent=!0),(e||r||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let d of this.state.facet(ya))try{d(n)}catch(f){ue(this.state,f,"update listener")}(a||h)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),h&&!hm(this,h)&&c.force&&Or(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Dm(t),this.plugins=t.facet(En).map(r=>new ba(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new em(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(En),r=t.state.facet(En);if(e!=r){let n=[];for(let o of r){let s=e.indexOf(o);if(s<0)n.push(new ba(o));else{let l=this.plugins[s];l.mustUpdate=t,n.push(l)}}for(let o of this.plugins)o.mustUpdate!=t&&o.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);e!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(r){ue(this.state,r,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,r=this.scrollDOM,n=r.scrollTop*this.scaleY,{scrollAnchorPos:o,scrollAnchorHeight:s}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(s<0)if(yp(r))o=-1,s=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(n);o=f.from,s=f.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];a&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(f=>{try{return f.read(this)}catch(m){return ue(this.state,m),Fm}}),u=Uo.create(this,this.state,[]),d=!1;u.flags|=a,e?e.flags|=a:e=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),d=this.docView.update(u),d&&this.docViewUpdate());for(let f=0;f<c.length;f++)if(h[f]!=Fm)try{let m=c[f];m.write&&m.write(h[f],this)}catch(m){ue(this.state,m)}if(d&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}else{let f=(o<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(o).top)-s;if(f>1||f<-1){n=n+f,r.scrollTop=n/this.scaleY,s=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let l of this.state.facet(ya))l(e)}get themeClasses(){return Pa+" "+(this.state.facet(Da)?Bm:Rm)+" "+this.state.facet(Qo)}updateAttrs(){let t=Vm(this,Gp,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Oi)?"true":"false",class:"cm-content",style:`${z.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Vm(this,xa,e);let r=this.observer.ignore(()=>{let n=ha(this.contentDOM,this.contentAttrs,e),o=ha(this.dom,this.editorAttrs,t);return n||o});return this.editorAttrs=t,this.contentAttrs=e,r}showAnnouncements(t){let e=!0;for(let r of t)for(let n of r.effects)if(n.is(V.announce)){e&&(this.announceDOM.textContent=""),e=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(Dn);let t=this.state.facet(V.cspNonce);Mi.mount(this.root,this.styleModules.concat(i2).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(r=>r.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,r){return Ma(this,t,am(this,t,e,r))}moveByGroup(t,e){return Ma(this,t,am(this,t,e,r=>wx(this,t.head,r)))}visualLineSide(t,e){let r=this.bidiSpans(t),n=this.textDirectionAt(t.from),o=r[e?r.length-1:0];return O.cursor(o.side(e,n)+t.from,o.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,r=!0){return vx(this,t,e,r)}moveVertically(t,e,r){return Ma(this,t,bx(this,t,e,r))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),sm(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let r=this.docView.coordsAt(t,e);if(!r||r.left==r.right)return r;let n=this.state.doc.lineAt(t),o=this.bidiSpans(n),s=o[Ei.find(o,t-n.from,-1,e)];return Mn(r,s.dir==wt.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet($p)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>l2)return Ip(t.length);let e=this.textDirectionAt(t.from),r;for(let o of this.bidiCache)if(o.from==t.from&&o.dir==e&&(o.fresh||Np(o.isolates,r=Qp(this,t))))return o.order;r||(r=Qp(this,t));let n=ix(t.text,e,r);return this.bidiCache.push(new Zo(t.from,t.to,e,r,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||z.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{pp(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Ho.of(new Rr(typeof t=="number"?O.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,r=this.viewState.scrollAnchorAt(t);return Ho.of(new Rr(O.cursor(r.from),"start","start",r.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return _t.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return _t.define(()=>({}),{eventObservers:t})}static theme(t,e){let r=Mi.newName(),n=[Qo.of(r),Dn.of(Ra(`.${r}`,t))];return e&&e.dark&&n.push(Da.of(!0)),n}static baseTheme(t){return Ji.lowest(Dn.of(Ra("."+Pa,t,Nm)))}static findFromDOM(t){var e;let r=t.querySelector(".cm-content"),n=r&&pt.get(r)||pt.get(t);return((e=n==null?void 0:n.rootView)===null||e===void 0?void 0:e.view)||null}}V.styleModule=Dn,V.inputHandler=zp,V.clipboardInputFilter=va,V.clipboardOutputFilter=wa,V.scrollHandler=Kp,V.focusChangeEffect=jp,V.perLineTextDirection=$p,V.exceptionSink=Up,V.updateListener=ya,V.editable=Oi,V.mouseSelectionStyle=Hp,V.dragMovesSelection=Vp,V.clickAddsSelectionRange=Fp,V.decorations=On,V.outerDecorations=Jp,V.atomicRanges=ka,V.bidiIsolatedRanges=Xp,V.scrollMargins=Zp,V.darkTheme=Da,V.cspNonce=U.define({combine:i=>i.length?i[0]:""}),V.contentAttributes=xa,V.editorAttributes=Gp,V.lineWrapping=V.contentAttributes.of({class:"cm-lineWrapping"}),V.announce=tt.define();const l2=4096,Fm={};class Zo{constructor(t,e,r,n,o,s){this.from=t,this.to=e,this.dir=r,this.isolates=n,this.fresh=o,this.order=s}static update(t,e){if(e.empty&&!t.some(o=>o.fresh))return t;let r=[],n=t.length?t[t.length-1].dir:wt.LTR;for(let o=Math.max(0,t.length-10);o<t.length;o++){let s=t[o];s.dir==n&&!e.touchesRange(s.from,s.to)&&r.push(new Zo(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.isolates,!1,s.order))}return r}}function Vm(i,t,e){for(let r=i.state.facet(t),n=r.length-1;n>=0;n--){let o=r[n],s=typeof o=="function"?o(i):o;s&&ca(s,e)}return e}const a2=z.mac?"mac":z.windows?"win":z.linux?"linux":"key";function c2(i,t){const e=i.split(/-(?!$)/);let r=e[e.length-1];r=="Space"&&(r=" ");let n,o,s,l;for(let a=0;a<e.length-1;++a){const c=e[a];if(/^(cmd|meta|m)$/i.test(c))l=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))s=!0;else if(/^mod$/i.test(c))t=="mac"?l=!0:o=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(r="Alt-"+r),o&&(r="Ctrl-"+r),l&&(r="Meta-"+r),s&&(r="Shift-"+r),r}function ts(i,t,e){return t.altKey&&(i="Alt-"+i),t.ctrlKey&&(i="Ctrl-"+i),t.metaKey&&(i="Meta-"+i),e!==!1&&t.shiftKey&&(i="Shift-"+i),i}const h2=Ji.default(V.domEventHandlers({keydown(i,t){return zm(Um(t.state),i,t,"editor")}})),es=U.define({enables:h2}),Hm=new WeakMap;function Um(i){let t=i.facet(es),e=Hm.get(t);return e||Hm.set(t,e=f2(t.reduce((r,n)=>r.concat(n),[]))),e}function u2(i,t,e){return zm(Um(i.state),t,i,e)}let Di=null;const d2=4e3;function f2(i,t=a2){let e=Object.create(null),r=Object.create(null),n=(s,l)=>{let a=r[s];if(a==null)r[s]=l;else if(a!=l)throw new Error("Key binding "+s+" is used both as a regular binding and as a multi-stroke prefix")},o=(s,l,a,c,h)=>{var u,d;let f=e[s]||(e[s]=Object.create(null)),m=l.split(/ (?!$)/).map(y=>c2(y,t));for(let y=1;y<m.length;y++){let b=m.slice(0,y).join(" ");n(b,!0),f[b]||(f[b]={preventDefault:!0,stopPropagation:!1,run:[k=>{let S=Di={view:k,prefix:b,scope:s};return setTimeout(()=>{Di==S&&(Di=null)},d2),!0}]})}let v=m.join(" ");n(v,!1);let p=f[v]||(f[v]={preventDefault:!1,stopPropagation:!1,run:((d=(u=f._any)===null||u===void 0?void 0:u.run)===null||d===void 0?void 0:d.slice())||[]});a&&p.run.push(a),c&&(p.preventDefault=!0),h&&(p.stopPropagation=!0)};for(let s of i){let l=s.scope?s.scope.split(" "):["editor"];if(s.any)for(let c of l){let h=e[c]||(e[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=s;for(let d in h)h[d].run.push(f=>u(f,Na))}let a=s[t]||s.key;if(a)for(let c of l)o(c,a,s.run,s.preventDefault,s.stopPropagation),s.shift&&o(c,"Shift-"+a,s.shift,s.preventDefault,s.stopPropagation)}return e}let Na=null;function zm(i,t,e,r){Na=t;let n=Wb(t),o=Ut(n,0),s=Se(o)==n.length&&n!=" ",l="",a=!1,c=!1,h=!1;Di&&Di.view==e&&Di.scope==r&&(l=Di.prefix+" ",fm.indexOf(t.keyCode)<0&&(c=!0,Di=null));let u=new Set,d=p=>{if(p){for(let y of p.run)if(!u.has(y)&&(u.add(y),y(e)))return p.stopPropagation&&(h=!0),!0;p.preventDefault&&(p.stopPropagation&&(h=!0),c=!0)}return!1},f=i[r],m,v;return f&&(d(f[l+ts(n,t,!s)])?a=!0:s&&(t.altKey||t.metaKey||t.ctrlKey)&&!(z.windows&&t.ctrlKey&&t.altKey)&&(m=Ci[t.keyCode])&&m!=n?(d(f[l+ts(m,t,!0)])||t.shiftKey&&(v=Sn[t.keyCode])!=n&&v!=m&&d(f[l+ts(v,t,!1)]))&&(a=!0):s&&t.shiftKey&&d(f[l+ts(n,t,!0)])&&(a=!0),!a&&d(f._any)&&(a=!0)),c&&(a=!0),a&&h&&t.stopPropagation(),Na=null,a}class Bn{constructor(t,e,r,n,o){this.className=t,this.left=e,this.top=r,this.width=n,this.height=o}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,r){if(r.empty){let n=t.coordsAtPos(r.head,r.assoc||1);if(!n)return[];let o=jm(t);return[new Bn(e,n.left-o.left,n.top-o.top,null,n.bottom-n.top)]}else return p2(t,e,r)}}function jm(i){let t=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==wt.LTR?t.left:t.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:t.top-i.scrollDOM.scrollTop*i.scaleY}}function $m(i,t,e,r){let n=i.coordsAtPos(t,e*2);if(!n)return r;let o=i.dom.getBoundingClientRect(),s=(n.top+n.bottom)/2,l=i.posAtCoords({x:o.left+1,y:s}),a=i.posAtCoords({x:o.right-1,y:s});return l==null||a==null?r:{from:Math.max(r.from,Math.min(l,a)),to:Math.min(r.to,Math.max(l,a))}}function p2(i,t,e){if(e.to<=i.viewport.from||e.from>=i.viewport.to)return[];let r=Math.max(e.from,i.viewport.from),n=Math.min(e.to,i.viewport.to),o=i.textDirection==wt.LTR,s=i.contentDOM,l=s.getBoundingClientRect(),a=jm(i),c=s.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=l.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),d=l.right-(h?parseInt(h.paddingRight):0),f=Aa(i,r),m=Aa(i,n),v=f.type==oe.Text?f:null,p=m.type==oe.Text?m:null;if(v&&(i.lineWrapping||f.widgetLineBreaks)&&(v=$m(i,r,1,v)),p&&(i.lineWrapping||m.widgetLineBreaks)&&(p=$m(i,n,-1,p)),v&&p&&v.from==p.from&&v.to==p.to)return b(k(e.from,e.to,v));{let M=v?k(e.from,null,v):S(f,!1),L=p?k(null,e.to,p):S(m,!0),A=[];return(v||f).to<(p||m).from-(v&&p?1:0)||f.widgetLineBreaks>1&&M.bottom+i.defaultLineHeight/2<L.top?A.push(y(u,M.bottom,d,L.top)):M.bottom<L.top&&i.elementAtHeight((M.bottom+L.top)/2).type==oe.Text&&(M.bottom=L.top=(M.bottom+L.top)/2),b(M).concat(A).concat(b(L))}function y(M,L,A,P){return new Bn(t,M-a.left,L-a.top-.01,A-M,P-L+.01)}function b({top:M,bottom:L,horizontal:A}){let P=[];for(let B=0;B<A.length;B+=2)P.push(y(A[B],M,A[B+1],L));return P}function k(M,L,A){let P=1e9,B=-1e9,Y=[];function q(J,K,nt,St,ft){let Et=i.coordsAtPos(J,J==A.to?-2:2),Tt=i.coordsAtPos(nt,nt==A.from?2:-2);!Et||!Tt||(P=Math.min(Et.top,Tt.top,P),B=Math.max(Et.bottom,Tt.bottom,B),ft==wt.LTR?Y.push(o&&K?u:Et.left,o&&St?d:Tt.right):Y.push(!o&&St?u:Tt.left,!o&&K?d:Et.right))}let j=M??A.from,$=L??A.to;for(let J of i.visibleRanges)if(J.to>j&&J.from<$)for(let K=Math.max(J.from,j),nt=Math.min(J.to,$);;){let St=i.state.doc.lineAt(K);for(let ft of i.bidiSpans(St)){let Et=ft.from+St.from,Tt=ft.to+St.from;if(Et>=nt)break;Tt>K&&q(Math.max(Et,K),M==null&&Et<=j,Math.min(Tt,nt),L==null&&Tt>=$,ft.dir)}if(K=St.to+1,K>=nt)break}return Y.length==0&&q(j,M==null,$,L==null,i.textDirection),{top:P,bottom:B,horizontal:Y}}function S(M,L){let A=l.top+(L?M.top:M.bottom);return{top:A,bottom:A,horizontal:[]}}}function m2(i,t){return i.constructor==t.constructor&&i.eq(t)}class g2{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(is)!=t.state.facet(is)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,r=t.facet(is);for(;e<r.length&&r[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((e,r)=>!m2(e,this.drawn[r]))){let e=this.dom.firstChild,r=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[r].constructor&&n.update(e,this.drawn[r])?(e=e.nextSibling,r++):this.dom.insertBefore(n.draw(),e);for(;e;){let n=e.nextSibling;e.remove(),e=n}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const is=U.define();function qm(i){return[_t.define(t=>new g2(t,i)),is.of(i)]}const Km=!z.ios,Nn=U.define({combine(i){return $e(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function y2(i={}){return[Nn.of(i),v2,w2,b2,qp.of(!0)]}function Ym(i){return i.startState.facet(Nn)!=i.state.facet(Nn)}const v2=qm({above:!0,markers(i){let{state:t}=i,e=t.facet(Nn),r=[];for(let n of t.selection.ranges){let o=n==t.selection.main;if(n.empty?!o||Km:e.drawRangeCursor){let s=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=n.empty?n:O.cursor(n.head,n.head>n.anchor?-1:1);for(let a of Bn.forRange(i,s,l))r.push(a)}}return r},update(i,t){i.transactions.some(r=>r.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=Ym(i);return e&&Gm(i.state,t),i.docChanged||i.selectionSet||e},mount(i,t){Gm(t.state,i)},class:"cm-cursorLayer"});function Gm(i,t){t.style.animationDuration=i.facet(Nn).cursorBlinkRate+"ms"}const w2=qm({above:!1,markers(i){return i.state.selection.ranges.map(t=>t.empty?[]:Bn.forRange(i,"cm-selectionBackground",t)).reduce((t,e)=>t.concat(e))},update(i,t){return i.docChanged||i.selectionSet||i.viewportChanged||Ym(i)},class:"cm-selectionLayer"}),Ia={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};Km&&(Ia[".cm-line"].caretColor=Ia[".cm-content"].caretColor="transparent !important");const b2=Ji.highest(V.theme(Ia)),Jm=tt.define({map(i,t){return i==null?null:t.mapPos(i)}}),In=zt.define({create(){return null},update(i,t){return i!=null&&(i=t.changes.mapPos(i)),t.effects.reduce((e,r)=>r.is(Jm)?r.value:e,i)}}),x2=_t.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var t;let e=i.state.field(In);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(In)!=e||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:i}=this,t=i.state.field(In),e=t!=null&&i.coordsAtPos(t);if(!e)return null;let r=i.scrollDOM.getBoundingClientRect();return{left:e.left-r.left+i.scrollDOM.scrollLeft*i.scaleX,top:e.top-r.top+i.scrollDOM.scrollTop*i.scaleY,height:e.bottom-e.top}}drawCursor(i){if(this.cursor){let{scaleX:t,scaleY:e}=this.view;i?(this.cursor.style.left=i.left/t+"px",this.cursor.style.top=i.top/e+"px",this.cursor.style.height=i.height/e+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(In)!=i&&this.view.dispatch({effects:Jm.of(i)})}},{eventObservers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function k2(){return[In,x2]}function Xm(i,t,e,r,n){t.lastIndex=0;for(let o=i.iterRange(e,r),s=e,l;!o.next().done;s+=o.value.length)if(!o.lineBreak)for(;l=t.exec(o.value);)n(s+l.index,l)}function S2(i,t){let e=i.visibleRanges;if(e.length==1&&e[0].from==i.viewport.from&&e[0].to==i.viewport.to)return e;let r=[];for(let{from:n,to:o}of e)n=Math.max(i.state.doc.lineAt(n).from,n-t),o=Math.min(i.state.doc.lineAt(o).to,o+t),r.length&&r[r.length-1].to>=n?r[r.length-1].to=o:r.push({from:n,to:o});return r}class T2{constructor(t){const{regexp:e,decoration:r,decorate:n,boundary:o,maxLength:s=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(l,a,c,h)=>n(h,c,c+l[0].length,l,a);else if(typeof r=="function")this.addMatch=(l,a,c,h)=>{let u=r(l,a,c);u&&h(c,c+l[0].length,u)};else if(r)this.addMatch=(l,a,c,h)=>h(c,c+l[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=s}createDeco(t){let e=new Ai,r=e.add.bind(e);for(let{from:n,to:o}of S2(t,this.maxLength))Xm(t.state.doc,this.regexp,n,o,(s,l)=>this.addMatch(l,t,s,r));return e.finish()}updateDeco(t,e){let r=1e9,n=-1;return t.docChanged&&t.changes.iterChanges((o,s,l,a)=>{a>t.view.viewport.from&&l<t.view.viewport.to&&(r=Math.min(l,r),n=Math.max(a,n))}),t.viewportChanged||n-r>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),r,n):e}updateRange(t,e,r,n){for(let o of t.visibleRanges){let s=Math.max(o.from,r),l=Math.min(o.to,n);if(l>s){let a=t.state.doc.lineAt(s),c=a.to<l?t.state.doc.lineAt(l):a,h=Math.max(o.from,a.from),u=Math.min(o.to,c.to);if(this.boundary){for(;s>a.from;s--)if(this.boundary.test(a.text[s-1-a.from])){h=s;break}for(;l<c.to;l++)if(this.boundary.test(c.text[l-c.from])){u=l;break}}let d=[],f,m=(v,p,y)=>d.push(y.range(v,p));if(a==c)for(this.regexp.lastIndex=h-a.from;(f=this.regexp.exec(a.text))&&f.index<u-a.from;)this.addMatch(f,t,f.index+a.from,m);else Xm(t.state.doc,this.regexp,h,u,(v,p)=>this.addMatch(p,t,v,m));e=e.update({filterFrom:h,filterTo:u,filter:(v,p)=>v<h||p>u,add:d})}}return e}}const Wa=/x/.unicode!=null?"gu":"g",A2=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Wa),M2={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Fa=null;function C2(){var i;if(Fa==null&&typeof document<"u"&&document.body){let t=document.body.style;Fa=((i=t.tabSize)!==null&&i!==void 0?i:t.MozTabSize)!=null}return Fa||!1}const rs=U.define({combine(i){let t=$e(i,{render:null,specialChars:A2,addSpecialChars:null});return(t.replaceTabs=!C2())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,Wa)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Wa)),t}});function L2(i={}){return[rs.of(i),_2()]}let Qm=null;function _2(){return Qm||(Qm=_t.fromClass(class{constructor(i){this.view=i,this.decorations=G.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(rs)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new T2({regexp:i.specialChars,decoration:(t,e,r)=>{let{doc:n}=e.state,o=Ut(t[0],0);if(o==9){let s=n.lineAt(r),l=e.state.tabSize,a=Lr(s.text,l,r-s.from);return G.replace({widget:new P2((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=G.replace({widget:new D2(i,o)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let t=i.state.facet(rs);i.startState.facet(rs)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const E2="\u2022";function O2(i){return i>=32?E2:i==10?"\u2424":String.fromCharCode(9216+i)}class D2 extends fi{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=O2(this.code),r=t.state.phrase("Control character")+" "+(M2[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,r,e);if(n)return n;let o=document.createElement("span");return o.textContent=e,o.title=r,o.setAttribute("aria-label",r),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class P2 extends fi{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function R2(){return N2}const B2=G.line({class:"cm-activeLine"}),N2=_t.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=-1,e=[];for(let r of i.state.selection.ranges){let n=i.lineBlockAt(r.head);n.from>t&&(e.push(B2.range(n.from)),t=n.from)}return G.set(e)}},{decorations:i=>i.decorations});class I2 extends fi{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?_r(t.firstChild):[];if(!e.length)return null;let r=window.getComputedStyle(t.parentNode),n=Mn(e[0],r.direction!="rtl"),o=parseInt(r.lineHeight);return n.bottom-n.top>o*1.5?{left:n.left,right:n.right,top:n.top,bottom:n.top+o}:n}ignoreEvent(){return!1}}function W2(i){return _t.fromClass(class{constructor(t){this.view=t,this.placeholder=i?G.set([G.widget({widget:new I2(i),side:1}).range(0)]):G.none}get decorations(){return this.view.state.doc.length?G.none:this.placeholder}},{decorations:t=>t.decorations})}const Va=2e3;function F2(i,t,e){let r=Math.min(t.line,e.line),n=Math.max(t.line,e.line),o=[];if(t.off>Va||e.off>Va||t.col<0||e.col<0){let s=Math.min(t.off,e.off),l=Math.max(t.off,e.off);for(let a=r;a<=n;a++){let c=i.doc.line(a);c.length<=l&&o.push(O.range(c.from+s,c.to+l))}}else{let s=Math.min(t.col,e.col),l=Math.max(t.col,e.col);for(let a=r;a<=n;a++){let c=i.doc.line(a),h=Zl(c.text,s,i.tabSize,!0);if(h<0)o.push(O.cursor(c.to));else{let u=Zl(c.text,l,i.tabSize);o.push(O.range(c.from+h,c.from+u))}}}return o}function V2(i,t){let e=i.coordsAtPos(i.viewport.from);return e?Math.round(Math.abs((e.left-t)/i.defaultCharacterWidth)):-1}function Zm(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1),r=i.state.doc.lineAt(e),n=e-r.from,o=n>Va?-1:n==r.length?V2(i,t.clientX):Lr(r.text,i.state.tabSize,e-r.from);return{line:r.number,col:o,off:n}}function H2(i,t){let e=Zm(i,t),r=i.state.selection;return e?{update(n){if(n.docChanged){let o=n.changes.mapPos(n.startState.doc.line(e.line).from),s=n.state.doc.lineAt(o);e={line:s.number,col:e.col,off:Math.min(e.off,s.length)},r=r.map(n.changes)}},get(n,o,s){let l=Zm(i,n);if(!l)return r;let a=F2(i.state,e,l);return a.length?s?O.create(a.concat(r.ranges)):O.create(a):r}}:null}function U2(i){let t=e=>e.altKey&&e.button==0;return V.mouseSelectionStyle.of((e,r)=>t(r)?H2(e,r):null)}const z2={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},j2={style:"cursor: crosshair"};function $2(i={}){let[t,e]=z2[i.key||"Alt"],r=_t.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventObservers:{keydown(n){this.set(n.keyCode==t||e(n))},keyup(n){(n.keyCode==t||!e(n))&&this.set(!1)},mousemove(n){this.set(e(n))}}});return[r,V.contentAttributes.of(n=>{var o;return!((o=n.plugin(r))===null||o===void 0)&&o.isDown?j2:null})]}const Wn="-10000px";class tg{constructor(t,e,r,n){this.facet=e,this.createTooltipView=r,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(s=>s);let o=null;this.tooltipViews=this.tooltips.map(s=>o=r(s,o))}update(t,e){var r;let n=t.state.facet(this.facet),o=n.filter(a=>a);if(n===this.input){for(let a of this.tooltipViews)a.update&&a.update(t);return!1}let s=[],l=e?[]:null;for(let a=0;a<o.length;a++){let c=o[a],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let d=this.tooltips[u];d&&d.create==c.create&&(h=u)}if(h<0)s[a]=this.createTooltipView(c,a?s[a-1]:null),l&&(l[a]=!!c.above);else{let u=s[a]=this.tooltipViews[h];l&&(l[a]=e[h]),u.update&&u.update(t)}}}for(let a of this.tooltipViews)s.indexOf(a)<0&&(this.removeTooltipView(a),(r=a.destroy)===null||r===void 0||r.call(a));return e&&(l.forEach((a,c)=>e[c]=a),e.length=l.length),this.input=n,this.tooltips=o,this.tooltipViews=s,!0}}function q2(i){let{win:t}=i;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const Ha=U.define({combine:i=>{var t,e,r;return{position:z.ios?"absolute":((t=i.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=i.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((r=i.find(n=>n.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||q2}}}),eg=new WeakMap,Ua=_t.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=i.state.facet(Ha);this.position=t.position,this.parent=t.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new tg(i,za,(e,r)=>this.createTooltip(e,r),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(i,this.above);t&&this.observeIntersection();let e=t||i.geometryChanged,r=i.state.facet(Ha);if(r.position!=this.position&&!this.madeAbsolute){this.position=r.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(i,t){let e=i.create(this.view),r=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),i.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Wn,e.dom.style.left="0px",this.container.insertBefore(e.dom,r),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var i,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(i=r.destroy)===null||i===void 0||i.call(r);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=this.view.dom.getBoundingClientRect(),t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:n}=this.manager.tooltipViews[0];if(z.gecko)r=n.offsetParent!=this.container.ownerDocument.body;else if(n.style.top==Wn&&n.style.left=="0px"){let o=n.getBoundingClientRect();r=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(r||this.position=="absolute")if(this.parent){let n=this.parent.getBoundingClientRect();n.width&&n.height&&(t=n.width/this.parent.offsetWidth,e=n.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);return{editor:i,parent:this.parent?this.container.getBoundingClientRect():i,pos:this.manager.tooltips.map((n,o)=>{let s=this.manager.tooltipViews[o];return s.getCoords?s.getCoords(n.pos):this.view.coordsAtPos(n.pos)}),size:this.manager.tooltipViews.map(({dom:n})=>n.getBoundingClientRect()),space:this.view.state.facet(Ha).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(i){var t;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{editor:e,space:r,scaleX:n,scaleY:o}=i,s=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],c=this.manager.tooltipViews[l],{dom:h}=c,u=i.pos[l],d=i.size[l];if(!u||u.bottom<=Math.max(e.top,r.top)||u.top>=Math.min(e.bottom,r.bottom)||u.right<Math.max(e.left,r.left)-.1||u.left>Math.min(e.right,r.right)+.1){h.style.top=Wn;continue}let f=a.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,m=f?7:0,v=d.right-d.left,p=(t=eg.get(c))!==null&&t!==void 0?t:d.bottom-d.top,y=c.offset||Y2,b=this.view.textDirection==wt.LTR,k=d.width>r.right-r.left?b?r.left:r.right-d.width:b?Math.max(r.left,Math.min(u.left-(f?14:0)+y.x,r.right-v)):Math.min(Math.max(r.left,u.left-v+(f?14:0)-y.x),r.right-v),S=this.above[l];!a.strictSide&&(S?u.top-(d.bottom-d.top)-y.y<r.top:u.bottom+(d.bottom-d.top)+y.y>r.bottom)&&S==r.bottom-u.bottom>u.top-r.top&&(S=this.above[l]=!S);let M=(S?u.top-r.top:r.bottom-u.bottom)-m;if(M<p&&c.resize!==!1){if(M<this.view.defaultLineHeight){h.style.top=Wn;continue}eg.set(c,p),h.style.height=(p=M)/o+"px"}else h.style.height&&(h.style.height="");let L=S?u.top-p-m-y.y:u.bottom+m+y.y,A=k+v;if(c.overlap!==!0)for(let P of s)P.left<A&&P.right>k&&P.top<L+p&&P.bottom>L&&(L=S?P.top-p-2-m:P.bottom+m+2);if(this.position=="absolute"?(h.style.top=(L-i.parent.top)/o+"px",h.style.left=(k-i.parent.left)/n+"px"):(h.style.top=L/o+"px",h.style.left=k/n+"px"),f){let P=u.left+(b?y.x:-y.x)-(k+14-7);f.style.left=P/n+"px"}c.overlap!==!0&&s.push({left:k,top:L,right:A,bottom:L+p}),h.classList.toggle("cm-tooltip-above",S),h.classList.toggle("cm-tooltip-below",!S),c.positioned&&c.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Wn}},{eventObservers:{scroll(){this.maybeMeasure()}}}),K2=V.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Y2={x:0,y:0},za=U.define({enables:[Ua,K2]}),ns=U.define({combine:i=>i.reduce((t,e)=>t.concat(e),[])});class os{static create(t){return new os(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new tg(t,ns,(e,r)=>this.createHostedView(e,r),e=>e.dom.remove())}createHostedView(t,e){let r=t.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let r of this.manager.tooltipViews){let n=r[t];if(n!==void 0){if(e===void 0)e=n;else if(e!==n)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const G2=za.compute([ns],i=>{let t=i.facet(ns);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var r;return(r=e.end)!==null&&r!==void 0?r:e.pos})),create:os.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class J2{constructor(t,e,r,n,o){this.view=t,this.source=e,this.field=r,this.setHover=n,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,r=t.docView.nearest(e.target);if(!r)return;let n,o=1;if(r instanceof Li)n=r.posAtStart;else{if(n=t.posAtCoords(e),n==null)return;let l=t.coordsAtPos(n);if(!l||e.y<l.top||e.y>l.bottom||e.x<l.left-t.defaultCharacterWidth||e.x>l.right+t.defaultCharacterWidth)return;let a=t.bidiSpans(t.state.doc.lineAt(n)).find(h=>h.from<=n&&h.to>=n),c=a&&a.dir==wt.RTL?-1:1;o=e.x<l.left?-c:c}let s=this.source(t,n,o);if(s!=null&&s.then){let l=this.pending={pos:n};s.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>ue(t.state,a,"hover tooltip"))}else s&&!(Array.isArray(s)&&!s.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(s)?s:[s])})}get tooltip(){let t=this.view.plugin(Ua),e=t?t.manager.tooltips.findIndex(r=>r.create==os.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,r;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:o}=this;if(n.length&&o&&!X2(o.dom,t)||this.pending){let{pos:s}=n[0]||this.pending,l=(r=(e=n[0])===null||e===void 0?void 0:e.end)!==null&&r!==void 0?r:s;(s==l?this.view.posAtCoords(this.lastMove)!=s:!Q2(this.view,s,l,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:r}=this;r&&r.dom.contains(t.relatedTarget)?this.watchTooltipLeave(r.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=r=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const ss=4;function X2(i,t){let{left:e,right:r,top:n,bottom:o}=i.getBoundingClientRect(),s;if(s=i.querySelector(".cm-tooltip-arrow")){let l=s.getBoundingClientRect();n=Math.min(l.top,n),o=Math.max(l.bottom,o)}return t.clientX>=e-ss&&t.clientX<=r+ss&&t.clientY>=n-ss&&t.clientY<=o+ss}function Q2(i,t,e,r,n,o){let s=i.scrollDOM.getBoundingClientRect(),l=i.documentTop+i.documentPadding.top+i.contentHeight;if(s.left>r||s.right<r||s.top>n||Math.min(s.bottom,l)<n)return!1;let a=i.posAtCoords({x:r,y:n},!1);return a>=t&&a<=e}function Z2(i,t={}){let e=tt.define(),r=zt.define({create(){return[]},update(n,o){if(n.length&&(t.hideOnChange&&(o.docChanged||o.selection)?n=[]:t.hideOn&&(n=n.filter(s=>!t.hideOn(o,s))),o.docChanged)){let s=[];for(let l of n){let a=o.changes.mapPos(l.pos,-1,ne.TrackDel);if(a!=null){let c=Object.assign(Object.create(null),l);c.pos=a,c.end!=null&&(c.end=o.changes.mapPos(c.end)),s.push(c)}}n=s}for(let s of o.effects)s.is(e)&&(n=s.value),s.is(tk)&&(n=[]);return n},provide:n=>ns.from(n)});return{active:r,extension:[r,_t.define(n=>new J2(n,i,r,e,t.hoverTime||300)),G2]}}function ig(i,t){let e=i.plugin(Ua);if(!e)return null;let r=e.manager.tooltips.indexOf(t);return r<0?null:e.manager.tooltipViews[r]}const tk=tt.define(),rg=U.define({combine(i){let t,e;for(let r of i)t=t||r.topContainer,e=e||r.bottomContainer;return{topContainer:t,bottomContainer:e}}});function Fn(i,t){let e=i.plugin(ng),r=e?e.specs.indexOf(t):-1;return r>-1?e.panels[r]:null}const ng=_t.fromClass(class{constructor(i){this.input=i.state.facet(Vn),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(i));let t=i.state.facet(rg);this.top=new ls(i,!0,t.topContainer),this.bottom=new ls(i,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(i){let t=i.state.facet(rg);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new ls(i.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new ls(i.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=i.state.facet(Vn);if(e!=this.input){let r=e.filter(a=>a),n=[],o=[],s=[],l=[];for(let a of r){let c=this.specs.indexOf(a),h;c<0?(h=a(i.view),l.push(h)):(h=this.panels[c],h.update&&h.update(i)),n.push(h),(h.top?o:s).push(h)}this.specs=r,this.panels=n,this.top.sync(o),this.bottom.sync(s);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let r of this.panels)r.update&&r.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>V.scrollMargins.of(t=>{let e=t.plugin(i);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class ls{constructor(t,e,r){this.view=t,this.top=e,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=og(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=og(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function og(i){let t=i.nextSibling;return i.remove(),t}const Vn=U.define({enables:ng});class mi extends Xi{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}mi.prototype.elementClass="",mi.prototype.toDOM=void 0,mi.prototype.mapMode=ne.TrackBefore,mi.prototype.startSide=mi.prototype.endSide=-1,mi.prototype.point=!0;const as=U.define(),ek=U.define(),ik={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>at.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Hn=U.define();function rk(i){return[lg(),Hn.of(Object.assign(Object.assign({},ik),i))]}const sg=U.define({combine:i=>i.some(t=>t)});function lg(i){return[nk]}const nk=_t.fromClass(class{constructor(i){this.view=i,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(Hn).map(t=>new cg(i,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!i.state.facet(sg),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}update(i){if(this.updateGutters(i)){let t=this.prevViewport,e=i.view.viewport,r=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(r<(e.to-e.from)*.8)}i.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(sg)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=i.view.viewport}syncGutters(i){let t=this.dom.nextSibling;i&&this.dom.remove();let e=at.iter(this.view.state.facet(as),this.view.viewport.from),r=[],n=this.gutters.map(o=>new ok(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(o.type)){let s=!0;for(let l of o.type)if(l.type==oe.Text&&s){ja(e,r,l.from);for(let a of n)a.line(this.view,l,r);s=!1}else if(l.widget)for(let a of n)a.widget(this.view,l)}else if(o.type==oe.Text){ja(e,r,o.from);for(let s of n)s.line(this.view,o,r)}else if(o.widget)for(let s of n)s.widget(this.view,o);for(let o of n)o.finish();i&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(i){let t=i.startState.facet(Hn),e=i.state.facet(Hn),r=i.docChanged||i.heightChanged||i.viewportChanged||!at.eq(i.startState.facet(as),i.state.facet(as),i.view.viewport.from,i.view.viewport.to);if(t==e)for(let n of this.gutters)n.update(i)&&(r=!0);else{r=!0;let n=[];for(let o of e){let s=t.indexOf(o);s<0?n.push(new cg(this.view,o)):(this.gutters[s].update(i),n.push(this.gutters[s]))}for(let o of this.gutters)o.dom.remove(),n.indexOf(o)<0&&o.destroy();for(let o of n)this.dom.appendChild(o.dom);this.gutters=n}return r}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove()}},{provide:i=>V.scrollMargins.of(t=>{let e=t.plugin(i);return!e||e.gutters.length==0||!e.fixed?null:t.textDirection==wt.LTR?{left:e.dom.offsetWidth*t.scaleX}:{right:e.dom.offsetWidth*t.scaleX}})});function ag(i){return Array.isArray(i)?i:[i]}function ja(i,t,e){for(;i.value&&i.from<=e;)i.from==e&&t.push(i.value),i.next()}class ok{constructor(t,e,r){this.gutter=t,this.height=r,this.i=0,this.cursor=at.iter(t.markers,e.from)}addElement(t,e,r){let{gutter:n}=this,o=(e.top-this.height)/t.scaleY,s=e.height/t.scaleY;if(this.i==n.elements.length){let l=new hg(t,s,o,r);n.elements.push(l),n.dom.appendChild(l.dom)}else n.elements[this.i].update(t,s,o,r);this.height=e.bottom,this.i++}line(t,e,r){let n=[];ja(this.cursor,n,e.from),r.length&&(n=n.concat(r));let o=this.gutter.config.lineMarker(t,e,n);o&&n.unshift(o);let s=this.gutter;n.length==0&&!s.config.renderEmptyElements||this.addElement(t,e,n)}widget(t,e){let r=this.gutter.config.widgetMarker(t,e.widget,e),n=r?[r]:null;for(let o of t.state.facet(ek)){let s=o(t,e.widget,e);s&&(n||(n=[])).push(s)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class cg{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in e.domEventHandlers)this.dom.addEventListener(r,n=>{let o=n.target,s;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let a=o.getBoundingClientRect();s=(a.top+a.bottom)/2}else s=n.clientY;let l=t.lineBlockAtHeight(s-t.documentTop);e.domEventHandlers[r](t,l,n)&&n.preventDefault()});this.markers=ag(e.markers(t)),e.initialSpacer&&(this.spacer=new hg(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=ag(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],t);n!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[n])}let r=t.view.viewport;return!at.eq(this.markers,e,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class hg{constructor(t,e,r,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,r,n)}update(t,e,r,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),sk(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let r="cm-gutterElement",n=this.dom.firstChild;for(let o=0,s=0;;){let l=s,a=o<e.length?e[o++]:null,c=!1;if(a){let h=a.elementClass;h&&(r+=" "+h);for(let u=s;u<this.markers.length;u++)if(this.markers[u].compare(a)){l=u,c=!0;break}}else l=this.markers.length;for(;s<l;){let h=this.markers[s++];if(h.toDOM){h.destroy(n);let u=n.nextSibling;n.remove(),n=u}}if(!a)break;a.toDOM&&(c?n=n.nextSibling:this.dom.insertBefore(a.toDOM(t),n)),c&&s++}this.dom.className=r,this.markers=e}destroy(){this.setMarkers(null,[])}}function sk(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(!i[e].compare(t[e]))return!1;return!0}const lk=U.define(),ak=U.define(),Nr=U.define({combine(i){return $e(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let r=Object.assign({},t);for(let n in e){let o=r[n],s=e[n];r[n]=o?(l,a,c)=>o(l,a,c)||s(l,a,c):s}return r}})}});class $a extends mi{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function qa(i,t){return i.state.facet(Nr).formatNumber(t,i.state)}const ck=Hn.compute([Nr],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(lk)},lineMarker(t,e,r){return r.some(n=>n.toDOM)?null:new $a(qa(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,r)=>{for(let n of t.state.facet(ak)){let o=n(t,e,r);if(o)return o}return null},lineMarkerChange:t=>t.startState.facet(Nr)!=t.state.facet(Nr),initialSpacer(t){return new $a(qa(t,ug(t.state.doc.lines)))},updateSpacer(t,e){let r=qa(e.view,ug(e.view.state.doc.lines));return r==t.number?t:new $a(r)},domEventHandlers:i.facet(Nr).domEventHandlers}));function hk(i={}){return[Nr.of(i),lg(),ck]}function ug(i){let t=9;for(;t<i;)t=t*10+9;return t}const uk=new class extends mi{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},dk=as.compute(["selection"],i=>{let t=[],e=-1;for(let r of i.selection.ranges){let n=i.doc.lineAt(r.head).from;n>e&&(e=n,t.push(uk.range(n)))}return at.of(t)});function fk(){return dk}const pk=1024;let mk=0;class Ka{constructor(t,e){this.from=t,this.to=e}}class lt{constructor(t={}){this.id=mk++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Me.match(t)),e=>{let r=t(e);return r===void 0?null:[this,r]}}}lt.closedBy=new lt({deserialize:i=>i.split(" ")}),lt.openedBy=new lt({deserialize:i=>i.split(" ")}),lt.group=new lt({deserialize:i=>i.split(" ")}),lt.isolate=new lt({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}}),lt.contextHash=new lt({perNode:!0}),lt.lookAhead=new lt({perNode:!0}),lt.mounted=new lt({perNode:!0});class cs{constructor(t,e,r){this.tree=t,this.overlay=e,this.parser=r}static get(t){return t&&t.props&&t.props[lt.mounted.id]}}const gk=Object.create(null);class Me{constructor(t,e,r,n=0){this.name=t,this.props=e,this.id=r,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):gk,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new Me(t.name||"",e,t.id,r);if(t.props){for(let o of t.props)if(Array.isArray(o)||(o=o(n)),o){if(o[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[o[0].id]=o[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(lt.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let r in t)for(let n of r.split(" "))e[n]=t[r];return r=>{for(let n=r.prop(lt.group),o=-1;o<(n?n.length:0);o++){let s=e[o<0?r.name:n[o]];if(s)return s}}}}Me.none=new Me("",Object.create(null),0,8);const hs=new WeakMap,dg=new WeakMap;var qt;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(qt||(qt={}));class Zt{constructor(t,e,r,n,o){if(this.type=t,this.children=e,this.positions=r,this.length=n,this.props=null,o&&o.length){this.props=Object.create(null);for(let[s,l]of o)this.props[typeof s=="number"?s:s.id]=l}}toString(){let t=cs.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let r of this.children){let n=r.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new Ja(this.topNode,t)}cursorAt(t,e=0,r=0){let n=hs.get(this)||this.topNode,o=new Ja(n);return o.moveTo(t,e),hs.set(this,o._tree),o}get topNode(){return new Ce(this,0,0,null)}resolve(t,e=0){let r=Un(hs.get(this)||this.topNode,t,e,!1);return hs.set(this,r),r}resolveInner(t,e=0){let r=Un(dg.get(this)||this.topNode,t,e,!0);return dg.set(this,r),r}resolveStack(t,e=0){return wk(this,t,e)}iterate(t){let{enter:e,leave:r,from:n=0,to:o=this.length}=t,s=t.mode||0,l=(s&qt.IncludeAnonymous)>0;for(let a=this.cursor(s|qt.IncludeAnonymous);;){let c=!1;if(a.from<=o&&a.to>=n&&(!l&&a.type.isAnonymous||e(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&r&&(l||!a.type.isAnonymous)&&r(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:Qa(Me.none,this.children,this.positions,0,this.children.length,0,this.length,(e,r,n)=>new Zt(this.type,e,r,n,this.propValues),t.makeTree||((e,r,n)=>new Zt(Me.none,e,r,n)))}static build(t){return bk(t)}}Zt.empty=new Zt(Me.none,[],[],0);class Ya{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ya(this.buffer,this.index)}}class Pi{constructor(t,e,r){this.buffer=t,this.length=e,this.set=r}get type(){return Me.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],r=this.buffer[t+3],n=this.set.types[e],o=n.name;if(/\W/.test(o)&&!n.isError&&(o=JSON.stringify(o)),t+=4,r==t)return o;let s=[];for(;t<r;)s.push(this.childString(t)),t=this.buffer[t+3];return o+"("+s.join(",")+")"}findChild(t,e,r,n,o){let{buffer:s}=this,l=-1;for(let a=t;a!=e&&!(fg(o,n,s[a+1],s[a+2])&&(l=a,r>0));a=s[a+3]);return l}slice(t,e,r){let n=this.buffer,o=new Uint16Array(e-t),s=0;for(let l=t,a=0;l<e;){o[a++]=n[l++],o[a++]=n[l++]-r;let c=o[a++]=n[l++]-r;o[a++]=n[l++]-t,s=Math.max(s,c)}return new Pi(o,s,this.set)}}function fg(i,t,e,r){switch(i){case-2:return e<t;case-1:return r>=t&&e<t;case 0:return e<t&&r>t;case 1:return e<=t&&r>t;case 2:return r>t;case 4:return!0}}function Un(i,t,e,r){for(var n;i.from==i.to||(e<1?i.from>=t:i.from>t)||(e>-1?i.to<=t:i.to<t);){let s=!r&&i instanceof Ce&&i.index<0?null:i.parent;if(!s)return i;i=s}let o=r?0:qt.IgnoreOverlays;if(r)for(let s=i,l=s.parent;l;s=l,l=s.parent)s instanceof Ce&&s.index<0&&((n=l.enter(t,e,o))===null||n===void 0?void 0:n.from)!=s.from&&(i=l);for(;;){let s=i.enter(t,e,o);if(!s)return i;i=s}}class pg{cursor(t=0){return new Ja(this,t)}getChild(t,e=null,r=null){let n=mg(this,t,e,r);return n.length?n[0]:null}getChildren(t,e=null,r=null){return mg(this,t,e,r)}resolve(t,e=0){return Un(this,t,e,!1)}resolveInner(t,e=0){return Un(this,t,e,!0)}matchContext(t){return Ga(this,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),r=this;for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(r=e,e=n.prevSibling):e=n}return r}get node(){return this}get next(){return this.parent}}class Ce extends pg{constructor(t,e,r,n){super(),this._tree=t,this.from=e,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,r,n,o=0){for(let s=this;;){for(let{children:l,positions:a}=s._tree,c=e>0?l.length:-1;t!=c;t+=e){let h=l[t],u=a[t]+s.from;if(fg(n,r,u,u+h.length)){if(h instanceof Pi){if(o&qt.ExcludeBuffers)continue;let d=h.findChild(0,h.buffer.length,e,r-u,n);if(d>-1)return new Ri(new yk(s,h,t,u),null,d)}else if(o&qt.IncludeAnonymous||!h.type.isAnonymous||Xa(h)){let d;if(!(o&qt.IgnoreMounts)&&(d=cs.get(h))&&!d.overlay)return new Ce(d.tree,u,t,s);let f=new Ce(h,u,t,s);return o&qt.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(e<0?h.children.length-1:0,e,r,n)}}}if(o&qt.IncludeAnonymous||!s.type.isAnonymous||(s.index>=0?t=s.index+e:t=e<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,r=0){let n;if(!(r&qt.IgnoreOverlays)&&(n=cs.get(this._tree))&&n.overlay){let o=t-this.from;for(let{from:s,to:l}of n.overlay)if((e>0?s<=o:s<o)&&(e<0?l>=o:l>o))return new Ce(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,r)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function mg(i,t,e,r){let n=i.cursor(),o=[];if(!n.firstChild())return o;if(e!=null){for(let s=!1;!s;)if(s=n.type.is(e),!n.nextSibling())return o}for(;;){if(r!=null&&n.type.is(r))return o;if(n.type.is(t)&&o.push(n.node),!n.nextSibling())return r==null?o:[]}}function Ga(i,t,e=t.length-1){for(let r=i.parent;e>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(t[e]&&t[e]!=r.name)return!1;e--}}return!0}class yk{constructor(t,e,r,n){this.parent=t,this.buffer=e,this.index=r,this.start=n}}class Ri extends pg{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,r){super(),this.context=t,this._parent=e,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]]}child(t,e,r){let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,r);return o<0?null:new Ri(this.context,this,o)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,r=0){if(r&qt.ExcludeBuffers)return null;let{buffer:n}=this.context,o=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return o<0?null:new Ri(this.context,this,o)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Ri(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new Ri(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:r}=this.context,n=this.index+4,o=r.buffer[this.index+3];if(o>n){let s=r.buffer[this.index+1];t.push(r.slice(n,o,s)),e.push(0)}return new Zt(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function gg(i){if(!i.length)return null;let t=0,e=i[0];for(let o=1;o<i.length;o++){let s=i[o];(s.from>e.from||s.to<e.to)&&(e=s,t=o)}let r=e instanceof Ce&&e.index<0?null:e.parent,n=i.slice();return r?n[t]=r:n.splice(t,1),new vk(n,e)}class vk{constructor(t,e){this.heads=t,this.node=e}get next(){return gg(this.heads)}}function wk(i,t,e){let r=i.resolveInner(t,e),n=null;for(let o=r instanceof Ce?r:r.context.parent;o;o=o.parent)if(o.index<0){let s=o.parent;(n||(n=[r])).push(s.resolve(t,e)),o=s}else{let s=cs.get(o.tree);if(s&&s.overlay&&s.overlay[0].from<=t&&s.overlay[s.overlay.length-1].to>=t){let l=new Ce(s.tree,s.overlay[0].from+o.from,-1,o);(n||(n=[r])).push(Un(l,t,e,!1))}}return n?gg(n):r}class Ja{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Ce)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let r=t._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:r,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=r+n.buffer[t+1],this.to=r+n.buffer[t+2],!0}yield(t){return t?t instanceof Ce?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,r){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,r,this.mode));let{buffer:n}=this.buffer,o=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,r);return o<0?!1:(this.stack.push(this.index),this.yieldBuf(o))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,r=this.mode){return this.buffer?r&qt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&qt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&qt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,r=this.stack.length-1;if(t<0){let n=r<0?0:this.stack[r]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(r<0?e.buffer.length:e.buffer[this.stack[r]+3]))return this.yieldBuf(n)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,r,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let o=0;o<this.index;o++)if(n.buffer.buffer[o+3]<this.index)return!1;({index:e,parent:r}=n)}else({index:e,_parent:r}=this._tree);for(;r;{index:e,_parent:r}=r)if(e>-1)for(let o=e+t,s=t<0?-1:r._tree.children.length;o!=s;o+=t){let l=r._tree.children[o];if(this.mode&qt.IncludeAnonymous||l instanceof Pi||!l.type.isAnonymous||Xa(l))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,r=0;if(t&&t.context==this.buffer)t:for(let n=this.index,o=this.stack.length;o>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,r=o+1;break t}n=this.stack[--o]}for(let n=r;n<this.stack.length;n++)e=new Ri(this.buffer,e,this.stack[n]);return this.bufferNode=new Ri(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let r=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,n=!0}}}matchContext(t){if(!this.buffer)return Ga(this.node,t);let{buffer:e}=this.buffer,{types:r}=e.set;for(let n=t.length-1,o=this.stack.length-1;n>=0;o--){if(o<0)return Ga(this.node,t,n);let s=r[e.buffer[this.stack[o]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function Xa(i){return i.children.some(t=>t instanceof Pi||!t.type.isAnonymous||Xa(t))}function bk(i){var t;let{buffer:e,nodeSet:r,maxBufferLength:n=pk,reused:o=[],minRepeatType:s=r.types.length}=i,l=Array.isArray(e)?new Ya(e,e.length):e,a=r.types,c=0,h=0;function u(M,L,A,P,B,Y){let{id:q,start:j,end:$,size:J}=l,K=h;for(;J<0;)if(l.next(),J==-1){let Tt=o[q];A.push(Tt),P.push(j-M);return}else if(J==-3){c=q;return}else if(J==-4){h=q;return}else throw new RangeError(`Unrecognized record size: ${J}`);let nt=a[q],St,ft,Et=j-M;if($-j<=n&&(ft=p(l.pos-L,B))){let Tt=new Uint16Array(ft.size-ft.skip),Yt=l.pos-ft.size,pe=Tt.length;for(;l.pos>Yt;)pe=y(ft.start,Tt,pe);St=new Pi(Tt,$-ft.start,r),Et=ft.start-M}else{let Tt=l.pos-J;l.next();let Yt=[],pe=[],Ne=q>=s?q:-1,ii=0,Hi=$;for(;l.pos>Tt;)Ne>=0&&l.id==Ne&&l.size>=0?(l.end<=Hi-n&&(m(Yt,pe,j,ii,l.end,Hi,Ne,K),ii=Yt.length,Hi=l.end),l.next()):Y>2500?d(j,Tt,Yt,pe):u(j,Tt,Yt,pe,Ne,Y+1);if(Ne>=0&&ii>0&&ii<Yt.length&&m(Yt,pe,j,ii,j,Hi,Ne,K),Yt.reverse(),pe.reverse(),Ne>-1&&ii>0){let Yr=f(nt);St=Qa(nt,Yt,pe,0,Yt.length,0,$-j,Yr,Yr)}else St=v(nt,Yt,pe,$-j,K-$)}A.push(St),P.push(Et)}function d(M,L,A,P){let B=[],Y=0,q=-1;for(;l.pos>L;){let{id:j,start:$,end:J,size:K}=l;if(K>4)l.next();else{if(q>-1&&$<q)break;q<0&&(q=J-n),B.push(j,$,J),Y++,l.next()}}if(Y){let j=new Uint16Array(Y*4),$=B[B.length-2];for(let J=B.length-3,K=0;J>=0;J-=3)j[K++]=B[J],j[K++]=B[J+1]-$,j[K++]=B[J+2]-$,j[K++]=K;A.push(new Pi(j,B[2]-$,r)),P.push($-M)}}function f(M){return(L,A,P)=>{let B=0,Y=L.length-1,q,j;if(Y>=0&&(q=L[Y])instanceof Zt){if(!Y&&q.type==M&&q.length==P)return q;(j=q.prop(lt.lookAhead))&&(B=A[Y]+q.length+j)}return v(M,L,A,P,B)}}function m(M,L,A,P,B,Y,q,j){let $=[],J=[];for(;M.length>P;)$.push(M.pop()),J.push(L.pop()+A-B);M.push(v(r.types[q],$,J,Y-B,j-Y)),L.push(B-A)}function v(M,L,A,P,B=0,Y){if(c){let q=[lt.contextHash,c];Y=Y?[q].concat(Y):[q]}if(B>25){let q=[lt.lookAhead,B];Y=Y?[q].concat(Y):[q]}return new Zt(M,L,A,P,Y)}function p(M,L){let A=l.fork(),P=0,B=0,Y=0,q=A.end-n,j={size:0,start:0,skip:0};t:for(let $=A.pos-M;A.pos>$;){let J=A.size;if(A.id==L&&J>=0){j.size=P,j.start=B,j.skip=Y,Y+=4,P+=4,A.next();continue}let K=A.pos-J;if(J<0||K<$||A.start<q)break;let nt=A.id>=s?4:0,St=A.start;for(A.next();A.pos>K;){if(A.size<0)if(A.size==-3)nt+=4;else break t;else A.id>=s&&(nt+=4);A.next()}B=St,P+=J,Y+=nt}return(L<0||P==M)&&(j.size=P,j.start=B,j.skip=Y),j.size>4?j:void 0}function y(M,L,A){let{id:P,start:B,end:Y,size:q}=l;if(l.next(),q>=0&&P<s){let j=A;if(q>4){let $=l.pos-(q-4);for(;l.pos>$;)A=y(M,L,A)}L[--A]=j,L[--A]=Y-M,L[--A]=B-M,L[--A]=P}else q==-3?c=P:q==-4&&(h=P);return A}let b=[],k=[];for(;l.pos>0;)u(i.start||0,i.bufferStart||0,b,k,-1,0);let S=(t=i.length)!==null&&t!==void 0?t:b.length?k[0]+b[0].length:0;return new Zt(a[i.topID],b.reverse(),k.reverse(),S)}const yg=new WeakMap;function us(i,t){if(!i.isAnonymous||t instanceof Pi||t.type!=i)return 1;let e=yg.get(t);if(e==null){e=1;for(let r of t.children){if(r.type!=i||!(r instanceof Zt)){e=1;break}e+=us(i,r)}yg.set(t,e)}return e}function Qa(i,t,e,r,n,o,s,l,a){let c=0;for(let m=r;m<n;m++)c+=us(i,t[m]);let h=Math.ceil(c*1.5/8),u=[],d=[];function f(m,v,p,y,b){for(let k=p;k<y;){let S=k,M=v[k],L=us(i,m[k]);for(k++;k<y;k++){let A=us(i,m[k]);if(L+A>=h)break;L+=A}if(k==S+1){if(L>h){let A=m[S];f(A.children,A.positions,0,A.children.length,v[S]+b);continue}u.push(m[S])}else{let A=v[k-1]+m[k-1].length-M;u.push(Qa(i,m,v,S,k,M,A,null,a))}d.push(M+b-o)}}return f(t,e,r,n,0),(l||a)(u,d,s)}class er{constructor(t,e,r,n,o=!1,s=!1){this.from=t,this.to=e,this.tree=r,this.offset=n,this.open=(o?1:0)|(s?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],r=!1){let n=[new er(0,t.length,t,0,!1,r)];for(let o of e)o.to>t.length&&n.push(o);return n}static applyChanges(t,e,r=128){if(!e.length)return t;let n=[],o=1,s=t.length?t[0]:null;for(let l=0,a=0,c=0;;l++){let h=l<e.length?e[l]:null,u=h?h.fromA:1e9;if(u-a>=r)for(;s&&s.from<u;){let d=s;if(a>=d.from||u<=d.to||c){let f=Math.max(d.from,a)-c,m=Math.min(d.to,u)-c;d=f>=m?null:new er(f,m,d.tree,d.offset+c,l>0,!!h)}if(d&&n.push(d),s.to>u)break;s=o<t.length?t[o++]:null}if(!h)break;a=h.toA,c=h.toA-h.toB}return n}}class xk{startParse(t,e,r){return typeof t=="string"&&(t=new kk(t)),r=r?r.length?r.map(n=>new Ka(n.from,n.to)):[new Ka(0,0)]:[new Ka(0,t.length)],this.createParse(t,e||[],r)}parse(t,e,r){let n=this.startParse(t,e,r);for(;;){let o=n.advance();if(o)return o}}}class kk{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new lt({perNode:!0});let Sk=0;class Le{constructor(t,e,r,n){this.name=t,this.set=e,this.base=r,this.modified=n,this.id=Sk++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let r=typeof t=="string"?t:"?";if(t instanceof Le&&(e=t),e==null?void 0:e.base)throw new Error("Can not derive from a modified tag");let n=new Le(r,[],null,[]);if(n.set.push(n),e)for(let o of e.set)n.set.push(o);return n}static defineModifier(t){let e=new ds(t);return r=>r.modified.indexOf(e)>-1?r:ds.get(r.base||r,r.modified.concat(e).sort((n,o)=>n.id-o.id))}}let Tk=0;class ds{constructor(t){this.name=t,this.instances=[],this.id=Tk++}static get(t,e){if(!e.length)return t;let r=e[0].instances.find(l=>l.base==t&&Ak(e,l.modified));if(r)return r;let n=[],o=new Le(t.name,n,t,e);for(let l of e)l.instances.push(o);let s=Mk(e);for(let l of t.set)if(!l.modified.length)for(let a of s)n.push(ds.get(l,a));return o}}function Ak(i,t){return i.length==t.length&&i.every((e,r)=>e==t[r])}function Mk(i){let t=[[]];for(let e=0;e<i.length;e++)for(let r=0,n=t.length;r<n;r++)t.push(t[r].concat(i[e]));return t.sort((e,r)=>r.length-e.length)}function Ck(i){let t=Object.create(null);for(let e in i){let r=i[e];Array.isArray(r)||(r=[r]);for(let n of e.split(" "))if(n){let o=[],s=2,l=n;for(let u=0;;){if(l=="..."&&u>0&&u+3==n.length){s=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!d)throw new RangeError("Invalid path: "+n);if(o.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),u+=d[0].length,u==n.length)break;let f=n[u++];if(u==n.length&&f=="!"){s=0;break}if(f!="/")throw new RangeError("Invalid path: "+n);l=n.slice(u)}let a=o.length-1,c=o[a];if(!c)throw new RangeError("Invalid path: "+n);let h=new fs(r,s,a>0?o.slice(0,a):null);t[c]=h.sort(t[c])}}return vg.add(t)}const vg=new lt;class fs{constructor(t,e,r,n){this.tags=t,this.mode=e,this.context=r,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}fs.empty=new fs([],2,null);function wg(i,t){let e=Object.create(null);for(let o of i)if(!Array.isArray(o.tag))e[o.tag.id]=o.class;else for(let s of o.tag)e[s.id]=o.class;let{scope:r,all:n=null}=t||{};return{style:o=>{let s=n;for(let l of o)for(let a of l.set){let c=e[a.id];if(c){s=s?s+" "+c:c;break}}return s},scope:r}}function Lk(i,t){let e=null;for(let r of i){let n=r.style(t);n&&(e=e?e+" "+n:n)}return e}function _k(i,t,e,r=0,n=i.length){let o=new Ek(r,Array.isArray(t)?t:[t],e);o.highlightRange(i.cursor(),r,n,"",o.highlighters),o.flush(n)}class Ek{constructor(t,e,r){this.at=t,this.highlighters=e,this.span=r,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,r,n,o){let{type:s,from:l,to:a}=t;if(l>=r||a<=e)return;s.isTop&&(o=this.highlighters.filter(f=>!f.scope||f.scope(s)));let c=n,h=Ok(t)||fs.empty,u=Lk(o,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(n+=(n?" ":"")+u)),this.startSpan(Math.max(e,l),c),h.opaque)return;let d=t.tree&&t.tree.prop(lt.mounted);if(d&&d.overlay){let f=t.node.enter(d.overlay[0].from+l,1),m=this.highlighters.filter(p=>!p.scope||p.scope(d.tree.type)),v=t.firstChild();for(let p=0,y=l;;p++){let b=p<d.overlay.length?d.overlay[p]:null,k=b?b.from+l:a,S=Math.max(e,y),M=Math.min(r,k);if(S<M&&v)for(;t.from<M&&(this.highlightRange(t,S,M,n,o),this.startSpan(Math.min(M,t.to),c),!(t.to>=k||!t.nextSibling())););if(!b||k>r)break;y=b.to+l,y>e&&(this.highlightRange(f.cursor(),Math.max(e,b.from+l),Math.min(r,y),"",m),this.startSpan(Math.min(r,y),c))}v&&t.parent()}else if(t.firstChild()){d&&(n="");do if(!(t.to<=e)){if(t.from>=r)break;this.highlightRange(t,e,r,n,o),this.startSpan(Math.min(r,t.to),c)}while(t.nextSibling());t.parent()}}}function Ok(i){let t=i.type.prop(vg);for(;t&&t.context&&!i.matchContext(t.context);)t=t.next;return t||null}const N=Le.define,ps=N(),Bi=N(),bg=N(Bi),xg=N(Bi),Ni=N(),ms=N(Ni),Za=N(Ni),Ge=N(),ir=N(Ge),Je=N(),Xe=N(),tc=N(),zn=N(tc),gs=N(),I={comment:ps,lineComment:N(ps),blockComment:N(ps),docComment:N(ps),name:Bi,variableName:N(Bi),typeName:bg,tagName:N(bg),propertyName:xg,attributeName:N(xg),className:N(Bi),labelName:N(Bi),namespace:N(Bi),macroName:N(Bi),literal:Ni,string:ms,docString:N(ms),character:N(ms),attributeValue:N(ms),number:Za,integer:N(Za),float:N(Za),bool:N(Ni),regexp:N(Ni),escape:N(Ni),color:N(Ni),url:N(Ni),keyword:Je,self:N(Je),null:N(Je),atom:N(Je),unit:N(Je),modifier:N(Je),operatorKeyword:N(Je),controlKeyword:N(Je),definitionKeyword:N(Je),moduleKeyword:N(Je),operator:Xe,derefOperator:N(Xe),arithmeticOperator:N(Xe),logicOperator:N(Xe),bitwiseOperator:N(Xe),compareOperator:N(Xe),updateOperator:N(Xe),definitionOperator:N(Xe),typeOperator:N(Xe),controlOperator:N(Xe),punctuation:tc,separator:N(tc),bracket:zn,angleBracket:N(zn),squareBracket:N(zn),paren:N(zn),brace:N(zn),content:Ge,heading:ir,heading1:N(ir),heading2:N(ir),heading3:N(ir),heading4:N(ir),heading5:N(ir),heading6:N(ir),contentSeparator:N(Ge),list:N(Ge),quote:N(Ge),emphasis:N(Ge),strong:N(Ge),link:N(Ge),monospace:N(Ge),strikethrough:N(Ge),inserted:N(),deleted:N(),changed:N(),invalid:N(),meta:gs,documentMeta:N(gs),annotation:N(gs),processingInstruction:N(gs),definition:Le.defineModifier("definition"),constant:Le.defineModifier("constant"),function:Le.defineModifier("function"),standard:Le.defineModifier("standard"),local:Le.defineModifier("local"),special:Le.defineModifier("special")};for(let i in I){let t=I[i];t instanceof Le&&(t.name=i)}wg([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);var ec;const jn=new lt,Dk=new lt;class Qe{constructor(t,e,r=[],n=""){this.data=t,this.name=n,ot.prototype.hasOwnProperty("tree")||Object.defineProperty(ot.prototype,"tree",{get(){return te(this)}}),this.parser=e,this.extension=[Ii.of(this),ot.languageData.of((o,s,l)=>{let a=kg(o,s,l),c=a.type.prop(jn);if(!c)return[];let h=o.facet(c),u=a.type.prop(Dk);if(u){let d=a.resolve(s-a.from,l);for(let f of u)if(f.test(d,o)){let m=o.facet(f.facet);return f.type=="replace"?m:m.concat(h)}}return h})].concat(r)}isActiveAt(t,e,r=-1){return kg(t,e,r).type.prop(jn)==this.data}findRegions(t){let e=t.facet(Ii);if((e==null?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let r=[],n=(o,s)=>{if(o.prop(jn)==this.data){r.push({from:s,to:s+o.length});return}let l=o.prop(lt.mounted);if(l){if(l.tree.prop(jn)==this.data){if(l.overlay)for(let a of l.overlay)r.push({from:a.from+s,to:a.to+s});else r.push({from:s,to:s+o.length});return}else if(l.overlay){let a=r.length;if(n(l.tree,l.overlay[0].from+s),r.length>a)return}}for(let a=0;a<o.children.length;a++){let c=o.children[a];c instanceof Zt&&n(c,o.positions[a]+s)}};return n(te(t),0),r}get allowsNesting(){return!0}}Qe.setState=tt.define();function kg(i,t,e){let r=i.facet(Ii),n=te(i).topNode;if(!r||r.allowsNesting)for(let o=n;o;o=o.enter(t,e,qt.ExcludeBuffers))o.type.isTop&&(n=o);return n}function te(i){let t=i.field(Qe.state,!1);return t?t.tree:Zt.empty}class Pk{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let r=this.cursorPos-this.string.length;return t<r||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-r,e-r)}}let $n=null;class ys{constructor(t,e,r=[],n,o,s,l,a){this.parser=t,this.state=e,this.fragments=r,this.tree=n,this.treeLen=o,this.viewport=s,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(t,e,r){return new ys(t,e,[],Zt.empty,0,r,[],null)}startParse(){return this.parser.startParse(new Pk(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=Zt.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(er.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(er.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=$n;$n=this;try{return t()}finally{$n=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Sg(t,e.from,e.to);return t}changes(t,e){let{fragments:r,tree:n,treeLen:o,viewport:s,skipped:l}=this;if(this.takeTree(),!t.empty){let a=[];if(t.iterChangedRanges((c,h,u,d)=>a.push({fromA:c,toA:h,fromB:u,toB:d})),r=er.applyChanges(r,a),n=Zt.empty,o=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let h=t.mapPos(c.from,1),u=t.mapPos(c.to,-1);h<u&&l.push({from:h,to:u})}}}return new ys(this.parser,e,r,n,o,s,l,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:n,to:o}=this.skipped[r];n<t.to&&o>t.from&&(this.fragments=Sg(this.fragments,n,o),this.skipped.splice(r--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends xk{createParse(e,r,n){let o=n[0].from,s=n[n.length-1].to;return{parsedPos:o,advance(){let l=$n;if(l){for(let a of n)l.tempSkipped.push(a);t&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,t]):t)}return this.parsedPos=s,new Zt(Me.none,[],[],s-o)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return $n}}function Sg(i,t,e){return er.applyChanges(i,[{fromA:t,toA:e,fromB:t,toB:e}])}class Ir{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,r)||e.takeTree(),new Ir(e)}static init(t){let e=Math.min(3e3,t.doc.length),r=ys.create(t.facet(Ii).parser,t,{from:0,to:e});return r.work(20,e)||r.takeTree(),new Ir(r)}}Qe.state=zt.define({create:Ir.init,update(i,t){for(let e of t.effects)if(e.is(Qe.setState))return e.value;return t.startState.facet(Ii)!=t.state.facet(Ii)?Ir.init(t.state):i.apply(t)}});let Tg=i=>{let t=setTimeout(()=>i(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Tg=i=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(i,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const ic=typeof navigator<"u"&&!((ec=navigator.scheduling)===null||ec===void 0)&&ec.isInputPending?()=>navigator.scheduling.isInputPending():null,Rk=_t.fromClass(class{constructor(i){this.view=i,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(i){let t=this.view.state.field(Qe.state).context;(t.updateViewport(i.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(i.docChanged||i.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:i}=this.view,t=i.field(Qe.state);(t.tree!=t.context.tree||!t.context.isDone(i.doc.length))&&(this.working=Tg(this.work))}work(i){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:e,viewport:{to:r}}=this.view,n=e.field(Qe.state);if(n.tree==n.context.tree&&n.context.isDone(r+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,i&&!ic?Math.max(25,i.timeRemaining()-5):1e9),s=n.context.treeLen<r&&e.doc.length>r+1e3,l=n.context.work(()=>ic&&ic()||Date.now()>o,r+(s?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(n.context.takeTree(),this.view.dispatch({effects:Qe.setState.of(new Ir(n.context))})),this.chunkBudget>0&&!(l&&!s)&&this.scheduleWork(),this.checkAsyncSchedule(n.context)}checkAsyncSchedule(i){i.scheduleOn&&(this.workScheduled++,i.scheduleOn.then(()=>this.scheduleWork()).catch(t=>ue(this.view.state,t)).then(()=>this.workScheduled--),i.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ii=U.define({combine(i){return i.length?i[0]:null},enables:i=>[Qe.state,Rk,V.contentAttributes.compute([i],t=>{let e=t.facet(i);return e&&e.name?{"data-language":e.name}:{}})]}),Bk=U.define(),vs=U.define({combine:i=>{if(!i.length)return"  ";let t=i[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return t}});function ws(i){let t=i.facet(vs);return t.charCodeAt(0)==9?i.tabSize*t.length:t.length}function qn(i,t){let e="",r=i.tabSize,n=i.facet(vs)[0];if(n=="	"){for(;t>=r;)e+="	",t-=r;n=" "}for(let o=0;o<t;o++)e+=n;return e}function rc(i,t){i instanceof ot&&(i=new bs(i));for(let r of i.state.facet(Bk)){let n=r(i,t);if(n!==void 0)return n}let e=te(i.state);return e.length>=t?Ik(i,e,t):null}class bs{constructor(t,e={}){this.state=t,this.options=e,this.unit=ws(t)}lineAt(t,e=1){let r=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:o}=this.options;return n!=null&&n>=r.from&&n<=r.to?o&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:r.text.slice(n-r.from),from:n}:{text:r.text.slice(0,n-r.from),from:r.from}:r}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:r,from:n}=this.lineAt(t,e);return r.slice(t-n,Math.min(r.length,t+100-n))}column(t,e=1){let{text:r,from:n}=this.lineAt(t,e),o=this.countColumn(r,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(o+=s-this.countColumn(r,r.search(/\S|$/))),o}countColumn(t,e=t.length){return Lr(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:r,from:n}=this.lineAt(t,e),o=this.options.overrideIndentation;if(o){let s=o(n);if(s>-1)return s}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Nk=new lt;function Ik(i,t,e){let r=t.resolveStack(e),n=r.node.enterUnfinishedNodesBefore(e);if(n!=r.node){let o=[];for(let s=n;s!=r.node;s=s.parent)o.push(s);for(let s=o.length-1;s>=0;s--)r={node:o[s],next:r}}return Ag(r,i,e)}function Ag(i,t,e){for(let r=i;r;r=r.next){let n=Fk(r.node);if(n)return n(nc.create(t,e,r))}return 0}function Wk(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function Fk(i){let t=i.type.prop(Nk);if(t)return t;let e=i.firstChild,r;if(e&&(r=e.type.prop(lt.closedBy))){let n=i.lastChild,o=n&&r.indexOf(n.name)>-1;return s=>zk(s,!0,1,void 0,o&&!Wk(s)?n.from:void 0)}return i.parent==null?Vk:null}function Vk(){return 0}class nc extends bs{constructor(t,e,r){super(t.state,t.options),this.base=t,this.pos=e,this.context=r}get node(){return this.context.node}static create(t,e,r){return new nc(t,e,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let r=t.resolve(e.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(Hk(r,t))break;e=this.state.doc.lineAt(r.from)}return this.lineIndent(e.from)}continue(){return Ag(this.context.next,this.base,this.pos)}}function Hk(i,t){for(let e=t;e;e=e.parent)if(i==e)return!0;return!1}function Uk(i){let t=i.node,e=t.childAfter(t.from),r=t.lastChild;if(!e)return null;let n=i.options.simulateBreak,o=i.state.doc.lineAt(e.from),s=n==null||n<=o.from?o.to:Math.min(o.to,n);for(let l=e.to;;){let a=t.childAfter(l);if(!a||a==r)return null;if(!a.type.isSkipped){if(a.from>=s)return null;let c=/^ */.exec(o.text.slice(e.to-o.from))[0].length;return{from:e.from,to:e.to+c}}l=a.to}}function zk(i,t,e,r,n){let o=i.textAfter,s=o.match(/^\s*/)[0].length,l=n==i.pos+s,a=Uk(i);return a?l?i.column(a.from):i.column(a.to):i.baseIndent+(l?0:i.unit*e)}const jk=200;function $k(){return ot.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let t=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!t.length)return i;let e=i.newDoc,{head:r}=i.newSelection.main,n=e.lineAt(r);if(r>n.from+jk)return i;let o=e.sliceString(n.from,r);if(!t.some(c=>c.test(o)))return i;let{state:s}=i,l=-1,a=[];for(let{head:c}of s.selection.ranges){let h=s.doc.lineAt(c);if(h.from==l)continue;l=h.from;let u=rc(s,h.from);if(u==null)continue;let d=/^\s*/.exec(h.text)[0],f=qn(s,u);d!=f&&a.push({from:h.from,to:h.from+d.length,insert:f})}return a.length?[i,{changes:a,sequential:!0}]:i})}const qk=U.define(),Kk=new lt;function Yk(i,t,e){let r=te(i);if(r.length<e)return null;let n=r.resolveStack(e,1),o=null;for(let s=n;s;s=s.next){let l=s.node;if(l.to<=e||l.from>e)continue;if(o&&l.from<t)break;let a=l.type.prop(Kk);if(a&&(l.to<r.length-50||r.length==i.doc.length||!Gk(l))){let c=a(l,i);c&&c.from<=e&&c.from>=t&&c.to>e&&(o=c)}}return o}function Gk(i){let t=i.lastChild;return t&&t.to==i.to&&t.type.isError}function xs(i,t,e){for(let r of i.facet(qk)){let n=r(i,t,e);if(n)return n}return Yk(i,t,e)}function Mg(i,t){let e=t.mapPos(i.from,1),r=t.mapPos(i.to,-1);return e>=r?void 0:{from:e,to:r}}const ks=tt.define({map:Mg}),Kn=tt.define({map:Mg});function Cg(i){let t=[];for(let{head:e}of i.state.selection.ranges)t.some(r=>r.from<=e&&r.to>=e)||t.push(i.lineBlockAt(e));return t}const rr=zt.define({create(){return G.none},update(i,t){i=i.map(t.changes);for(let e of t.effects)if(e.is(ks)&&!Jk(i,e.value.from,e.value.to)){let{preparePlaceholder:r}=t.state.facet(Eg),n=r?G.replace({widget:new r5(r(t.state,e.value))}):Pg;i=i.update({add:[n.range(e.value.from,e.value.to)]})}else e.is(Kn)&&(i=i.update({filter:(r,n)=>e.value.from!=r||e.value.to!=n,filterFrom:e.value.from,filterTo:e.value.to}));if(t.selection){let e=!1,{head:r}=t.selection.main;i.between(r,r,(n,o)=>{n<r&&o>r&&(e=!0)}),e&&(i=i.update({filterFrom:r,filterTo:r,filter:(n,o)=>o<=r||n>=r}))}return i},provide:i=>V.decorations.from(i),toJSON(i,t){let e=[];return i.between(0,t.doc.length,(r,n)=>{e.push(r,n)}),e},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<i.length;){let r=i[e++],n=i[e++];if(typeof r!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");t.push(Pg.range(r,n))}return G.set(t,!0)}});function Ss(i,t,e){var r;let n=null;return(r=i.field(rr,!1))===null||r===void 0||r.between(t,e,(o,s)=>{(!n||n.from>o)&&(n={from:o,to:s})}),n}function Jk(i,t,e){let r=!1;return i.between(t,t,(n,o)=>{n==t&&o==e&&(r=!0)}),r}function Lg(i,t){return i.field(rr,!1)?t:t.concat(tt.appendConfig.of(Og()))}const Xk=i=>{for(let t of Cg(i)){let e=xs(i.state,t.from,t.to);if(e)return i.dispatch({effects:Lg(i.state,[ks.of(e),_g(i,e)])}),!0}return!1},Qk=i=>{if(!i.state.field(rr,!1))return!1;let t=[];for(let e of Cg(i)){let r=Ss(i.state,e.from,e.to);r&&t.push(Kn.of(r),_g(i,r,!1))}return t.length&&i.dispatch({effects:t}),t.length>0};function _g(i,t,e=!0){let r=i.state.doc.lineAt(t.from).number,n=i.state.doc.lineAt(t.to).number;return V.announce.of(`${i.state.phrase(e?"Folded lines":"Unfolded lines")} ${r} ${i.state.phrase("to")} ${n}.`)}const Zk=i=>{let{state:t}=i,e=[];for(let r=0;r<t.doc.length;){let n=i.lineBlockAt(r),o=xs(t,n.from,n.to);o&&e.push(ks.of(o)),r=(o?i.lineBlockAt(o.to):n).to+1}return e.length&&i.dispatch({effects:Lg(i.state,e)}),!!e.length},t5=i=>{let t=i.state.field(rr,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,i.state.doc.length,(r,n)=>{e.push(Kn.of({from:r,to:n}))}),i.dispatch({effects:e}),!0},e5=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Xk},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Qk},{key:"Ctrl-Alt-[",run:Zk},{key:"Ctrl-Alt-]",run:t5}],i5={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Eg=U.define({combine(i){return $e(i,i5)}});function Og(i){return[rr,s5]}function Dg(i,t){let{state:e}=i,r=e.facet(Eg),n=s=>{let l=i.lineBlockAt(i.posAtDOM(s.target)),a=Ss(i.state,l.from,l.to);a&&i.dispatch({effects:Kn.of(a)}),s.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(i,n,t);let o=document.createElement("span");return o.textContent=r.placeholderText,o.setAttribute("aria-label",e.phrase("folded code")),o.title=e.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=n,o}const Pg=G.replace({widget:new class extends fi{toDOM(i){return Dg(i,null)}}});class r5 extends fi{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return Dg(t,this.value)}}const n5={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class oc extends mi{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function o5(i={}){let t=Object.assign(Object.assign({},n5),i),e=new oc(t,!0),r=new oc(t,!1),n=_t.fromClass(class{constructor(s){this.from=s.viewport.from,this.markers=this.buildMarkers(s)}update(s){(s.docChanged||s.viewportChanged||s.startState.facet(Ii)!=s.state.facet(Ii)||s.startState.field(rr,!1)!=s.state.field(rr,!1)||te(s.startState)!=te(s.state)||t.foldingChanged(s))&&(this.markers=this.buildMarkers(s.view))}buildMarkers(s){let l=new Ai;for(let a of s.viewportLineBlocks){let c=Ss(s.state,a.from,a.to)?r:xs(s.state,a.from,a.to)?e:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:o}=t;return[n,rk({class:"cm-foldGutter",markers(s){var l;return((l=s.plugin(n))===null||l===void 0?void 0:l.markers)||at.empty},initialSpacer(){return new oc(t,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(s,l,a)=>{if(o.click&&o.click(s,l,a))return!0;let c=Ss(s.state,l.from,l.to);if(c)return s.dispatch({effects:Kn.of(c)}),!0;let h=xs(s.state,l.from,l.to);return h?(s.dispatch({effects:ks.of(h)}),!0):!1}})}),Og()]}const s5=V.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ts{constructor(t,e){this.specs=t;let r;function n(l){let a=Mi.newName();return(r||(r=Object.create(null)))["."+a]=l,a}const o=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,s=e.scope;this.scope=s instanceof Qe?l=>l.prop(jn)==s.data:s?l=>l==s:void 0,this.style=wg(t.map(l=>({tag:l.tag,class:l.class||n(Object.assign({},l,{tag:null}))})),{all:o}).style,this.module=r?new Mi(r):null,this.themeType=e.themeType}static define(t,e){return new Ts(t,e||{})}}const sc=U.define(),Rg=U.define({combine(i){return i.length?[i[0]]:null}});function lc(i){let t=i.facet(sc);return t.length?t:i.facet(Rg)}function l5(i,t){let e=[c5],r;return i instanceof Ts&&(i.module&&e.push(V.styleModule.of(i.module)),r=i.themeType),t!=null&&t.fallback?e.push(Rg.of(i)):r?e.push(sc.computeN([V.darkTheme],n=>n.facet(V.darkTheme)==(r=="dark")?[i]:[])):e.push(sc.of(i)),e}class a5{constructor(t){this.markCache=Object.create(null),this.tree=te(t.state),this.decorations=this.buildDeco(t,lc(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=te(t.state),r=lc(t.state),n=r!=lc(t.startState),{viewport:o}=t.view,s=t.changes.mapPos(this.decoratedTo,1);e.length<o.to&&!n&&e.type==this.tree.type&&s>=o.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=s):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,r),this.decoratedTo=o.to)}buildDeco(t,e){if(!e||!this.tree.length)return G.none;let r=new Ai;for(let{from:n,to:o}of t.visibleRanges)_k(this.tree,e,(s,l,a)=>{r.add(s,l,this.markCache[a]||(this.markCache[a]=G.mark({class:a})))},n,o);return r.finish()}}const c5=Ji.high(_t.fromClass(a5,{decorations:i=>i.decorations})),h5=Ts.define([{tag:I.meta,color:"#404740"},{tag:I.link,textDecoration:"underline"},{tag:I.heading,textDecoration:"underline",fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strong,fontWeight:"bold"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.keyword,color:"#708"},{tag:[I.atom,I.bool,I.url,I.contentSeparator,I.labelName],color:"#219"},{tag:[I.literal,I.inserted],color:"#164"},{tag:[I.string,I.deleted],color:"#a11"},{tag:[I.regexp,I.escape,I.special(I.string)],color:"#e40"},{tag:I.definition(I.variableName),color:"#00f"},{tag:I.local(I.variableName),color:"#30a"},{tag:[I.typeName,I.namespace],color:"#085"},{tag:I.className,color:"#167"},{tag:[I.special(I.variableName),I.macroName],color:"#256"},{tag:I.definition(I.propertyName),color:"#00c"},{tag:I.comment,color:"#940"},{tag:I.invalid,color:"#f00"}]),u5=V.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Bg=1e4,Ng="()[]{}",Ig=U.define({combine(i){return $e(i,{afterCursor:!0,brackets:Ng,maxScanDistance:Bg,renderMatch:p5})}}),d5=G.mark({class:"cm-matchingBracket"}),f5=G.mark({class:"cm-nonmatchingBracket"});function p5(i){let t=[],e=i.matched?d5:f5;return t.push(e.range(i.start.from,i.start.to)),i.end&&t.push(e.range(i.end.from,i.end.to)),t}const m5=zt.define({create(){return G.none},update(i,t){if(!t.docChanged&&!t.selection)return i;let e=[],r=t.state.facet(Ig);for(let n of t.state.selection.ranges){if(!n.empty)continue;let o=Ze(t.state,n.head,-1,r)||n.head>0&&Ze(t.state,n.head-1,1,r)||r.afterCursor&&(Ze(t.state,n.head,1,r)||n.head<t.state.doc.length&&Ze(t.state,n.head+1,-1,r));o&&(e=e.concat(r.renderMatch(o,t.state)))}return G.set(e,!0)},provide:i=>V.decorations.from(i)}),g5=[m5,u5];function y5(i={}){return[Ig.of(i),g5]}const v5=new lt;function ac(i,t,e){let r=i.prop(t<0?lt.openedBy:lt.closedBy);if(r)return r;if(i.name.length==1){let n=e.indexOf(i.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function cc(i){let t=i.type.prop(v5);return t?t(i.node):i}function Ze(i,t,e,r={}){let n=r.maxScanDistance||Bg,o=r.brackets||Ng,s=te(i),l=s.resolveInner(t,e);for(let a=l;a;a=a.parent){let c=ac(a.type,e,o);if(c&&a.from<a.to){let h=cc(a);if(h&&(e>0?t>=h.from&&t<h.to:t>h.from&&t<=h.to))return w5(i,t,e,a,h,c,o)}}return b5(i,t,e,s,l.type,n,o)}function w5(i,t,e,r,n,o,s){let l=r.parent,a={from:n.from,to:n.to},c=0,h=l==null?void 0:l.cursor();if(h&&(e<0?h.childBefore(r.from):h.childAfter(r.to)))do if(e<0?h.to<=r.from:h.from>=r.to){if(c==0&&o.indexOf(h.type.name)>-1&&h.from<h.to){let u=cc(h);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(ac(h.type,e,s))c++;else if(ac(h.type,-e,s)){if(c==0){let u=cc(h);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(e<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function b5(i,t,e,r,n,o,s){let l=e<0?i.sliceDoc(t-1,t):i.sliceDoc(t,t+1),a=s.indexOf(l);if(a<0||a%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},h=i.doc.iterRange(t,e>0?i.doc.length:0),u=0;for(let d=0;!h.next().done&&d<=o;){let f=h.value;e<0&&(d+=f.length);let m=t+d*e;for(let v=e>0?0:f.length-1,p=e>0?f.length:-1;v!=p;v+=e){let y=s.indexOf(f[v]);if(!(y<0||r.resolveInner(m+v,1).type!=n))if(y%2==0==e>0)u++;else{if(u==1)return{start:c,end:{from:m+v,to:m+v+1},matched:y>>1==a>>1};u--}}e>0&&(d+=f.length)}return h.done?{start:c,matched:!1}:null}const x5=Object.create(null),Wg=[Me.none],Fg=[],Vg=Object.create(null),k5=Object.create(null);for(let[i,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])k5[i]=S5(x5,t);function hc(i,t){Fg.indexOf(i)>-1||(Fg.push(i),console.warn(t))}function S5(i,t){let e=[];for(let l of t.split(" ")){let a=[];for(let c of l.split(".")){let h=i[c]||I[c];h?typeof h=="function"?a.length?a=a.map(h):hc(c,`Modifier ${c} used at start of tag`):a.length?hc(c,`Tag ${c} used as modifier`):a=Array.isArray(h)?h:[h]:hc(c,`Unknown highlighting tag ${c}`)}for(let c of a)e.push(c)}if(!e.length)return 0;let r=t.replace(/ /g,"_"),n=r+" "+e.map(l=>l.id),o=Vg[n];if(o)return o.id;let s=Vg[n]=Me.define({id:Wg.length,name:r,props:[Ck({[r]:e})]});return Wg.push(s),s.id}wt.RTL,wt.LTR;const T5=i=>{let{state:t}=i,e=t.doc.lineAt(t.selection.main.from),r=dc(i.state,e.from);return r.line?A5(i):r.block?C5(i):!1};function uc(i,t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=i(t,e);return n?(r(e.update(n)),!0):!1}}const A5=uc(E5,0),M5=uc(Hg,0),C5=uc((i,t)=>Hg(i,t,_5(t)),0);function dc(i,t){let e=i.languageDataAt("commentTokens",t);return e.length?e[0]:{}}const Yn=50;function L5(i,{open:t,close:e},r,n){let o=i.sliceDoc(r-Yn,r),s=i.sliceDoc(n,n+Yn),l=/\s*$/.exec(o)[0].length,a=/^\s*/.exec(s)[0].length,c=o.length-l;if(o.slice(c-t.length,c)==t&&s.slice(a,a+e.length)==e)return{open:{pos:r-l,margin:l&&1},close:{pos:n+a,margin:a&&1}};let h,u;n-r<=2*Yn?h=u=i.sliceDoc(r,n):(h=i.sliceDoc(r,r+Yn),u=i.sliceDoc(n-Yn,n));let d=/^\s*/.exec(h)[0].length,f=/\s*$/.exec(u)[0].length,m=u.length-f-e.length;return h.slice(d,d+t.length)==t&&u.slice(m,m+e.length)==e?{open:{pos:r+d+t.length,margin:/\s/.test(h.charAt(d+t.length))?1:0},close:{pos:n-f-e.length,margin:/\s/.test(u.charAt(m-1))?1:0}}:null}function _5(i){let t=[];for(let e of i.selection.ranges){let r=i.doc.lineAt(e.from),n=e.to<=r.to?r:i.doc.lineAt(e.to),o=t.length-1;o>=0&&t[o].to>r.from?t[o].to=n.to:t.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:n.to})}return t}function Hg(i,t,e=t.selection.ranges){let r=e.map(o=>dc(t,o.from).block);if(!r.every(o=>o))return null;let n=e.map((o,s)=>L5(t,r[s],o.from,o.to));if(i!=2&&!n.every(o=>o))return{changes:t.changes(e.map((o,s)=>n[s]?[]:[{from:o.from,insert:r[s].open+" "},{from:o.to,insert:" "+r[s].close}]))};if(i!=1&&n.some(o=>o)){let o=[];for(let s=0,l;s<n.length;s++)if(l=n[s]){let a=r[s],{open:c,close:h}=l;o.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+a.close.length})}return{changes:o}}return null}function E5(i,t,e=t.selection.ranges){let r=[],n=-1;for(let{from:o,to:s}of e){let l=r.length,a=1e9,c=dc(t,o).line;if(c){for(let h=o;h<=s;){let u=t.doc.lineAt(h);if(u.from>n&&(o==s||s>u.from)){n=u.from;let d=/^\s*/.exec(u.text)[0].length,f=d==u.length,m=u.text.slice(d,d+c.length)==c?d:-1;d<u.text.length&&d<a&&(a=d),r.push({line:u,comment:m,token:c,indent:d,empty:f,single:!1})}h=u.to+1}if(a<1e9)for(let h=l;h<r.length;h++)r[h].indent<r[h].line.text.length&&(r[h].indent=a);r.length==l+1&&(r[l].single=!0)}}if(i!=2&&r.some(o=>o.comment<0&&(!o.empty||o.single))){let o=[];for(let{line:l,token:a,indent:c,empty:h,single:u}of r)(u||!h)&&o.push({from:l.from+c,insert:a+" "});let s=t.changes(o);return{changes:s,selection:t.selection.map(s,1)}}else if(i!=1&&r.some(o=>o.comment>=0)){let o=[];for(let{line:s,comment:l,token:a}of r)if(l>=0){let c=s.from+l,h=c+a.length;s.text[h-s.from]==" "&&h++,o.push({from:c,to:h})}return{changes:o}}return null}const fc=ui.define(),O5=ui.define(),D5=U.define(),Ug=U.define({combine(i){return $e(i,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(r,n)=>t(r,n)||e(r,n)})}}),zg=zt.define({create(){return ti.empty},update(i,t){let e=t.state.facet(Ug),r=t.annotation(fc);if(r){let a=de.fromTransaction(t,r.selection),c=r.side,h=c==0?i.undone:i.done;return a?h=Ms(h,h.length,e.minDepth,a):h=qg(h,t.startState.selection),new ti(c==0?r.rest:h,c==0?h:r.rest)}let n=t.annotation(O5);if((n=="full"||n=="before")&&(i=i.isolate()),t.annotation(Ft.addToHistory)===!1)return t.changes.empty?i:i.addMapping(t.changes.desc);let o=de.fromTransaction(t),s=t.annotation(Ft.time),l=t.annotation(Ft.userEvent);return o?i=i.addChanges(o,s,l,e,t):t.selection&&(i=i.addSelection(t.startState.selection,s,l,e.newGroupDelay)),(n=="full"||n=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(t=>t.toJSON()),undone:i.undone.map(t=>t.toJSON())}},fromJSON(i){return new ti(i.done.map(de.fromJSON),i.undone.map(de.fromJSON))}});function P5(i={}){return[zg,Ug.of(i),V.domEventHandlers({beforeinput(t,e){let r=t.inputType=="historyUndo"?jg:t.inputType=="historyRedo"?pc:null;return r?(t.preventDefault(),r(e)):!1}})]}function As(i,t){return function({state:e,dispatch:r}){if(!t&&e.readOnly)return!1;let n=e.field(zg,!1);if(!n)return!1;let o=n.pop(i,e,t);return o?(r(o),!0):!1}}const jg=As(0,!1),pc=As(1,!1),R5=As(0,!0),B5=As(1,!0);class de{constructor(t,e,r,n,o){this.changes=t,this.effects=e,this.mapped=r,this.startSelection=n,this.selectionsAfter=o}setSelAfter(t){return new de(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,r;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new de(t.changes&&Wt.fromJSON(t.changes),[],t.mapped&&je.fromJSON(t.mapped),t.startSelection&&O.fromJSON(t.startSelection),t.selectionsAfter.map(O.fromJSON))}static fromTransaction(t,e){let r=_e;for(let n of t.startState.facet(D5)){let o=n(t);o.length&&(r=r.concat(o))}return!r.length&&t.changes.empty?null:new de(t.changes.invert(t.startState.doc),r,void 0,e||t.startState.selection,_e)}static selection(t){return new de(void 0,_e,void 0,void 0,t)}}function Ms(i,t,e,r){let n=t+1>e+20?t-e-1:0,o=i.slice(n,t);return o.push(r),o}function N5(i,t){let e=[],r=!1;return i.iterChangedRanges((n,o)=>e.push(n,o)),t.iterChangedRanges((n,o,s,l)=>{for(let a=0;a<e.length;){let c=e[a++],h=e[a++];l>=c&&s<=h&&(r=!0)}}),r}function I5(i,t){return i.ranges.length==t.ranges.length&&i.ranges.filter((e,r)=>e.empty!=t.ranges[r].empty).length===0}function $g(i,t){return i.length?t.length?i.concat(t):i:t}const _e=[],W5=200;function qg(i,t){if(i.length){let e=i[i.length-1],r=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-W5));return r.length&&r[r.length-1].eq(t)?i:(r.push(t),Ms(i,i.length-1,1e9,e.setSelAfter(r)))}else return[de.selection([t])]}function F5(i){let t=i[i.length-1],e=i.slice();return e[i.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function mc(i,t){if(!i.length)return i;let e=i.length,r=_e;for(;e;){let n=V5(i[e-1],t,r);if(n.changes&&!n.changes.empty||n.effects.length){let o=i.slice(0,e);return o[e-1]=n,o}else t=n.mapped,e--,r=n.selectionsAfter}return r.length?[de.selection(r)]:_e}function V5(i,t,e){let r=$g(i.selectionsAfter.length?i.selectionsAfter.map(l=>l.map(t)):_e,e);if(!i.changes)return de.selection(r);let n=i.changes.map(t),o=t.mapDesc(i.changes,!0),s=i.mapped?i.mapped.composeDesc(o):o;return new de(n,tt.mapEffects(i.effects,t),s,i.startSelection.map(o),r)}const H5=/^(input\.type|delete)($|\.)/;class ti{constructor(t,e,r=0,n=void 0){this.done=t,this.undone=e,this.prevTime=r,this.prevUserEvent=n}isolate(){return this.prevTime?new ti(this.done,this.undone):this}addChanges(t,e,r,n,o){let s=this.done,l=s[s.length-1];return l&&l.changes&&!l.changes.empty&&t.changes&&(!r||H5.test(r))&&(!l.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(o,N5(l.changes,t.changes))||r=="input.type.compose")?s=Ms(s,s.length-1,n.minDepth,new de(t.changes.compose(l.changes),$g(tt.mapEffects(t.effects,l.changes),l.effects),l.mapped,l.startSelection,_e)):s=Ms(s,s.length,n.minDepth,t),new ti(s,_e,e,r)}addSelection(t,e,r,n){let o=this.done.length?this.done[this.done.length-1].selectionsAfter:_e;return o.length>0&&e-this.prevTime<n&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&I5(o[o.length-1],t)?this:new ti(qg(this.done,t),this.undone,e,r)}addMapping(t){return new ti(mc(this.done,t),mc(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,r){let n=t==0?this.done:this.undone;if(n.length==0)return null;let o=n[n.length-1],s=o.selectionsAfter[0]||e.selection;if(r&&o.selectionsAfter.length)return e.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:fc.of({side:t,rest:F5(n),selection:s}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(o.changes){let l=n.length==1?_e:n.slice(0,n.length-1);return o.mapped&&(l=mc(l,o.mapped)),e.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:fc.of({side:t,rest:l,selection:s}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}ti.empty=new ti(_e,_e);const U5=[{key:"Mod-z",run:jg,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:pc,preventDefault:!0},{linux:"Ctrl-Shift-z",run:pc,preventDefault:!0},{key:"Mod-u",run:R5,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:B5,preventDefault:!0}];function Wr(i,t){return O.create(i.ranges.map(t),i.mainIndex)}function ei(i,t){return i.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Be({state:i,dispatch:t},e){let r=Wr(i.selection,e);return r.eq(i.selection,!0)?!1:(t(ei(i,r)),!0)}function Cs(i,t){return O.cursor(t?i.to:i.from)}function Kg(i,t){return Be(i,e=>e.empty?i.moveByChar(e,t):Cs(e,t))}function ee(i){return i.textDirectionAt(i.state.selection.main.head)==wt.LTR}const Yg=i=>Kg(i,!ee(i)),Gg=i=>Kg(i,ee(i));function Jg(i,t){return Be(i,e=>e.empty?i.moveByGroup(e,t):Cs(e,t))}const z5=i=>Jg(i,!ee(i)),j5=i=>Jg(i,ee(i));function $5(i,t,e){if(t.type.prop(e))return!0;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(i.sliceDoc(t.from,t.to)))||t.firstChild}function Ls(i,t,e){let r=te(i).resolveInner(t.head),n=e?lt.closedBy:lt.openedBy;for(let a=t.head;;){let c=e?r.childAfter(a):r.childBefore(a);if(!c)break;$5(i,c,n)?r=c:a=e?c.to:c.from}let o=r.type.prop(n),s,l;return o&&(s=e?Ze(i,r.from,1):Ze(i,r.to,-1))&&s.matched?l=e?s.end.to:s.end.from:l=e?r.to:r.from,O.cursor(l,e?-1:1)}const q5=i=>Be(i,t=>Ls(i.state,t,!ee(i))),K5=i=>Be(i,t=>Ls(i.state,t,ee(i)));function Xg(i,t){return Be(i,e=>{if(!e.empty)return Cs(e,t);let r=i.moveVertically(e,t);return r.head!=e.head?r:i.moveToLineBoundary(e,t)})}const Qg=i=>Xg(i,!1),Zg=i=>Xg(i,!0);function t0(i){let t=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,e=0,r=0,n;if(t){for(let o of i.state.facet(V.scrollMargins)){let s=o(i);s!=null&&s.top&&(e=Math.max(s==null?void 0:s.top,e)),s!=null&&s.bottom&&(r=Math.max(s==null?void 0:s.bottom,r))}n=i.scrollDOM.clientHeight-e-r}else n=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:e,marginBottom:r,selfScroll:t,height:Math.max(i.defaultLineHeight,n-5)}}function e0(i,t){let e=t0(i),{state:r}=i,n=Wr(r.selection,s=>s.empty?i.moveVertically(s,t,e.height):Cs(s,t));if(n.eq(r.selection))return!1;let o;if(e.selfScroll){let s=i.coordsAtPos(r.selection.main.head),l=i.scrollDOM.getBoundingClientRect(),a=l.top+e.marginTop,c=l.bottom-e.marginBottom;s&&s.top>a&&s.bottom<c&&(o=V.scrollIntoView(n.main.head,{y:"start",yMargin:s.top-a}))}return i.dispatch(ei(r,n),{effects:o}),!0}const i0=i=>e0(i,!1),gc=i=>e0(i,!0);function Wi(i,t,e){let r=i.lineBlockAt(t.head),n=i.moveToLineBoundary(t,e);if(n.head==t.head&&n.head!=(e?r.to:r.from)&&(n=i.moveToLineBoundary(t,e,!1)),!e&&n.head==r.from&&r.length){let o=/^\s*/.exec(i.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;o&&t.head!=r.from+o&&(n=O.cursor(r.from+o))}return n}const Y5=i=>Be(i,t=>Wi(i,t,!0)),G5=i=>Be(i,t=>Wi(i,t,!1)),J5=i=>Be(i,t=>Wi(i,t,!ee(i))),X5=i=>Be(i,t=>Wi(i,t,ee(i))),Q5=i=>Be(i,t=>O.cursor(i.lineBlockAt(t.head).from,1)),Z5=i=>Be(i,t=>O.cursor(i.lineBlockAt(t.head).to,-1));function tS(i,t,e){let r=!1,n=Wr(i.selection,o=>{let s=Ze(i,o.head,-1)||Ze(i,o.head,1)||o.head>0&&Ze(i,o.head-1,1)||o.head<i.doc.length&&Ze(i,o.head+1,-1);if(!s||!s.end)return o;r=!0;let l=s.start.from==o.head?s.end.to:s.end.from;return O.cursor(l)});return r?(t(ei(i,n)),!0):!1}const eS=({state:i,dispatch:t})=>tS(i,t);function Ee(i,t){let e=Wr(i.state.selection,r=>{let n=t(r);return O.range(r.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return e.eq(i.state.selection)?!1:(i.dispatch(ei(i.state,e)),!0)}function r0(i,t){return Ee(i,e=>i.moveByChar(e,t))}const n0=i=>r0(i,!ee(i)),o0=i=>r0(i,ee(i));function s0(i,t){return Ee(i,e=>i.moveByGroup(e,t))}const iS=i=>s0(i,!ee(i)),rS=i=>s0(i,ee(i)),nS=i=>Ee(i,t=>Ls(i.state,t,!ee(i))),oS=i=>Ee(i,t=>Ls(i.state,t,ee(i)));function l0(i,t){return Ee(i,e=>i.moveVertically(e,t))}const a0=i=>l0(i,!1),c0=i=>l0(i,!0);function h0(i,t){return Ee(i,e=>i.moveVertically(e,t,t0(i).height))}const u0=i=>h0(i,!1),d0=i=>h0(i,!0),sS=i=>Ee(i,t=>Wi(i,t,!0)),lS=i=>Ee(i,t=>Wi(i,t,!1)),aS=i=>Ee(i,t=>Wi(i,t,!ee(i))),cS=i=>Ee(i,t=>Wi(i,t,ee(i))),hS=i=>Ee(i,t=>O.cursor(i.lineBlockAt(t.head).from)),uS=i=>Ee(i,t=>O.cursor(i.lineBlockAt(t.head).to)),f0=({state:i,dispatch:t})=>(t(ei(i,{anchor:0})),!0),p0=({state:i,dispatch:t})=>(t(ei(i,{anchor:i.doc.length})),!0),m0=({state:i,dispatch:t})=>(t(ei(i,{anchor:i.selection.main.anchor,head:0})),!0),g0=({state:i,dispatch:t})=>(t(ei(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),dS=({state:i,dispatch:t})=>(t(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),fS=({state:i,dispatch:t})=>{let e=Es(i).map(({from:r,to:n})=>O.range(r,Math.min(n+1,i.doc.length)));return t(i.update({selection:O.create(e),userEvent:"select"})),!0},pS=({state:i,dispatch:t})=>{let e=Wr(i.selection,r=>{let n=te(i),o=n.resolveStack(r.from,1);if(r.empty){let s=n.resolveStack(r.from,-1);s.node.from>=o.node.from&&s.node.to<=o.node.to&&(o=s)}for(let s=o;s;s=s.next){let{node:l}=s;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&s.next)return O.range(l.to,l.from)}return r});return e.eq(i.selection)?!1:(t(ei(i,e)),!0)},mS=({state:i,dispatch:t})=>{let e=i.selection,r=null;return e.ranges.length>1?r=O.create([e.main]):e.main.empty||(r=O.create([O.cursor(e.main.head)])),r?(t(ei(i,r)),!0):!1};function Gn(i,t){if(i.state.readOnly)return!1;let e="delete.selection",{state:r}=i,n=r.changeByRange(o=>{let{from:s,to:l}=o;if(s==l){let a=t(o);a<s?(e="delete.backward",a=_s(i,a,!1)):a>s&&(e="delete.forward",a=_s(i,a,!0)),s=Math.min(s,a),l=Math.max(l,a)}else s=_s(i,s,!1),l=_s(i,l,!0);return s==l?{range:o}:{changes:{from:s,to:l},range:O.cursor(s,s<o.head?-1:1)}});return n.changes.empty?!1:(i.dispatch(r.update(n,{scrollIntoView:!0,userEvent:e,effects:e=="delete.selection"?V.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function _s(i,t,e){if(i instanceof V)for(let r of i.state.facet(V.atomicRanges).map(n=>n(i)))r.between(t,t,(n,o)=>{n<t&&o>t&&(t=e?o:n)});return t}const y0=(i,t,e)=>Gn(i,r=>{let n=r.from,{state:o}=i,s=o.doc.lineAt(n),l,a;if(e&&!t&&n>s.from&&n<s.from+200&&!/[^ \t]/.test(l=s.text.slice(0,n-s.from))){if(l[l.length-1]=="	")return n-1;let c=Lr(l,o.tabSize),h=c%ws(o)||ws(o);for(let u=0;u<h&&l[l.length-1-u]==" ";u++)n--;a=n}else a=Ht(s.text,n-s.from,t,t)+s.from,a==n&&s.number!=(t?o.doc.lines:1)?a+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(s.text.slice(a-s.from,n-s.from))&&(a=Ht(s.text,a-s.from,!1,!1)+s.from);return a}),yc=i=>y0(i,!1,!0),v0=i=>y0(i,!0,!1),w0=(i,t)=>Gn(i,e=>{let r=e.head,{state:n}=i,o=n.doc.lineAt(r),s=n.charCategorizer(r);for(let l=null;;){if(r==(t?o.to:o.from)){r==e.head&&o.number!=(t?n.doc.lines:1)&&(r+=t?1:-1);break}let a=Ht(o.text,r-o.from,t)+o.from,c=o.text.slice(Math.min(r,a)-o.from,Math.max(r,a)-o.from),h=s(c);if(l!=null&&h!=l)break;(c!=" "||r!=e.head)&&(l=h),r=a}return r}),b0=i=>w0(i,!1),gS=i=>w0(i,!0),yS=i=>Gn(i,t=>{let e=i.lineBlockAt(t.head).to;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),vS=i=>Gn(i,t=>{let e=i.moveToLineBoundary(t,!1).head;return t.head>e?e:Math.max(0,t.head-1)}),wS=i=>Gn(i,t=>{let e=i.moveToLineBoundary(t,!0).head;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),bS=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:ht.of(["",""])},range:O.cursor(r.from)}));return t(i.update(e,{scrollIntoView:!0,userEvent:"input"})),!0},xS=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(r=>{if(!r.empty||r.from==0||r.from==i.doc.length)return{range:r};let n=r.from,o=i.doc.lineAt(n),s=n==o.from?n-1:Ht(o.text,n-o.from,!1)+o.from,l=n==o.to?n+1:Ht(o.text,n-o.from,!0)+o.from;return{changes:{from:s,to:l,insert:i.doc.slice(n,l).append(i.doc.slice(s,n))},range:O.cursor(l)}});return e.changes.empty?!1:(t(i.update(e,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Es(i){let t=[],e=-1;for(let r of i.selection.ranges){let n=i.doc.lineAt(r.from),o=i.doc.lineAt(r.to);if(!r.empty&&r.to==o.from&&(o=i.doc.lineAt(r.to-1)),e>=n.number){let s=t[t.length-1];s.to=o.to,s.ranges.push(r)}else t.push({from:n.from,to:o.to,ranges:[r]});e=o.number+1}return t}function x0(i,t,e){if(i.readOnly)return!1;let r=[],n=[];for(let o of Es(i)){if(e?o.to==i.doc.length:o.from==0)continue;let s=i.doc.lineAt(e?o.to+1:o.from-1),l=s.length+1;if(e){r.push({from:o.to,to:s.to},{from:o.from,insert:s.text+i.lineBreak});for(let a of o.ranges)n.push(O.range(Math.min(i.doc.length,a.anchor+l),Math.min(i.doc.length,a.head+l)))}else{r.push({from:s.from,to:o.from},{from:o.to,insert:i.lineBreak+s.text});for(let a of o.ranges)n.push(O.range(a.anchor-l,a.head-l))}}return r.length?(t(i.update({changes:r,scrollIntoView:!0,selection:O.create(n,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const kS=({state:i,dispatch:t})=>x0(i,t,!1),SS=({state:i,dispatch:t})=>x0(i,t,!0);function k0(i,t,e){if(i.readOnly)return!1;let r=[];for(let n of Es(i))e?r.push({from:n.from,insert:i.doc.slice(n.from,n.to)+i.lineBreak}):r.push({from:n.to,insert:i.lineBreak+i.doc.slice(n.from,n.to)});return t(i.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const TS=({state:i,dispatch:t})=>k0(i,t,!1),AS=({state:i,dispatch:t})=>k0(i,t,!0),MS=i=>{if(i.state.readOnly)return!1;let{state:t}=i,e=t.changes(Es(t).map(({from:n,to:o})=>(n>0?n--:o<t.doc.length&&o++,{from:n,to:o}))),r=Wr(t.selection,n=>{let o;if(i.lineWrapping){let s=i.lineBlockAt(n.head),l=i.coordsAtPos(n.head,n.assoc||1);l&&(o=s.bottom+i.documentTop-l.bottom+i.defaultLineHeight/2)}return i.moveVertically(n,!0,o)}).map(e);return i.dispatch({changes:e,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function CS(i,t){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=te(i).resolveInner(t),r=e.childBefore(t),n=e.childAfter(t),o;return r&&n&&r.to<=t&&n.from>=t&&(o=r.type.prop(lt.closedBy))&&o.indexOf(n.name)>-1&&i.doc.lineAt(r.to).from==i.doc.lineAt(n.from).from&&!/\S/.test(i.sliceDoc(r.to,n.from))?{from:r.to,to:n.from}:null}const LS=S0(!1),_S=S0(!0);function S0(i){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{let{from:o,to:s}=n,l=t.doc.lineAt(o),a=!i&&o==s&&CS(t,o);i&&(o=s=(s<=l.to?l:t.doc.lineAt(s)).to);let c=new bs(t,{simulateBreak:o,simulateDoubleBreak:!!a}),h=rc(c,o);for(h==null&&(h=Lr(/^\s*/.exec(t.doc.lineAt(o).text)[0],t.tabSize));s<l.to&&/\s/.test(l.text[s-l.from]);)s++;a?{from:o,to:s}=a:o>l.from&&o<l.from+100&&!/\S/.test(l.text.slice(0,o))&&(o=l.from);let u=["",qn(t,h)];return a&&u.push(qn(t,c.lineIndent(l.from,-1))),{changes:{from:o,to:s,insert:ht.of(u)},range:O.cursor(o+1+u[1].length)}});return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function vc(i,t){let e=-1;return i.changeByRange(r=>{let n=[];for(let s=r.from;s<=r.to;){let l=i.doc.lineAt(s);l.number>e&&(r.empty||r.to>l.from)&&(t(l,n,r),e=l.number),s=l.to+1}let o=i.changes(n);return{changes:n,range:O.range(o.mapPos(r.anchor,1),o.mapPos(r.head,1))}})}const ES=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=Object.create(null),r=new bs(i,{overrideIndentation:o=>e[o]??-1}),n=vc(i,(o,s,l)=>{let a=rc(r,o.from);if(a==null)return;/\S/.test(o.text)||(a=0);let c=/^\s*/.exec(o.text)[0],h=qn(i,a);(c!=h||l.from<o.from+c.length)&&(e[o.from]=a,s.push({from:o.from,to:o.from+c.length,insert:h}))});return n.changes.empty||t(i.update(n,{userEvent:"indent"})),!0},T0=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(vc(i,(e,r)=>{r.push({from:e.from,insert:i.facet(vs)})}),{userEvent:"input.indent"})),!0),A0=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(vc(i,(e,r)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let o=Lr(n,i.tabSize),s=0,l=qn(i,Math.max(0,o-ws(i)));for(;s<n.length&&s<l.length&&n.charCodeAt(s)==l.charCodeAt(s);)s++;r.push({from:e.from+s,to:e.from+n.length,insert:l.slice(s)})}),{userEvent:"delete.dedent"})),!0),OS=i=>(i.setTabFocusMode(),!0),DS=[{key:"Ctrl-b",run:Yg,shift:n0,preventDefault:!0},{key:"Ctrl-f",run:Gg,shift:o0},{key:"Ctrl-p",run:Qg,shift:a0},{key:"Ctrl-n",run:Zg,shift:c0},{key:"Ctrl-a",run:Q5,shift:hS},{key:"Ctrl-e",run:Z5,shift:uS},{key:"Ctrl-d",run:v0},{key:"Ctrl-h",run:yc},{key:"Ctrl-k",run:yS},{key:"Ctrl-Alt-h",run:b0},{key:"Ctrl-o",run:bS},{key:"Ctrl-t",run:xS},{key:"Ctrl-v",run:gc}],PS=[{key:"ArrowLeft",run:Yg,shift:n0,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:z5,shift:iS,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:J5,shift:aS,preventDefault:!0},{key:"ArrowRight",run:Gg,shift:o0,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:j5,shift:rS,preventDefault:!0},{mac:"Cmd-ArrowRight",run:X5,shift:cS,preventDefault:!0},{key:"ArrowUp",run:Qg,shift:a0,preventDefault:!0},{mac:"Cmd-ArrowUp",run:f0,shift:m0},{mac:"Ctrl-ArrowUp",run:i0,shift:u0},{key:"ArrowDown",run:Zg,shift:c0,preventDefault:!0},{mac:"Cmd-ArrowDown",run:p0,shift:g0},{mac:"Ctrl-ArrowDown",run:gc,shift:d0},{key:"PageUp",run:i0,shift:u0},{key:"PageDown",run:gc,shift:d0},{key:"Home",run:G5,shift:lS,preventDefault:!0},{key:"Mod-Home",run:f0,shift:m0},{key:"End",run:Y5,shift:sS,preventDefault:!0},{key:"Mod-End",run:p0,shift:g0},{key:"Enter",run:LS},{key:"Mod-a",run:dS},{key:"Backspace",run:yc,shift:yc},{key:"Delete",run:v0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:b0},{key:"Mod-Delete",mac:"Alt-Delete",run:gS},{mac:"Mod-Backspace",run:vS},{mac:"Mod-Delete",run:wS}].concat(DS.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),RS=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:q5,shift:nS},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:K5,shift:oS},{key:"Alt-ArrowUp",run:kS},{key:"Shift-Alt-ArrowUp",run:TS},{key:"Alt-ArrowDown",run:SS},{key:"Shift-Alt-ArrowDown",run:AS},{key:"Escape",run:mS},{key:"Mod-Enter",run:_S},{key:"Alt-l",mac:"Ctrl-l",run:fS},{key:"Mod-i",run:pS,preventDefault:!0},{key:"Mod-[",run:A0},{key:"Mod-]",run:T0},{key:"Mod-Alt-\\",run:ES},{key:"Shift-Mod-k",run:MS},{key:"Shift-Mod-\\",run:eS},{key:"Mod-/",run:T5},{key:"Alt-A",run:M5},{key:"Ctrl-m",mac:"Shift-Alt-m",run:OS}].concat(PS),BS={key:"Tab",run:T0,shift:A0};function gt(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=e[r];typeof n=="string"?i.setAttribute(r,n):n!=null&&(i[r]=n)}t++}for(;t<arguments.length;t++)M0(i,arguments[t]);return i}function M0(i,t){if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)i.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)M0(i,t[e]);else throw new RangeError("Unsupported child node: "+t)}const C0=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class Fr{constructor(t,e,r=0,n=t.length,o,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(r,n),this.bufferStart=r,this.normalize=o?l=>o(C0(l)):C0,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ut(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=Il(t),r=this.bufferStart+this.bufferPos;this.bufferPos+=Se(t);let n=this.normalize(e);for(let o=0,s=r;;o++){let l=n.charCodeAt(o),a=this.match(l,s,this.bufferPos+this.bufferStart);if(o==n.length-1){if(a)return this.value=a,this;break}s==r&&o<e.length&&e.charCodeAt(o)==l&&s++}}}match(t,e,r){let n=null;for(let o=0;o<this.matches.length;o+=2){let s=this.matches[o],l=!1;this.query.charCodeAt(s)==t&&(s==this.query.length-1?n={from:this.matches[o+1],to:r}:(this.matches[o]++,l=!0)),l||(this.matches.splice(o,2),o-=2)}return this.query.charCodeAt(0)==t&&(this.query.length==1?n={from:e,to:r}:this.matches.push(1,e)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}typeof Symbol<"u"&&(Fr.prototype[Symbol.iterator]=function(){return this});const L0={from:-1,to:-1,match:/.*/.exec("")},wc="gm"+(/x/.unicode==null?"":"u");class _0{constructor(t,e,r,n=0,o=t.length){if(this.text=t,this.to=o,this.curLine="",this.done=!1,this.value=L0,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new E0(t,e,r,n,o);this.re=new RegExp(e,wc+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=Os(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let r=this.curLineStart+e.index,n=r+e[0].length;if(this.matchPos=Os(this.text,n+(r==n?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<n||r>this.value.to)&&(!this.test||this.test(r,n,e)))return this.value={from:r,to:n,match:e},this;t=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),t=0;else return this.done=!0,this}}}const bc=new WeakMap;class Vr{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,r){let n=bc.get(t);if(!n||n.from>=r||n.to<=e){let l=new Vr(e,t.sliceString(e,r));return bc.set(t,l),l}if(n.from==e&&n.to==r)return n;let{text:o,from:s}=n;return s>e&&(o=t.sliceString(e,s)+o,s=e),n.to<r&&(o+=t.sliceString(n.to,r)),bc.set(t,new Vr(s,o)),new Vr(e,o.slice(e-s,r-s))}}class E0{constructor(t,e,r,n,o){this.text=t,this.to=o,this.done=!1,this.value=L0,this.matchPos=Os(t,n),this.re=new RegExp(e,wc+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=Vr.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let r=this.flat.from+e.index,n=r+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,n,e)))return this.value={from:r,to:n,match:e},this.matchPos=Os(this.text,n+(r==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Vr.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(_0.prototype[Symbol.iterator]=E0.prototype[Symbol.iterator]=function(){return this});function NS(i){try{return new RegExp(i,wc),!0}catch{return!1}}function Os(i,t){if(t>=i.length)return t;let e=i.lineAt(t),r;for(;t<e.to&&(r=e.text.charCodeAt(t-e.from))>=56320&&r<57344;)t++;return t}function xc(i){let t=String(i.state.doc.lineAt(i.state.selection.main.head).number),e=gt("input",{class:"cm-textfield",name:"line",value:t}),r=gt("form",{class:"cm-gotoLine",onkeydown:o=>{o.keyCode==27?(o.preventDefault(),i.dispatch({effects:Ds.of(!1)}),i.focus()):o.keyCode==13&&(o.preventDefault(),n())},onsubmit:o=>{o.preventDefault(),n()}},gt("label",i.state.phrase("Go to line"),": ",e)," ",gt("button",{class:"cm-button",type:"submit"},i.state.phrase("go")));function n(){let o=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!o)return;let{state:s}=i,l=s.doc.lineAt(s.selection.main.head),[,a,c,h,u]=o,d=h?+h.slice(1):0,f=c?+c:l.number;if(c&&u){let p=f/100;a&&(p=p*(a=="-"?-1:1)+l.number/s.doc.lines),f=Math.round(s.doc.lines*p)}else c&&a&&(f=f*(a=="-"?-1:1)+l.number);let m=s.doc.line(Math.max(1,Math.min(s.doc.lines,f))),v=O.cursor(m.from+Math.max(0,Math.min(d,m.length)));i.dispatch({effects:[Ds.of(!1),V.scrollIntoView(v.from,{y:"center"})],selection:v}),i.focus()}return{dom:r}}const Ds=tt.define(),O0=zt.define({create(){return!0},update(i,t){for(let e of t.effects)e.is(Ds)&&(i=e.value);return i},provide:i=>Vn.from(i,t=>t?xc:null)}),IS=i=>{let t=Fn(i,xc);if(!t){let e=[Ds.of(!0)];i.state.field(O0,!1)==null&&e.push(tt.appendConfig.of([O0,WS])),i.dispatch({effects:e}),t=Fn(i,xc)}return t&&t.dom.querySelector("input").select(),!0},WS=V.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),FS={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},VS=U.define({combine(i){return $e(i,FS,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}});function HS(i){return[qS,$S]}const US=G.mark({class:"cm-selectionMatch"}),zS=G.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function D0(i,t,e,r){return(e==0||i(t.sliceDoc(e-1,e))!=kt.Word)&&(r==t.doc.length||i(t.sliceDoc(r,r+1))!=kt.Word)}function jS(i,t,e,r){return i(t.sliceDoc(e,e+1))==kt.Word&&i(t.sliceDoc(r-1,r))==kt.Word}const $S=_t.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=i.state.facet(VS),{state:e}=i,r=e.selection;if(r.ranges.length>1)return G.none;let n=r.main,o,s=null;if(n.empty){if(!t.highlightWordAroundCursor)return G.none;let a=e.wordAt(n.head);if(!a)return G.none;s=e.charCategorizer(n.head),o=e.sliceDoc(a.from,a.to)}else{let a=n.to-n.from;if(a<t.minSelectionLength||a>200)return G.none;if(t.wholeWords){if(o=e.sliceDoc(n.from,n.to),s=e.charCategorizer(n.head),!(D0(s,e,n.from,n.to)&&jS(s,e,n.from,n.to)))return G.none}else if(o=e.sliceDoc(n.from,n.to),!o)return G.none}let l=[];for(let a of i.visibleRanges){let c=new Fr(e.doc,o,a.from,a.to);for(;!c.next().done;){let{from:h,to:u}=c.value;if((!s||D0(s,e,h,u))&&(n.empty&&h<=n.from&&u>=n.to?l.push(zS.range(h,u)):(h>=n.to||u<=n.from)&&l.push(US.range(h,u)),l.length>t.maxMatches))return G.none}}return G.set(l)}},{decorations:i=>i.decorations}),qS=V.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),KS=({state:i,dispatch:t})=>{let{selection:e}=i,r=O.create(e.ranges.map(n=>i.wordAt(n.head)||O.cursor(n.head)),e.mainIndex);return r.eq(e)?!1:(t(i.update({selection:r})),!0)};function YS(i,t){let{main:e,ranges:r}=i.selection,n=i.wordAt(e.head),o=n&&n.from==e.from&&n.to==e.to;for(let s=!1,l=new Fr(i.doc,t,r[r.length-1].to);;)if(l.next(),l.done){if(s)return null;l=new Fr(i.doc,t,0,Math.max(0,r[r.length-1].from-1)),s=!0}else{if(s&&r.some(a=>a.from==l.value.from))continue;if(o){let a=i.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const GS=({state:i,dispatch:t})=>{let{ranges:e}=i.selection;if(e.some(o=>o.from===o.to))return KS({state:i,dispatch:t});let r=i.sliceDoc(e[0].from,e[0].to);if(i.selection.ranges.some(o=>i.sliceDoc(o.from,o.to)!=r))return!1;let n=YS(i,r);return n?(t(i.update({selection:i.selection.addRange(O.range(n.from,n.to),!1),effects:V.scrollIntoView(n.to)})),!0):!1},Hr=U.define({combine(i){return $e(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new lT(t),scrollToMatch:t=>V.scrollIntoView(t)})}});class P0{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||NS(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(e,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new ZS(this):new XS(this)}getCursor(t,e=0,r){let n=t.doc?t:ot.create({doc:t});return r==null&&(r=n.doc.length),this.regexp?zr(this,n,e,r):Ur(this,n,e,r)}}class R0{constructor(t){this.spec=t}}function Ur(i,t,e,r){return new Fr(t.doc,i.unquoted,e,r,i.caseSensitive?void 0:n=>n.toLowerCase(),i.wholeWord?JS(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function JS(i,t){return(e,r,n,o)=>((o>e||o+n.length<r)&&(o=Math.max(0,e-2),n=i.sliceString(o,Math.min(i.length,r+2))),(t(Ps(n,e-o))!=kt.Word||t(Rs(n,e-o))!=kt.Word)&&(t(Rs(n,r-o))!=kt.Word||t(Ps(n,r-o))!=kt.Word))}class XS extends R0{constructor(t){super(t)}nextMatch(t,e,r){let n=Ur(this.spec,t,r,t.doc.length).nextOverlapping();return n.done&&(n=Ur(this.spec,t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,r){for(let n=r;;){let o=Math.max(e,n-1e4-this.spec.unquoted.length),s=Ur(this.spec,t,o,n),l=null;for(;!s.nextOverlapping().done;)l=s.value;if(l)return l;if(o==e)return null;n-=1e4}}prevMatch(t,e,r){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,r,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let r=Ur(this.spec,t,0,t.doc.length),n=[];for(;!r.next().done;){if(n.length>=e)return null;n.push(r.value)}return n}highlight(t,e,r,n){let o=Ur(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,t.doc.length));for(;!o.next().done;)n(o.value.from,o.value.to)}}function zr(i,t,e,r){return new _0(t.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?QS(t.charCategorizer(t.selection.main.head)):void 0},e,r)}function Ps(i,t){return i.slice(Ht(i,t,!1),t)}function Rs(i,t){return i.slice(t,Ht(i,t))}function QS(i){return(t,e,r)=>!r[0].length||(i(Ps(r.input,r.index))!=kt.Word||i(Rs(r.input,r.index))!=kt.Word)&&(i(Rs(r.input,r.index+r[0].length))!=kt.Word||i(Ps(r.input,r.index+r[0].length))!=kt.Word)}class ZS extends R0{nextMatch(t,e,r){let n=zr(this.spec,t,r,t.doc.length).next();return n.done&&(n=zr(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,r){for(let n=1;;n++){let o=Math.max(e,r-n*1e4),s=zr(this.spec,t,o,r),l=null;for(;!s.next().done;)l=s.value;if(l&&(o==e||l.from>o+10))return l;if(o==e)return null}}prevMatch(t,e,r){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,r,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(e,r)=>r=="$"?"$":r=="&"?t.match[0]:r!="0"&&+r<t.match.length?t.match[r]:e)}matchAll(t,e){let r=zr(this.spec,t,0,t.doc.length),n=[];for(;!r.next().done;){if(n.length>=e)return null;n.push(r.value)}return n}highlight(t,e,r,n){let o=zr(this.spec,t,Math.max(0,e-250),Math.min(r+250,t.doc.length));for(;!o.next().done;)n(o.value.from,o.value.to)}}const Jn=tt.define(),kc=tt.define(),Fi=zt.define({create(i){return new Sc(Ac(i).create(),null)},update(i,t){for(let e of t.effects)e.is(Jn)?i=new Sc(e.value.create(),i.panel):e.is(kc)&&(i=new Sc(i.query,e.value?Tc:null));return i},provide:i=>Vn.from(i,t=>t.panel)});class Sc{constructor(t,e){this.query=t,this.panel=e}}const tT=G.mark({class:"cm-searchMatch"}),eT=G.mark({class:"cm-searchMatch cm-searchMatch-selected"}),iT=_t.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Fi))}update(i){let t=i.state.field(Fi);(t!=i.startState.field(Fi)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:i,panel:t}){if(!t||!i.spec.valid)return G.none;let{view:e}=this,r=new Ai;for(let n=0,o=e.visibleRanges,s=o.length;n<s;n++){let{from:l,to:a}=o[n];for(;n<s-1&&a>o[n+1].from-2*250;)a=o[++n].to;i.highlight(e.state,l,a,(c,h)=>{let u=e.state.selection.ranges.some(d=>d.from==c&&d.to==h);r.add(c,h,u?eT:tT)})}return r.finish()}},{decorations:i=>i.decorations});function Xn(i){return t=>{let e=t.state.field(Fi,!1);return e&&e.query.spec.valid?i(t,e):W0(t)}}const Bs=Xn((i,{query:t})=>{let{to:e}=i.state.selection.main,r=t.nextMatch(i.state,e,e);if(!r)return!1;let n=O.single(r.from,r.to),o=i.state.facet(Hr);return i.dispatch({selection:n,effects:[Mc(i,r),o.scrollToMatch(n.main,i)],userEvent:"select.search"}),I0(i),!0}),Ns=Xn((i,{query:t})=>{let{state:e}=i,{from:r}=e.selection.main,n=t.prevMatch(e,r,r);if(!n)return!1;let o=O.single(n.from,n.to),s=i.state.facet(Hr);return i.dispatch({selection:o,effects:[Mc(i,n),s.scrollToMatch(o.main,i)],userEvent:"select.search"}),I0(i),!0}),rT=Xn((i,{query:t})=>{let e=t.matchAll(i.state,1e3);return!e||!e.length?!1:(i.dispatch({selection:O.create(e.map(r=>O.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),nT=({state:i,dispatch:t})=>{let e=i.selection;if(e.ranges.length>1||e.main.empty)return!1;let{from:r,to:n}=e.main,o=[],s=0;for(let l=new Fr(i.doc,i.sliceDoc(r,n));!l.next().done;){if(o.length>1e3)return!1;l.value.from==r&&(s=o.length),o.push(O.range(l.value.from,l.value.to))}return t(i.update({selection:O.create(o,s),userEvent:"select.search.matches"})),!0},B0=Xn((i,{query:t})=>{let{state:e}=i,{from:r,to:n}=e.selection.main;if(e.readOnly)return!1;let o=t.nextMatch(e,r,r);if(!o)return!1;let s=[],l,a,c=[];if(o.from==r&&o.to==n&&(a=e.toText(t.getReplacement(o)),s.push({from:o.from,to:o.to,insert:a}),o=t.nextMatch(e,o.from,o.to),c.push(V.announce.of(e.phrase("replaced match on line $",e.doc.lineAt(r).number)+"."))),o){let h=s.length==0||s[0].from>=o.to?0:o.to-o.from-a.length;l=O.single(o.from-h,o.to-h),c.push(Mc(i,o)),c.push(e.facet(Hr).scrollToMatch(l.main,i))}return i.dispatch({changes:s,selection:l,effects:c,userEvent:"input.replace"}),!0}),oT=Xn((i,{query:t})=>{if(i.state.readOnly)return!1;let e=t.matchAll(i.state,1e9).map(n=>{let{from:o,to:s}=n;return{from:o,to:s,insert:t.getReplacement(n)}});if(!e.length)return!1;let r=i.state.phrase("replaced $ matches",e.length)+".";return i.dispatch({changes:e,effects:V.announce.of(r),userEvent:"input.replace.all"}),!0});function Tc(i){return i.state.facet(Hr).createPanel(i)}function Ac(i,t){var e,r,n,o,s;let l=i.selection.main,a=l.empty||l.to>l.from+100?"":i.sliceDoc(l.from,l.to);if(t&&!a)return t;let c=i.facet(Hr);return new P0({search:((e=t==null?void 0:t.literal)!==null&&e!==void 0?e:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(r=t==null?void 0:t.caseSensitive)!==null&&r!==void 0?r:c.caseSensitive,literal:(n=t==null?void 0:t.literal)!==null&&n!==void 0?n:c.literal,regexp:(o=t==null?void 0:t.regexp)!==null&&o!==void 0?o:c.regexp,wholeWord:(s=t==null?void 0:t.wholeWord)!==null&&s!==void 0?s:c.wholeWord})}function N0(i){let t=Fn(i,Tc);return t&&t.dom.querySelector("[main-field]")}function I0(i){let t=N0(i);t&&t==i.root.activeElement&&t.select()}const W0=i=>{let t=i.state.field(Fi,!1);if(t&&t.panel){let e=N0(i);if(e&&e!=i.root.activeElement){let r=Ac(i.state,t.query.spec);r.valid&&i.dispatch({effects:Jn.of(r)}),e.focus(),e.select()}}else i.dispatch({effects:[kc.of(!0),t?Jn.of(Ac(i.state,t.query.spec)):tt.appendConfig.of(cT)]});return!0},F0=i=>{let t=i.state.field(Fi,!1);if(!t||!t.panel)return!1;let e=Fn(i,Tc);return e&&e.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:kc.of(!1)}),!0},sT=[{key:"Mod-f",run:W0,scope:"editor search-panel"},{key:"F3",run:Bs,shift:Ns,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Bs,shift:Ns,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:F0,scope:"editor search-panel"},{key:"Mod-Shift-l",run:nT},{key:"Mod-Alt-g",run:IS},{key:"Mod-d",run:GS,preventDefault:!0}];class lT{constructor(t){this.view=t;let e=this.query=t.state.field(Fi).query.spec;this.commit=this.commit.bind(this),this.searchField=gt("input",{value:e.search,placeholder:ve(t,"Find"),"aria-label":ve(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=gt("input",{value:e.replace,placeholder:ve(t,"Replace"),"aria-label":ve(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=gt("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=gt("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=gt("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit});function r(n,o,s){return gt("button",{class:"cm-button",name:n,onclick:o,type:"button"},s)}this.dom=gt("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,r("next",()=>Bs(t),[ve(t,"next")]),r("prev",()=>Ns(t),[ve(t,"previous")]),r("select",()=>rT(t),[ve(t,"all")]),gt("label",null,[this.caseField,ve(t,"match case")]),gt("label",null,[this.reField,ve(t,"regexp")]),gt("label",null,[this.wordField,ve(t,"by word")]),...t.state.readOnly?[]:[gt("br"),this.replaceField,r("replace",()=>B0(t),[ve(t,"replace")]),r("replaceAll",()=>oT(t),[ve(t,"replace all")])],gt("button",{name:"close",onclick:()=>F0(t),"aria-label":ve(t,"close"),type:"button"},["\xD7"])])}commit(){let t=new P0({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Jn.of(t)}))}keydown(t){u2(this.view,t,"search-panel")?t.preventDefault():t.keyCode==13&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?Ns:Bs)(this.view)):t.keyCode==13&&t.target==this.replaceField&&(t.preventDefault(),B0(this.view))}update(t){for(let e of t.transactions)for(let r of e.effects)r.is(Jn)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Hr).top}}function ve(i,t){return i.state.phrase(t)}const Is=30,Ws=/[\s\.,:;?!]/;function Mc(i,{from:t,to:e}){let r=i.state.doc.lineAt(t),n=i.state.doc.lineAt(e).to,o=Math.max(r.from,t-Is),s=Math.min(n,e+Is),l=i.state.sliceDoc(o,s);if(o!=r.from){for(let a=0;a<Is;a++)if(!Ws.test(l[a+1])&&Ws.test(l[a])){l=l.slice(a);break}}if(s!=n){for(let a=l.length-1;a>l.length-Is;a--)if(!Ws.test(l[a-1])&&Ws.test(l[a])){l=l.slice(0,a);break}}return V.announce.of(`${i.state.phrase("current match")}. ${l} ${i.state.phrase("on line")} ${r.number}.`)}const aT=V.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),cT=[Fi,Ji.low(iT),aT];class V0{constructor(t,e,r,n){this.state=t,this.pos=e,this.explicit=r,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=te(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),r=Math.max(e.from,this.pos-250),n=e.text.slice(r-e.from,this.pos-e.from),o=n.search(z0(t,!1));return o<0?null:{from:r+o,to:this.pos,text:n.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,r){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function H0(i){let t=Object.keys(i).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function hT(i){let t=Object.create(null),e=Object.create(null);for(let{label:n}of i){t[n[0]]=!0;for(let o=1;o<n.length;o++)e[n[o]]=!0}let r=H0(t)+H0(e)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function uT(i){let t=i.map(n=>typeof n=="string"?{label:n}:n),[e,r]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:hT(t);return n=>{let o=n.matchBefore(r);return o||n.explicit?{from:o?o.from:n.pos,options:t,validFor:e}:null}}class U0{constructor(t,e,r,n){this.completion=t,this.source=e,this.match=r,this.score=n}}function Vi(i){return i.selection.main.from}function z0(i,t){var e;let{source:r}=i,n=t&&r[0]!="^",o=r[r.length-1]!="$";return!n&&!o?i:new RegExp(`${n?"^":""}(?:${r})${o?"$":""}`,(e=i.flags)!==null&&e!==void 0?e:i.ignoreCase?"i":"")}const j0=ui.define();function dT(i,t,e,r){let{main:n}=i.selection,o=e-n.from,s=r-n.from;return Object.assign(Object.assign({},i.changeByRange(l=>{if(l!=n&&e!=r&&i.sliceDoc(l.from+o,l.from+s)!=i.sliceDoc(e,r))return{range:l};let a=i.toText(t);return{changes:{from:l.from+o,to:r==n.from?l.to:l.from+s,insert:a},range:O.cursor(l.from+o+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const $0=new WeakMap;function fT(i){if(!Array.isArray(i))return i;let t=$0.get(i);return t||$0.set(i,t=uT(i)),t}const Fs=tt.define(),Qn=tt.define();class pT{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let r=Ut(t,e),n=Se(r);this.chars.push(r);let o=t.slice(e,e+n),s=o.toUpperCase();this.folded.push(Ut(s==o?o.toLowerCase():s,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:r,any:n,precise:o,byWord:s}=this;if(e.length==1){let b=Ut(t,0),k=Se(b),S=k==t.length?0:-100;if(b!=e[0])if(b==r[0])S+=-200;else return null;return this.ret(S,[0,k])}let l=t.indexOf(this.pattern);if(l==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=e.length,c=0;if(l<0){for(let b=0,k=Math.min(t.length,200);b<k&&c<a;){let S=Ut(t,b);(S==e[c]||S==r[c])&&(n[c++]=b),b+=Se(S)}if(c<a)return null}let h=0,u=0,d=!1,f=0,m=-1,v=-1,p=/[a-z]/.test(t),y=!0;for(let b=0,k=Math.min(t.length,200),S=0;b<k&&u<a;){let M=Ut(t,b);l<0&&(h<a&&M==e[h]&&(o[h++]=b),f<a&&(M==e[f]||M==r[f]?(f==0&&(m=b),v=b+1,f++):f=0));let L,A=M<255?M>=48&&M<=57||M>=97&&M<=122?2:M>=65&&M<=90?1:0:(L=Il(M))!=L.toLowerCase()?1:L!=L.toUpperCase()?2:0;(!b||A==1&&p||S==0&&A!=0)&&(e[u]==M||r[u]==M&&(d=!0)?s[u++]=b:s.length&&(y=!1)),S=A,b+=Se(M)}return u==a&&s[0]==0&&y?this.result(-100+(d?-200:0),s,t):f==a&&m==0?this.ret(-200-t.length+(v==t.length?0:-100),[0,v]):l>-1?this.ret(-700-t.length,[l,l+this.pattern.length]):f==a?this.ret(-900-t.length,[m,v]):u==a?this.result(-100+(d?-200:0)+-700+(y?0:-1100),s,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,r){let n=[],o=0;for(let s of e){let l=s+(this.astral?Se(Ut(r,s)):1);o&&n[o-1]==s?n[o-1]=l:(n[o++]=s,n[o++]=l)}return this.ret(t-r.length,n)}}class mT{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),r=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,e.length],this.score=r+(t.length==this.pattern.length?0:-100),this)}}const Kt=U.define({combine(i){return $e(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:gT,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>r=>q0(t(r),e(r)),optionClass:(t,e)=>r=>q0(t(r),e(r)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function q0(i,t){return i?t?i+" "+t:i:t}function gT(i,t,e,r,n,o){let s=i.textDirection==wt.RTL,l=s,a=!1,c="top",h,u,d=t.left-n.left,f=n.right-t.right,m=r.right-r.left,v=r.bottom-r.top;if(l&&d<Math.min(m,f)?l=!1:!l&&f<Math.min(m,d)&&(l=!0),m<=(l?d:f))h=Math.max(n.top,Math.min(e.top,n.bottom-v))-t.top,u=Math.min(400,l?d:f);else{a=!0,u=Math.min(400,(s?t.right:n.right-t.left)-30);let b=n.bottom-t.bottom;b>=v||b>t.top?h=e.bottom-t.top:(c="bottom",h=t.bottom-e.top)}let p=(t.bottom-t.top)/o.offsetHeight,y=(t.right-t.left)/o.offsetWidth;return{style:`${c}: ${h/p}px; max-width: ${u/y}px`,class:"cm-completionInfo-"+(a?s?"left-narrow":"right-narrow":l?"left":"right")}}function yT(i){let t=i.addToOptions.slice();return i.icons&&t.push({render(e){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),e.type&&r.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),r.setAttribute("aria-hidden","true"),r},position:20}),t.push({render(e,r,n,o){let s=document.createElement("span");s.className="cm-completionLabel";let l=e.displayLabel||e.label,a=0;for(let c=0;c<o.length;){let h=o[c++],u=o[c++];h>a&&s.appendChild(document.createTextNode(l.slice(a,h)));let d=s.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(l.slice(h,u))),d.className="cm-completionMatchedText",a=u}return a<l.length&&s.appendChild(document.createTextNode(l.slice(a))),s},position:50},{render(e){if(!e.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=e.detail,r},position:80}),t.sort((e,r)=>e.position-r.position).map(e=>e.render)}function Cc(i,t,e){if(i<=e)return{from:0,to:i};if(t<0&&(t=0),t<=i>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let r=Math.floor((i-t)/e);return{from:i-(r+1)*e,to:i-r*e}}class vT{constructor(t,e,r){this.view=t,this.stateField=e,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:o,selected:s}=n.open,l=t.state.facet(Kt);this.optionContent=yT(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Cc(o.length,s,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=t.state.field(e).open;for(let h=a.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(t,c[+u[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(Kt).closeOnBlur&&a.relatedTarget!=t.contentDOM&&t.dispatch({effects:Qn.of(null)})}),this.showOptions(o,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let r=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),r!=n){let{options:o,selected:s,disabled:l}=r.open;(!n.open||n.open.options!=o)&&(this.range=Cc(o.length,s,t.state.facet(Kt).maxRenderedOptions),this.showOptions(o,r.id)),this.updateSel(),l!=((e=n.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of e.split(" "))r&&this.dom.classList.add(r);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=Cc(e.options.length,e.selected,this.view.state.facet(Kt).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:r}=e.options[e.selected],{info:n}=r;if(!n)return;let o=typeof n=="string"?document.createTextNode(n):n(r);if(!o)return;"then"in o?o.then(s=>{s&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(s,r)}).catch(s=>ue(this.view.state,s,"completion info")):this.addInfoPane(o,r)}}addInfoPane(t,e){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",t.nodeType!=null)r.appendChild(t),this.infoDestroy=null;else{let{dom:n,destroy:o}=t;r.appendChild(n),this.infoDestroy=o||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let r=this.list.firstChild,n=this.range.from;r;r=r.nextSibling,n++)r.nodeName!="LI"||!r.id?n--:n==t?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),e=r):r.hasAttribute("aria-selected")&&r.removeAttribute("aria-selected");return e&&bT(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),o=this.space;if(!o){let s=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:s.innerWidth,bottom:s.innerHeight}}return n.top>Math.min(o.bottom,e.bottom)-10||n.bottom<Math.max(o.top,e.top)+10?null:this.view.state.facet(Kt).positionInfo(this.view,e,n,r,o,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,r){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let s=r.from;s<r.to;s++){let{completion:l,match:a}=t[s],{section:c}=l;if(c){let d=typeof c=="string"?c:c.name;if(d!=o&&(s>r.from||r.from==0))if(o=d,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let f=n.appendChild(document.createElement("completion-section"));f.textContent=d}}const h=n.appendChild(document.createElement("li"));h.id=e+"-"+s,h.setAttribute("role","option");let u=this.optionClass(l);u&&(h.className=u);for(let d of this.optionContent){let f=d(l,this.view.state,this.view,a);f&&h.appendChild(f)}}return r.from&&n.classList.add("cm-completionListIncompleteTop"),r.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function wT(i,t){return e=>new vT(e,i,t)}function bT(i,t){let e=i.getBoundingClientRect(),r=t.getBoundingClientRect(),n=e.height/i.offsetHeight;r.top<e.top?i.scrollTop-=(e.top-r.top)/n:r.bottom>e.bottom&&(i.scrollTop+=(r.bottom-e.bottom)/n)}function K0(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function xT(i,t){let e=[],r=null,n=c=>{e.push(c);let{section:h}=c.completion;if(h){r||(r=[]);let u=typeof h=="string"?h:h.name;r.some(d=>d.name==u)||r.push(typeof h=="string"?{name:u}:h)}},o=t.facet(Kt);for(let c of i)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let u of c.result.options)n(new U0(u,c.source,h?h(u):[],1e9-e.length));else{let u=t.sliceDoc(c.from,c.to),d,f=o.filterStrict?new mT(u):new pT(u);for(let m of c.result.options)if(d=f.match(m.label)){let v=m.displayLabel?h?h(m,d.matched):[]:d.matched;n(new U0(m,c.source,v,d.score+(m.boost||0)))}}}if(r){let c=Object.create(null),h=0,u=(d,f)=>{var m,v;return((m=d.rank)!==null&&m!==void 0?m:1e9)-((v=f.rank)!==null&&v!==void 0?v:1e9)||(d.name<f.name?-1:1)};for(let d of r.sort(u))h-=1e5,c[d.name]=h;for(let d of e){let{section:f}=d.completion;f&&(d.score+=c[typeof f=="string"?f:f.name])}}let s=[],l=null,a=o.compareCompletions;for(let c of e.sort((h,u)=>u.score-h.score||a(h.completion,u.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?s.push(c):K0(c.completion)>K0(l)&&(s[s.length-1]=c),l=c.completion}return s}class jr{constructor(t,e,r,n,o,s){this.options=t,this.attrs=e,this.tooltip=r,this.timestamp=n,this.selected=o,this.disabled=s}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new jr(this.options,Y0(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,r,n,o){let s=xT(t,e);if(!s.length)return n&&t.some(a=>a.state==1)?new jr(n.options,n.attrs,n.tooltip,n.timestamp,n.selected,!0):null;let l=e.facet(Kt).selectOnOpen?0:-1;if(n&&n.selected!=l&&n.selected!=-1){let a=n.options[n.selected].completion;for(let c=0;c<s.length;c++)if(s[c].completion==a){l=c;break}}return new jr(s,Y0(r,l),{pos:t.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:CT,above:o.aboveCursor},n?n.timestamp:Date.now(),l,!1)}map(t){return new jr(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Vs{constructor(t,e,r){this.active=t,this.id=e,this.open=r}static start(){return new Vs(AT,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,r=e.facet(Kt),n=(r.override||e.languageDataAt("autocomplete",Vi(e)).map(fT)).map(s=>(this.active.find(l=>l.source==s)||new we(s,this.active.some(l=>l.state!=0)?1:0)).update(t,r));n.length==this.active.length&&n.every((s,l)=>s==this.active[l])&&(n=this.active);let o=this.open;o&&t.docChanged&&(o=o.map(t.changes)),t.selection||n.some(s=>s.hasResult()&&t.changes.touchesRange(s.from,s.to))||!kT(n,this.active)?o=jr.build(n,e,this.id,o,r):o&&o.disabled&&!n.some(s=>s.state==1)&&(o=null),!o&&n.every(s=>s.state!=1)&&n.some(s=>s.hasResult())&&(n=n.map(s=>s.hasResult()?new we(s.source,0):s));for(let s of t.effects)s.is(X0)&&(o=o&&o.setSelected(s.value,this.id));return n==this.active&&o==this.open?this:new Vs(n,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?ST:TT}}function kT(i,t){if(i==t)return!0;for(let e=0,r=0;;){for(;e<i.length&&!i[e].hasResult;)e++;for(;r<t.length&&!t[r].hasResult;)r++;let n=e==i.length,o=r==t.length;if(n||o)return n==o;if(i[e++].result!=t[r++].result)return!1}}const ST={"aria-autocomplete":"list"},TT={};function Y0(i,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return t>-1&&(e["aria-activedescendant"]=i+"-"+t),e}const AT=[];function G0(i,t){if(i.isUserEvent("input.complete")){let r=i.annotation(j0);if(r&&t.activateOnCompletion(r))return 12}let e=i.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class we{constructor(t,e,r=-1){this.source=t,this.state=e,this.explicitPos=r}hasResult(){return!1}update(t,e){let r=G0(t,e),n=this;(r&8||r&16&&this.touches(t))&&(n=new we(n.source,0)),r&4&&n.state==0&&(n=new we(this.source,1)),n=n.updateFor(t,r);for(let o of t.effects)if(o.is(Fs))n=new we(n.source,1,o.value?Vi(t.state):-1);else if(o.is(Qn))n=new we(n.source,0);else if(o.is(J0))for(let s of o.value)s.source==n.source&&(n=s);return n}updateFor(t,e){return this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new we(this.source,this.state,t.mapPos(this.explicitPos))}touches(t){return t.changes.touchesRange(Vi(t.state))}}class $r extends we{constructor(t,e,r,n,o){super(t,2,e),this.result=r,this.from=n,this.to=o}hasResult(){return!0}updateFor(t,e){var r;if(!(e&3))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let o=t.changes.mapPos(this.from),s=t.changes.mapPos(this.to,1),l=Vi(t.state);if((this.explicitPos<0?l<=o:l<this.from)||l>s||!n||e&2&&Vi(t.startState)==this.from)return new we(this.source,e&4?1:0);let a=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos);return MT(n.validFor,t.state,o,s)?new $r(this.source,a,n,o,s):n.update&&(n=n.update(n,o,s,new V0(t.state,l,a>=0)))?new $r(this.source,a,n,n.from,(r=n.to)!==null&&r!==void 0?r:Vi(t.state)):new we(this.source,1,a)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new $r(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new we(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function MT(i,t,e,r){if(!i)return!1;let n=t.sliceDoc(e,r);return typeof i=="function"?i(n,e,r,t):z0(i,!0).test(n)}const J0=tt.define({map(i,t){return i.map(e=>e.map(t))}}),X0=tt.define(),fe=zt.define({create(){return Vs.start()},update(i,t){return i.update(t)},provide:i=>[za.from(i,t=>t.tooltip),V.contentAttributes.from(i,t=>t.attrs)]});function Lc(i,t){const e=t.completion.apply||t.completion.label;let r=i.state.field(fe).active.find(n=>n.source==t.source);return r instanceof $r?(typeof e=="string"?i.dispatch(Object.assign(Object.assign({},dT(i.state,e,r.from,r.to)),{annotations:j0.of(t.completion)})):e(i,t.completion,r.from,r.to),!0):!1}const CT=wT(fe,Lc);function Hs(i,t="option"){return e=>{let r=e.state.field(fe,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<e.state.facet(Kt).interactionDelay)return!1;let n=1,o;t=="page"&&(o=ig(e,r.open.tooltip))&&(n=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:s}=r.open.options,l=r.open.selected>-1?r.open.selected+n*(i?1:-1):i?0:s-1;return l<0?l=t=="page"?0:s-1:l>=s&&(l=t=="page"?s-1:0),e.dispatch({effects:X0.of(l)}),!0}}const LT=i=>{let t=i.state.field(fe,!1);return i.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<i.state.facet(Kt).interactionDelay?!1:Lc(i,t.open.options[t.open.selected])},Q0=i=>i.state.field(fe,!1)?(i.dispatch({effects:Fs.of(!0)}),!0):!1,_T=i=>{let t=i.state.field(fe,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(i.dispatch({effects:Qn.of(null)}),!0)};class ET{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const OT=50,DT=1e3,PT=_t.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of i.state.field(fe).active)t.state==1&&this.startQuery(t)}update(i){let t=i.state.field(fe),e=i.state.facet(Kt);if(!i.selectionSet&&!i.docChanged&&i.startState.field(fe)==t)return;let r=i.transactions.some(o=>{let s=G0(o,e);return s&8||(o.selection||o.docChanged)&&!(s&3)});for(let o=0;o<this.running.length;o++){let s=this.running[o];if(r||s.context.abortOnDocChange&&i.docChanged||s.updates.length+i.transactions.length>OT&&Date.now()-s.time>DT){for(let l of s.context.abortListeners)try{l()}catch(a){ue(this.view.state,a)}s.context.abortListeners=null,this.running.splice(o--,1)}else s.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(o=>o.effects.some(s=>s.is(Fs)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(o=>o.state==1&&!this.running.some(s=>s.active.source==o.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let o of i.transactions)o.isUserEvent("input.type")?this.composing=2:this.composing==2&&o.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,t=i.field(fe);for(let e of t.active)e.state==1&&!this.running.some(r=>r.active.source==e.source)&&this.startQuery(e)}startQuery(i){let{state:t}=this.view,e=Vi(t),r=new V0(t,e,i.explicitPos==e,this.view),n=new ET(i,r);this.running.push(n),Promise.resolve(i.source(r)).then(o=>{n.context.aborted||(n.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:Qn.of(null)}),ue(this.view.state,o)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Kt).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(Kt);for(let r=0;r<this.running.length;r++){let n=this.running[r];if(n.done===void 0)continue;if(this.running.splice(r--,1),n.done){let s=new $r(n.active.source,n.active.explicitPos,n.done,n.done.from,(i=n.done.to)!==null&&i!==void 0?i:Vi(n.updates.length?n.updates[0].startState:this.view.state));for(let l of n.updates)s=s.update(l,e);if(s.hasResult()){t.push(s);continue}}let o=this.view.state.field(fe).active.find(s=>s.source==n.active.source);if(o&&o.state==1)if(n.done==null){let s=new we(n.active.source,0);for(let l of n.updates)s=s.update(l,e);s.state!=1&&t.push(s)}else this.startQuery(o)}t.length&&this.view.dispatch({effects:J0.of(t)})}},{eventHandlers:{blur(i){let t=this.view.state.field(fe,!1);if(t&&t.tooltip&&this.view.state.facet(Kt).closeOnBlur){let e=t.open&&ig(this.view,t.open.tooltip);(!e||!e.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Qn.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Fs.of(!1)}),20),this.composing=0}}}),RT=typeof navigator=="object"&&/Win/.test(navigator.platform),BT=Ji.highest(V.domEventHandlers({keydown(i,t){let e=t.state.field(fe,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||i.key.length>1||i.ctrlKey&&!(RT&&i.altKey)||i.metaKey)return!1;let r=e.open.options[e.open.selected],n=e.active.find(s=>s.source==r.source),o=r.completion.commitCharacters||n.result.commitCharacters;return o&&o.indexOf(i.key)>-1&&Lc(t,r),!1}})),NT=V.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Zn={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},nr=tt.define({map(i,t){return t.mapPos(i,-1,ne.TrackAfter)??void 0}}),_c=new class extends Xi{};_c.startSide=1,_c.endSide=-1;const Z0=zt.define({create(){return at.empty},update(i,t){if(i=i.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);i=i.update({filter:r=>r>=e.from&&r<=e.to})}for(let e of t.effects)e.is(nr)&&(i=i.update({add:[_c.range(e.value,e.value+1)]}));return i}});function IT(){return[FT,Z0]}const Ec="()[]{}<>";function t1(i){for(let t=0;t<Ec.length;t+=2)if(Ec.charCodeAt(t)==i)return Ec.charAt(t+1);return Il(i<128?i:i+1)}function e1(i,t){return i.languageDataAt("closeBrackets",t)[0]||Zn}const WT=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),FT=V.inputHandler.of((i,t,e,r)=>{if((WT?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let n=i.state.selection.main;if(r.length>2||r.length==2&&Se(Ut(r,0))==1||t!=n.from||e!=n.to)return!1;let o=UT(i.state,r);return o?(i.dispatch(o),!0):!1}),VT=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=e1(i,i.selection.main.head).brackets||Zn.brackets,r=null,n=i.changeByRange(o=>{if(o.empty){let s=zT(i.doc,o.head);for(let l of e)if(l==s&&Us(i.doc,o.head)==t1(Ut(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:O.cursor(o.head-l.length)}}return{range:r=o}});return r||t(i.update(n,{scrollIntoView:!0,userEvent:"delete.backward"})),!r},HT=[{key:"Backspace",run:VT}];function UT(i,t){let e=e1(i,i.selection.main.head),r=e.brackets||Zn.brackets;for(let n of r){let o=t1(Ut(n,0));if(t==n)return o==n?qT(i,n,r.indexOf(n+n+n)>-1,e):jT(i,n,o,e.before||Zn.before);if(t==o&&i1(i,i.selection.main.from))return $T(i,n,o)}return null}function i1(i,t){let e=!1;return i.field(Z0).between(0,i.doc.length,r=>{r==t&&(e=!0)}),e}function Us(i,t){let e=i.sliceString(t,t+2);return e.slice(0,Se(Ut(e,0)))}function zT(i,t){let e=i.sliceString(t-2,t);return Se(Ut(e,0))==e.length?e:e.slice(1)}function jT(i,t,e,r){let n=null,o=i.changeByRange(s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:e,from:s.to}],effects:nr.of(s.to+t.length),range:O.range(s.anchor+t.length,s.head+t.length)};let l=Us(i.doc,s.head);return!l||/\s/.test(l)||r.indexOf(l)>-1?{changes:{insert:t+e,from:s.head},effects:nr.of(s.head+t.length),range:O.cursor(s.head+t.length)}:{range:n=s}});return n?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function $T(i,t,e){let r=null,n=i.changeByRange(o=>o.empty&&Us(i.doc,o.head)==e?{changes:{from:o.head,to:o.head+e.length,insert:e},range:O.cursor(o.head+e.length)}:r={range:o});return r?null:i.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function qT(i,t,e,r){let n=r.stringPrefixes||Zn.stringPrefixes,o=null,s=i.changeByRange(l=>{if(!l.empty)return{changes:[{insert:t,from:l.from},{insert:t,from:l.to}],effects:nr.of(l.to+t.length),range:O.range(l.anchor+t.length,l.head+t.length)};let a=l.head,c=Us(i.doc,a),h;if(c==t){if(r1(i,a))return{changes:{insert:t+t,from:a},effects:nr.of(a+t.length),range:O.cursor(a+t.length)};if(i1(i,a)){let u=e&&i.sliceDoc(a,a+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:a,to:a+u.length,insert:u},range:O.cursor(a+u.length)}}}else{if(e&&i.sliceDoc(a-2*t.length,a)==t+t&&(h=n1(i,a-2*t.length,n))>-1&&r1(i,h))return{changes:{insert:t+t+t+t,from:a},effects:nr.of(a+t.length),range:O.cursor(a+t.length)};if(i.charCategorizer(a)(c)!=kt.Word&&n1(i,a,n)>-1&&!KT(i,a,t,n))return{changes:{insert:t+t,from:a},effects:nr.of(a+t.length),range:O.cursor(a+t.length)}}return{range:o=l}});return o?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function r1(i,t){let e=te(i).resolveInner(t+1);return e.parent&&e.from==t}function KT(i,t,e,r){let n=te(i).resolveInner(t,-1),o=r.reduce((s,l)=>Math.max(s,l.length),0);for(let s=0;s<5;s++){let l=i.sliceDoc(n.from,Math.min(n.to,n.from+e.length+o)),a=l.indexOf(e);if(!a||a>-1&&r.indexOf(l.slice(0,a))>-1){let h=n.firstChild;for(;h&&h.from==n.from&&h.to-h.from>e.length+a;){if(i.sliceDoc(h.to-e.length,h.to)==e)return!1;h=h.firstChild}return!0}let c=n.to==t&&n.parent;if(!c)break;n=c}return!1}function n1(i,t,e){let r=i.charCategorizer(t);if(r(i.sliceDoc(t-1,t))!=kt.Word)return t;for(let n of e){let o=t-n.length;if(i.sliceDoc(o,t)==n&&r(i.sliceDoc(o-1,o))!=kt.Word)return o}return-1}function YT(i={}){return[BT,fe,Kt.of(i),PT,GT,NT]}const o1=[{key:"Ctrl-Space",run:Q0},{mac:"Alt-`",run:Q0},{key:"Escape",run:_T},{key:"ArrowDown",run:Hs(!0)},{key:"ArrowUp",run:Hs(!1)},{key:"PageDown",run:Hs(!0,"page")},{key:"PageUp",run:Hs(!1,"page")},{key:"Enter",run:LT}],GT=Ji.highest(es.computeN([Kt],i=>i.facet(Kt).defaultKeymap?[o1]:[]));class JT{constructor(t,e,r){this.from=t,this.to=e,this.diagnostic=r}}class or{constructor(t,e,r){this.diagnostics=t,this.panel=e,this.selected=r}static init(t,e,r){let n=t,o=r.facet(to).markerFilter;o&&(n=o(n,r));let s=G.set(n.map(l=>l.from==l.to||l.from==l.to-1&&r.doc.lineAt(l.from).to==l.from?G.widget({widget:new oA(l),diagnostic:l}).range(l.from):G.mark({attributes:{class:"cm-lintRange cm-lintRange-"+l.severity+(l.markClass?" "+l.markClass:"")},diagnostic:l}).range(l.from,l.to)),!0);return new or(s,e,qr(s))}}function qr(i,t=null,e=0){let r=null;return i.between(e,1e9,(n,o,{spec:s})=>{if(!(t&&s.diagnostic!=t))return r=new JT(n,o,s.diagnostic),!1}),r}function XT(i,t){let e=t.pos,r=t.end||e,n=i.state.facet(to).hideOn(i,e,r);if(n!=null)return n;let o=i.startState.doc.lineAt(t.pos);return!!(i.effects.some(s=>s.is(s1))||i.changes.touchesRange(o.from,Math.max(o.to,r)))}function QT(i,t){return i.field(be,!1)?t:t.concat(tt.appendConfig.of(aA))}const s1=tt.define(),Oc=tt.define(),l1=tt.define(),be=zt.define({create(){return new or(G.none,null,null)},update(i,t){if(t.docChanged&&i.diagnostics.size){let e=i.diagnostics.map(t.changes),r=null,n=i.panel;if(i.selected){let o=t.changes.mapPos(i.selected.from,1);r=qr(e,i.selected.diagnostic,o)||qr(e,null,o)}!e.size&&n&&t.state.facet(to).autoPanel&&(n=null),i=new or(e,n,r)}for(let e of t.effects)if(e.is(s1)){let r=t.state.facet(to).autoPanel?e.value.length?eo.open:null:i.panel;i=or.init(e.value,r,t.state)}else e.is(Oc)?i=new or(i.diagnostics,e.value?eo.open:null,i.selected):e.is(l1)&&(i=new or(i.diagnostics,i.panel,e.value));return i},provide:i=>[Vn.from(i,t=>t.panel),V.decorations.from(i,t=>t.diagnostics)]}),ZT=G.mark({class:"cm-lintRange cm-lintRange-active"});function tA(i,t,e){let{diagnostics:r}=i.state.field(be),n=[],o=2e8,s=0;r.between(t-(e<0?1:0),t+(e>0?1:0),(a,c,{spec:h})=>{t>=a&&t<=c&&(a==c||(t>a||e>0)&&(t<c||e<0))&&(n.push(h.diagnostic),o=Math.min(a,o),s=Math.max(c,s))});let l=i.state.facet(to).tooltipFilter;return l&&(n=l(n,i.state)),n.length?{pos:o,end:s,above:i.state.doc.lineAt(o).to<s,create(){return{dom:eA(i,n)}}}:null}function eA(i,t){return gt("ul",{class:"cm-tooltip-lint"},t.map(e=>h1(i,e,!1)))}const iA=i=>{let t=i.state.field(be,!1);(!t||!t.panel)&&i.dispatch({effects:QT(i.state,[Oc.of(!0)])});let e=Fn(i,eo.open);return e&&e.dom.querySelector(".cm-panel-lint ul").focus(),!0},a1=i=>{let t=i.state.field(be,!1);return!t||!t.panel?!1:(i.dispatch({effects:Oc.of(!1)}),!0)},rA=i=>{let t=i.state.field(be,!1);if(!t)return!1;let e=i.state.selection.main,r=t.diagnostics.iter(e.to+1);return!r.value&&(r=t.diagnostics.iter(0),!r.value||r.from==e.from&&r.to==e.to)?!1:(i.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},nA=[{key:"Mod-Shift-m",run:iA,preventDefault:!0},{key:"F8",run:rA}],to=U.define({combine(i){return Object.assign({sources:i.map(t=>t.source).filter(t=>t!=null)},$e(i.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,e)=>t?e?r=>t(r)||e(r):t:e}))}});function c1(i){let t=[];if(i)t:for(let{name:e}of i){for(let r=0;r<e.length;r++){let n=e[r];if(/[a-zA-Z]/.test(n)&&!t.some(o=>o.toLowerCase()==n.toLowerCase())){t.push(n);continue t}}t.push("")}return t}function h1(i,t,e){var r;let n=e?c1(t.actions):[];return gt("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},gt("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(i):t.message),(r=t.actions)===null||r===void 0?void 0:r.map((o,s)=>{let l=!1,a=d=>{if(d.preventDefault(),l)return;l=!0;let f=qr(i.state.field(be).diagnostics,t);f&&o.apply(i,f.from,f.to)},{name:c}=o,h=n[s]?c.indexOf(n[s]):-1,u=h<0?c:[c.slice(0,h),gt("u",c.slice(h,h+1)),c.slice(h+1)];return gt("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${c}${h<0?"":` (access key "${n[s]})"`}.`},u)}),t.source&&gt("div",{class:"cm-diagnosticSource"},t.source))}class oA extends fi{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return gt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class u1{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=h1(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class eo{constructor(t){this.view=t,this.items=[];let e=n=>{if(n.keyCode==27)a1(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:o}=this.items[this.selectedIndex],s=c1(o.actions);for(let l=0;l<s.length;l++)if(s[l].toUpperCase().charCodeAt(0)==n.keyCode){let a=qr(this.view.state.field(be).diagnostics,o);a&&o.actions[l].apply(t,a.from,a.to)}}else return;n.preventDefault()},r=n=>{for(let o=0;o<this.items.length;o++)this.items[o].dom.contains(n.target)&&this.moveSelection(o)};this.list=gt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:r}),this.dom=gt("div",{class:"cm-panel-lint"},this.list,gt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>a1(this.view)},"\xD7")),this.update()}get selectedIndex(){let t=this.view.state.field(be).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(be),r=0,n=!1,o=null;for(t.between(0,this.view.state.doc.length,(s,l,{spec:a})=>{let c=-1,h;for(let u=r;u<this.items.length;u++)if(this.items[u].diagnostic==a.diagnostic){c=u;break}c<0?(h=new u1(this.view,a.diagnostic),this.items.splice(r,0,h),n=!0):(h=this.items[c],c>r&&(this.items.splice(r,c-r),n=!0)),e&&h.diagnostic==e.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),o=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),r++});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new u1(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:l})=>{let a=l.height/this.list.offsetHeight;s.top<l.top?this.list.scrollTop-=(l.top-s.top)/a:s.bottom>l.bottom&&(this.list.scrollTop+=(s.bottom-l.bottom)/a)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let r=t;t=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;t!=r.dom;)e();t=r.dom.nextSibling}else this.list.insertBefore(r.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(be),r=qr(e.diagnostics,this.items[t].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:l1.of(r)})}static open(t){return new eo(t)}}function sA(i,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(i)}</svg>')`}function zs(i){return sA(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const lA=V.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:zs("#d11")},".cm-lintRange-warning":{backgroundImage:zs("orange")},".cm-lintRange-info":{backgroundImage:zs("#999")},".cm-lintRange-hint":{backgroundImage:zs("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),aA=[be,V.decorations.compute([be],i=>{let{selected:t,panel:e}=i.field(be);return!t||!e||t.from==t.to?G.none:G.set([ZT.range(t.from,t.to)])}),Z2(tA,{hideOn:XT}),lA],cA=[hk(),fk(),L2(),P5(),o5(),y2(),k2(),ot.allowMultipleSelections.of(!0),$k(),l5(h5,{fallback:!0}),y5(),IT(),YT(),U2(),$2(),R2(),HS(),es.of([...HT,...RS,...sT,...U5,...e5,...o1,...nA])];var hA=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[cA]}),uA=Symbol("vue-codemirror-global-config"),le,dA=function(i){var t=i.onUpdate,e=i.onChange,r=i.onFocus,n=i.onBlur,o=function(s,l){var a={};for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&l.indexOf(c)<0&&(a[c]=s[c]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function"){var h=0;for(c=Object.getOwnPropertySymbols(s);h<c.length;h++)l.indexOf(c[h])<0&&Object.prototype.propertyIsEnumerable.call(s,c[h])&&(a[c[h]]=s[c[h]])}return a}(i,["onUpdate","onChange","onFocus","onBlur"]);return ot.create({doc:o.doc,selection:o.selection,extensions:(Array.isArray(o.extensions)?o.extensions:[o.extensions]).concat([V.updateListener.of(function(s){t(s),s.docChanged&&e(s.state.doc.toString(),s),s.focusChanged&&(s.view.hasFocus?r(s):n(s))})])})},Kr=function(i){var t=new wn;return{compartment:t,run:function(e){t.get(i.state)?i.dispatch({effects:t.reconfigure(e)}):i.dispatch({effects:tt.appendConfig.of(t.of(e))})}}},d1=function(i,t){var e=Kr(i),r=e.compartment,n=e.run;return function(o){var s=r.get(i.state);n(o??s!==t?t:[])}},js={type:Boolean,default:void 0},fA={autofocus:js,disabled:js,indentWithTab:js,tabSize:Number,placeholder:String,style:Object,autoDestroy:js,phrases:Object,root:Object,extensions:Array,selection:Object},pA={modelValue:{type:String,default:""}},mA=Object.assign(Object.assign({},fA),pA);(function(i){i.Change="change",i.Update="update",i.Focus="focus",i.Blur="blur",i.Ready="ready",i.ModelUpdate="update:modelValue"})(le||(le={}));var sr={};sr[le.Change]=function(i,t){return!0},sr[le.Update]=function(i){return!0},sr[le.Focus]=function(i){return!0},sr[le.Blur]=function(i){return!0},sr[le.Ready]=function(i){return!0};var f1={};f1[le.ModelUpdate]=sr[le.Change];var gA=Object.assign(Object.assign({},sr),f1),yA=Q({name:"VueCodemirror",props:Object.assign({},mA),emits:Object.assign({},gA),setup:function(i,t){var e=Js(),r=Js(),n=Js(),o=Object.assign(Object.assign({},hA),Hc(uA,{})),s=Dt(function(){var l={};return Object.keys(Bt(i)).forEach(function(a){var c;a!=="modelValue"&&(l[a]=(c=i[a])!==null&&c!==void 0?c:o[a])}),l});return hr(function(){var l;r.value=dA({doc:i.modelValue,selection:s.value.selection,extensions:(l=o.extensions)!==null&&l!==void 0?l:[],onFocus:function(c){return t.emit(le.Focus,c)},onBlur:function(c){return t.emit(le.Blur,c)},onUpdate:function(c){return t.emit(le.Update,c)},onChange:function(c,h){c!==i.modelValue&&(t.emit(le.Change,c,h),t.emit(le.ModelUpdate,c,h))}}),n.value=function(c){return new V(Object.assign({},c))}({state:r.value,parent:e.value,root:s.value.root});var a=function(c){var h=function(){return c.state.doc.toString()},u=Kr(c).run,d=d1(c,[V.editable.of(!1),ot.readOnly.of(!0)]),f=d1(c,es.of([BS])),m=Kr(c).run,v=Kr(c).run,p=Kr(c).run,y=Kr(c).run;return{focus:function(){return c.focus()},getDoc:h,setDoc:function(b){b!==h()&&c.dispatch({changes:{from:0,to:c.state.doc.length,insert:b}})},reExtensions:u,toggleDisabled:d,toggleIndentWithTab:f,setTabSize:function(b){m([ot.tabSize.of(b),vs.of(" ".repeat(b))])},setPhrases:function(b){v([ot.phrases.of(b)])},setPlaceholder:function(b){p(W2(b))},setStyle:function(b){b===void 0&&(b={}),y(V.theme({"&":Object.assign({},b)}))}}}(n.value);xe(function(){return i.modelValue},function(c){c!==a.getDoc()&&a.setDoc(c)}),xe(function(){return i.extensions},function(c){return a.reExtensions(c||[])},{immediate:!0}),xe(function(){return s.value.disabled},function(c){return a.toggleDisabled(c)},{immediate:!0}),xe(function(){return s.value.indentWithTab},function(c){return a.toggleIndentWithTab(c)},{immediate:!0}),xe(function(){return s.value.tabSize},function(c){return a.setTabSize(c)},{immediate:!0}),xe(function(){return s.value.phrases},function(c){return a.setPhrases(c||{})},{immediate:!0}),xe(function(){return s.value.placeholder},function(c){return a.setPlaceholder(c)},{immediate:!0}),xe(function(){return s.value.style},function(c){return a.setStyle(c)},{immediate:!0}),s.value.autofocus&&a.focus(),t.emit(le.Ready,{state:r.value,view:n.value,container:e.value})}),PM(function(){s.value.autoDestroy&&n.value&&function(l){l.destroy()}(n.value)}),function(){return Xr("div",{class:"v-codemirror",style:{display:"contents"},ref:e})}}}),vA=yA;const wA={class:"import-plain-text-editor"},bA={class:"import-plain-text-options"},xA=Q({__name:"ImportPlainTextModal",setup(i){const t=We(),e=Ve(),{t:r}=Jt({useScope:"global"}),n=Zr({textContent:"",fullscreen:!1,importMode:"lyric-only",lyricSplitMode:"interleaved-line",sameLineSeparator:"|",swapTransAndRoman:!1,wordSeparator:"\\",prefixMarkup:!1,bgLinePrefix:"<",duetLinePrefix:">",emptyBeat:!1,emptyBeatMark:"^"}),o=[{label:r("importPlainTextModal.lyricOnly"),value:"lyric-only"},{label:r("importPlainTextModal.lyricWithTranslation"),value:"lyric-with-translation"},{label:r("importPlainTextModal.lyricWithRoman"),value:"lyric-with-roman"},{label:r("importPlainTextModal.lyricWithTranslationAndRoman"),value:"lyric-with-translation-and-roman"}],s=[{label:r("importPlainTextModal.interleavedLine"),value:"interleaved-line"},{label:r("importPlainTextModal.sameLineWithSeparator"),value:"same-line-separator"}];function l(){const a=n.textContent.split(`
`),c=[];function h(d="",f="",m=""){let v=!1,p=!1;if(n.prefixMarkup)for(let y=0;y<2;y++)if(d.startsWith(n.bgLinePrefix))d=d.substring(n.bgLinePrefix.length),v=!0;else if(d.startsWith(n.duetLinePrefix))d=d.substring(n.duetLinePrefix.length),p=!0;else break;c.push({words:[{word:d,startTime:0,endTime:0}],translatedLyric:f,romanLyric:m,isBG:v,isDuet:p,selected:!1,startTime:0,endTime:0})}function u(){for(const d of a)h(d)}switch(n.importMode){case"lyric-with-translation":{switch(n.lyricSplitMode){case"interleaved-line":{for(let d=0;d<a.length;d+=2)h(a[d],a[d+1]);break}case"same-line-separator":{if(n.sameLineSeparator==="")u();else for(const d of a){const[f,m]=d.split(n.sameLineSeparator);h(f,m)}break}default:return}break}case"lyric-with-roman":{switch(n.lyricSplitMode){case"interleaved-line":{for(let d=0;d<a.length;d+=2)h(a[d],"",a[d+1]);break}case"same-line-separator":{if(n.sameLineSeparator==="")u();else for(const d of a){const[f,m]=d.split(n.sameLineSeparator);h(f,"",m)}break}default:return}break}case"lyric-with-translation-and-roman":{switch(n.lyricSplitMode){case"interleaved-line":{for(let d=0;d<a.length;d+=3)h(a[d],a[d+1],a[d+2]);break}case"same-line-separator":{if(n.sameLineSeparator==="")u();else for(const d of a){const[f,m,v]=d.split(n.sameLineSeparator);h(f,m,v)}break}default:return}break}case"lyric-only":u();break;default:return}if(n.swapTransAndRoman&&c.forEach(d=>{[d.romanLyric,d.translatedLyric]=[d.translatedLyric,d.romanLyric]}),n.wordSeparator.length>0&&c.forEach(d=>{const f=d.words.map(m=>m.word).join("");d.words=f.split(n.wordSeparator).map(m=>({word:m,startTime:0,endTime:0}))}),n.emptyBeat&&n.emptyBeatMark.trim().length===1){const d=n.emptyBeatMark.trim();c.forEach(f=>{f.words.forEach(m=>{let v=m.word;for(;v.endsWith(d);)v=v.substring(0,v.length-d.length),m.emptyBeat?m.emptyBeat+=1:m.emptyBeat=1;m.word=v})})}t.lyrics=c,t.record(),e.importFromText=!1}return(a,c)=>{const h=De("i18n-t");return W(),xt(g(ri),{class:jc({"import-plain-text-modal":!0,fullscreen:n.fullscreen}),show:g(e).importFromText,title:g(r)("importPlainTextModal.title"),"content-style":"display:flex;gap:16px;align-items:stretch;max-height:100%;overflow:hidden;",preset:"card","transform-origin":"center",onClose:c[12]||(c[12]=u=>g(e).importFromText=!1)},{"header-extra":E(()=>[w(g(rt),{circle:"",quaternary:"",onClick:c[0]||(c[0]=u=>n.fullscreen=!n.fullscreen)},{default:E(()=>[w(g(gi),{size:"18"},{default:E(()=>[w(g(ju))]),_:1})]),_:1})]),default:E(()=>[x("div",wA,[w(g(vA),{"model-value":n.textContent,"onUpdate:modelValue":c[1]||(c[1]=u=>n.textContent=u),placeholder:g(r)("importPlainTextModal.textPlaceholder"),style:{height:"100%"}},null,8,["model-value","placeholder"])]),x("div",bA,[x("div",null,[w(h,{keypath:"importPlainTextModal.importMode"}),w(g(lo),{value:n.importMode,"onUpdate:value":c[2]||(c[2]=u=>n.importMode=u),options:o},null,8,["value"]),w(h,{keypath:"importPlainTextModal.lyricSplitMode"}),w(g(lo),{value:n.lyricSplitMode,"onUpdate:value":c[3]||(c[3]=u=>n.lyricSplitMode=u),disabled:n.importMode==="lyric-only",options:s},null,8,["value","disabled"]),w(h,{keypath:"importPlainTextModal.sameLineSeparator"}),w(g(me),{value:n.sameLineSeparator,"onUpdate:value":c[4]||(c[4]=u=>n.sameLineSeparator=u),disabled:n.importMode==="lyric-only"||n.lyricSplitMode==="interleaved-line",placeholder:g(r)("importPlainTextModal.sameLineSeparatorPlaceholder")},null,8,["value","disabled","placeholder"]),w(h,{keypath:"importPlainTextModal.swapTransAndRoman"}),w(g(tl),{checked:n.swapTransAndRoman,"onUpdate:checked":c[5]||(c[5]=u=>n.swapTransAndRoman=u),disabled:n.importMode==="lyric-only"||n.importMode==="lyric-with-translation",style:{"justify-self":"flex-end"}},null,8,["checked","disabled"]),w(h,{keypath:"importPlainTextModal.wordSeparator"}),w(g(me),{value:n.wordSeparator,"onUpdate:value":c[6]||(c[6]=u=>n.wordSeparator=u),placeholder:g(r)("importPlainTextModal.wordSeparatorPlaceholder")},null,8,["value","placeholder"]),w(h,{keypath:"importPlainTextModal.enablePrefixMarkup"}),w(g(tl),{checked:n.prefixMarkup,"onUpdate:checked":c[7]||(c[7]=u=>n.prefixMarkup=u),style:{"justify-self":"flex-end"}},null,8,["checked"]),w(h,{keypath:"importPlainTextModal.bgLinePrefix"}),w(g(me),{value:n.bgLinePrefix,"onUpdate:value":c[8]||(c[8]=u=>n.bgLinePrefix=u),disabled:!n.prefixMarkup,placeholder:g(r)("importPlainTextModal.wordSeparatorPlaceholder")},null,8,["value","disabled","placeholder"]),w(h,{keypath:"importPlainTextModal.duetLinePrefix"}),w(g(me),{value:n.duetLinePrefix,"onUpdate:value":c[9]||(c[9]=u=>n.duetLinePrefix=u),disabled:!n.prefixMarkup,placeholder:g(r)("importPlainTextModal.wordSeparatorPlaceholder")},null,8,["value","disabled","placeholder"]),w(h,{keypath:"importPlainTextModal.emptyBeat"}),w(g(tl),{checked:n.emptyBeat,"onUpdate:checked":c[10]||(c[10]=u=>n.emptyBeat=u),style:{"justify-self":"flex-end"}},null,8,["checked"]),w(h,{keypath:"importPlainTextModal.emptyBeatMark"}),w(g(me),{value:n.emptyBeatMark,"onUpdate:value":c[11]||(c[11]=u=>n.emptyBeatMark=u),disabled:!n.emptyBeat,placeholder:g(r)("importPlainTextModal.wordSeparatorPlaceholder")},null,8,["value","disabled","placeholder"])]),x("div",null,[w(g(rt),{type:"primary",onClick:l},{default:E(()=>[w(h,{keypath:"importPlainTextModal.importBtn"})]),_:1})])])]),_:1},8,["class","show","title"])}}}),kA=Fe(xA,[["__scopeId","data-v-c84e25e9"]]),SA={style:{"text-align":"right"}},TA={class:"key"},AA={class:"entry"},MA={colspan:"2"},CA=Q({__name:"MetadataDialog",setup(i){const t=Ve(),e=We(),{t:r}=Jt({useScope:"global"});function n(h,u){const d=e.metadata[h];d.value.length>1?d.value.splice(u,1):e.metadata.splice(h,1)}function o(){if(a.value){const h=e.metadata.find(u=>u.key===a.value);h?h.value.push(""):e.metadata.push({key:a.value,value:[""]})}}function s(){c.forEach(h=>{e.metadata.find(u=>u.key===h.value)||e.metadata.push({key:h.value,value:[""]})})}function l(h){var u;return`${((u=c.find(d=>d.value===h))==null?void 0:u.label)||h}`}const a=Gt(null),c=[{label:r("metadataDialog.builtinOptions.ncmMusicId"),value:"ncmMusicId"},{label:r("metadataDialog.builtinOptions.qqMusicId"),value:"qqMusicId"},{label:r("metadataDialog.builtinOptions.spotifyId"),value:"spotifyId"},{label:r("metadataDialog.builtinOptions.appleMusicId"),value:"appleMusicId"},{label:r("metadataDialog.builtinOptions.isrc"),value:"isrc"},{label:r("metadataDialog.builtinOptions.musicName"),value:"musicName"},{label:r("metadataDialog.builtinOptions.artists"),value:"artists"},{label:r("metadataDialog.builtinOptions.album"),value:"album"},{label:r("metadataDialog.builtinOptions.ttmlAuthorGithub"),value:"ttmlAuthorGithub"}];return(h,u)=>{const d=De("i18n-t");return W(),xt(g(ri),{show:g(t).metadata,title:g(r)("metadataDialog.title"),preset:"card",style:{"max-width":"600px"},"transform-origin":"center",onClose:u[1]||(u[1]=f=>g(t).metadata=!1)},{default:E(()=>[w(g(RM),null,{default:E(()=>[x("thead",null,[x("tr",null,[x("th",SA,[w(d,{keypath:"metadataDialog.tableHead.key"})]),x("th",null,[w(d,{keypath:"metadataDialog.tableHead.values"})])])]),x("tbody",null,[(W(!0),Z(Oe,null,fr(g(e).metadata,(f,m)=>(W(),Z("tr",null,[x("td",TA,Ie(l(f.key)),1),x("td",null,[(W(!0),Z(Oe,null,fr(f.value,(v,p)=>(W(),Z("div",AA,[w(g(me),{placeholder:g(r)("metadataDialog.valuePlaceholder"),value:v,onInput:y=>f.value[p]=y},null,8,["placeholder","value","onInput"]),w(g(rt),{circle:"",quaternary:"",onClick:y=>n(m,p)},{icon:E(()=>[w(g(gi),null,{default:E(()=>[w(g(Du))]),_:1})]),_:2},1032,["onClick"])]))),256))])]))),256)),x("tr",null,[x("td",null,[w(g(lo),{value:a.value,"onUpdate:value":u[0]||(u[0]=f=>a.value=f),options:c,placeholder:g(r)("metadataDialog.selectNew"),filterable:"",tag:""},null,8,["value","placeholder"])]),x("td",null,[w(g(rt),{disabled:!a.value,block:"",onClick:o},{default:E(()=>[w(d,{keypath:"metadataDialog.addNew"})]),_:1},8,["disabled"])])]),x("tr",null,[x("td",MA,[w(g(rt),{block:"",onClick:s},{default:E(()=>[w(d,{keypath:"metadataDialog.addAllBatch"})]),_:1})])])])]),_:1})]),_:1},8,["show","title"])}}}),LA=Fe(CA,[["__scopeId","data-v-b179a3bb"]]),_A=Q({__name:"ProgressOverlay",setup(i){const{currentProgresses:t}=Xc(Sf()),{t:e}=Jt({useScope:"global"});return(r,n)=>(W(),xt(g(ri),{show:g(t).length>0,"transform-origin":"center"},{default:E(()=>[w(g(T1),{title:g(e)("ProgressOverlay.title"),style:{"max-width":"500px"}},{default:E(()=>[(W(!0),Z(Oe,null,fr(g(t),(o,s)=>(W(),Z("div",{key:s},[x("div",null,Ie(g(e)(o.label)),1),w(g(BM),{percentage:Math.round(o.progress*100),type:"line"},null,8,["percentage"])]))),128))]),_:1},8,["title"])]),_:1},8,["show"]))}}),Ct=Q({__name:"ShortcutInput",props:k1({default:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(i){const t=S1(i,"modelValue"),e=i,{t:r}=Jt({useScope:"global"}),n=Gt(!1),o=Dt(()=>mb(t.value??[])||r("shortcutInput.none"));async function s(){_o(),n.value=!0;try{t.value=await yb()}catch{}n.value=!1}function l(){_o(),n.value=!1}function a(){e.default&&(t.value=(window.structuredClone||qi)(e.default)),n.value=!1}return(c,h)=>(W(),xt(g(me),{clearable:!!e.default,placeholder:g(r)("shortcutInput.recording"),value:n.value?"":o.value,onBlur:l,onClear:a,onFocus:s},{"clear-icon":E(()=>[w(g(gi),null,{default:E(()=>[w(g(au))]),_:1})]),_:1},8,["clearable","placeholder","value"]))}}),EA={class:"desc"},OA={class:"desc"},DA={class:"desc"},PA=Q({__name:"SettingsModal",setup(i){const t=Ve(),e=ji(),{t:r}=Jt({useScope:"global"}),n=[{value:en.Simple,label:r("settingsDialog.common.uiLayoutModeOptions.simple")},{value:en.Advanced,label:r("settingsDialog.common.uiLayoutModeOptions.advanced")}];return(o,s)=>{const l=De("i18n-t");return W(),xt(g(ri),{show:g(t).settings,title:g(r)("settingsDialog.title"),"mask-closable":"",preset:"card",style:{"max-width":"600px"},"transform-origin":"center",onClose:s[30]||(s[30]=a=>g(t).settings=!1)},{default:E(()=>[w(g(NM),{animated:"",type:"line"},{default:E(()=>[w(g(A1),{key:"common",name:g(r)("settingsDialog.tab.common"),class:"setting-grid"},{default:E(()=>[x("div",null,[w(l,{keypath:"settingsDialog.common.showTranslateLine"})]),x("div",null,[w(g($c),{value:g(e).showTranslateLine,"onUpdate:value":s[0]||(s[0]=a=>g(e).showTranslateLine=a)},null,8,["value"])]),x("div",null,[w(l,{keypath:"settingsDialog.common.showRomanLine"})]),x("div",null,[w(g($c),{value:g(e).showRomanLine,"onUpdate:value":s[1]||(s[1]=a=>g(e).showRomanLine=a)},null,8,["value"])]),x("div",null,[w(l,{keypath:"settingsDialog.common.showJpnRomaji"})]),x("div",null,[w(g($c),{value:g(e).showJpnRomaji,"onUpdate:value":s[2]||(s[2]=a=>g(e).showJpnRomaji=a)},null,8,["value"])]),x("div",null,[w(l,{keypath:"settingsDialog.common.volume"})]),x("div",null,[w(g(tn),{value:g(e).volume,"onUpdate:value":s[3]||(s[3]=a=>g(e).volume=a),"format-tooltip":a=>`${a*100|0}%`,max:1,min:0,step:.01,style:{width:"10em"}},null,8,["value","format-tooltip"])]),x("div",null,[w(l,{keypath:"settingsDialog.common.speed"})]),x("div",null,[w(g(tn),{value:g(e).speed,"onUpdate:value":s[4]||(s[4]=a=>g(e).speed=a),"format-tooltip":a=>`${a.toFixed(2)}x`,max:4,min:.25,step:.01,style:{width:"10em"}},null,8,["value","format-tooltip"])]),x("div",null,[x("div",null,[w(l,{keypath:"settingsDialog.common.timeOffset"})]),x("div",EA,[w(l,{keypath:"settingsDialog.common.timeOffsetDesc"})])]),x("div",null,[w(g(zc),{value:g(e).timeOffset,"onUpdate:value":s[5]||(s[5]=a=>g(e).timeOffset=a),step:1},null,8,["value"])]),x("div",null,[x("div",null,[w(l,{keypath:"settingsDialog.common.uiLayoutMode"})]),x("div",OA,[w(l,{keypath:"settingsDialog.common.uiLayoutModeDesc"})])]),x("div",null,[w(g(lo),{value:g(e).uiLayoutMode,"onUpdate:value":s[6]||(s[6]=a=>g(e).uiLayoutMode=a),options:n,style:{"min-width":"16em"}},null,8,["value"])]),s[31]||(s[31]=x("div",null,null,-1)),s[32]||(s[32]=x("div",null,null,-1)),x("div",null,[x("div",null,[w(l,{keypath:"settingsDialog.common.dbUploadApiBaseUrl"})]),x("div",DA,[w(l,{keypath:"settingsDialog.common.dbUploadApiBaseUrlDesc"})])]),x("div",null,[w(g(me),{value:g(e).dbUploadApiBaseUrl,"onUpdate:value":s[7]||(s[7]=a=>g(e).dbUploadApiBaseUrl=a),style:{"min-width":"16em"}},null,8,["value"])])]),_:1},8,["name"]),w(g(A1),{key:"shortcut",name:g(r)("settingsDialog.tab.keybindings"),class:"setting-grid"},{default:E(()=>[x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayForward5s"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayForward5s,"onUpdate:modelValue":s[8]||(s[8]=a=>g(e).keybindings.seekPlayForward5s=a),default:["ArrowRight"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayBackward5s"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayBackward5s,"onUpdate:modelValue":s[9]||(s[9]=a=>g(e).keybindings.seekPlayBackward5s=a),default:["ArrowLeft"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayForward1s"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayForward1s,"onUpdate:modelValue":s[10]||(s[10]=a=>g(e).keybindings.seekPlayForward1s=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayBackward1s"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayBackward1s,"onUpdate:modelValue":s[11]||(s[11]=a=>g(e).keybindings.seekPlayBackward1s=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayForward100ms"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayForward100ms,"onUpdate:modelValue":s[12]||(s[12]=a=>g(e).keybindings.seekPlayForward100ms=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekPlayBackward100ms"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekPlayBackward100ms,"onUpdate:modelValue":s[13]||(s[13]=a=>g(e).keybindings.seekPlayBackward100ms=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.volumeUp"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.volumeUp,"onUpdate:modelValue":s[14]||(s[14]=a=>g(e).keybindings.volumeUp=a),default:["ArrowUp"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.volumeDown"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.volumeDown,"onUpdate:modelValue":s[15]||(s[15]=a=>g(e).keybindings.volumeDown=a),default:["ArrowDown"]},null,8,["modelValue"])]),s[33]||(s[33]=x("div",null,null,-1)),s[34]||(s[34]=x("div",null,null,-1)),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.moveLeftWord"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.moveLeftWord,"onUpdate:modelValue":s[16]||(s[16]=a=>g(e).keybindings.moveLeftWord=a),default:["KeyA"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.moveRightWord"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.moveRightWord,"onUpdate:modelValue":s[17]||(s[17]=a=>g(e).keybindings.moveRightWord=a),default:["KeyD"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.moveUpLine"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.moveUpLine,"onUpdate:modelValue":s[18]||(s[18]=a=>g(e).keybindings.moveUpLine=a),default:["KeyW"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.moveDownLine"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.moveDownLine,"onUpdate:modelValue":s[19]||(s[19]=a=>g(e).keybindings.moveDownLine=a),default:["KeyS"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekLeftWord"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekLeftWord,"onUpdate:modelValue":s[20]||(s[20]=a=>g(e).keybindings.seekLeftWord=a),default:["KeyR"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.seekRightWord"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.seekRightWord,"onUpdate:modelValue":s[21]||(s[21]=a=>g(e).keybindings.seekRightWord=a),default:["KeyY"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.setCurWordStartTime"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.setCurWordStartTime,"onUpdate:modelValue":s[22]||(s[22]=a=>g(e).keybindings.setCurWordStartTime=a),default:["KeyF"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.stepWordAndSetTime"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.stepWordAndSetTime,"onUpdate:modelValue":s[23]||(s[23]=a=>g(e).keybindings.stepWordAndSetTime=a),default:["KeyG"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.stepWordAndSetTimeAlias1"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.stepWordAndSetTimeAlias1,"onUpdate:modelValue":s[24]||(s[24]=a=>g(e).keybindings.stepWordAndSetTimeAlias1=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.stepWordAndSetTimeAlias2"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.stepWordAndSetTimeAlias2,"onUpdate:modelValue":s[25]||(s[25]=a=>g(e).keybindings.stepWordAndSetTimeAlias2=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.stepWordAndSetTimeAlias3"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.stepWordAndSetTimeAlias3,"onUpdate:modelValue":s[26]||(s[26]=a=>g(e).keybindings.stepWordAndSetTimeAlias3=a),default:[]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.stepWordAndSetEndTime"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.stepWordAndSetEndTime,"onUpdate:modelValue":s[27]||(s[27]=a=>g(e).keybindings.stepWordAndSetEndTime=a),default:["KeyH"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.setLineStartTime"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.setLineStartTime,"onUpdate:modelValue":s[28]||(s[28]=a=>g(e).keybindings.setLineStartTime=a),default:["KeyV"]},null,8,["modelValue"])]),x("div",null,[w(l,{keypath:"settingsDialog.keybindings.setLineEndTime"})]),x("div",null,[w(Ct,{modelValue:g(e).keybindings.setLineEndTime,"onUpdate:modelValue":s[29]||(s[29]=a=>g(e).keybindings.setLineEndTime=a),default:["KeyN"]},null,8,["modelValue"])])]),_:1},8,["name"])]),_:1})]),_:1},8,["show","title"])}}}),RA=Fe(PA,[["__scopeId","data-v-aa76bc27"]]),BA={class:"result-preview"},NA=Q({__name:"SplitWordModal",setup(i){const t=We(),e=pr(),r=Ve(),n=Gt(""),o=Gt("\\"),{t:s}=Jt({useScope:"global"}),l=Dt(()=>{var h,u,d;return((d=(u=(h=t.lyrics[e.selectedLine])==null?void 0:h.words)==null?void 0:u[e.selectedWord])==null?void 0:d.word)??""}),a=Dt(()=>{const h=n.value,u=o.value;return h&&u?h.split(u):[h]});function c(){var u,d;const h=t.lyrics[e.selectedLine];if(h){const f=a.value.join(""),m=a.value.map(b=>({word:b,startTime:0,endTime:0})),v=((u=h.words[e.selectedWord])==null?void 0:u.startTime)??0,p=((((d=h.words[e.selectedWord])==null?void 0:d.endTime)??0)-v)/f.length;let y=0;for(const b of m)b.startTime=v+p*y,b.endTime=v+p*(y+b.word.length),y+=b.word.length;h.words.splice(e.selectedWord,1,...m),t.record()}r.splitWord=!1}return Xs(()=>{n.value=l.value}),(h,u)=>{const d=De("i18n-t");return W(),xt(g(ri),{segmented:{footer:"soft"},show:g(r).splitWord,preset:"card",style:{"max-width":"600px"},"transform-origin":"center",title:g(s)("splitWordModal.title"),onClose:u[2]||(u[2]=f=>g(r).splitWord=!1)},{footer:E(()=>[w(g(rt),{type:"primary",onClick:c},{default:E(()=>[w(d,{keypath:"splitWordModal.splitBtn"})]),_:1})]),default:E(()=>[w(g(dr),{style:{"margin-bottom":"1em"},type:"info"},{default:E(()=>[w(d,{keypath:"splitWordModal.tip"})]),_:1}),w(g(Zs),{label:g(s)("splitWordModal.originalWord")},{default:E(()=>[w(g(me),{value:n.value,"onUpdate:value":u[0]||(u[0]=f=>n.value=f)},null,8,["value"])]),_:1},8,["label"]),w(g(Zs),{label:g(s)("splitWordModal.delimiter")},{default:E(()=>[w(g(me),{value:o.value,"onUpdate:value":u[1]||(u[1]=f=>o.value=f)},null,8,["value"])]),_:1},8,["label"]),w(g(zi),{vertical:""},{default:E(()=>[x("div",null,[w(d,{keypath:"splitWordModal.splitResultPreview"})]),x("div",BA,[(W(!0),Z(Oe,null,fr(a.value,f=>(W(),Z("span",null,Ie(f),1))),256))])]),_:1})]),_:1},8,["show","title"])}}}),IA=Fe(NA,[["__scopeId","data-v-95b4f4ec"]]),WA={href:"https://github.com/Steve-xmh/amll-ttml-db"},FA=Q({__name:"TutorialModal",setup(i){const t=ji(),{t:e}=Jt({useScope:"global"});return(r,n)=>{const o=De("i18n-t");return W(),xt(g(ri),{show:g(t).showingTutorial,"transform-origin":"center"},{default:E(()=>[w(g(T1),{title:g(e)("tutorial.title"),style:{"max-width":"800px"}},{footer:E(()=>[w(g(rt),{type:"primary",onClick:n[0]||(n[0]=s=>g(t).showingTutorial=!1)},{default:E(()=>[w(o,{keypath:"tutorial.closeBtn"})]),_:1})]),default:E(()=>[w(g(zi),{style:{"white-space":"pre-line","line-height":"2rem"},vertical:""},{default:E(()=>[w(o,{keypath:"tutorial.content"}),w(g(dr),{type:"warning"},{default:E(()=>[w(o,{keypath:"tutorial.wipWarning"})]),_:1}),w(g(IM),{vertical:""},{default:E(()=>[w(g(ao),{title:g(e)("tutorial.step1.title")},{default:E(()=>[w(o,{keypath:"tutorial.step1.content"})]),_:1},8,["title"]),w(g(ao),{title:g(e)("tutorial.step2.title")},{default:E(()=>[w(o,{keypath:"tutorial.step2.content"},{default:E(()=>[w(g(rt),null,{default:E(()=>[M1(Ie(g(e)("tutorial.step2.editModeBtnExample")),1)]),_:1})]),_:1})]),_:1},8,["title"]),w(g(ao),{title:g(e)("tutorial.step3.title")},{default:E(()=>[w(o,{keypath:"tutorial.step3.content"},{default:E(()=>[w(g(rt),null,{default:E(()=>[M1(Ie(g(e)("tutorial.step3.syncModeBtnExample")),1)]),_:1})]),_:1}),x("table",null,[x("tbody",null,[x("tr",null,[x("th",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.header.key"})]),x("th",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.header.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToPreviousWord.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToPreviousWord.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToNextWord.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToNextWord.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToFirstWordOfPreviousLine.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToFirstWordOfPreviousLine.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToFirstWordOfNextLine.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToFirstWordOfNextLine.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToPreviousWordAndCurrentTime.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToPreviousWordAndCurrentTime.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToNextWordAndSetCurrentTime.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveToNextWordAndSetCurrentTime.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.setWordStartTimeToCurrentTime.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.setWordStartTimeToCurrentTime.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveNextAndSetWordTime.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveNextAndSetWordTime.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.moveNextAndSetWordEndTimeOnly.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.moveNextAndSetWordEndTimeOnly.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.decreasePlaybackSpeed.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.decreasePlaybackSpeed.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.increasePlaybackSpeed.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.increasePlaybackSpeed.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.resetPlaybackSpeed.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.resetPlaybackSpeed.description"})])]),x("tr",null,[x("td",null,[w(g(rt),{block:""},{default:E(()=>[w(o,{keypath:"tutorial.step3.shortcutsTable.resumeOrPauseMusic.key"})]),_:1})]),x("td",null,[w(o,{keypath:"tutorial.step3.shortcutsTable.resumeOrPauseMusic.description"})])])])])]),_:1},8,["title"]),w(g(ao),{title:g(e)("tutorial.step4.title")},{default:E(()=>[w(o,{keypath:"tutorial.step4.content"})]),_:1},8,["title"]),w(g(ao),{title:g(e)("tutorial.step5.title")},{default:E(()=>[w(g(dr),{type:"warning"},{default:E(()=>[w(o,{keypath:"tutorial.step5.ncmOnlyWarning"})]),_:1}),w(o,{keypath:"tutorial.step5.content"},{default:E(()=>[x("a",WA,Ie(g(e)("tutorial.step5.amllTtmlDbUrlName")),1)]),_:1})]),_:1},8,["title"])]),_:1}),w(o,{keypath:"tutorial.ending"})]),_:1})]),_:1},8,["title"])]),_:1},8,["show"])}}});function VA(i){const t=[],e=i.map((r,n)=>({...r,id:n}));e.length===0&&t.push("\u6B4C\u8BCD\u5185\u5BB9\u4E3A\u7A7A");for(const r of e){const n=r.words.map(o=>o.word).join("").trim();if(n.length>0){const o=/\s\s+/;console.log(`\u6B63\u5728\u68C0\u67E5\u7B2C ${r.id+1} \u884C:`,JSON.stringify(n)),o.exec(n)&&t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD\u5185\u5BB9\u4E2D\u6709\u591A\u4F59\u7684\u7A7A\u683C`),r.words.forEach((s,l)=>{s.word.trim().length>0&&(s.startTime<0&&t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD\u7684\u7B2C ${l+1} \u4E2A\u5355\u8BCD "${s.word}" \u5F00\u59CB\u65F6\u95F4\u6709\u8BEF (${s.startTime})`),s.endTime<s.startTime&&t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD\u7684\u7B2C ${l+1} \u4E2A\u5355\u8BCD "${s.word}" \u7ED3\u675F\u65F6\u95F4\u6709\u8BEF/\u5C0F\u4E8E\u5F00\u59CB\u65F6\u95F4 (${s.endTime})`))}),r.startTime<0&&t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD \u5F00\u59CB\u65F6\u95F4\u6709\u8BEF (${r.startTime})`),r.endTime<r.startTime&&t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD \u7ED3\u675F\u65F6\u95F4\u6709\u8BEF/\u5C0F\u4E8E\u5F00\u59CB\u65F6\u95F4 (${r.endTime})`)}else t.push(`\u7B2C ${r.id+1} \u884C\u6B4C\u8BCD\u5185\u5BB9\u4E3A\u7A7A`)}return t}const HA=Q({__name:"UploadDBDialog",setup(i){const t=ji(),e=We(),r=so(),n=Ve(),{t:o}=Jt({useScope:"global"}),s=Zr({name:"",submitReason:"\u65B0\u6B4C\u8BCD\u63D0\u4EA4",comment:"",processing:!1,generateMusicNameFromMetadata:!0});function l(m,v){const p=[];return m.filter(y=>y.key===v).map(y=>y.value).forEach(y=>{p.push(...y)}),p}const a=Dt(()=>{const m=["ncmMusicId","qqMusicId","spotifyId","appleMusicId"];for(const v of m)if(l(e.metadata,v).filter(p=>p.trim().length>0).length>0)return!0;return!1}),c=Dt(()=>l(e.metadata,"musicName").filter(m=>m.trim().length>0).length>0),h=Dt(()=>l(e.metadata,"artists").filter(m=>m.trim().length>0).length>0),u=Dt(()=>l(e.metadata,"album").filter(m=>m.trim().length>0).length>0),d=Dt(()=>{const m=[];return a.value||m.push(o("uploadDBDialog.noMusicIdWarning")),c.value||m.push(o("uploadDBDialog.noMusicNameWarning")),h.value||m.push(o("uploadDBDialog.noArtistWarning")),u.value||m.push(o("uploadDBDialog.noAlbumWarning")),m.push(...VA(e.lyrics)),m});Xs(()=>{if(s.generateMusicNameFromMetadata){const m=l(e.metadata,"artists");m.length>0?(s.name=m.join(", "),s.name.trim().length===0&&(s.name=o("uploadDBDialog.unknownArtists"))):s.name=o("uploadDBDialog.unknownArtists"),s.name+=" - ";const v=l(e.metadata,"musicName");v[0]&&v[0].trim().length>0?s.name+=v[0]:s.name+=o("uploadDBDialog.unknownMusicName")}});async function f(){if(!s.processing){s.processing=!0;try{const m=encodeURIComponent(e.toTTML()),v=await fetch(t.dbUploadApiBaseUrl||"https://dpaste.org/api/",{method:"POST",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`format=url&lexer=xml&expires=3600&filename=lyric.ttml&content=${m}`}).then(y=>(console.log(y),y.text())).then(y=>`${y.trim()}/raw`),p=new URL("https://github.com/Steve-xmh/amll-ttml-db/issues/new");p.searchParams.append("labels","\u6B4C\u8BCD\u63D0\u4EA4/\u8865\u6B63"),p.searchParams.append("template","submit-lyric.yml"),p.searchParams.append("title",`[\u6B4C\u8BCD\u63D0\u4EA4/\u4FEE\u6B63] ${s.name}`),p.searchParams.append("song-name",s.name),p.searchParams.append("ttml-download-url",v),p.searchParams.append("upload-reason",s.submitReason),p.searchParams.append("comment",s.comment),open(p.toString())}catch(m){console.warn("Submit failed",m),r.error({title:o("uploadDBDialog.errorNotification.title"),content:o("uploadDBDialog.errorNotification.content",[m])})}s.processing=!1}}return(m,v)=>{const p=De("i18n-t"),y=WM("t");return W(),xt(g(ri),{closable:!s.processing,show:g(n).submitLyric,title:g(o)("uploadDBDialog.title"),preset:"card",style:{"max-width":"600px"},"transform-origin":"center",onClose:v[5]||(v[5]=b=>g(n).submitLyric=!1)},{footer:E(()=>[w(g(rt),{disabled:s.processing||!s.name||d.value.length>0,type:"primary",onClick:f},{default:E(()=>[w(p,{keypath:"uploadDBDialog.uploadBtn"})]),_:1},8,["disabled"])]),default:E(()=>[w(g(zi),{style:{"line-height":"2rem","white-space":"pre-line"},vertical:""},{default:E(()=>[w(g(dr),{type:"warning"},{default:E(()=>[w(p,{keypath:"uploadDBDialog.chineseUserOnlyWarning"})]),_:1}),w(p,{keypath:"uploadDBDialog.content"},{default:E(()=>[FM(x("b",null,null,512),[[y,"uploadDBDialog.boldCC0"]])]),_:1}),x("h4",null,[w(p,{keypath:"uploadDBDialog.musicName"})]),w(g(tl),{checked:s.generateMusicNameFromMetadata,"onUpdate:checked":v[0]||(v[0]=b=>s.generateMusicNameFromMetadata=b),label:g(o)("uploadDBDialog.generateFromMetadata")},null,8,["checked","label"]),w(g(me),{value:s.name,"onUpdate:value":v[1]||(v[1]=b=>s.name=b),disabled:s.processing||s.generateMusicNameFromMetadata,loading:s.processing,placeholder:g(o)("uploadDBDialog.musicNamePlaceholder")},null,8,["value","disabled","loading","placeholder"]),x("div",null,[w(p,{keypath:"uploadDBDialog.musicNameTip"})]),x("h4",null,[w(p,{keypath:"uploadDBDialog.uploadReason.label"})]),w(g(C1),{checked:s.submitReason==="\u65B0\u6B4C\u8BCD\u63D0\u4EA4",value:"\u65B0\u6B4C\u8BCD\u63D0\u4EA4",onClick:v[2]||(v[2]=b=>s.submitReason="\u65B0\u6B4C\u8BCD\u63D0\u4EA4")},{default:E(()=>[w(p,{keypath:"uploadDBDialog.uploadReason.newLyric"})]),_:1},8,["checked"]),w(g(C1),{checked:s.submitReason==="\u4FEE\u6B63\u5DF2\u6709\u6B4C\u8BCD",value:"\u4FEE\u6B63\u5DF2\u6709\u6B4C\u8BCD",onClick:v[3]||(v[3]=b=>s.submitReason="\u4FEE\u6B63\u5DF2\u6709\u6B4C\u8BCD")},{default:E(()=>[w(p,{keypath:"uploadDBDialog.uploadReason.patchLyric"})]),_:1},8,["checked"]),x("h4",null,[w(p,{keypath:"uploadDBDialog.comment"})]),w(g(me),{value:s.comment,"onUpdate:value":v[4]||(v[4]=b=>s.comment=b),disabled:s.processing,loading:s.processing,placeholder:g(o)("uploadDBDialog.commentPlaceholder")},null,8,["value","disabled","loading","placeholder"]),x("div",null,[w(p,{keypath:"uploadDBDialog.commentTip"})]),d.value.length>0?(W(),xt(g(dr),{key:0,type:"error"},{default:E(()=>[w(p,{keypath:"uploadDBDialog.issuesWarning"}),x("ul",null,[(W(!0),Z(Oe,null,fr(d.value,b=>(W(),Z("li",null,Ie(b),1))),256))])]),_:1})):ur("",!0)]),_:1})]),_:1},8,["closable","show","title"])}}});var $s={exports:{}},p1={exports:{}};(function(i,t){(function(e,r){r()})(ho,function(){function e(c,h){return typeof h>"u"?h={autoBom:!1}:typeof h!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),h={autoBom:!h}),h.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,h,u){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){a(d.response,h,u)},d.onerror=function(){console.error("could not download file")},d.send()}function n(c){var h=new XMLHttpRequest;h.open("HEAD",c,!1);try{h.send()}catch{}return 200<=h.status&&299>=h.status}function o(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var h=document.createEvent("MouseEvents");h.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(h)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ho=="object"&&ho.global===ho?ho:void 0,l=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(c,h,u){var d=s.URL||s.webkitURL,f=document.createElement("a");h=h||c.name||"download",f.download=h,f.rel="noopener",typeof c=="string"?(f.href=c,f.origin===location.origin?o(f):n(f.href)?r(c,h,u):o(f,f.target="_blank")):(f.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){o(f)},0))}:"msSaveOrOpenBlob"in navigator?function(c,h,u){if(h=h||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(e(c,u),h);else if(n(c))r(c,h,u);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){o(d)})}}:function(c,h,u,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return r(c,h,u);var f=c.type==="application/octet-stream",m=/constructor/i.test(s.HTMLElement)||s.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||f&&m||l)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var k=p.result;k=v?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=k:location=k,d=null},p.readAsDataURL(c)}else{var y=s.URL||s.webkitURL,b=y.createObjectURL(c);d?d.location=b:location.href=b,d=null,setTimeout(function(){y.revokeObjectURL(b)},4e4)}});s.saveAs=a.saveAs=a,i.exports=a})})(p1);var UA=p1.exports,zA=function(i){return atob(i)},Dc={exports:{}};(function(i,t){(function(e){function r(n,o){if(n instanceof Boolean||typeof n=="boolean"||(o instanceof Object||(o={}),o.hasOwnProperty("allowBlank")&&!o.allowBlank&&n===""))return!1;var s="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return o.mime&&(s="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+s),o.paddingRequired===!1&&(s="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+s+"$","gi").test(n)}i.exports&&(t=i.exports=r),t.isBase64=r})()})(Dc,Dc.exports);var jA=Dc.exports,m1=zA,$A=jA,qA=function(i){if(typeof i!="string")throw Error("Argument should be a string");return/^data\:/i.test(i)?KA(i):($A(i)&&(i=m1(i)),g1(i))};function g1(i){for(var t=new Uint8Array(i.length),e=0;e<i.length;e++)t[e]=i.charCodeAt(e);return t.buffer}function KA(i){i=i.replace(/\r?\n/g,"");var t=i.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data-URI");for(var e=i.substring(5,t).split(";"),r=!1,n="US-ASCII",o=0;o<e.length;o++)e[o]=="base64"?r=!0:e[o].indexOf("charset=")==0&&(n=e[o].substring(8));var s=unescape(i.substring(t+1));r&&(s=m1(s));var l=g1(s);return l.type=e[0]||"text/plain",l.charset=n,l}var YA=function(i){switch(i){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}},y1=YA,GA=JA;function JA(i,t,e){if(!i)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(i)&&i[0]&&typeof i[0][0]=="number"){var r=i[0].length,n=i.length*r,o,s,l,a;(!t||typeof t=="string")&&(t=new(y1(t||"float32"))(n+e));var c=t.length-e;if(n!==c)throw new Error("source length "+n+" ("+r+"x"+i.length+") does not match destination length "+c);for(o=0,l=e;o<i.length;o++)for(s=0;s<r;s++)t[l++]=i[o][s]===null?NaN:i[o][s]}else if(!t||typeof t=="string"){var h=y1(t||"float32");if(Array.isArray(i)||t==="array")for(t=new h(i.length+e),o=0,l=e,a=t.length;l<a;l++,o++)t[l]=i[o]===null?NaN:i[o];else e===0?t=new h(i):(t=new h(i.length+e),t.set(i,e))}else t.set(i,e);return t}var XA=qA,QA=GA,ZA=function i(t){if(!t)return null;if(t instanceof ArrayBuffer)return t;if(typeof t=="string")return XA(t);if(ArrayBuffer.isView(t))return t.byteOffset?t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):t.buffer;if(t.buffer||t.data||t._data){var r=i(t.buffer||t.data||t._data);return r}if(Array.isArray(t)){for(var e=0;e<t.length;e++)if(t[e].length!=null){t=QA(t);break}}var r=new Uint8Array(t);return r.length?r.buffer:null},v1,tM=function(i){return function(t){t=t.toLowerCase().trim();var e=t.lastIndexOf("/");return e>=0&&(t=t.substr(e+1)),e=t.lastIndexOf("."),e>=0&&(t=t.substr(e+1)),v1[t]||i}};v1={"3gp":"video/3gpp",a:"application/octet-stream",ai:"application/postscript",aif:"audio/x-aiff",aiff:"audio/x-aiff",asc:"application/pgp-signature",asf:"video/x-ms-asf",asm:"text/x-asm",asx:"video/x-ms-asf",atom:"application/atom+xml",au:"audio/basic",avi:"video/x-msvideo",bat:"application/x-msdownload",bin:"application/octet-stream",bmp:"image/bmp",bz2:"application/x-bzip2",c:"text/x-csrc",cab:"application/vnd.ms-cab-compressed",can:"application/candor",cc:"text/x-c++src",chm:"application/vnd.ms-htmlhelp",class:"application/octet-stream",com:"application/x-msdownload",conf:"text/plain",cpp:"text/x-c",crt:"application/x-x509-ca-cert",css:"text/css",csv:"text/csv",cxx:"text/x-c",deb:"application/x-debian-package",der:"application/x-x509-ca-cert",diff:"text/x-diff",djv:"image/vnd.djvu",djvu:"image/vnd.djvu",dll:"application/x-msdownload",dmg:"application/octet-stream",doc:"application/msword",dot:"application/msword",dtd:"application/xml-dtd",dvi:"application/x-dvi",ear:"application/java-archive",eml:"message/rfc822",eps:"application/postscript",exe:"application/x-msdownload",f:"text/x-fortran",f77:"text/x-fortran",f90:"text/x-fortran",flv:"video/x-flv",for:"text/x-fortran",gem:"application/octet-stream",gemspec:"text/x-script.ruby",gif:"image/gif",gyp:"text/x-script.python",gypi:"text/x-script.python",gz:"application/x-gzip",h:"text/x-chdr",hh:"text/x-c++hdr",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",ifb:"text/calendar",iso:"application/octet-stream",jar:"application/java-archive",java:"text/x-java-source",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/javascript",json:"application/json",less:"text/css",log:"text/plain",lua:"text/x-script.lua",luac:"application/x-bytecode.lua",makefile:"text/x-makefile",m3u:"audio/x-mpegurl",m4v:"video/mp4",man:"text/troff",manifest:"text/cache-manifest",markdown:"text/x-markdown",mathml:"application/mathml+xml",mbox:"application/mbox",mdoc:"text/troff",md:"text/x-markdown",me:"text/troff",mid:"audio/midi",midi:"audio/midi",mime:"message/rfc822",mml:"application/mathml+xml",mng:"video/x-mng",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",ms:"text/troff",msi:"application/x-msdownload",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",p:"text/x-pascal",pas:"text/x-pascal",pbm:"image/x-portable-bitmap",pdf:"application/pdf",pem:"application/x-x509-ca-cert",pgm:"image/x-portable-graymap",pgp:"application/pgp-encrypted",pkg:"application/octet-stream",pl:"text/x-script.perl",pm:"text/x-script.perl-module",png:"image/png",pnm:"image/x-portable-anymap",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",psd:"image/vnd.adobe.photoshop",py:"text/x-script.python",qt:"video/quicktime",ra:"audio/x-pn-realaudio",rake:"text/x-script.ruby",ram:"audio/x-pn-realaudio",rar:"application/x-rar-compressed",rb:"text/x-script.ruby",rdf:"application/rdf+xml",roff:"text/troff",rpm:"application/x-redhat-package-manager",rss:"application/rss+xml",rtf:"application/rtf",ru:"text/x-script.ruby",s:"text/x-asm",sgm:"text/sgml",sgml:"text/sgml",sh:"application/x-sh",sig:"application/pgp-signature",snd:"audio/basic",so:"application/octet-stream",svg:"image/svg+xml",svgz:"image/svg+xml",swf:"application/x-shockwave-flash",t:"text/troff",tar:"application/x-tar",tbz:"application/x-bzip-compressed-tar",tci:"application/x-topcloud",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",torrent:"application/x-bittorrent",tr:"text/troff",ttf:"application/x-font-ttf",txt:"text/plain",vcf:"text/x-vcard",vcs:"text/x-vcalendar",vrml:"model/vrml",war:"application/java-archive",wav:"audio/x-wav",webapp:"application/x-web-app-manifest+json",webm:"video/webm",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",wmx:"video/x-ms-wmx",wrl:"model/vrml",wsdl:"application/wsdl+xml",xbm:"image/x-xbitmap",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xml:"application/xml",xpm:"image/x-xpixmap",xsl:"application/xml",xslt:"application/xslt+xml",yaml:"text/yaml",yml:"text/yaml",zip:"application/zip"};var eM=Object.prototype.toString,iM=function(i){return i instanceof Blob||eM.call(i)==="[object Blob]"},rM=ZA,nM=tM("application/octect-stream"),oM=iM,sM=function(i,t){if(!oM(i)&&!(i instanceof File)){i=rM(i);var e=nM(t||"");i=new Blob([i],{type:e})}return i},w1=UA.saveAs,b1=sM,lr=null;$s.exports=Pc,$s.exports.save=Pc,$s.exports.saveSync=lM;function Pc(i,t){if(typeof i=="string"&&(typeof t!="string"||t.length>i.length)){var e=t;t=i,i=e}var r=b1(i,t);return lr?lr.then(function(){return lr=Pc(i,t),lr}):(lr=new Promise(function(n,o){w1(r,t),window.addEventListener("focus",function s(){lr=null,window.removeEventListener("focus",s),n()})}),lr)}function lM(i,t){return w1(b1(i,t),t)}var aM=$s.exports;const ar=tC(aM),cM={class:"menu-full"},hM={class:"menu-slim"},uM={style:{display:"flex","justify-content":"center",gap:"8px"}},dM={class:"app-name",style:{flex:"1","padding-right":"1em","text-align":"right"}},fM=Q({__name:"TopBar",setup(i){const t=_l(),e=VM(),r=We(),n=pr(),o=ji(),s=Gt(!1),l=so(),a=Ve(),{t:c}=Jt({useScope:"global"}),h=v=>()=>Xr(gi,null,{default:()=>Xr(v)}),u=Zr({file:[{label:c("topBar.menu.newLyric"),key:"new",icon:h(Nu)},{label:c("topBar.menu.openLyric"),key:"open",icon:h(Vu)},{label:c("topBar.menu.openFromClipboard"),key:"open-from-clipboard",icon:h(gu)},{type:"divider"},{label:c("topBar.menu.saveLyric"),key:"save",icon:h(vd)},{label:c("topBar.menu.saveLyricToClipboard"),key:"save-to-clipboard",icon:h(bu)},{label:c("topBar.menu.importLyric"),key:"import-from",icon:h(tu),children:[{label:c("topBar.menu.importLyricFromText"),key:"import-from-text"},{label:c("topBar.menu.importLyricFromLrc"),key:"import-from-lrc"},{label:c("topBar.menu.importLyricFromEslrc"),key:"import-from-eslrc"},{label:c("topBar.menu.importLyricFromYrc"),key:"import-from-yrc"},{label:c("topBar.menu.importLyricFromQrc"),key:"import-from-qrc"},{label:c("topBar.menu.importLyricFromLys"),key:"import-from-lys"}]},{label:c("topBar.menu.exportLyric"),key:"export-to",icon:h(Jh),children:[{label:c("topBar.menu.exportLyricToLrc"),key:"export-to-lrc"},{label:c("topBar.menu.exportLyricToEslrc"),key:"export-to-eslrc"},{label:c("topBar.menu.exportLyricToYrc"),key:"export-to-yrc"},{label:c("topBar.menu.exportLyricToQrc"),key:"export-to-qrc"},{label:c("topBar.menu.exportLyricToLys"),key:"export-to-lys"},{label:c("topBar.menu.exportLyricToAss"),key:"export-to-ass"}]},{label:c("topBar.menu.importFromAMLLDB"),key:"import-from-amll-db",icon:h(Tu)},{label:c("topBar.menu.uploadToAMLLDB"),key:"submit-to-amll-db",icon:h(Lu)},{type:"divider"},{label:c("topBar.menu.settings"),key:"settings",icon:h(Ed)},{label:c("topBar.menu.about"),key:"about",icon:h(Qu)}],edit:[{label:c("topBar.menu.undo"),key:"undo",icon:h(du)},{label:c("topBar.menu.redo"),key:"redo",icon:h(nu)},{label:c("topBar.menu.selectAllLines"),key:"select-all",icon:h(Md)},{label:c("topBar.menu.unselectAllLines"),key:"unselect-all",icon:h(kd)},{label:c("topBar.menu.invertSelectAllLines"),key:"invert-select-all",icon:h(id)},{type:"divider"},{label:c("topBar.menu.toggleBGLineOnSelectedLines"),key:"toggle-bg",icon:h(Gd)},{label:c("topBar.menu.toggleDuetLineOnSelectedLines"),key:"toggle-duet",icon:h(Gc)},{type:"divider"},{label:c("topBar.menu.editMetadata"),key:"edit-metadata",icon:h(Hd)}],view:[{label:c("topBar.menu.showTranslatedLyricLines"),key:"show-tran"},{label:c("topBar.menu.showRomanLyricLines"),key:"show-roman"},{label:c("topBar.menu.showMachineRomanji"),key:"show-jpn-romaji"}],tool:[{label:c("topBar.menu.splitWordBySimpleMethod"),key:"split-words-simple"},{label:c("topBar.menu.splitWordByJieba"),key:"split-words-jieba"},{label:c("topBar.menu.splitWordBySmartMethod"),key:"split-words-smart"}]});function d(){open("https://github.com/Steve-xmh/amll-ttml-tool")}async function f(){try{const v=await navigator.clipboard.readText();if(v.trim().length>0)try{const p=Pl(v);r.loadLyric(p)}catch(p){l.error({title:"\u52A0\u8F7D\u6B4C\u8BCD\u5931\u8D25",content:`\u89E3\u6790\u6B4C\u8BCD\u6570\u636E\u51FA\u9519\uFF1A${String(p)}`})}else l.error({title:"\u4ECE\u526A\u5207\u677F\u52A0\u8F7D\u6B4C\u8BCD\u5931\u8D25",content:"\u526A\u5207\u677F\u6CA1\u6709\u4EFB\u4F55\u6570\u636E"})}catch(v){l.error({title:"\u4ECE\u526A\u5207\u677F\u52A0\u8F7D\u6B4C\u8BCD\u5931\u8D25",content:`\u65E0\u6CD5\u8BFB\u53D6\u526A\u5207\u677F\uFF1A${String(v)}`})}}function m(v){switch(n.show=!1,v){case"new":{r.reset();break}case"open":{const p=document.createElement("input");p.type="file",p.accept=".ttml, application/ttml+xml, application/xml, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());if(k){const S=Pl(k);r.loadLyric(S)}}catch(k){l.error({title:"\u52A0\u8F7D\u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"open-from-clipboard":{r.isDirty()?e.warning({title:"\u8986\u76D6\u8B66\u544A",content:"\u5C06\u4F1A\u8986\u76D6\u5F53\u524D\u6B4C\u8BCD\uFF0C\u662F\u5426\u7EE7\u7EED\uFF1F",positiveText:"\u7EE7\u7EED",negativeText:"\u53D6\u6D88",transformOrigin:"mouse",onPositiveClick:()=>{f()}}):f();break}case"import-from-text":{a.importFromText=!0;break}case"import-from-lrc":{const p=document.createElement("input");p.type="file",p.accept=".lrc, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());k&&r.loadLRC(k)}catch(k){l.error({title:"\u5BFC\u5165 LRC \u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"import-from-eslrc":{const p=document.createElement("input");p.type="file",p.accept=".lrc, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());k&&r.loadESLRC(k)}catch(k){l.error({title:"\u5BFC\u5165 ESLyric \u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"import-from-yrc":{const p=document.createElement("input");p.type="file",p.accept=".yrc, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());k&&r.loadYRC(k)}catch(k){l.error({title:"\u5BFC\u5165 YRC \u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"import-from-qrc":{const p=document.createElement("input");p.type="file",p.accept=".qrc, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());k&&r.loadQRC(k)}catch(k){l.error({title:"\u5BFC\u5165 QRC \u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"import-from-lys":{const p=document.createElement("input");p.type="file",p.accept=".lys, */*",p.click(),p.addEventListener("input",async()=>{var y,b;try{const k=await((b=(y=p.files)==null?void 0:y[0])==null?void 0:b.text());k&&r.loadLYS(k)}catch(k){l.error({title:"\u5BFC\u5165 Lyricify Syllable \u6B4C\u8BCD\u5931\u8D25",content:String(k)})}}),p.remove();break}case"save":{try{const p=r.toTTML();ar(new TextEncoder().encode(p),"lyric.ttml")}catch(p){l.error({title:"\u4FDD\u5B58\u5931\u8D25",content:String(p)})}break}case"save-to-clipboard":{const p=r.toTTML();navigator.clipboard.writeText(p).then(()=>{l.success({title:"\u4FDD\u5B58\u5230\u526A\u8D34\u677F\u6210\u529F",content:"\u5DF2\u5C06\u6B4C\u8BCD\u4FDD\u5B58\u5230\u526A\u8D34\u677F",duration:3e3})}).catch(y=>{l.error({title:"\u4FDD\u5B58\u5230\u526A\u8D34\u677F\u5931\u8D25",content:String(y)})});break}case"export-to-lrc":{try{const p=r.toLRC();ar(new TextEncoder().encode(p),"lyric.lrc")}catch(p){l.error({title:"\u5BFC\u51FA LRC \u6B4C\u8BCD\u5931\u8D25",content:String(p)})}break}case"export-to-eslrc":{try{const p=r.toESLRC();ar(new TextEncoder().encode(p),"lyric.lrc")}catch(p){l.error({title:"\u5BFC\u51FA ESLyric \u6B4C\u8BCD\u5931\u8D25",content:String(p)})}break}case"export-to-yrc":{try{const p=r.toYRC();ar(new TextEncoder().encode(p),"lyric.yrc")}catch(p){l.error({title:"\u5BFC\u51FA YRC \u6B4C\u8BCD\u5931\u8D25",content:String(p)})}break}case"export-to-qrc":{try{const p=r.toQRC();ar(new TextEncoder().encode(p),"lyric.qrc")}catch(p){l.error({title:"\u5BFC\u51FA QRC \u6B4C\u8BCD\u5931\u8D25",content:String(p)})}break}case"export-to-lys":{try{const p=r.toLYS();ar(new TextEncoder().encode(p),"lyric.lys")}catch(p){l.error({title:"\u5BFC\u51FA Lyricify Syllable \u6B4C\u8BCD\u5931\u8D25",content:String(p)})}break}case"export-to-ass":{const p=r.toASS();ar(new TextEncoder().encode(p),"lyric.ass");break}case"import-from-amll-db":{a.importFromDB=!0;break}case"submit-to-amll-db":{a.submitLyric=!0;break}case"settings":{a.settings=!0;break}case"about":{s.value=!0;break}case"undo":{r.undo();break}case"redo":{r.redo();break}case"edit-metadata":{a.metadata=!0;break}case"show-tran":{o.showTranslateLine=!o.showTranslateLine;break}case"show-roman":{o.showRomanLine=!o.showRomanLine;break}case"show-jpn-romaji":{o.showJpnRomaji=!o.showJpnRomaji;break}case"select-all":{r.selectAllLine();break}case"unselect-all":{r.unselectAllLine();break}case"invert-select-all":{r.invertSelectAllLine();break}case"split-words-jieba":{r.splitLineByJieba();break}case"split-words-simple":{r.splitLineBySimpleMethod();break}case"split-words-smart":{r.splitLineBySmartMethod();break}case"toggle-bg":{r.toggleSelectedLineBackground();break}case"toggle-duet":{r.toggleSelectedLineDuet();break}default:l.error({title:"\u529F\u80FD\u6682\u672A\u5B9E\u73B0",content:"\u8BF7\u9759\u5019\u4F5C\u8005\u7206\u809D\u5B9E\u73B0\u5427~",duration:4e3})}}return(v,p)=>{const y=De("i18n-t");return W(),Z(Oe,null,[w(g(HM),{bordered:"",style:{padding:"4px",display:"flex","align-items":"center"}},{default:E(()=>[x("div",cM,[w(g(co),{options:u.file,placement:"bottom-start",trigger:"click",onSelect:m},{default:E(()=>[w(g(rt),{quaternary:""},{default:E(()=>[w(y,{keypath:"topBar.menu.file"})]),_:1})]),_:1},8,["options"]),w(g(co),{options:u.edit,placement:"bottom-start",trigger:"click",onSelect:m},{default:E(()=>[w(g(rt),{quaternary:""},{default:E(()=>[w(y,{keypath:"topBar.menu.edit"})]),_:1})]),_:1},8,["options"]),w(g(co),{options:u.view,placement:"bottom-start",trigger:"click",onSelect:m},{default:E(()=>[w(g(rt),{quaternary:""},{default:E(()=>[w(y,{keypath:"topBar.menu.view"})]),_:1})]),_:1},8,["options"]),w(g(co),{options:u.tool,placement:"bottom-start",trigger:"click",onSelect:m},{default:E(()=>[w(g(rt),{quaternary:""},{default:E(()=>[w(y,{keypath:"topBar.menu.tool"})]),_:1})]),_:1},8,["options"]),w(g(Qs),{vertical:""})]),x("div",hM,[w(g(co),{options:[{label:g(c)("topBar.menu.file"),key:"sub-file",children:u.file},{label:g(c)("topBar.menu.edit"),key:"sub-edit",children:u.edit},{label:g(c)("topBar.menu.view"),key:"sub-view",children:u.view},{label:g(c)("topBar.menu.tool"),key:"sub-tool",children:u.tool}],trigger:"click",onSelect:m},{default:E(()=>[w(g(rt),{circle:"",secondary:""},{default:E(()=>[w(g(gi),{size:"24"},{default:E(()=>[w(g(Yu))]),_:1})]),_:1})]),_:1},8,["options"])]),x("div",uM,[w(g(rt),{quaternary:g(t).editMode!=="edit",type:g(t).editMode==="edit"?"primary":"default",onClick:p[0]||(p[0]=b=>g(t).editMode="edit")},{default:E(()=>[w(y,{keypath:"topBar.modeBtns.edit"})]),_:1},8,["quaternary","type"]),w(g(rt),{quaternary:g(t).editMode!=="sync",type:g(t).editMode==="sync"?"primary":"default",onClick:p[1]||(p[1]=b=>g(t).editMode="sync")},{default:E(()=>[w(y,{keypath:"topBar.modeBtns.sync"})]),_:1},8,["quaternary","type"]),w(g(rt),{quaternary:g(t).editMode!=="amll-preview",type:g(t).editMode==="amll-preview"?"primary":"default",onClick:p[2]||(p[2]=b=>g(t).editMode="amll-preview")},{default:E(()=>[w(y,{keypath:"topBar.modeBtns.preview"})]),_:1},8,["quaternary","type"])]),x("div",dM,[w(y,{keypath:"topBar.appName"})])]),_:1}),w(g(ri),{show:s.value,"onUpdate:show":p[4]||(p[4]=b=>s.value=b),title:g(c)("aboutModal.appName"),preset:"card",style:{"max-width":"600px"},"transform-origin":"center"},{default:E(()=>[w(g(zi),{vertical:""},{default:E(()=>[x("div",null,[w(y,{keypath:"aboutModal.description"})]),w(g(zi),null,{default:E(()=>[w(g(rt),{onClick:d},{default:E(()=>[w(y,{keypath:"aboutModal.githubBtn"})]),_:1}),w(g(rt),{onClick:p[3]||(p[3]=b=>{g(o).showingTutorial=!0,s.value=!1})},{default:E(()=>[w(y,{keypath:"aboutModal.tutorialBtn"})]),_:1})]),_:1})]),_:1})]),_:1},8,["show","title"])],64)}}}),pM=Fe(fM,[["__scopeId","data-v-a396c1b6"]]),mM={style:{height:"100%",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"16px"}},gM={style:{height:"100%",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"16px"}},yM={style:{height:"100%",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",gap:"16px"}},vM=Q({__name:"App",setup(i){const t=Yc(()=>nn(()=>import("./LyricEditor-BmfyCJHx.js").then(async a=>(await a.__tla,a)),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),e=Yc(()=>nn(()=>import("./LyricSyncEditor-CVwpWnbO.js").then(async a=>(await a.__tla,a)),__vite__mapDeps([6,2,1,3,4,7]),import.meta.url)),r=Yc(()=>nn(()=>import("./AMLLPreviewView-CNgp4rv2.js").then(async a=>(await a.__tla,a)),__vite__mapDeps([8,3,1,4,9]),import.meta.url)),n=UM(),o=_l(),s=so(),l=Jt({useScope:"global"});return zM(a=>(s.error({title:l.t("runtimeError.title"),content:l.t("runtimeError.content",[String(a.stack??a)])}),console.error(a),!1)),hr(()=>{window.addEventListener("beforeunload",a=>(a.preventDefault(),a.returnValue=""))}),(a,c)=>{const h=De("i18n-t");return W(),Z(Oe,null,[w(g(jM)),w(g(KM),{style:qM({"--att-theme-color":g(n).primaryColorSuppl,"--att-theme-color-hover":g(n).primaryColorHover,"--att-theme-color-pressed":g(n).primaryColorPressed,"--att-border-color":g(n).borderColor,"--att-divider-color":g(n).dividerColor,"--att-height-medium":g(n).heightMedium}),"content-style":"display: flex; flex-direction: column;",position:"absolute"},{default:E(()=>[w(pM),w(g($M),{style:{flex:"1"}},{default:E(()=>[g(o).editMode==="edit"?(W(),xt(Kc,{key:0},{fallback:E(()=>[x("div",mM,[w(g(qc)),x("div",null,[w(h,{keypath:"app.loadingEditPage"})])])]),default:E(()=>[w(g(t))]),_:1})):g(o).editMode==="sync"?(W(),xt(Kc,{key:1},{fallback:E(()=>[x("div",gM,[w(g(qc)),x("div",null,[w(h,{keypath:"app.loadingSyncPage"})])])]),default:E(()=>[w(g(e))]),_:1})):g(o).editMode==="amll-preview"?(W(),xt(Kc,{key:2},{fallback:E(()=>[x("div",yM,[w(g(qc)),x("div",null,[w(h,{keypath:"app.loadingAMLLPreviewPage"})])])]),default:E(()=>[w(g(r))]),_:1})):ur("",!0)]),_:1}),w(Cf)]),_:1},8,["style"]),w(Df),w(FA),w(_A),w(HA),w(kA),w(If),w(LA),w(RA),w(IA),w(Nf),ur("",!0)],64)}}}),wM=Q({__name:"Main",setup(i){const t=YM(),e=Dt(()=>t.value==="dark"?GM:void 0);return(r,n)=>(W(),xt(g(JM),{theme:e.value},{default:E(()=>[w(g(QM),null,{default:E(()=>[w(g(XM),null,{default:E(()=>[w(vM)]),_:1})]),_:1})]),_:1},8,["theme"]))}});window.document.addEventListener("keydown",i=>{const t=i.target.nodeName;t!=="TEXTAREA"&&t!=="INPUT"&&i.code==="Space"&&i.preventDefault()}),ZM(wM).use(Lo).use(ie).mount("#root")})();export{Gc as T,en as U,rn as _,eC as __tla,We as a,pr as b,ji as c,Fe as d,Jt as e,yi as f,Jc as g,nn as h,ie as i,ge as j,Xc as s,Ve as u};
